2021-02-24 13:14:14.122524: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-02-24 13:14:14.122596: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
LOADING DICO FINI
1000 edges added on 111397   --------   1 % 
2000 edges added on 111397   --------   2 % 
3000 edges added on 111397   --------   3 % 
4000 edges added on 111397   --------   4 % 
5000 edges added on 111397   --------   4 % 
6000 edges added on 111397   --------   5 % 
7000 edges added on 111397   --------   6 % 
8000 edges added on 111397   --------   7 % 
9000 edges added on 111397   --------   8 % 
10000 edges added on 111397   --------   9 % 
11000 edges added on 111397   --------   10 % 
12000 edges added on 111397   --------   11 % 
13000 edges added on 111397   --------   12 % 
14000 edges added on 111397   --------   13 % 
15000 edges added on 111397   --------   13 % 
16000 edges added on 111397   --------   14 % 
17000 edges added on 111397   --------   15 % 
18000 edges added on 111397   --------   16 % 
19000 edges added on 111397   --------   17 % 
20000 edges added on 111397   --------   18 % 
21000 edges added on 111397   --------   19 % 
22000 edges added on 111397   --------   20 % 
23000 edges added on 111397   --------   21 % 
24000 edges added on 111397   --------   22 % 
25000 edges added on 111397   --------   22 % 
26000 edges added on 111397   --------   23 % 
27000 edges added on 111397   --------   24 % 
28000 edges added on 111397   --------   25 % 
29000 edges added on 111397   --------   26 % 
30000 edges added on 111397   --------   27 % 
31000 edges added on 111397   --------   28 % 
32000 edges added on 111397   --------   29 % 
33000 edges added on 111397   --------   30 % 
34000 edges added on 111397   --------   31 % 
35000 edges added on 111397   --------   31 % 
36000 edges added on 111397   --------   32 % 
37000 edges added on 111397   --------   33 % 
38000 edges added on 111397   --------   34 % 
39000 edges added on 111397   --------   35 % 
40000 edges added on 111397   --------   36 % 
41000 edges added on 111397   --------   37 % 
42000 edges added on 111397   --------   38 % 
43000 edges added on 111397   --------   39 % 
44000 edges added on 111397   --------   39 % 
45000 edges added on 111397   --------   40 % 
46000 edges added on 111397   --------   41 % 
47000 edges added on 111397   --------   42 % 
48000 edges added on 111397   --------   43 % 
49000 edges added on 111397   --------   44 % 
50000 edges added on 111397   --------   45 % 
51000 edges added on 111397   --------   46 % 
52000 edges added on 111397   --------   47 % 
53000 edges added on 111397   --------   48 % 
54000 edges added on 111397   --------   48 % 
55000 edges added on 111397   --------   49 % 
56000 edges added on 111397   --------   50 % 
57000 edges added on 111397   --------   51 % 
58000 edges added on 111397   --------   52 % 
59000 edges added on 111397   --------   53 % 
60000 edges added on 111397   --------   54 % 
61000 edges added on 111397   --------   55 % 
62000 edges added on 111397   --------   56 % 
63000 edges added on 111397   --------   57 % 
64000 edges added on 111397   --------   57 % 
65000 edges added on 111397   --------   58 % 
66000 edges added on 111397   --------   59 % 
67000 edges added on 111397   --------   60 % 
68000 edges added on 111397   --------   61 % 
69000 edges added on 111397   --------   62 % 
70000 edges added on 111397   --------   63 % 
71000 edges added on 111397   --------   64 % 
72000 edges added on 111397   --------   65 % 
73000 edges added on 111397   --------   66 % 
74000 edges added on 111397   --------   66 % 
75000 edges added on 111397   --------   67 % 
76000 edges added on 111397   --------   68 % 
77000 edges added on 111397   --------   69 % 
78000 edges added on 111397   --------   70 % 
79000 edges added on 111397   --------   71 % 
80000 edges added on 111397   --------   72 % 
81000 edges added on 111397   --------   73 % 
82000 edges added on 111397   --------   74 % 
83000 edges added on 111397   --------   75 % 
84000 edges added on 111397   --------   75 % 
85000 edges added on 111397   --------   76 % 
86000 edges added on 111397   --------   77 % 
87000 edges added on 111397   --------   78 % 
88000 edges added on 111397   --------   79 % 
89000 edges added on 111397   --------   80 % 
90000 edges added on 111397   --------   81 % 
91000 edges added on 111397   --------   82 % 
92000 edges added on 111397   --------   83 % 
93000 edges added on 111397   --------   83 % 
94000 edges added on 111397   --------   84 % 
95000 edges added on 111397   --------   85 % 
96000 edges added on 111397   --------   86 % 
97000 edges added on 111397   --------   87 % 
98000 edges added on 111397   --------   88 % 
99000 edges added on 111397   --------   89 % 
100000 edges added on 111397   --------   90 % 
101000 edges added on 111397   --------   91 % 
102000 edges added on 111397   --------   92 % 
103000 edges added on 111397   --------   92 % 
104000 edges added on 111397   --------   93 % 
105000 edges added on 111397   --------   94 % 
106000 edges added on 111397   --------   95 % 
107000 edges added on 111397   --------   96 % 
108000 edges added on 111397   --------   97 % 
109000 edges added on 111397   --------   98 % 
110000 edges added on 111397   --------   99 % 
111000 edges added on 111397   --------   100 % 
avant: 7685
apres: 7301
2021-02-24 13:14:51.956427: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-02-24 13:14:51.957058: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-02-24 13:14:51.957092: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-02-24 13:14:51.957145: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (cedar006.saclay.inria.fr): /proc/driver/nvidia/version does not exist
2021-02-24 13:14:51.962636: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
EPOCH  0 #################################
/data/projet_citations/sage/edgeMinibatch.py:119: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.train_edges[i][2])
509
loss: tf.Tensor(1.1265514, shape=(), dtype=float32)
loss: tf.Tensor(1.0467683, shape=(), dtype=float32)
loss: tf.Tensor(0.9969005, shape=(), dtype=float32)
loss: tf.Tensor(0.9710691, shape=(), dtype=float32)
loss: tf.Tensor(0.9838172, shape=(), dtype=float32)
loss: tf.Tensor(0.98652816, shape=(), dtype=float32)
loss: tf.Tensor(0.96530783, shape=(), dtype=float32)
loss: tf.Tensor(0.95108575, shape=(), dtype=float32)
loss: tf.Tensor(0.939185, shape=(), dtype=float32)
loss: tf.Tensor(0.8770828, shape=(), dtype=float32)
loss: tf.Tensor(1.0156534, shape=(), dtype=float32)
loss: tf.Tensor(1.0530142, shape=(), dtype=float32)
loss: tf.Tensor(0.97495043, shape=(), dtype=float32)
loss: tf.Tensor(0.94941527, shape=(), dtype=float32)
loss: tf.Tensor(0.9340845, shape=(), dtype=float32)
loss: tf.Tensor(0.8716343, shape=(), dtype=float32)
loss: tf.Tensor(0.97419894, shape=(), dtype=float32)
loss: tf.Tensor(0.93840635, shape=(), dtype=float32)
loss: tf.Tensor(1.0356275, shape=(), dtype=float32)
loss: tf.Tensor(1.028448, shape=(), dtype=float32)
loss: tf.Tensor(0.9537931, shape=(), dtype=float32)
loss: tf.Tensor(0.94070905, shape=(), dtype=float32)
loss: tf.Tensor(0.98277074, shape=(), dtype=float32)
loss: tf.Tensor(0.82839423, shape=(), dtype=float32)
loss: tf.Tensor(0.917567, shape=(), dtype=float32)
loss: tf.Tensor(0.87860274, shape=(), dtype=float32)
loss: tf.Tensor(0.81151086, shape=(), dtype=float32)
loss: tf.Tensor(0.8096315, shape=(), dtype=float32)
loss: tf.Tensor(0.91488105, shape=(), dtype=float32)
loss: tf.Tensor(1.0225431, shape=(), dtype=float32)
loss: tf.Tensor(0.9859587, shape=(), dtype=float32)
loss: tf.Tensor(0.9335155, shape=(), dtype=float32)
loss: tf.Tensor(0.984185, shape=(), dtype=float32)
loss: tf.Tensor(0.93584025, shape=(), dtype=float32)
loss: tf.Tensor(0.9308068, shape=(), dtype=float32)
loss: tf.Tensor(0.96354836, shape=(), dtype=float32)
loss: tf.Tensor(0.94277173, shape=(), dtype=float32)
loss: tf.Tensor(0.8840876, shape=(), dtype=float32)
loss: tf.Tensor(1.0064597, shape=(), dtype=float32)
loss: tf.Tensor(1.0374806, shape=(), dtype=float32)
loss: tf.Tensor(0.94403464, shape=(), dtype=float32)
loss: tf.Tensor(0.97769326, shape=(), dtype=float32)
loss: tf.Tensor(0.9269515, shape=(), dtype=float32)
loss: tf.Tensor(0.9933415, shape=(), dtype=float32)
loss: tf.Tensor(0.8672699, shape=(), dtype=float32)
loss: tf.Tensor(0.86274207, shape=(), dtype=float32)
loss: tf.Tensor(0.86937356, shape=(), dtype=float32)
loss: tf.Tensor(0.90825915, shape=(), dtype=float32)
loss: tf.Tensor(0.9245745, shape=(), dtype=float32)
loss: tf.Tensor(0.95394117, shape=(), dtype=float32)
loss: tf.Tensor(0.7984715, shape=(), dtype=float32)
loss: tf.Tensor(1.0079513, shape=(), dtype=float32)
loss: tf.Tensor(0.9683353, shape=(), dtype=float32)
loss: tf.Tensor(0.8583993, shape=(), dtype=float32)
loss: tf.Tensor(0.9547622, shape=(), dtype=float32)
loss: tf.Tensor(1.0094749, shape=(), dtype=float32)
loss: tf.Tensor(0.9805079, shape=(), dtype=float32)
loss: tf.Tensor(0.89567834, shape=(), dtype=float32)
loss: tf.Tensor(0.88794035, shape=(), dtype=float32)
loss: tf.Tensor(0.92779136, shape=(), dtype=float32)
loss: tf.Tensor(0.91066855, shape=(), dtype=float32)
loss: tf.Tensor(0.8947549, shape=(), dtype=float32)
loss: tf.Tensor(0.961857, shape=(), dtype=float32)
loss: tf.Tensor(0.9632795, shape=(), dtype=float32)
loss: tf.Tensor(0.92672616, shape=(), dtype=float32)
loss: tf.Tensor(0.9128597, shape=(), dtype=float32)
loss: tf.Tensor(0.8123684, shape=(), dtype=float32)
loss: tf.Tensor(0.89344895, shape=(), dtype=float32)
loss: tf.Tensor(0.94702286, shape=(), dtype=float32)
loss: tf.Tensor(1.043687, shape=(), dtype=float32)
loss: tf.Tensor(1.01158, shape=(), dtype=float32)
loss: tf.Tensor(0.9426125, shape=(), dtype=float32)
loss: tf.Tensor(0.9353321, shape=(), dtype=float32)
loss: tf.Tensor(0.52732784, shape=(), dtype=float32)
TEST LOSS: #####################################
/data/projet_citations/sage/edgeMinibatch.py:163: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.test_edges[i][2])
2021-02-24 13:38:56.605905: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-02-24 13:38:56.606794: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2399860000 Hz
tf.Tensor(1.0110561, shape=(), dtype=float32)
F1 SCORE:
0.23494054
EPOCH  1 #################################
loss: tf.Tensor(0.9481895, shape=(), dtype=float32)
loss: tf.Tensor(0.86011124, shape=(), dtype=float32)
loss: tf.Tensor(0.90303594, shape=(), dtype=float32)
loss: tf.Tensor(1.0442452, shape=(), dtype=float32)
loss: tf.Tensor(0.9453329, shape=(), dtype=float32)
loss: tf.Tensor(0.9129998, shape=(), dtype=float32)
loss: tf.Tensor(0.90076274, shape=(), dtype=float32)
loss: tf.Tensor(0.8708217, shape=(), dtype=float32)
loss: tf.Tensor(0.8964601, shape=(), dtype=float32)
loss: tf.Tensor(0.85584676, shape=(), dtype=float32)
loss: tf.Tensor(0.87311673, shape=(), dtype=float32)
loss: tf.Tensor(1.050935, shape=(), dtype=float32)
loss: tf.Tensor(0.9165826, shape=(), dtype=float32)
loss: tf.Tensor(0.94262105, shape=(), dtype=float32)
loss: tf.Tensor(0.9203227, shape=(), dtype=float32)
loss: tf.Tensor(0.93000567, shape=(), dtype=float32)
loss: tf.Tensor(0.91236025, shape=(), dtype=float32)
loss: tf.Tensor(0.9934207, shape=(), dtype=float32)
loss: tf.Tensor(0.885027, shape=(), dtype=float32)
loss: tf.Tensor(0.8587151, shape=(), dtype=float32)
loss: tf.Tensor(0.8852735, shape=(), dtype=float32)
loss: tf.Tensor(0.96488976, shape=(), dtype=float32)
loss: tf.Tensor(0.90305406, shape=(), dtype=float32)
loss: tf.Tensor(0.9237394, shape=(), dtype=float32)
loss: tf.Tensor(0.9459251, shape=(), dtype=float32)
loss: tf.Tensor(0.90023375, shape=(), dtype=float32)
loss: tf.Tensor(0.8816631, shape=(), dtype=float32)
loss: tf.Tensor(0.94509447, shape=(), dtype=float32)
loss: tf.Tensor(0.9653682, shape=(), dtype=float32)
loss: tf.Tensor(0.9020192, shape=(), dtype=float32)
loss: tf.Tensor(0.9811404, shape=(), dtype=float32)
loss: tf.Tensor(0.8735965, shape=(), dtype=float32)
loss: tf.Tensor(0.9184537, shape=(), dtype=float32)
loss: tf.Tensor(0.9894924, shape=(), dtype=float32)
loss: tf.Tensor(0.93708754, shape=(), dtype=float32)
loss: tf.Tensor(0.8601041, shape=(), dtype=float32)
loss: tf.Tensor(0.9021536, shape=(), dtype=float32)
loss: tf.Tensor(0.8307021, shape=(), dtype=float32)
loss: tf.Tensor(0.86897296, shape=(), dtype=float32)
loss: tf.Tensor(0.84116244, shape=(), dtype=float32)
loss: tf.Tensor(0.87788755, shape=(), dtype=float32)
loss: tf.Tensor(0.89614356, shape=(), dtype=float32)
loss: tf.Tensor(0.8992147, shape=(), dtype=float32)
loss: tf.Tensor(0.82590514, shape=(), dtype=float32)
loss: tf.Tensor(0.8702362, shape=(), dtype=float32)
loss: tf.Tensor(0.9299309, shape=(), dtype=float32)
loss: tf.Tensor(0.99287695, shape=(), dtype=float32)
loss: tf.Tensor(0.869087, shape=(), dtype=float32)
loss: tf.Tensor(0.83141136, shape=(), dtype=float32)
loss: tf.Tensor(0.89018166, shape=(), dtype=float32)
loss: tf.Tensor(1.0146468, shape=(), dtype=float32)
loss: tf.Tensor(0.88687396, shape=(), dtype=float32)
loss: tf.Tensor(0.90592456, shape=(), dtype=float32)
loss: tf.Tensor(0.91872823, shape=(), dtype=float32)
loss: tf.Tensor(0.8890482, shape=(), dtype=float32)
loss: tf.Tensor(0.8233961, shape=(), dtype=float32)
loss: tf.Tensor(0.92119974, shape=(), dtype=float32)
loss: tf.Tensor(1.0110054, shape=(), dtype=float32)
loss: tf.Tensor(0.90146184, shape=(), dtype=float32)
loss: tf.Tensor(0.9464198, shape=(), dtype=float32)
loss: tf.Tensor(0.7946448, shape=(), dtype=float32)
loss: tf.Tensor(0.94740295, shape=(), dtype=float32)
loss: tf.Tensor(0.8531205, shape=(), dtype=float32)
loss: tf.Tensor(0.8924631, shape=(), dtype=float32)
loss: tf.Tensor(0.9057506, shape=(), dtype=float32)
loss: tf.Tensor(0.8583467, shape=(), dtype=float32)
loss: tf.Tensor(0.8521778, shape=(), dtype=float32)
loss: tf.Tensor(0.8346527, shape=(), dtype=float32)
loss: tf.Tensor(0.83654284, shape=(), dtype=float32)
loss: tf.Tensor(0.98440504, shape=(), dtype=float32)
loss: tf.Tensor(0.88547647, shape=(), dtype=float32)
loss: tf.Tensor(0.827438, shape=(), dtype=float32)
loss: tf.Tensor(0.7793718, shape=(), dtype=float32)
loss: tf.Tensor(0.52621126, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.97111064, shape=(), dtype=float32)
F1 SCORE:
0.31063262
EPOCH  2 #################################
loss: tf.Tensor(0.9693355, shape=(), dtype=float32)
loss: tf.Tensor(0.97562814, shape=(), dtype=float32)
loss: tf.Tensor(0.8950397, shape=(), dtype=float32)
loss: tf.Tensor(0.9985676, shape=(), dtype=float32)
loss: tf.Tensor(0.96034485, shape=(), dtype=float32)
loss: tf.Tensor(0.8772966, shape=(), dtype=float32)
loss: tf.Tensor(0.7682309, shape=(), dtype=float32)
loss: tf.Tensor(0.8435223, shape=(), dtype=float32)
loss: tf.Tensor(0.9282513, shape=(), dtype=float32)
loss: tf.Tensor(0.9238335, shape=(), dtype=float32)
loss: tf.Tensor(0.8035888, shape=(), dtype=float32)
loss: tf.Tensor(0.84529305, shape=(), dtype=float32)
loss: tf.Tensor(1.0024438, shape=(), dtype=float32)
loss: tf.Tensor(0.8197142, shape=(), dtype=float32)
loss: tf.Tensor(0.9392851, shape=(), dtype=float32)
loss: tf.Tensor(0.8899633, shape=(), dtype=float32)
loss: tf.Tensor(0.9175031, shape=(), dtype=float32)
loss: tf.Tensor(0.96134996, shape=(), dtype=float32)
loss: tf.Tensor(0.88465685, shape=(), dtype=float32)
loss: tf.Tensor(0.74751824, shape=(), dtype=float32)
loss: tf.Tensor(0.854602, shape=(), dtype=float32)
loss: tf.Tensor(0.8570938, shape=(), dtype=float32)
loss: tf.Tensor(0.8939895, shape=(), dtype=float32)
loss: tf.Tensor(0.9442266, shape=(), dtype=float32)
loss: tf.Tensor(0.85303426, shape=(), dtype=float32)
loss: tf.Tensor(0.912875, shape=(), dtype=float32)
loss: tf.Tensor(0.9387289, shape=(), dtype=float32)
loss: tf.Tensor(0.90639246, shape=(), dtype=float32)
loss: tf.Tensor(0.87926567, shape=(), dtype=float32)
loss: tf.Tensor(0.8835242, shape=(), dtype=float32)
loss: tf.Tensor(0.8345375, shape=(), dtype=float32)
loss: tf.Tensor(0.79841727, shape=(), dtype=float32)
loss: tf.Tensor(0.82707345, shape=(), dtype=float32)
loss: tf.Tensor(1.0523288, shape=(), dtype=float32)
loss: tf.Tensor(0.92541814, shape=(), dtype=float32)
loss: tf.Tensor(0.8360754, shape=(), dtype=float32)
loss: tf.Tensor(0.870187, shape=(), dtype=float32)
loss: tf.Tensor(0.92782545, shape=(), dtype=float32)
loss: tf.Tensor(0.87057954, shape=(), dtype=float32)
loss: tf.Tensor(0.9351235, shape=(), dtype=float32)
loss: tf.Tensor(0.8203384, shape=(), dtype=float32)
loss: tf.Tensor(0.87769336, shape=(), dtype=float32)
loss: tf.Tensor(0.7907867, shape=(), dtype=float32)
loss: tf.Tensor(0.88445544, shape=(), dtype=float32)
loss: tf.Tensor(0.79794276, shape=(), dtype=float32)
loss: tf.Tensor(0.8755246, shape=(), dtype=float32)
loss: tf.Tensor(0.9367823, shape=(), dtype=float32)
loss: tf.Tensor(0.99344987, shape=(), dtype=float32)
loss: tf.Tensor(0.8114551, shape=(), dtype=float32)
loss: tf.Tensor(0.9461251, shape=(), dtype=float32)
loss: tf.Tensor(0.84931266, shape=(), dtype=float32)
loss: tf.Tensor(0.8600538, shape=(), dtype=float32)
loss: tf.Tensor(0.85078704, shape=(), dtype=float32)
loss: tf.Tensor(0.93583906, shape=(), dtype=float32)
loss: tf.Tensor(0.8660766, shape=(), dtype=float32)
loss: tf.Tensor(0.8703032, shape=(), dtype=float32)
loss: tf.Tensor(0.90188235, shape=(), dtype=float32)
loss: tf.Tensor(0.8508474, shape=(), dtype=float32)
loss: tf.Tensor(0.8188972, shape=(), dtype=float32)
loss: tf.Tensor(0.9416619, shape=(), dtype=float32)
loss: tf.Tensor(0.833826, shape=(), dtype=float32)
loss: tf.Tensor(0.9340822, shape=(), dtype=float32)
loss: tf.Tensor(0.8253424, shape=(), dtype=float32)
loss: tf.Tensor(0.8683997, shape=(), dtype=float32)
loss: tf.Tensor(0.8252461, shape=(), dtype=float32)
loss: tf.Tensor(0.8498138, shape=(), dtype=float32)
loss: tf.Tensor(0.8544953, shape=(), dtype=float32)
loss: tf.Tensor(0.8520067, shape=(), dtype=float32)
loss: tf.Tensor(0.99018174, shape=(), dtype=float32)
loss: tf.Tensor(0.9279343, shape=(), dtype=float32)
loss: tf.Tensor(0.85262483, shape=(), dtype=float32)
loss: tf.Tensor(0.8222136, shape=(), dtype=float32)
loss: tf.Tensor(0.80376023, shape=(), dtype=float32)
loss: tf.Tensor(0.9146663, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.98358184, shape=(), dtype=float32)
F1 SCORE:
0.31767753
EPOCH  3 #################################
loss: tf.Tensor(0.7382003, shape=(), dtype=float32)
loss: tf.Tensor(0.8813578, shape=(), dtype=float32)
loss: tf.Tensor(0.9041419, shape=(), dtype=float32)
loss: tf.Tensor(0.9608882, shape=(), dtype=float32)
loss: tf.Tensor(0.93913406, shape=(), dtype=float32)
loss: tf.Tensor(0.8953944, shape=(), dtype=float32)
loss: tf.Tensor(0.83473116, shape=(), dtype=float32)
loss: tf.Tensor(0.9769545, shape=(), dtype=float32)
loss: tf.Tensor(0.9146993, shape=(), dtype=float32)
loss: tf.Tensor(0.9044273, shape=(), dtype=float32)
loss: tf.Tensor(0.93227506, shape=(), dtype=float32)
loss: tf.Tensor(0.9151346, shape=(), dtype=float32)
loss: tf.Tensor(0.8684107, shape=(), dtype=float32)
loss: tf.Tensor(0.9169235, shape=(), dtype=float32)
loss: tf.Tensor(0.95035535, shape=(), dtype=float32)
loss: tf.Tensor(1.0996289, shape=(), dtype=float32)
loss: tf.Tensor(0.8822554, shape=(), dtype=float32)
loss: tf.Tensor(0.8665171, shape=(), dtype=float32)
loss: tf.Tensor(1.0045183, shape=(), dtype=float32)
loss: tf.Tensor(0.9922631, shape=(), dtype=float32)
loss: tf.Tensor(0.8568918, shape=(), dtype=float32)
loss: tf.Tensor(0.92437166, shape=(), dtype=float32)
loss: tf.Tensor(0.89744735, shape=(), dtype=float32)
loss: tf.Tensor(0.86475515, shape=(), dtype=float32)
loss: tf.Tensor(0.8934628, shape=(), dtype=float32)
loss: tf.Tensor(0.9368401, shape=(), dtype=float32)
loss: tf.Tensor(0.8832005, shape=(), dtype=float32)
loss: tf.Tensor(0.7944194, shape=(), dtype=float32)
loss: tf.Tensor(0.8773389, shape=(), dtype=float32)
loss: tf.Tensor(0.8251123, shape=(), dtype=float32)
loss: tf.Tensor(0.93957084, shape=(), dtype=float32)
loss: tf.Tensor(0.7782486, shape=(), dtype=float32)
loss: tf.Tensor(0.82404864, shape=(), dtype=float32)
loss: tf.Tensor(0.8370132, shape=(), dtype=float32)
loss: tf.Tensor(0.9345091, shape=(), dtype=float32)
loss: tf.Tensor(0.9521219, shape=(), dtype=float32)
loss: tf.Tensor(0.8239491, shape=(), dtype=float32)
loss: tf.Tensor(0.87364304, shape=(), dtype=float32)
loss: tf.Tensor(0.9056491, shape=(), dtype=float32)
loss: tf.Tensor(0.83803254, shape=(), dtype=float32)
loss: tf.Tensor(0.95484954, shape=(), dtype=float32)
loss: tf.Tensor(1.0097123, shape=(), dtype=float32)
loss: tf.Tensor(0.89102155, shape=(), dtype=float32)
loss: tf.Tensor(0.86127555, shape=(), dtype=float32)
loss: tf.Tensor(0.8858932, shape=(), dtype=float32)
loss: tf.Tensor(0.8318168, shape=(), dtype=float32)
loss: tf.Tensor(0.8870221, shape=(), dtype=float32)
loss: tf.Tensor(0.8177156, shape=(), dtype=float32)
loss: tf.Tensor(0.98745185, shape=(), dtype=float32)
loss: tf.Tensor(0.9218106, shape=(), dtype=float32)
loss: tf.Tensor(0.85843134, shape=(), dtype=float32)
loss: tf.Tensor(0.9210996, shape=(), dtype=float32)
loss: tf.Tensor(0.8884332, shape=(), dtype=float32)
loss: tf.Tensor(0.8440707, shape=(), dtype=float32)
loss: tf.Tensor(0.90281844, shape=(), dtype=float32)
loss: tf.Tensor(0.91317195, shape=(), dtype=float32)
loss: tf.Tensor(0.77086675, shape=(), dtype=float32)
loss: tf.Tensor(0.86379683, shape=(), dtype=float32)
loss: tf.Tensor(0.7893725, shape=(), dtype=float32)
loss: tf.Tensor(0.942361, shape=(), dtype=float32)
loss: tf.Tensor(0.8339212, shape=(), dtype=float32)
loss: tf.Tensor(0.9239172, shape=(), dtype=float32)
loss: tf.Tensor(1.0175954, shape=(), dtype=float32)
loss: tf.Tensor(0.89739084, shape=(), dtype=float32)
loss: tf.Tensor(0.82536644, shape=(), dtype=float32)
loss: tf.Tensor(0.867606, shape=(), dtype=float32)
loss: tf.Tensor(0.8235719, shape=(), dtype=float32)
loss: tf.Tensor(0.7312414, shape=(), dtype=float32)
loss: tf.Tensor(0.86514336, shape=(), dtype=float32)
loss: tf.Tensor(0.87959504, shape=(), dtype=float32)
loss: tf.Tensor(0.8042209, shape=(), dtype=float32)
loss: tf.Tensor(0.76459974, shape=(), dtype=float32)
loss: tf.Tensor(0.76937205, shape=(), dtype=float32)
loss: tf.Tensor(0.5146012, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.97257364, shape=(), dtype=float32)
F1 SCORE:
0.3123217
EPOCH  4 #################################
loss: tf.Tensor(0.9742144, shape=(), dtype=float32)
loss: tf.Tensor(0.79642516, shape=(), dtype=float32)
loss: tf.Tensor(0.88009775, shape=(), dtype=float32)
loss: tf.Tensor(0.7897646, shape=(), dtype=float32)
loss: tf.Tensor(0.8407293, shape=(), dtype=float32)
loss: tf.Tensor(0.8687149, shape=(), dtype=float32)
loss: tf.Tensor(0.9535661, shape=(), dtype=float32)
loss: tf.Tensor(0.87100714, shape=(), dtype=float32)
loss: tf.Tensor(0.9234834, shape=(), dtype=float32)
loss: tf.Tensor(0.837335, shape=(), dtype=float32)
loss: tf.Tensor(0.9059369, shape=(), dtype=float32)
loss: tf.Tensor(0.83303183, shape=(), dtype=float32)
loss: tf.Tensor(0.896417, shape=(), dtype=float32)
loss: tf.Tensor(0.805715, shape=(), dtype=float32)
loss: tf.Tensor(0.8241898, shape=(), dtype=float32)
loss: tf.Tensor(0.8939283, shape=(), dtype=float32)
loss: tf.Tensor(0.9155581, shape=(), dtype=float32)
loss: tf.Tensor(0.9839932, shape=(), dtype=float32)
loss: tf.Tensor(0.8580764, shape=(), dtype=float32)
loss: tf.Tensor(0.8548143, shape=(), dtype=float32)
loss: tf.Tensor(0.9008751, shape=(), dtype=float32)
loss: tf.Tensor(0.8468987, shape=(), dtype=float32)
loss: tf.Tensor(0.92222714, shape=(), dtype=float32)
loss: tf.Tensor(0.82532686, shape=(), dtype=float32)
loss: tf.Tensor(0.8530652, shape=(), dtype=float32)
loss: tf.Tensor(0.8273331, shape=(), dtype=float32)
loss: tf.Tensor(0.82268834, shape=(), dtype=float32)
loss: tf.Tensor(0.8387443, shape=(), dtype=float32)
loss: tf.Tensor(0.9504521, shape=(), dtype=float32)
loss: tf.Tensor(0.9303959, shape=(), dtype=float32)
loss: tf.Tensor(0.8978446, shape=(), dtype=float32)
loss: tf.Tensor(0.9792183, shape=(), dtype=float32)
loss: tf.Tensor(0.8663286, shape=(), dtype=float32)
loss: tf.Tensor(0.83313704, shape=(), dtype=float32)
loss: tf.Tensor(0.8601097, shape=(), dtype=float32)
loss: tf.Tensor(0.8495376, shape=(), dtype=float32)
loss: tf.Tensor(0.8254275, shape=(), dtype=float32)
loss: tf.Tensor(0.91242576, shape=(), dtype=float32)
loss: tf.Tensor(0.8475181, shape=(), dtype=float32)
loss: tf.Tensor(0.8911343, shape=(), dtype=float32)
loss: tf.Tensor(0.9054085, shape=(), dtype=float32)
loss: tf.Tensor(0.8015019, shape=(), dtype=float32)
loss: tf.Tensor(0.8154075, shape=(), dtype=float32)
loss: tf.Tensor(0.78873277, shape=(), dtype=float32)
loss: tf.Tensor(0.78145164, shape=(), dtype=float32)
loss: tf.Tensor(0.8371091, shape=(), dtype=float32)
loss: tf.Tensor(0.8950255, shape=(), dtype=float32)
loss: tf.Tensor(0.82160926, shape=(), dtype=float32)
loss: tf.Tensor(0.8801622, shape=(), dtype=float32)
loss: tf.Tensor(0.94349146, shape=(), dtype=float32)
loss: tf.Tensor(0.80456, shape=(), dtype=float32)
loss: tf.Tensor(0.8275226, shape=(), dtype=float32)
loss: tf.Tensor(0.841358, shape=(), dtype=float32)
loss: tf.Tensor(0.8616317, shape=(), dtype=float32)
loss: tf.Tensor(0.936054, shape=(), dtype=float32)
loss: tf.Tensor(0.8890965, shape=(), dtype=float32)
loss: tf.Tensor(0.82940733, shape=(), dtype=float32)
loss: tf.Tensor(0.8798125, shape=(), dtype=float32)
loss: tf.Tensor(0.87933624, shape=(), dtype=float32)
loss: tf.Tensor(0.8647854, shape=(), dtype=float32)
loss: tf.Tensor(0.87066096, shape=(), dtype=float32)
loss: tf.Tensor(0.88563347, shape=(), dtype=float32)
loss: tf.Tensor(0.8242965, shape=(), dtype=float32)
loss: tf.Tensor(0.88598716, shape=(), dtype=float32)
loss: tf.Tensor(0.9795088, shape=(), dtype=float32)
loss: tf.Tensor(0.8922223, shape=(), dtype=float32)
loss: tf.Tensor(0.8585999, shape=(), dtype=float32)
loss: tf.Tensor(0.8382432, shape=(), dtype=float32)
loss: tf.Tensor(0.85332847, shape=(), dtype=float32)
loss: tf.Tensor(0.8126376, shape=(), dtype=float32)
loss: tf.Tensor(0.8800413, shape=(), dtype=float32)
loss: tf.Tensor(0.8217536, shape=(), dtype=float32)
loss: tf.Tensor(0.8645248, shape=(), dtype=float32)
loss: tf.Tensor(0.59058064, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:5 out of the last 5 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.98094964, shape=(), dtype=float32)
F1 SCORE:
0.34278846
EPOCH  5 #################################
loss: tf.Tensor(0.8633556, shape=(), dtype=float32)
loss: tf.Tensor(0.8947127, shape=(), dtype=float32)
loss: tf.Tensor(0.9144702, shape=(), dtype=float32)
loss: tf.Tensor(1.0526266, shape=(), dtype=float32)
loss: tf.Tensor(1.0605525, shape=(), dtype=float32)
loss: tf.Tensor(0.9370446, shape=(), dtype=float32)
loss: tf.Tensor(0.9446413, shape=(), dtype=float32)
loss: tf.Tensor(0.85881597, shape=(), dtype=float32)
loss: tf.Tensor(0.93761545, shape=(), dtype=float32)
loss: tf.Tensor(0.8094944, shape=(), dtype=float32)
loss: tf.Tensor(0.88250405, shape=(), dtype=float32)
loss: tf.Tensor(0.8822601, shape=(), dtype=float32)
loss: tf.Tensor(0.8369914, shape=(), dtype=float32)
loss: tf.Tensor(0.85447425, shape=(), dtype=float32)
loss: tf.Tensor(0.754965, shape=(), dtype=float32)
loss: tf.Tensor(0.76898444, shape=(), dtype=float32)
loss: tf.Tensor(0.90350145, shape=(), dtype=float32)
loss: tf.Tensor(0.8988929, shape=(), dtype=float32)
loss: tf.Tensor(0.83171153, shape=(), dtype=float32)
loss: tf.Tensor(0.9570575, shape=(), dtype=float32)
loss: tf.Tensor(0.90317845, shape=(), dtype=float32)
loss: tf.Tensor(0.85113305, shape=(), dtype=float32)
loss: tf.Tensor(0.8741648, shape=(), dtype=float32)
loss: tf.Tensor(0.920354, shape=(), dtype=float32)
loss: tf.Tensor(0.8184769, shape=(), dtype=float32)
loss: tf.Tensor(0.8926046, shape=(), dtype=float32)
loss: tf.Tensor(0.9672964, shape=(), dtype=float32)
loss: tf.Tensor(0.84092957, shape=(), dtype=float32)
loss: tf.Tensor(0.75333333, shape=(), dtype=float32)
loss: tf.Tensor(0.8364732, shape=(), dtype=float32)
loss: tf.Tensor(0.80962545, shape=(), dtype=float32)
loss: tf.Tensor(0.91897696, shape=(), dtype=float32)
loss: tf.Tensor(0.80562204, shape=(), dtype=float32)
loss: tf.Tensor(0.88766843, shape=(), dtype=float32)
loss: tf.Tensor(0.8894519, shape=(), dtype=float32)
loss: tf.Tensor(0.69610524, shape=(), dtype=float32)
loss: tf.Tensor(0.7951611, shape=(), dtype=float32)
loss: tf.Tensor(0.84369415, shape=(), dtype=float32)
loss: tf.Tensor(0.9388398, shape=(), dtype=float32)
loss: tf.Tensor(0.8474334, shape=(), dtype=float32)
loss: tf.Tensor(0.86319995, shape=(), dtype=float32)
loss: tf.Tensor(0.8143267, shape=(), dtype=float32)
loss: tf.Tensor(0.91270196, shape=(), dtype=float32)
loss: tf.Tensor(0.8709466, shape=(), dtype=float32)
loss: tf.Tensor(0.85549545, shape=(), dtype=float32)
loss: tf.Tensor(0.92232466, shape=(), dtype=float32)
loss: tf.Tensor(0.83723533, shape=(), dtype=float32)
loss: tf.Tensor(0.91911817, shape=(), dtype=float32)
loss: tf.Tensor(0.84754837, shape=(), dtype=float32)
loss: tf.Tensor(0.8460325, shape=(), dtype=float32)
loss: tf.Tensor(0.7931518, shape=(), dtype=float32)
loss: tf.Tensor(0.7541656, shape=(), dtype=float32)
loss: tf.Tensor(0.9177931, shape=(), dtype=float32)
loss: tf.Tensor(0.9468309, shape=(), dtype=float32)
loss: tf.Tensor(0.85138273, shape=(), dtype=float32)
loss: tf.Tensor(0.85933626, shape=(), dtype=float32)
loss: tf.Tensor(0.88602483, shape=(), dtype=float32)
loss: tf.Tensor(0.8557992, shape=(), dtype=float32)
loss: tf.Tensor(0.7858358, shape=(), dtype=float32)
loss: tf.Tensor(0.8584578, shape=(), dtype=float32)
loss: tf.Tensor(0.8741622, shape=(), dtype=float32)
loss: tf.Tensor(0.7314122, shape=(), dtype=float32)
loss: tf.Tensor(0.8365136, shape=(), dtype=float32)
loss: tf.Tensor(0.8609846, shape=(), dtype=float32)
loss: tf.Tensor(0.7918632, shape=(), dtype=float32)
loss: tf.Tensor(0.9467223, shape=(), dtype=float32)
loss: tf.Tensor(0.8863134, shape=(), dtype=float32)
loss: tf.Tensor(0.783322, shape=(), dtype=float32)
loss: tf.Tensor(0.84034467, shape=(), dtype=float32)
loss: tf.Tensor(0.8093662, shape=(), dtype=float32)
loss: tf.Tensor(0.7856718, shape=(), dtype=float32)
loss: tf.Tensor(0.79227304, shape=(), dtype=float32)
loss: tf.Tensor(0.8553279, shape=(), dtype=float32)
loss: tf.Tensor(0.5392213, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:6 out of the last 6 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9743255, shape=(), dtype=float32)
F1 SCORE:
0.35506597
EPOCH  6 #################################
loss: tf.Tensor(0.7956812, shape=(), dtype=float32)
loss: tf.Tensor(0.86318284, shape=(), dtype=float32)
loss: tf.Tensor(0.88980067, shape=(), dtype=float32)
loss: tf.Tensor(0.8558276, shape=(), dtype=float32)
loss: tf.Tensor(0.8767477, shape=(), dtype=float32)
loss: tf.Tensor(0.891316, shape=(), dtype=float32)
loss: tf.Tensor(0.87322444, shape=(), dtype=float32)
loss: tf.Tensor(1.0016514, shape=(), dtype=float32)
loss: tf.Tensor(0.839502, shape=(), dtype=float32)
loss: tf.Tensor(0.8807843, shape=(), dtype=float32)
loss: tf.Tensor(0.89143157, shape=(), dtype=float32)
loss: tf.Tensor(0.891697, shape=(), dtype=float32)
loss: tf.Tensor(0.96844983, shape=(), dtype=float32)
loss: tf.Tensor(0.8977929, shape=(), dtype=float32)
loss: tf.Tensor(0.8415497, shape=(), dtype=float32)
loss: tf.Tensor(0.9251107, shape=(), dtype=float32)
loss: tf.Tensor(0.8111382, shape=(), dtype=float32)
loss: tf.Tensor(0.933975, shape=(), dtype=float32)
loss: tf.Tensor(0.9259704, shape=(), dtype=float32)
loss: tf.Tensor(0.85391366, shape=(), dtype=float32)
loss: tf.Tensor(0.84421235, shape=(), dtype=float32)
loss: tf.Tensor(0.8414867, shape=(), dtype=float32)
loss: tf.Tensor(0.8019568, shape=(), dtype=float32)
loss: tf.Tensor(0.75848126, shape=(), dtype=float32)
loss: tf.Tensor(0.8457122, shape=(), dtype=float32)
loss: tf.Tensor(0.84765226, shape=(), dtype=float32)
loss: tf.Tensor(0.85737014, shape=(), dtype=float32)
loss: tf.Tensor(0.89237994, shape=(), dtype=float32)
loss: tf.Tensor(0.75746477, shape=(), dtype=float32)
loss: tf.Tensor(0.83109003, shape=(), dtype=float32)
loss: tf.Tensor(0.8536807, shape=(), dtype=float32)
loss: tf.Tensor(0.86015093, shape=(), dtype=float32)
loss: tf.Tensor(0.88247466, shape=(), dtype=float32)
loss: tf.Tensor(0.82186776, shape=(), dtype=float32)
loss: tf.Tensor(0.91995627, shape=(), dtype=float32)
loss: tf.Tensor(0.86182857, shape=(), dtype=float32)
loss: tf.Tensor(0.840233, shape=(), dtype=float32)
loss: tf.Tensor(0.9069361, shape=(), dtype=float32)
loss: tf.Tensor(0.86022377, shape=(), dtype=float32)
loss: tf.Tensor(0.78637224, shape=(), dtype=float32)
loss: tf.Tensor(0.7304221, shape=(), dtype=float32)
loss: tf.Tensor(0.82959, shape=(), dtype=float32)
loss: tf.Tensor(0.8982877, shape=(), dtype=float32)
loss: tf.Tensor(0.8361781, shape=(), dtype=float32)
loss: tf.Tensor(0.7930426, shape=(), dtype=float32)
loss: tf.Tensor(0.85667044, shape=(), dtype=float32)
loss: tf.Tensor(0.8439995, shape=(), dtype=float32)
loss: tf.Tensor(0.798406, shape=(), dtype=float32)
loss: tf.Tensor(0.8121946, shape=(), dtype=float32)
loss: tf.Tensor(0.9820176, shape=(), dtype=float32)
loss: tf.Tensor(0.7830389, shape=(), dtype=float32)
loss: tf.Tensor(0.8133785, shape=(), dtype=float32)
loss: tf.Tensor(0.8125076, shape=(), dtype=float32)
loss: tf.Tensor(0.766831, shape=(), dtype=float32)
loss: tf.Tensor(0.7222259, shape=(), dtype=float32)
loss: tf.Tensor(0.96248764, shape=(), dtype=float32)
loss: tf.Tensor(0.8793219, shape=(), dtype=float32)
loss: tf.Tensor(0.76448274, shape=(), dtype=float32)
loss: tf.Tensor(0.8085485, shape=(), dtype=float32)
loss: tf.Tensor(0.91456085, shape=(), dtype=float32)
loss: tf.Tensor(0.833535, shape=(), dtype=float32)
loss: tf.Tensor(0.8339637, shape=(), dtype=float32)
loss: tf.Tensor(0.8969936, shape=(), dtype=float32)
loss: tf.Tensor(0.8740559, shape=(), dtype=float32)
loss: tf.Tensor(0.90662646, shape=(), dtype=float32)
loss: tf.Tensor(0.7600771, shape=(), dtype=float32)
loss: tf.Tensor(0.8509544, shape=(), dtype=float32)
loss: tf.Tensor(0.9365017, shape=(), dtype=float32)
loss: tf.Tensor(0.7731332, shape=(), dtype=float32)
loss: tf.Tensor(0.7927781, shape=(), dtype=float32)
loss: tf.Tensor(0.88069296, shape=(), dtype=float32)
loss: tf.Tensor(0.8059859, shape=(), dtype=float32)
loss: tf.Tensor(0.84488726, shape=(), dtype=float32)
loss: tf.Tensor(0.54528093, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:7 out of the last 7 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.95994, shape=(), dtype=float32)
F1 SCORE:
0.35722634
EPOCH  7 #################################
loss: tf.Tensor(0.8221847, shape=(), dtype=float32)
loss: tf.Tensor(0.9550119, shape=(), dtype=float32)
loss: tf.Tensor(0.947339, shape=(), dtype=float32)
loss: tf.Tensor(0.8023865, shape=(), dtype=float32)
loss: tf.Tensor(1.070951, shape=(), dtype=float32)
loss: tf.Tensor(0.96551126, shape=(), dtype=float32)
loss: tf.Tensor(0.9307118, shape=(), dtype=float32)
loss: tf.Tensor(0.79697686, shape=(), dtype=float32)
loss: tf.Tensor(1.0690207, shape=(), dtype=float32)
loss: tf.Tensor(0.87928694, shape=(), dtype=float32)
loss: tf.Tensor(0.8215381, shape=(), dtype=float32)
loss: tf.Tensor(0.87275606, shape=(), dtype=float32)
loss: tf.Tensor(0.94284165, shape=(), dtype=float32)
loss: tf.Tensor(0.946827, shape=(), dtype=float32)
loss: tf.Tensor(0.9449425, shape=(), dtype=float32)
loss: tf.Tensor(0.84620774, shape=(), dtype=float32)
loss: tf.Tensor(0.92489344, shape=(), dtype=float32)
loss: tf.Tensor(0.8937411, shape=(), dtype=float32)
loss: tf.Tensor(0.88869894, shape=(), dtype=float32)
loss: tf.Tensor(0.8394105, shape=(), dtype=float32)
loss: tf.Tensor(0.9302573, shape=(), dtype=float32)
loss: tf.Tensor(0.82765406, shape=(), dtype=float32)
loss: tf.Tensor(0.8463154, shape=(), dtype=float32)
loss: tf.Tensor(0.8391404, shape=(), dtype=float32)
loss: tf.Tensor(0.92954004, shape=(), dtype=float32)
loss: tf.Tensor(0.84569037, shape=(), dtype=float32)
loss: tf.Tensor(0.78462213, shape=(), dtype=float32)
loss: tf.Tensor(0.8800419, shape=(), dtype=float32)
loss: tf.Tensor(0.964917, shape=(), dtype=float32)
loss: tf.Tensor(0.8366163, shape=(), dtype=float32)
loss: tf.Tensor(0.8547946, shape=(), dtype=float32)
loss: tf.Tensor(0.8460205, shape=(), dtype=float32)
loss: tf.Tensor(0.83788687, shape=(), dtype=float32)
loss: tf.Tensor(0.7852385, shape=(), dtype=float32)
loss: tf.Tensor(0.8332926, shape=(), dtype=float32)
loss: tf.Tensor(0.79644823, shape=(), dtype=float32)
loss: tf.Tensor(0.94831574, shape=(), dtype=float32)
loss: tf.Tensor(0.87911206, shape=(), dtype=float32)
loss: tf.Tensor(0.7922426, shape=(), dtype=float32)
loss: tf.Tensor(1.0253949, shape=(), dtype=float32)
loss: tf.Tensor(0.84681696, shape=(), dtype=float32)
loss: tf.Tensor(0.9160067, shape=(), dtype=float32)
loss: tf.Tensor(0.744516, shape=(), dtype=float32)
loss: tf.Tensor(0.7845944, shape=(), dtype=float32)
loss: tf.Tensor(0.8136532, shape=(), dtype=float32)
loss: tf.Tensor(0.81450963, shape=(), dtype=float32)
loss: tf.Tensor(0.8162291, shape=(), dtype=float32)
loss: tf.Tensor(0.78523004, shape=(), dtype=float32)
loss: tf.Tensor(0.91075987, shape=(), dtype=float32)
loss: tf.Tensor(0.87254834, shape=(), dtype=float32)
loss: tf.Tensor(0.778496, shape=(), dtype=float32)
loss: tf.Tensor(0.8120597, shape=(), dtype=float32)
loss: tf.Tensor(0.84380376, shape=(), dtype=float32)
loss: tf.Tensor(0.9952734, shape=(), dtype=float32)
loss: tf.Tensor(0.7608114, shape=(), dtype=float32)
loss: tf.Tensor(0.8923485, shape=(), dtype=float32)
loss: tf.Tensor(0.81040734, shape=(), dtype=float32)
loss: tf.Tensor(0.8993197, shape=(), dtype=float32)
loss: tf.Tensor(0.6699671, shape=(), dtype=float32)
loss: tf.Tensor(0.92604065, shape=(), dtype=float32)
loss: tf.Tensor(0.6947278, shape=(), dtype=float32)
loss: tf.Tensor(0.7852871, shape=(), dtype=float32)
loss: tf.Tensor(0.65282965, shape=(), dtype=float32)
loss: tf.Tensor(0.79049635, shape=(), dtype=float32)
loss: tf.Tensor(0.89166725, shape=(), dtype=float32)
loss: tf.Tensor(0.7506759, shape=(), dtype=float32)
loss: tf.Tensor(0.89425397, shape=(), dtype=float32)
loss: tf.Tensor(0.79886, shape=(), dtype=float32)
loss: tf.Tensor(0.90326905, shape=(), dtype=float32)
loss: tf.Tensor(0.89150625, shape=(), dtype=float32)
loss: tf.Tensor(0.8634722, shape=(), dtype=float32)
loss: tf.Tensor(0.8350166, shape=(), dtype=float32)
loss: tf.Tensor(0.95495516, shape=(), dtype=float32)
loss: tf.Tensor(0.9749795, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:8 out of the last 8 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.97747, shape=(), dtype=float32)
F1 SCORE:
0.36669418
EPOCH  8 #################################
loss: tf.Tensor(0.72462916, shape=(), dtype=float32)
loss: tf.Tensor(0.8697403, shape=(), dtype=float32)
loss: tf.Tensor(0.9509489, shape=(), dtype=float32)
loss: tf.Tensor(0.851469, shape=(), dtype=float32)
loss: tf.Tensor(0.84140617, shape=(), dtype=float32)
loss: tf.Tensor(0.8733283, shape=(), dtype=float32)
loss: tf.Tensor(0.8756284, shape=(), dtype=float32)
loss: tf.Tensor(0.88541704, shape=(), dtype=float32)
loss: tf.Tensor(0.7752602, shape=(), dtype=float32)
loss: tf.Tensor(0.81175727, shape=(), dtype=float32)
loss: tf.Tensor(0.82376534, shape=(), dtype=float32)
loss: tf.Tensor(0.91669464, shape=(), dtype=float32)
loss: tf.Tensor(0.77256566, shape=(), dtype=float32)
loss: tf.Tensor(0.8592982, shape=(), dtype=float32)
loss: tf.Tensor(0.80544585, shape=(), dtype=float32)
loss: tf.Tensor(0.8846352, shape=(), dtype=float32)
loss: tf.Tensor(0.87893736, shape=(), dtype=float32)
loss: tf.Tensor(0.8738404, shape=(), dtype=float32)
loss: tf.Tensor(0.9089789, shape=(), dtype=float32)
loss: tf.Tensor(0.9132287, shape=(), dtype=float32)
loss: tf.Tensor(0.8369799, shape=(), dtype=float32)
loss: tf.Tensor(0.8754011, shape=(), dtype=float32)
loss: tf.Tensor(0.85977244, shape=(), dtype=float32)
loss: tf.Tensor(0.7698685, shape=(), dtype=float32)
loss: tf.Tensor(0.92293954, shape=(), dtype=float32)
loss: tf.Tensor(0.90833783, shape=(), dtype=float32)
loss: tf.Tensor(0.8784299, shape=(), dtype=float32)
loss: tf.Tensor(0.7485454, shape=(), dtype=float32)
loss: tf.Tensor(0.78031516, shape=(), dtype=float32)
loss: tf.Tensor(0.8877809, shape=(), dtype=float32)
loss: tf.Tensor(0.8759499, shape=(), dtype=float32)
loss: tf.Tensor(0.73473984, shape=(), dtype=float32)
loss: tf.Tensor(0.69057983, shape=(), dtype=float32)
loss: tf.Tensor(0.79719526, shape=(), dtype=float32)
loss: tf.Tensor(0.7907336, shape=(), dtype=float32)
loss: tf.Tensor(0.9370953, shape=(), dtype=float32)
loss: tf.Tensor(0.835719, shape=(), dtype=float32)
loss: tf.Tensor(0.783947, shape=(), dtype=float32)
loss: tf.Tensor(0.804852, shape=(), dtype=float32)
loss: tf.Tensor(0.86626834, shape=(), dtype=float32)
loss: tf.Tensor(0.83896685, shape=(), dtype=float32)
loss: tf.Tensor(0.93142843, shape=(), dtype=float32)
loss: tf.Tensor(0.9690116, shape=(), dtype=float32)
loss: tf.Tensor(0.88969725, shape=(), dtype=float32)
loss: tf.Tensor(0.85647637, shape=(), dtype=float32)
loss: tf.Tensor(0.8644714, shape=(), dtype=float32)
loss: tf.Tensor(0.8163308, shape=(), dtype=float32)
loss: tf.Tensor(0.77035683, shape=(), dtype=float32)
loss: tf.Tensor(0.77690417, shape=(), dtype=float32)
loss: tf.Tensor(0.8569424, shape=(), dtype=float32)
loss: tf.Tensor(0.84547216, shape=(), dtype=float32)
loss: tf.Tensor(0.85835284, shape=(), dtype=float32)
loss: tf.Tensor(0.8550427, shape=(), dtype=float32)
loss: tf.Tensor(0.87805396, shape=(), dtype=float32)
loss: tf.Tensor(0.77923745, shape=(), dtype=float32)
loss: tf.Tensor(0.91430545, shape=(), dtype=float32)
loss: tf.Tensor(0.9186017, shape=(), dtype=float32)
loss: tf.Tensor(0.7901555, shape=(), dtype=float32)
loss: tf.Tensor(0.85984236, shape=(), dtype=float32)
loss: tf.Tensor(0.8151643, shape=(), dtype=float32)
loss: tf.Tensor(0.8094099, shape=(), dtype=float32)
loss: tf.Tensor(0.8456758, shape=(), dtype=float32)
loss: tf.Tensor(0.8373902, shape=(), dtype=float32)
loss: tf.Tensor(0.81813294, shape=(), dtype=float32)
loss: tf.Tensor(0.93413377, shape=(), dtype=float32)
loss: tf.Tensor(0.9288159, shape=(), dtype=float32)
loss: tf.Tensor(0.83147454, shape=(), dtype=float32)
loss: tf.Tensor(0.8630867, shape=(), dtype=float32)
loss: tf.Tensor(0.83390355, shape=(), dtype=float32)
loss: tf.Tensor(0.7979949, shape=(), dtype=float32)
loss: tf.Tensor(0.9382995, shape=(), dtype=float32)
loss: tf.Tensor(0.88978684, shape=(), dtype=float32)
loss: tf.Tensor(0.8923886, shape=(), dtype=float32)
loss: tf.Tensor(1.2193506, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:9 out of the last 9 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(1.0063045, shape=(), dtype=float32)
F1 SCORE:
0.37888584
EPOCH  9 #################################
loss: tf.Tensor(0.83079696, shape=(), dtype=float32)
loss: tf.Tensor(0.91153586, shape=(), dtype=float32)
loss: tf.Tensor(0.85764074, shape=(), dtype=float32)
loss: tf.Tensor(0.8896092, shape=(), dtype=float32)
loss: tf.Tensor(0.9178867, shape=(), dtype=float32)
loss: tf.Tensor(0.79982275, shape=(), dtype=float32)
loss: tf.Tensor(0.6754516, shape=(), dtype=float32)
loss: tf.Tensor(0.8731424, shape=(), dtype=float32)
loss: tf.Tensor(0.9635247, shape=(), dtype=float32)
loss: tf.Tensor(0.86839753, shape=(), dtype=float32)
loss: tf.Tensor(1.1349298, shape=(), dtype=float32)
loss: tf.Tensor(0.9634138, shape=(), dtype=float32)
loss: tf.Tensor(0.94974566, shape=(), dtype=float32)
loss: tf.Tensor(0.85257727, shape=(), dtype=float32)
loss: tf.Tensor(0.88210595, shape=(), dtype=float32)
loss: tf.Tensor(0.9000042, shape=(), dtype=float32)
loss: tf.Tensor(0.84583396, shape=(), dtype=float32)
loss: tf.Tensor(0.84403, shape=(), dtype=float32)
loss: tf.Tensor(0.9325022, shape=(), dtype=float32)
loss: tf.Tensor(0.8900179, shape=(), dtype=float32)
loss: tf.Tensor(0.8018671, shape=(), dtype=float32)
loss: tf.Tensor(0.89847535, shape=(), dtype=float32)
loss: tf.Tensor(0.8416272, shape=(), dtype=float32)
loss: tf.Tensor(0.8771831, shape=(), dtype=float32)
loss: tf.Tensor(0.8372778, shape=(), dtype=float32)
loss: tf.Tensor(0.913186, shape=(), dtype=float32)
loss: tf.Tensor(0.8308541, shape=(), dtype=float32)
loss: tf.Tensor(0.88468117, shape=(), dtype=float32)
loss: tf.Tensor(0.7670282, shape=(), dtype=float32)
loss: tf.Tensor(0.71806073, shape=(), dtype=float32)
loss: tf.Tensor(0.88936114, shape=(), dtype=float32)
loss: tf.Tensor(0.86204886, shape=(), dtype=float32)
loss: tf.Tensor(0.79289514, shape=(), dtype=float32)
loss: tf.Tensor(0.90056634, shape=(), dtype=float32)
loss: tf.Tensor(0.84727025, shape=(), dtype=float32)
loss: tf.Tensor(0.8857094, shape=(), dtype=float32)
loss: tf.Tensor(0.7833205, shape=(), dtype=float32)
loss: tf.Tensor(0.8897459, shape=(), dtype=float32)
loss: tf.Tensor(0.8617035, shape=(), dtype=float32)
loss: tf.Tensor(0.87363863, shape=(), dtype=float32)
loss: tf.Tensor(0.8008463, shape=(), dtype=float32)
loss: tf.Tensor(0.9126489, shape=(), dtype=float32)
loss: tf.Tensor(0.7527047, shape=(), dtype=float32)
loss: tf.Tensor(0.8544831, shape=(), dtype=float32)
loss: tf.Tensor(0.8817494, shape=(), dtype=float32)
loss: tf.Tensor(0.7157184, shape=(), dtype=float32)
loss: tf.Tensor(0.8475621, shape=(), dtype=float32)
loss: tf.Tensor(0.8452971, shape=(), dtype=float32)
loss: tf.Tensor(0.9214293, shape=(), dtype=float32)
loss: tf.Tensor(0.8601545, shape=(), dtype=float32)
loss: tf.Tensor(0.7495587, shape=(), dtype=float32)
loss: tf.Tensor(0.8199455, shape=(), dtype=float32)
loss: tf.Tensor(0.8759131, shape=(), dtype=float32)
loss: tf.Tensor(0.8396582, shape=(), dtype=float32)
loss: tf.Tensor(0.7651605, shape=(), dtype=float32)
loss: tf.Tensor(0.85247946, shape=(), dtype=float32)
loss: tf.Tensor(0.817471, shape=(), dtype=float32)
loss: tf.Tensor(0.7736693, shape=(), dtype=float32)
loss: tf.Tensor(0.931879, shape=(), dtype=float32)
loss: tf.Tensor(0.7524087, shape=(), dtype=float32)
loss: tf.Tensor(0.8733175, shape=(), dtype=float32)
loss: tf.Tensor(0.8383743, shape=(), dtype=float32)
loss: tf.Tensor(0.8258149, shape=(), dtype=float32)
loss: tf.Tensor(1.037546, shape=(), dtype=float32)
loss: tf.Tensor(0.811294, shape=(), dtype=float32)
loss: tf.Tensor(0.8518409, shape=(), dtype=float32)
loss: tf.Tensor(0.83705974, shape=(), dtype=float32)
loss: tf.Tensor(0.8774845, shape=(), dtype=float32)
loss: tf.Tensor(0.87185335, shape=(), dtype=float32)
loss: tf.Tensor(0.8128582, shape=(), dtype=float32)
loss: tf.Tensor(0.8792766, shape=(), dtype=float32)
loss: tf.Tensor(0.8341539, shape=(), dtype=float32)
loss: tf.Tensor(0.77616507, shape=(), dtype=float32)
loss: tf.Tensor(0.7219198, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:10 out of the last 10 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.96783113, shape=(), dtype=float32)
F1 SCORE:
0.37668192
EPOCH  10 #################################
loss: tf.Tensor(0.85567117, shape=(), dtype=float32)
loss: tf.Tensor(0.7562108, shape=(), dtype=float32)
loss: tf.Tensor(0.95423025, shape=(), dtype=float32)
loss: tf.Tensor(0.9774607, shape=(), dtype=float32)
loss: tf.Tensor(0.9021129, shape=(), dtype=float32)
loss: tf.Tensor(1.0290953, shape=(), dtype=float32)
loss: tf.Tensor(0.8537903, shape=(), dtype=float32)
loss: tf.Tensor(0.8166336, shape=(), dtype=float32)
loss: tf.Tensor(0.8936556, shape=(), dtype=float32)
loss: tf.Tensor(0.89828867, shape=(), dtype=float32)
loss: tf.Tensor(0.7988751, shape=(), dtype=float32)
loss: tf.Tensor(0.8425517, shape=(), dtype=float32)
loss: tf.Tensor(0.8488446, shape=(), dtype=float32)
loss: tf.Tensor(0.7851596, shape=(), dtype=float32)
loss: tf.Tensor(0.80108565, shape=(), dtype=float32)
loss: tf.Tensor(0.7929669, shape=(), dtype=float32)
loss: tf.Tensor(0.7920048, shape=(), dtype=float32)
loss: tf.Tensor(0.89565486, shape=(), dtype=float32)
loss: tf.Tensor(0.98015326, shape=(), dtype=float32)
loss: tf.Tensor(0.88198555, shape=(), dtype=float32)
loss: tf.Tensor(0.9189009, shape=(), dtype=float32)
loss: tf.Tensor(0.7658448, shape=(), dtype=float32)
loss: tf.Tensor(0.9811206, shape=(), dtype=float32)
loss: tf.Tensor(0.7624041, shape=(), dtype=float32)
loss: tf.Tensor(0.8774768, shape=(), dtype=float32)
loss: tf.Tensor(0.9629667, shape=(), dtype=float32)
loss: tf.Tensor(0.78567064, shape=(), dtype=float32)
loss: tf.Tensor(0.7760383, shape=(), dtype=float32)
loss: tf.Tensor(0.8673515, shape=(), dtype=float32)
loss: tf.Tensor(0.8676322, shape=(), dtype=float32)
loss: tf.Tensor(0.8982693, shape=(), dtype=float32)
loss: tf.Tensor(0.7828479, shape=(), dtype=float32)
loss: tf.Tensor(0.8961552, shape=(), dtype=float32)
loss: tf.Tensor(0.7813239, shape=(), dtype=float32)
loss: tf.Tensor(0.8914044, shape=(), dtype=float32)
loss: tf.Tensor(0.7027512, shape=(), dtype=float32)
loss: tf.Tensor(0.86749125, shape=(), dtype=float32)
loss: tf.Tensor(0.90661234, shape=(), dtype=float32)
loss: tf.Tensor(0.774746, shape=(), dtype=float32)
loss: tf.Tensor(0.8504072, shape=(), dtype=float32)
loss: tf.Tensor(0.7822599, shape=(), dtype=float32)
loss: tf.Tensor(0.83211154, shape=(), dtype=float32)
loss: tf.Tensor(0.9039252, shape=(), dtype=float32)
loss: tf.Tensor(0.89603364, shape=(), dtype=float32)
loss: tf.Tensor(0.778991, shape=(), dtype=float32)
loss: tf.Tensor(0.86481583, shape=(), dtype=float32)
loss: tf.Tensor(0.8936031, shape=(), dtype=float32)
loss: tf.Tensor(0.76314783, shape=(), dtype=float32)
loss: tf.Tensor(0.86926115, shape=(), dtype=float32)
loss: tf.Tensor(0.8418519, shape=(), dtype=float32)
loss: tf.Tensor(0.8210098, shape=(), dtype=float32)
loss: tf.Tensor(0.7431182, shape=(), dtype=float32)
loss: tf.Tensor(0.91206056, shape=(), dtype=float32)
loss: tf.Tensor(0.7600987, shape=(), dtype=float32)
loss: tf.Tensor(0.8402569, shape=(), dtype=float32)
loss: tf.Tensor(0.9760546, shape=(), dtype=float32)
loss: tf.Tensor(0.7530967, shape=(), dtype=float32)
loss: tf.Tensor(0.77290064, shape=(), dtype=float32)
loss: tf.Tensor(0.79248995, shape=(), dtype=float32)
loss: tf.Tensor(0.8579938, shape=(), dtype=float32)
loss: tf.Tensor(0.8653405, shape=(), dtype=float32)
loss: tf.Tensor(0.845735, shape=(), dtype=float32)
loss: tf.Tensor(0.86943674, shape=(), dtype=float32)
loss: tf.Tensor(0.7926195, shape=(), dtype=float32)
loss: tf.Tensor(0.8095317, shape=(), dtype=float32)
loss: tf.Tensor(0.79938513, shape=(), dtype=float32)
loss: tf.Tensor(0.8478992, shape=(), dtype=float32)
loss: tf.Tensor(0.8524534, shape=(), dtype=float32)
loss: tf.Tensor(0.80281186, shape=(), dtype=float32)
loss: tf.Tensor(0.9038738, shape=(), dtype=float32)
loss: tf.Tensor(0.9682803, shape=(), dtype=float32)
loss: tf.Tensor(0.90014315, shape=(), dtype=float32)
loss: tf.Tensor(0.7683617, shape=(), dtype=float32)
loss: tf.Tensor(0.87754005, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9792197, shape=(), dtype=float32)
F1 SCORE:
0.37201175
EPOCH  11 #################################
loss: tf.Tensor(0.8604582, shape=(), dtype=float32)
loss: tf.Tensor(0.8216476, shape=(), dtype=float32)
loss: tf.Tensor(0.84956765, shape=(), dtype=float32)
loss: tf.Tensor(0.94927096, shape=(), dtype=float32)
loss: tf.Tensor(0.8834748, shape=(), dtype=float32)
loss: tf.Tensor(0.7768392, shape=(), dtype=float32)
loss: tf.Tensor(0.8491072, shape=(), dtype=float32)
loss: tf.Tensor(0.8985171, shape=(), dtype=float32)
loss: tf.Tensor(0.8337489, shape=(), dtype=float32)
loss: tf.Tensor(0.92914176, shape=(), dtype=float32)
loss: tf.Tensor(0.8954544, shape=(), dtype=float32)
loss: tf.Tensor(1.0054115, shape=(), dtype=float32)
loss: tf.Tensor(0.996408, shape=(), dtype=float32)
loss: tf.Tensor(0.9686366, shape=(), dtype=float32)
loss: tf.Tensor(0.8613412, shape=(), dtype=float32)
loss: tf.Tensor(0.9333766, shape=(), dtype=float32)
loss: tf.Tensor(0.8179902, shape=(), dtype=float32)
loss: tf.Tensor(0.7990117, shape=(), dtype=float32)
loss: tf.Tensor(0.85076606, shape=(), dtype=float32)
loss: tf.Tensor(0.79718125, shape=(), dtype=float32)
loss: tf.Tensor(0.93028986, shape=(), dtype=float32)
loss: tf.Tensor(0.7351402, shape=(), dtype=float32)
loss: tf.Tensor(0.8214465, shape=(), dtype=float32)
loss: tf.Tensor(0.7372598, shape=(), dtype=float32)
loss: tf.Tensor(0.8426702, shape=(), dtype=float32)
loss: tf.Tensor(0.9210399, shape=(), dtype=float32)
loss: tf.Tensor(0.9466318, shape=(), dtype=float32)
loss: tf.Tensor(0.87263185, shape=(), dtype=float32)
loss: tf.Tensor(0.7967011, shape=(), dtype=float32)
loss: tf.Tensor(0.80344653, shape=(), dtype=float32)
loss: tf.Tensor(0.7364495, shape=(), dtype=float32)
loss: tf.Tensor(0.92903227, shape=(), dtype=float32)
loss: tf.Tensor(0.8328415, shape=(), dtype=float32)
loss: tf.Tensor(0.8604275, shape=(), dtype=float32)
loss: tf.Tensor(0.86681366, shape=(), dtype=float32)
loss: tf.Tensor(0.7510164, shape=(), dtype=float32)
loss: tf.Tensor(0.93272567, shape=(), dtype=float32)
loss: tf.Tensor(0.8290029, shape=(), dtype=float32)
loss: tf.Tensor(0.74515265, shape=(), dtype=float32)
loss: tf.Tensor(0.84397286, shape=(), dtype=float32)
loss: tf.Tensor(0.7539168, shape=(), dtype=float32)
loss: tf.Tensor(0.8080343, shape=(), dtype=float32)
loss: tf.Tensor(0.7421013, shape=(), dtype=float32)
loss: tf.Tensor(0.79017824, shape=(), dtype=float32)
loss: tf.Tensor(0.8031493, shape=(), dtype=float32)
loss: tf.Tensor(0.92832506, shape=(), dtype=float32)
loss: tf.Tensor(0.85542005, shape=(), dtype=float32)
loss: tf.Tensor(0.8213987, shape=(), dtype=float32)
loss: tf.Tensor(0.8015696, shape=(), dtype=float32)
loss: tf.Tensor(0.8701791, shape=(), dtype=float32)
loss: tf.Tensor(0.7997651, shape=(), dtype=float32)
loss: tf.Tensor(0.93016976, shape=(), dtype=float32)
loss: tf.Tensor(0.9193728, shape=(), dtype=float32)
loss: tf.Tensor(0.7693691, shape=(), dtype=float32)
loss: tf.Tensor(0.75477815, shape=(), dtype=float32)
loss: tf.Tensor(0.80754274, shape=(), dtype=float32)
loss: tf.Tensor(0.8597657, shape=(), dtype=float32)
loss: tf.Tensor(0.9236485, shape=(), dtype=float32)
loss: tf.Tensor(0.8647857, shape=(), dtype=float32)
loss: tf.Tensor(0.81009, shape=(), dtype=float32)
loss: tf.Tensor(0.7875316, shape=(), dtype=float32)
loss: tf.Tensor(0.8114402, shape=(), dtype=float32)
loss: tf.Tensor(0.88555557, shape=(), dtype=float32)
loss: tf.Tensor(0.880197, shape=(), dtype=float32)
loss: tf.Tensor(0.84234136, shape=(), dtype=float32)
loss: tf.Tensor(0.8109671, shape=(), dtype=float32)
loss: tf.Tensor(0.83477044, shape=(), dtype=float32)
loss: tf.Tensor(0.84923846, shape=(), dtype=float32)
loss: tf.Tensor(0.7771748, shape=(), dtype=float32)
loss: tf.Tensor(0.777261, shape=(), dtype=float32)
loss: tf.Tensor(0.8310349, shape=(), dtype=float32)
loss: tf.Tensor(0.7692043, shape=(), dtype=float32)
loss: tf.Tensor(0.72108895, shape=(), dtype=float32)
loss: tf.Tensor(0.46362165, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9578072, shape=(), dtype=float32)
F1 SCORE:
0.37239555
EPOCH  12 #################################
loss: tf.Tensor(0.8270748, shape=(), dtype=float32)
loss: tf.Tensor(0.95901525, shape=(), dtype=float32)
loss: tf.Tensor(0.7452172, shape=(), dtype=float32)
loss: tf.Tensor(1.0673051, shape=(), dtype=float32)
loss: tf.Tensor(0.8574132, shape=(), dtype=float32)
loss: tf.Tensor(0.98884606, shape=(), dtype=float32)
loss: tf.Tensor(0.79773116, shape=(), dtype=float32)
loss: tf.Tensor(0.9423945, shape=(), dtype=float32)
loss: tf.Tensor(0.9405059, shape=(), dtype=float32)
loss: tf.Tensor(0.97511625, shape=(), dtype=float32)
loss: tf.Tensor(0.83915144, shape=(), dtype=float32)
loss: tf.Tensor(0.9238594, shape=(), dtype=float32)
loss: tf.Tensor(0.8691347, shape=(), dtype=float32)
loss: tf.Tensor(0.8761682, shape=(), dtype=float32)
loss: tf.Tensor(0.8014653, shape=(), dtype=float32)
loss: tf.Tensor(0.9255723, shape=(), dtype=float32)
loss: tf.Tensor(0.729501, shape=(), dtype=float32)
loss: tf.Tensor(0.9498823, shape=(), dtype=float32)
loss: tf.Tensor(0.85852194, shape=(), dtype=float32)
loss: tf.Tensor(0.7425724, shape=(), dtype=float32)
loss: tf.Tensor(0.88728464, shape=(), dtype=float32)
loss: tf.Tensor(0.8622234, shape=(), dtype=float32)
loss: tf.Tensor(0.734811, shape=(), dtype=float32)
loss: tf.Tensor(0.82230514, shape=(), dtype=float32)
loss: tf.Tensor(0.78618586, shape=(), dtype=float32)
loss: tf.Tensor(0.78001386, shape=(), dtype=float32)
loss: tf.Tensor(0.79100907, shape=(), dtype=float32)
loss: tf.Tensor(0.7758625, shape=(), dtype=float32)
loss: tf.Tensor(0.87423086, shape=(), dtype=float32)
loss: tf.Tensor(0.68314415, shape=(), dtype=float32)
loss: tf.Tensor(0.88075423, shape=(), dtype=float32)
loss: tf.Tensor(0.9274856, shape=(), dtype=float32)
loss: tf.Tensor(0.716092, shape=(), dtype=float32)
loss: tf.Tensor(0.9183706, shape=(), dtype=float32)
loss: tf.Tensor(0.69381255, shape=(), dtype=float32)
loss: tf.Tensor(0.83321553, shape=(), dtype=float32)
loss: tf.Tensor(0.79581213, shape=(), dtype=float32)
loss: tf.Tensor(0.80301416, shape=(), dtype=float32)
loss: tf.Tensor(0.796657, shape=(), dtype=float32)
loss: tf.Tensor(0.801585, shape=(), dtype=float32)
loss: tf.Tensor(0.9787385, shape=(), dtype=float32)
loss: tf.Tensor(0.7729001, shape=(), dtype=float32)
loss: tf.Tensor(0.7473845, shape=(), dtype=float32)
loss: tf.Tensor(0.8985449, shape=(), dtype=float32)
loss: tf.Tensor(0.8548201, shape=(), dtype=float32)
loss: tf.Tensor(0.8249527, shape=(), dtype=float32)
loss: tf.Tensor(0.7816307, shape=(), dtype=float32)
loss: tf.Tensor(0.7432891, shape=(), dtype=float32)
loss: tf.Tensor(0.80805963, shape=(), dtype=float32)
loss: tf.Tensor(0.76673526, shape=(), dtype=float32)
loss: tf.Tensor(0.8971756, shape=(), dtype=float32)
loss: tf.Tensor(0.83594877, shape=(), dtype=float32)
loss: tf.Tensor(0.7496807, shape=(), dtype=float32)
loss: tf.Tensor(0.88486296, shape=(), dtype=float32)
loss: tf.Tensor(0.867096, shape=(), dtype=float32)
loss: tf.Tensor(0.94439644, shape=(), dtype=float32)
loss: tf.Tensor(0.9183766, shape=(), dtype=float32)
loss: tf.Tensor(0.9171756, shape=(), dtype=float32)
loss: tf.Tensor(0.82025373, shape=(), dtype=float32)
loss: tf.Tensor(0.7727228, shape=(), dtype=float32)
loss: tf.Tensor(0.75392854, shape=(), dtype=float32)
loss: tf.Tensor(0.8223855, shape=(), dtype=float32)
loss: tf.Tensor(0.9373262, shape=(), dtype=float32)
loss: tf.Tensor(0.923043, shape=(), dtype=float32)
loss: tf.Tensor(0.82787734, shape=(), dtype=float32)
loss: tf.Tensor(0.82302856, shape=(), dtype=float32)
loss: tf.Tensor(0.8109901, shape=(), dtype=float32)
loss: tf.Tensor(0.8125695, shape=(), dtype=float32)
loss: tf.Tensor(0.79553604, shape=(), dtype=float32)
loss: tf.Tensor(0.91775393, shape=(), dtype=float32)
loss: tf.Tensor(0.7896676, shape=(), dtype=float32)
loss: tf.Tensor(0.7464546, shape=(), dtype=float32)
loss: tf.Tensor(0.9163843, shape=(), dtype=float32)
loss: tf.Tensor(0.8618295, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.976877, shape=(), dtype=float32)
F1 SCORE:
0.37264398
EPOCH  13 #################################
loss: tf.Tensor(0.8283966, shape=(), dtype=float32)
loss: tf.Tensor(0.7725227, shape=(), dtype=float32)
loss: tf.Tensor(0.8332781, shape=(), dtype=float32)
loss: tf.Tensor(0.857575, shape=(), dtype=float32)
loss: tf.Tensor(0.83127713, shape=(), dtype=float32)
loss: tf.Tensor(0.83474535, shape=(), dtype=float32)
loss: tf.Tensor(0.9816861, shape=(), dtype=float32)
loss: tf.Tensor(0.7818197, shape=(), dtype=float32)
loss: tf.Tensor(0.7923497, shape=(), dtype=float32)
loss: tf.Tensor(0.79974246, shape=(), dtype=float32)
loss: tf.Tensor(0.8343502, shape=(), dtype=float32)
loss: tf.Tensor(0.89060193, shape=(), dtype=float32)
loss: tf.Tensor(0.87363905, shape=(), dtype=float32)
loss: tf.Tensor(0.78775215, shape=(), dtype=float32)
loss: tf.Tensor(0.87655914, shape=(), dtype=float32)
loss: tf.Tensor(0.8315609, shape=(), dtype=float32)
loss: tf.Tensor(0.8274654, shape=(), dtype=float32)
loss: tf.Tensor(0.73834914, shape=(), dtype=float32)
loss: tf.Tensor(0.86114335, shape=(), dtype=float32)
loss: tf.Tensor(0.7453171, shape=(), dtype=float32)
loss: tf.Tensor(0.8229161, shape=(), dtype=float32)
loss: tf.Tensor(0.84284073, shape=(), dtype=float32)
loss: tf.Tensor(0.88478297, shape=(), dtype=float32)
loss: tf.Tensor(0.83247536, shape=(), dtype=float32)
loss: tf.Tensor(0.82978606, shape=(), dtype=float32)
loss: tf.Tensor(0.7175621, shape=(), dtype=float32)
loss: tf.Tensor(0.8101151, shape=(), dtype=float32)
loss: tf.Tensor(0.88396525, shape=(), dtype=float32)
loss: tf.Tensor(0.89573485, shape=(), dtype=float32)
loss: tf.Tensor(0.8334054, shape=(), dtype=float32)
loss: tf.Tensor(0.68353355, shape=(), dtype=float32)
loss: tf.Tensor(0.89028794, shape=(), dtype=float32)
loss: tf.Tensor(0.8250206, shape=(), dtype=float32)
loss: tf.Tensor(0.95234686, shape=(), dtype=float32)
loss: tf.Tensor(0.7853994, shape=(), dtype=float32)
loss: tf.Tensor(0.79320544, shape=(), dtype=float32)
loss: tf.Tensor(0.79561496, shape=(), dtype=float32)
loss: tf.Tensor(0.883394, shape=(), dtype=float32)
loss: tf.Tensor(0.89406586, shape=(), dtype=float32)
loss: tf.Tensor(0.8805165, shape=(), dtype=float32)
loss: tf.Tensor(0.7877849, shape=(), dtype=float32)
loss: tf.Tensor(0.83465105, shape=(), dtype=float32)
loss: tf.Tensor(0.8476875, shape=(), dtype=float32)
loss: tf.Tensor(0.7665602, shape=(), dtype=float32)
loss: tf.Tensor(0.86615694, shape=(), dtype=float32)
loss: tf.Tensor(0.7701901, shape=(), dtype=float32)
loss: tf.Tensor(0.8128442, shape=(), dtype=float32)
loss: tf.Tensor(0.8383227, shape=(), dtype=float32)
loss: tf.Tensor(0.74302703, shape=(), dtype=float32)
loss: tf.Tensor(0.91098017, shape=(), dtype=float32)
loss: tf.Tensor(0.7879674, shape=(), dtype=float32)
loss: tf.Tensor(0.8505753, shape=(), dtype=float32)
loss: tf.Tensor(0.8453122, shape=(), dtype=float32)
loss: tf.Tensor(0.79169726, shape=(), dtype=float32)
loss: tf.Tensor(0.7962773, shape=(), dtype=float32)
loss: tf.Tensor(0.77240074, shape=(), dtype=float32)
loss: tf.Tensor(0.7629458, shape=(), dtype=float32)
loss: tf.Tensor(0.84685814, shape=(), dtype=float32)
loss: tf.Tensor(0.8687329, shape=(), dtype=float32)
loss: tf.Tensor(0.7620993, shape=(), dtype=float32)
loss: tf.Tensor(0.8478061, shape=(), dtype=float32)
loss: tf.Tensor(0.817904, shape=(), dtype=float32)
loss: tf.Tensor(0.8556576, shape=(), dtype=float32)
loss: tf.Tensor(0.7990124, shape=(), dtype=float32)
loss: tf.Tensor(0.872677, shape=(), dtype=float32)
loss: tf.Tensor(0.766518, shape=(), dtype=float32)
loss: tf.Tensor(0.8481239, shape=(), dtype=float32)
loss: tf.Tensor(0.84271383, shape=(), dtype=float32)
loss: tf.Tensor(0.76660055, shape=(), dtype=float32)
loss: tf.Tensor(0.76042473, shape=(), dtype=float32)
loss: tf.Tensor(0.816166, shape=(), dtype=float32)
loss: tf.Tensor(0.69753766, shape=(), dtype=float32)
loss: tf.Tensor(0.8175541, shape=(), dtype=float32)
loss: tf.Tensor(0.18228553, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9687222, shape=(), dtype=float32)
F1 SCORE:
0.3766358
EPOCH  14 #################################
loss: tf.Tensor(0.78477424, shape=(), dtype=float32)
loss: tf.Tensor(0.72774905, shape=(), dtype=float32)
loss: tf.Tensor(0.92651415, shape=(), dtype=float32)
loss: tf.Tensor(0.8634914, shape=(), dtype=float32)
loss: tf.Tensor(0.7976075, shape=(), dtype=float32)
loss: tf.Tensor(0.87870336, shape=(), dtype=float32)
loss: tf.Tensor(0.79141164, shape=(), dtype=float32)
loss: tf.Tensor(0.84817094, shape=(), dtype=float32)
loss: tf.Tensor(0.82773554, shape=(), dtype=float32)
loss: tf.Tensor(0.88209224, shape=(), dtype=float32)
loss: tf.Tensor(0.8045085, shape=(), dtype=float32)
loss: tf.Tensor(0.8690199, shape=(), dtype=float32)
loss: tf.Tensor(0.8405217, shape=(), dtype=float32)
loss: tf.Tensor(0.96444726, shape=(), dtype=float32)
loss: tf.Tensor(0.84163696, shape=(), dtype=float32)
loss: tf.Tensor(0.81490606, shape=(), dtype=float32)
loss: tf.Tensor(0.81354254, shape=(), dtype=float32)
loss: tf.Tensor(0.80376226, shape=(), dtype=float32)
loss: tf.Tensor(0.7879216, shape=(), dtype=float32)
loss: tf.Tensor(0.8572963, shape=(), dtype=float32)
loss: tf.Tensor(0.81804055, shape=(), dtype=float32)
loss: tf.Tensor(0.84823245, shape=(), dtype=float32)
loss: tf.Tensor(0.85782784, shape=(), dtype=float32)
loss: tf.Tensor(0.80308664, shape=(), dtype=float32)
loss: tf.Tensor(0.8336319, shape=(), dtype=float32)
loss: tf.Tensor(0.8646232, shape=(), dtype=float32)
loss: tf.Tensor(0.7303342, shape=(), dtype=float32)
loss: tf.Tensor(0.90343153, shape=(), dtype=float32)
loss: tf.Tensor(0.7877638, shape=(), dtype=float32)
loss: tf.Tensor(0.84126097, shape=(), dtype=float32)
loss: tf.Tensor(0.8641284, shape=(), dtype=float32)
loss: tf.Tensor(0.8571071, shape=(), dtype=float32)
loss: tf.Tensor(0.8273798, shape=(), dtype=float32)
loss: tf.Tensor(0.8493889, shape=(), dtype=float32)
loss: tf.Tensor(0.722431, shape=(), dtype=float32)
loss: tf.Tensor(0.9157264, shape=(), dtype=float32)
loss: tf.Tensor(0.7274202, shape=(), dtype=float32)
loss: tf.Tensor(0.86332107, shape=(), dtype=float32)
loss: tf.Tensor(0.7938412, shape=(), dtype=float32)
loss: tf.Tensor(0.93868226, shape=(), dtype=float32)
loss: tf.Tensor(0.77632713, shape=(), dtype=float32)
loss: tf.Tensor(0.8060263, shape=(), dtype=float32)
loss: tf.Tensor(0.9054213, shape=(), dtype=float32)
loss: tf.Tensor(0.9162255, shape=(), dtype=float32)
loss: tf.Tensor(0.7653819, shape=(), dtype=float32)
loss: tf.Tensor(0.81689394, shape=(), dtype=float32)
loss: tf.Tensor(0.78300035, shape=(), dtype=float32)
loss: tf.Tensor(0.82253206, shape=(), dtype=float32)
loss: tf.Tensor(0.79269946, shape=(), dtype=float32)
loss: tf.Tensor(0.75518113, shape=(), dtype=float32)
loss: tf.Tensor(0.8042995, shape=(), dtype=float32)
loss: tf.Tensor(0.7019838, shape=(), dtype=float32)
loss: tf.Tensor(0.775877, shape=(), dtype=float32)
loss: tf.Tensor(0.9806179, shape=(), dtype=float32)
loss: tf.Tensor(0.7605957, shape=(), dtype=float32)
loss: tf.Tensor(0.68882906, shape=(), dtype=float32)
loss: tf.Tensor(0.7714821, shape=(), dtype=float32)
loss: tf.Tensor(0.9072744, shape=(), dtype=float32)
loss: tf.Tensor(0.75164145, shape=(), dtype=float32)
loss: tf.Tensor(0.79164124, shape=(), dtype=float32)
loss: tf.Tensor(0.8873796, shape=(), dtype=float32)
loss: tf.Tensor(0.8456456, shape=(), dtype=float32)
loss: tf.Tensor(0.87207717, shape=(), dtype=float32)
loss: tf.Tensor(0.7624384, shape=(), dtype=float32)
loss: tf.Tensor(0.78214025, shape=(), dtype=float32)
loss: tf.Tensor(0.907534, shape=(), dtype=float32)
loss: tf.Tensor(0.83037466, shape=(), dtype=float32)
loss: tf.Tensor(0.76047605, shape=(), dtype=float32)
loss: tf.Tensor(0.71804404, shape=(), dtype=float32)
loss: tf.Tensor(0.7217466, shape=(), dtype=float32)
loss: tf.Tensor(0.7916555, shape=(), dtype=float32)
loss: tf.Tensor(0.7815151, shape=(), dtype=float32)
loss: tf.Tensor(0.7690489, shape=(), dtype=float32)
loss: tf.Tensor(0.04122894, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9614257, shape=(), dtype=float32)
F1 SCORE:
0.37596413
EPOCH  15 #################################
loss: tf.Tensor(0.80900794, shape=(), dtype=float32)
loss: tf.Tensor(0.99407434, shape=(), dtype=float32)
loss: tf.Tensor(0.90596616, shape=(), dtype=float32)
loss: tf.Tensor(0.94049144, shape=(), dtype=float32)
loss: tf.Tensor(0.8343994, shape=(), dtype=float32)
loss: tf.Tensor(0.87594485, shape=(), dtype=float32)
loss: tf.Tensor(0.78492063, shape=(), dtype=float32)
loss: tf.Tensor(0.89936966, shape=(), dtype=float32)
loss: tf.Tensor(0.82416636, shape=(), dtype=float32)
loss: tf.Tensor(0.8111104, shape=(), dtype=float32)
loss: tf.Tensor(0.76444936, shape=(), dtype=float32)
loss: tf.Tensor(0.8256586, shape=(), dtype=float32)
loss: tf.Tensor(0.80304956, shape=(), dtype=float32)
loss: tf.Tensor(0.8473783, shape=(), dtype=float32)
loss: tf.Tensor(0.8885457, shape=(), dtype=float32)
loss: tf.Tensor(0.7177885, shape=(), dtype=float32)
loss: tf.Tensor(0.8881469, shape=(), dtype=float32)
loss: tf.Tensor(0.8722957, shape=(), dtype=float32)
loss: tf.Tensor(0.8084431, shape=(), dtype=float32)
loss: tf.Tensor(0.76801074, shape=(), dtype=float32)
loss: tf.Tensor(0.7353366, shape=(), dtype=float32)
loss: tf.Tensor(0.7371771, shape=(), dtype=float32)
loss: tf.Tensor(0.76265645, shape=(), dtype=float32)
loss: tf.Tensor(0.8219209, shape=(), dtype=float32)
loss: tf.Tensor(0.7144623, shape=(), dtype=float32)
loss: tf.Tensor(0.90202546, shape=(), dtype=float32)
loss: tf.Tensor(0.8019481, shape=(), dtype=float32)
loss: tf.Tensor(0.78335357, shape=(), dtype=float32)
loss: tf.Tensor(0.8901536, shape=(), dtype=float32)
loss: tf.Tensor(0.8061428, shape=(), dtype=float32)
loss: tf.Tensor(0.77778184, shape=(), dtype=float32)
loss: tf.Tensor(0.9039283, shape=(), dtype=float32)
loss: tf.Tensor(0.8431505, shape=(), dtype=float32)
loss: tf.Tensor(0.84813845, shape=(), dtype=float32)
loss: tf.Tensor(0.6914017, shape=(), dtype=float32)
loss: tf.Tensor(0.64348406, shape=(), dtype=float32)
loss: tf.Tensor(0.8352188, shape=(), dtype=float32)
loss: tf.Tensor(0.83896995, shape=(), dtype=float32)
loss: tf.Tensor(0.7866806, shape=(), dtype=float32)
loss: tf.Tensor(0.79866457, shape=(), dtype=float32)
loss: tf.Tensor(0.8692046, shape=(), dtype=float32)
loss: tf.Tensor(0.66803586, shape=(), dtype=float32)
loss: tf.Tensor(0.85038394, shape=(), dtype=float32)
loss: tf.Tensor(0.7688443, shape=(), dtype=float32)
loss: tf.Tensor(0.7473317, shape=(), dtype=float32)
loss: tf.Tensor(0.75835526, shape=(), dtype=float32)
loss: tf.Tensor(0.8406659, shape=(), dtype=float32)
loss: tf.Tensor(0.7417997, shape=(), dtype=float32)
loss: tf.Tensor(0.8498236, shape=(), dtype=float32)
loss: tf.Tensor(0.8625543, shape=(), dtype=float32)
loss: tf.Tensor(0.79879713, shape=(), dtype=float32)
loss: tf.Tensor(0.84056944, shape=(), dtype=float32)
loss: tf.Tensor(0.7457932, shape=(), dtype=float32)
loss: tf.Tensor(0.8633474, shape=(), dtype=float32)
loss: tf.Tensor(0.7426892, shape=(), dtype=float32)
loss: tf.Tensor(0.8215074, shape=(), dtype=float32)
loss: tf.Tensor(0.8707449, shape=(), dtype=float32)
loss: tf.Tensor(0.9441191, shape=(), dtype=float32)
loss: tf.Tensor(0.79097724, shape=(), dtype=float32)
loss: tf.Tensor(0.8216706, shape=(), dtype=float32)
loss: tf.Tensor(0.772316, shape=(), dtype=float32)
loss: tf.Tensor(0.7626961, shape=(), dtype=float32)
loss: tf.Tensor(0.7997402, shape=(), dtype=float32)
loss: tf.Tensor(0.95173335, shape=(), dtype=float32)
loss: tf.Tensor(0.74165106, shape=(), dtype=float32)
loss: tf.Tensor(0.9147425, shape=(), dtype=float32)
loss: tf.Tensor(0.8080723, shape=(), dtype=float32)
loss: tf.Tensor(0.787122, shape=(), dtype=float32)
loss: tf.Tensor(0.7945823, shape=(), dtype=float32)
loss: tf.Tensor(0.91967374, shape=(), dtype=float32)
loss: tf.Tensor(0.78749716, shape=(), dtype=float32)
loss: tf.Tensor(0.6944262, shape=(), dtype=float32)
loss: tf.Tensor(0.785971, shape=(), dtype=float32)
loss: tf.Tensor(0.571786, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9627663, shape=(), dtype=float32)
F1 SCORE:
0.37425634
EPOCH  16 #################################
loss: tf.Tensor(0.85742956, shape=(), dtype=float32)
loss: tf.Tensor(0.8586891, shape=(), dtype=float32)
loss: tf.Tensor(0.98626435, shape=(), dtype=float32)
loss: tf.Tensor(1.0499383, shape=(), dtype=float32)
loss: tf.Tensor(0.82264894, shape=(), dtype=float32)
loss: tf.Tensor(0.838343, shape=(), dtype=float32)
loss: tf.Tensor(0.8041461, shape=(), dtype=float32)
loss: tf.Tensor(0.85014445, shape=(), dtype=float32)
loss: tf.Tensor(0.84410095, shape=(), dtype=float32)
loss: tf.Tensor(0.8571, shape=(), dtype=float32)
loss: tf.Tensor(0.86636627, shape=(), dtype=float32)
loss: tf.Tensor(0.87251645, shape=(), dtype=float32)
loss: tf.Tensor(0.8418352, shape=(), dtype=float32)
loss: tf.Tensor(0.7464736, shape=(), dtype=float32)
loss: tf.Tensor(0.77937144, shape=(), dtype=float32)
loss: tf.Tensor(0.8176127, shape=(), dtype=float32)
loss: tf.Tensor(0.8384881, shape=(), dtype=float32)
loss: tf.Tensor(0.92419493, shape=(), dtype=float32)
loss: tf.Tensor(0.8588826, shape=(), dtype=float32)
loss: tf.Tensor(0.8068728, shape=(), dtype=float32)
loss: tf.Tensor(0.8142693, shape=(), dtype=float32)
loss: tf.Tensor(0.79797906, shape=(), dtype=float32)
loss: tf.Tensor(0.8295364, shape=(), dtype=float32)
loss: tf.Tensor(0.8280956, shape=(), dtype=float32)
loss: tf.Tensor(0.608365, shape=(), dtype=float32)
loss: tf.Tensor(0.7352928, shape=(), dtype=float32)
loss: tf.Tensor(0.90700996, shape=(), dtype=float32)
loss: tf.Tensor(0.68821925, shape=(), dtype=float32)
loss: tf.Tensor(0.987497, shape=(), dtype=float32)
loss: tf.Tensor(0.871803, shape=(), dtype=float32)
loss: tf.Tensor(0.72647184, shape=(), dtype=float32)
loss: tf.Tensor(0.83400655, shape=(), dtype=float32)
loss: tf.Tensor(0.7990377, shape=(), dtype=float32)
loss: tf.Tensor(0.962167, shape=(), dtype=float32)
loss: tf.Tensor(0.7069324, shape=(), dtype=float32)
loss: tf.Tensor(0.8208932, shape=(), dtype=float32)
loss: tf.Tensor(0.7556311, shape=(), dtype=float32)
loss: tf.Tensor(0.71893305, shape=(), dtype=float32)
loss: tf.Tensor(0.8511767, shape=(), dtype=float32)
loss: tf.Tensor(0.742455, shape=(), dtype=float32)
loss: tf.Tensor(0.8279523, shape=(), dtype=float32)
loss: tf.Tensor(0.78456336, shape=(), dtype=float32)
loss: tf.Tensor(0.83387315, shape=(), dtype=float32)
loss: tf.Tensor(0.8557514, shape=(), dtype=float32)
loss: tf.Tensor(0.78880936, shape=(), dtype=float32)
loss: tf.Tensor(0.8051378, shape=(), dtype=float32)
loss: tf.Tensor(0.84555715, shape=(), dtype=float32)
loss: tf.Tensor(0.88438463, shape=(), dtype=float32)
loss: tf.Tensor(0.8202007, shape=(), dtype=float32)
loss: tf.Tensor(0.8029063, shape=(), dtype=float32)
loss: tf.Tensor(0.7479012, shape=(), dtype=float32)
loss: tf.Tensor(0.8496895, shape=(), dtype=float32)
loss: tf.Tensor(0.82706994, shape=(), dtype=float32)
loss: tf.Tensor(0.8384317, shape=(), dtype=float32)
loss: tf.Tensor(0.8671332, shape=(), dtype=float32)
loss: tf.Tensor(0.89656854, shape=(), dtype=float32)
loss: tf.Tensor(0.7569324, shape=(), dtype=float32)
loss: tf.Tensor(0.9034282, shape=(), dtype=float32)
loss: tf.Tensor(0.77770203, shape=(), dtype=float32)
loss: tf.Tensor(0.6600115, shape=(), dtype=float32)
loss: tf.Tensor(0.71336854, shape=(), dtype=float32)
loss: tf.Tensor(0.8266475, shape=(), dtype=float32)
loss: tf.Tensor(0.8077881, shape=(), dtype=float32)
loss: tf.Tensor(0.8661197, shape=(), dtype=float32)
loss: tf.Tensor(0.7643378, shape=(), dtype=float32)
loss: tf.Tensor(0.73106164, shape=(), dtype=float32)
loss: tf.Tensor(0.8335928, shape=(), dtype=float32)
loss: tf.Tensor(0.6804329, shape=(), dtype=float32)
loss: tf.Tensor(0.79533815, shape=(), dtype=float32)
loss: tf.Tensor(0.7582492, shape=(), dtype=float32)
loss: tf.Tensor(0.7829871, shape=(), dtype=float32)
loss: tf.Tensor(0.7877308, shape=(), dtype=float32)
loss: tf.Tensor(0.79907817, shape=(), dtype=float32)
loss: tf.Tensor(0.38232565, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9597397, shape=(), dtype=float32)
F1 SCORE:
0.3765981
EPOCH  17 #################################
loss: tf.Tensor(0.99379754, shape=(), dtype=float32)
loss: tf.Tensor(0.6156698, shape=(), dtype=float32)
loss: tf.Tensor(0.7607743, shape=(), dtype=float32)
loss: tf.Tensor(0.87018603, shape=(), dtype=float32)
loss: tf.Tensor(0.8019592, shape=(), dtype=float32)
loss: tf.Tensor(0.75020784, shape=(), dtype=float32)
loss: tf.Tensor(0.8474081, shape=(), dtype=float32)
loss: tf.Tensor(0.7184328, shape=(), dtype=float32)
loss: tf.Tensor(0.7910282, shape=(), dtype=float32)
loss: tf.Tensor(0.7560705, shape=(), dtype=float32)
loss: tf.Tensor(0.7471867, shape=(), dtype=float32)
loss: tf.Tensor(0.64618826, shape=(), dtype=float32)
loss: tf.Tensor(0.7756855, shape=(), dtype=float32)
loss: tf.Tensor(0.7846627, shape=(), dtype=float32)
loss: tf.Tensor(0.8560515, shape=(), dtype=float32)
loss: tf.Tensor(0.94390345, shape=(), dtype=float32)
loss: tf.Tensor(0.86779374, shape=(), dtype=float32)
loss: tf.Tensor(0.7560379, shape=(), dtype=float32)
loss: tf.Tensor(0.7411009, shape=(), dtype=float32)
loss: tf.Tensor(0.7706453, shape=(), dtype=float32)
loss: tf.Tensor(0.81241834, shape=(), dtype=float32)
loss: tf.Tensor(0.77049935, shape=(), dtype=float32)
loss: tf.Tensor(0.80781364, shape=(), dtype=float32)
loss: tf.Tensor(0.94013685, shape=(), dtype=float32)
loss: tf.Tensor(0.70489556, shape=(), dtype=float32)
loss: tf.Tensor(0.73322874, shape=(), dtype=float32)
loss: tf.Tensor(0.7548269, shape=(), dtype=float32)
loss: tf.Tensor(0.84422296, shape=(), dtype=float32)
loss: tf.Tensor(0.77222496, shape=(), dtype=float32)
loss: tf.Tensor(0.85346574, shape=(), dtype=float32)
loss: tf.Tensor(0.76144576, shape=(), dtype=float32)
loss: tf.Tensor(0.9601718, shape=(), dtype=float32)
loss: tf.Tensor(0.8585481, shape=(), dtype=float32)
loss: tf.Tensor(0.84985185, shape=(), dtype=float32)
loss: tf.Tensor(0.77387893, shape=(), dtype=float32)
loss: tf.Tensor(0.7626026, shape=(), dtype=float32)
loss: tf.Tensor(0.7920792, shape=(), dtype=float32)
loss: tf.Tensor(0.77123934, shape=(), dtype=float32)
loss: tf.Tensor(0.8183334, shape=(), dtype=float32)
loss: tf.Tensor(0.9123203, shape=(), dtype=float32)
loss: tf.Tensor(0.82629454, shape=(), dtype=float32)
loss: tf.Tensor(0.7388189, shape=(), dtype=float32)
loss: tf.Tensor(0.76950926, shape=(), dtype=float32)
loss: tf.Tensor(0.8373361, shape=(), dtype=float32)
loss: tf.Tensor(0.79657274, shape=(), dtype=float32)
loss: tf.Tensor(0.8852245, shape=(), dtype=float32)
loss: tf.Tensor(0.8245163, shape=(), dtype=float32)
loss: tf.Tensor(0.82390916, shape=(), dtype=float32)
loss: tf.Tensor(0.8207324, shape=(), dtype=float32)
loss: tf.Tensor(0.82252973, shape=(), dtype=float32)
loss: tf.Tensor(0.8403187, shape=(), dtype=float32)
loss: tf.Tensor(0.7072103, shape=(), dtype=float32)
loss: tf.Tensor(0.8546206, shape=(), dtype=float32)
loss: tf.Tensor(0.9076702, shape=(), dtype=float32)
loss: tf.Tensor(0.78536224, shape=(), dtype=float32)
loss: tf.Tensor(0.80944806, shape=(), dtype=float32)
loss: tf.Tensor(0.7740854, shape=(), dtype=float32)
loss: tf.Tensor(0.7813742, shape=(), dtype=float32)
loss: tf.Tensor(0.84200037, shape=(), dtype=float32)
loss: tf.Tensor(0.778861, shape=(), dtype=float32)
loss: tf.Tensor(0.8557135, shape=(), dtype=float32)
loss: tf.Tensor(0.8203528, shape=(), dtype=float32)
loss: tf.Tensor(0.71173024, shape=(), dtype=float32)
loss: tf.Tensor(0.86038584, shape=(), dtype=float32)
loss: tf.Tensor(0.86977357, shape=(), dtype=float32)
loss: tf.Tensor(0.8260936, shape=(), dtype=float32)
loss: tf.Tensor(0.7774926, shape=(), dtype=float32)
loss: tf.Tensor(0.8737751, shape=(), dtype=float32)
loss: tf.Tensor(0.87533414, shape=(), dtype=float32)
loss: tf.Tensor(0.8027794, shape=(), dtype=float32)
loss: tf.Tensor(0.7382358, shape=(), dtype=float32)
loss: tf.Tensor(0.8304655, shape=(), dtype=float32)
loss: tf.Tensor(0.836274, shape=(), dtype=float32)
loss: tf.Tensor(0.9064386, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9736245, shape=(), dtype=float32)
F1 SCORE:
0.37590626
EPOCH  18 #################################
loss: tf.Tensor(0.6616427, shape=(), dtype=float32)
loss: tf.Tensor(0.77128565, shape=(), dtype=float32)
loss: tf.Tensor(0.82505417, shape=(), dtype=float32)
loss: tf.Tensor(0.94608897, shape=(), dtype=float32)
loss: tf.Tensor(0.8809152, shape=(), dtype=float32)
loss: tf.Tensor(0.7486016, shape=(), dtype=float32)
loss: tf.Tensor(0.86982214, shape=(), dtype=float32)
loss: tf.Tensor(0.81838447, shape=(), dtype=float32)
loss: tf.Tensor(0.827579, shape=(), dtype=float32)
loss: tf.Tensor(0.80210894, shape=(), dtype=float32)
loss: tf.Tensor(0.9315152, shape=(), dtype=float32)
loss: tf.Tensor(0.81977576, shape=(), dtype=float32)
loss: tf.Tensor(0.7490705, shape=(), dtype=float32)
loss: tf.Tensor(0.7952761, shape=(), dtype=float32)
loss: tf.Tensor(0.78997856, shape=(), dtype=float32)
loss: tf.Tensor(0.8253951, shape=(), dtype=float32)
loss: tf.Tensor(0.9125488, shape=(), dtype=float32)
loss: tf.Tensor(0.64353156, shape=(), dtype=float32)
loss: tf.Tensor(0.83956164, shape=(), dtype=float32)
loss: tf.Tensor(0.7239521, shape=(), dtype=float32)
loss: tf.Tensor(0.83499736, shape=(), dtype=float32)
loss: tf.Tensor(0.65587646, shape=(), dtype=float32)
loss: tf.Tensor(0.6868671, shape=(), dtype=float32)
loss: tf.Tensor(0.824237, shape=(), dtype=float32)
loss: tf.Tensor(0.90487206, shape=(), dtype=float32)
loss: tf.Tensor(0.8503262, shape=(), dtype=float32)
loss: tf.Tensor(0.8707134, shape=(), dtype=float32)
loss: tf.Tensor(0.77435976, shape=(), dtype=float32)
loss: tf.Tensor(0.699254, shape=(), dtype=float32)
loss: tf.Tensor(0.7318921, shape=(), dtype=float32)
loss: tf.Tensor(0.8051731, shape=(), dtype=float32)
loss: tf.Tensor(0.70955276, shape=(), dtype=float32)
loss: tf.Tensor(0.9747244, shape=(), dtype=float32)
loss: tf.Tensor(0.7826704, shape=(), dtype=float32)
loss: tf.Tensor(0.8134117, shape=(), dtype=float32)
loss: tf.Tensor(0.8842051, shape=(), dtype=float32)
loss: tf.Tensor(0.80349874, shape=(), dtype=float32)
loss: tf.Tensor(0.85726637, shape=(), dtype=float32)
loss: tf.Tensor(0.67493415, shape=(), dtype=float32)
loss: tf.Tensor(0.8308289, shape=(), dtype=float32)
loss: tf.Tensor(0.87796736, shape=(), dtype=float32)
loss: tf.Tensor(0.8486637, shape=(), dtype=float32)
loss: tf.Tensor(0.82680994, shape=(), dtype=float32)
loss: tf.Tensor(0.72673106, shape=(), dtype=float32)
loss: tf.Tensor(0.87038714, shape=(), dtype=float32)
loss: tf.Tensor(0.94172806, shape=(), dtype=float32)
loss: tf.Tensor(0.85181963, shape=(), dtype=float32)
loss: tf.Tensor(0.71559507, shape=(), dtype=float32)
loss: tf.Tensor(0.88800645, shape=(), dtype=float32)
loss: tf.Tensor(0.80965185, shape=(), dtype=float32)
loss: tf.Tensor(0.8127908, shape=(), dtype=float32)
loss: tf.Tensor(0.8249999, shape=(), dtype=float32)
loss: tf.Tensor(0.82282114, shape=(), dtype=float32)
loss: tf.Tensor(0.82934535, shape=(), dtype=float32)
loss: tf.Tensor(0.8023794, shape=(), dtype=float32)
loss: tf.Tensor(0.87307584, shape=(), dtype=float32)
loss: tf.Tensor(0.81271803, shape=(), dtype=float32)
loss: tf.Tensor(0.7683888, shape=(), dtype=float32)
loss: tf.Tensor(0.7894025, shape=(), dtype=float32)
loss: tf.Tensor(0.8079733, shape=(), dtype=float32)
loss: tf.Tensor(0.69700795, shape=(), dtype=float32)
loss: tf.Tensor(0.824677, shape=(), dtype=float32)
loss: tf.Tensor(0.8251612, shape=(), dtype=float32)
loss: tf.Tensor(0.75877607, shape=(), dtype=float32)
loss: tf.Tensor(0.78489554, shape=(), dtype=float32)
loss: tf.Tensor(0.7834195, shape=(), dtype=float32)
loss: tf.Tensor(0.7331713, shape=(), dtype=float32)
loss: tf.Tensor(0.9013509, shape=(), dtype=float32)
loss: tf.Tensor(0.8466629, shape=(), dtype=float32)
loss: tf.Tensor(0.8266418, shape=(), dtype=float32)
loss: tf.Tensor(0.8544262, shape=(), dtype=float32)
loss: tf.Tensor(0.7874397, shape=(), dtype=float32)
loss: tf.Tensor(0.8266346, shape=(), dtype=float32)
loss: tf.Tensor(1.7402172, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(1.0040072, shape=(), dtype=float32)
F1 SCORE:
0.38346526
EPOCH  19 #################################
loss: tf.Tensor(0.8341822, shape=(), dtype=float32)
loss: tf.Tensor(0.8900307, shape=(), dtype=float32)
loss: tf.Tensor(0.9345142, shape=(), dtype=float32)
loss: tf.Tensor(0.94807947, shape=(), dtype=float32)
loss: tf.Tensor(0.8763817, shape=(), dtype=float32)
loss: tf.Tensor(0.81410456, shape=(), dtype=float32)
loss: tf.Tensor(0.7883507, shape=(), dtype=float32)
loss: tf.Tensor(0.8417236, shape=(), dtype=float32)
loss: tf.Tensor(0.86581266, shape=(), dtype=float32)
loss: tf.Tensor(0.80645365, shape=(), dtype=float32)
loss: tf.Tensor(0.90089345, shape=(), dtype=float32)
loss: tf.Tensor(0.88571227, shape=(), dtype=float32)
loss: tf.Tensor(0.9679682, shape=(), dtype=float32)
loss: tf.Tensor(0.7881859, shape=(), dtype=float32)
loss: tf.Tensor(0.88322204, shape=(), dtype=float32)
loss: tf.Tensor(0.8538511, shape=(), dtype=float32)
loss: tf.Tensor(0.85689825, shape=(), dtype=float32)
loss: tf.Tensor(0.92060804, shape=(), dtype=float32)
loss: tf.Tensor(0.79956186, shape=(), dtype=float32)
loss: tf.Tensor(0.8682685, shape=(), dtype=float32)
loss: tf.Tensor(0.8951912, shape=(), dtype=float32)
loss: tf.Tensor(0.84779626, shape=(), dtype=float32)
loss: tf.Tensor(0.941706, shape=(), dtype=float32)
loss: tf.Tensor(0.8417253, shape=(), dtype=float32)
loss: tf.Tensor(0.97453386, shape=(), dtype=float32)
loss: tf.Tensor(0.8126973, shape=(), dtype=float32)
loss: tf.Tensor(0.888703, shape=(), dtype=float32)
loss: tf.Tensor(0.88489556, shape=(), dtype=float32)
loss: tf.Tensor(0.8628575, shape=(), dtype=float32)
loss: tf.Tensor(0.8471547, shape=(), dtype=float32)
loss: tf.Tensor(0.7492652, shape=(), dtype=float32)
loss: tf.Tensor(0.776561, shape=(), dtype=float32)
loss: tf.Tensor(0.8309838, shape=(), dtype=float32)
loss: tf.Tensor(0.9041544, shape=(), dtype=float32)
loss: tf.Tensor(0.9212369, shape=(), dtype=float32)
loss: tf.Tensor(0.7801862, shape=(), dtype=float32)
loss: tf.Tensor(1.023261, shape=(), dtype=float32)
loss: tf.Tensor(0.84201926, shape=(), dtype=float32)
loss: tf.Tensor(0.9043071, shape=(), dtype=float32)
loss: tf.Tensor(0.8965216, shape=(), dtype=float32)
loss: tf.Tensor(0.9756961, shape=(), dtype=float32)
loss: tf.Tensor(0.85340905, shape=(), dtype=float32)
loss: tf.Tensor(0.7258236, shape=(), dtype=float32)
loss: tf.Tensor(0.80289376, shape=(), dtype=float32)
loss: tf.Tensor(0.8436174, shape=(), dtype=float32)
loss: tf.Tensor(0.8588731, shape=(), dtype=float32)
loss: tf.Tensor(0.8040165, shape=(), dtype=float32)
loss: tf.Tensor(0.94888663, shape=(), dtype=float32)
loss: tf.Tensor(0.9330246, shape=(), dtype=float32)
loss: tf.Tensor(0.7542622, shape=(), dtype=float32)
loss: tf.Tensor(0.84865004, shape=(), dtype=float32)
loss: tf.Tensor(0.8966315, shape=(), dtype=float32)
loss: tf.Tensor(0.81506777, shape=(), dtype=float32)
loss: tf.Tensor(0.8291228, shape=(), dtype=float32)
loss: tf.Tensor(0.84463334, shape=(), dtype=float32)
loss: tf.Tensor(0.9376921, shape=(), dtype=float32)
loss: tf.Tensor(0.8237779, shape=(), dtype=float32)
loss: tf.Tensor(0.81278044, shape=(), dtype=float32)
loss: tf.Tensor(0.796215, shape=(), dtype=float32)
loss: tf.Tensor(0.8694554, shape=(), dtype=float32)
loss: tf.Tensor(0.8650081, shape=(), dtype=float32)
loss: tf.Tensor(0.959386, shape=(), dtype=float32)
loss: tf.Tensor(0.8001757, shape=(), dtype=float32)
loss: tf.Tensor(0.83268553, shape=(), dtype=float32)
loss: tf.Tensor(0.9038659, shape=(), dtype=float32)
loss: tf.Tensor(0.8413555, shape=(), dtype=float32)
loss: tf.Tensor(0.8424518, shape=(), dtype=float32)
loss: tf.Tensor(0.8375173, shape=(), dtype=float32)
loss: tf.Tensor(0.84794855, shape=(), dtype=float32)
loss: tf.Tensor(0.8320042, shape=(), dtype=float32)
loss: tf.Tensor(0.76713175, shape=(), dtype=float32)
loss: tf.Tensor(0.8076719, shape=(), dtype=float32)
loss: tf.Tensor(0.86162347, shape=(), dtype=float32)
loss: tf.Tensor(0.058392104, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9578018, shape=(), dtype=float32)
F1 SCORE:
0.38305524
EPOCH  20 #################################
loss: tf.Tensor(0.74347425, shape=(), dtype=float32)
loss: tf.Tensor(0.90124243, shape=(), dtype=float32)
loss: tf.Tensor(0.80426335, shape=(), dtype=float32)
loss: tf.Tensor(0.97369695, shape=(), dtype=float32)
loss: tf.Tensor(0.703602, shape=(), dtype=float32)
loss: tf.Tensor(0.81327057, shape=(), dtype=float32)
loss: tf.Tensor(0.72321457, shape=(), dtype=float32)
loss: tf.Tensor(0.86726624, shape=(), dtype=float32)
loss: tf.Tensor(0.8193524, shape=(), dtype=float32)
loss: tf.Tensor(0.84474665, shape=(), dtype=float32)
loss: tf.Tensor(0.8255514, shape=(), dtype=float32)
loss: tf.Tensor(0.7926052, shape=(), dtype=float32)
loss: tf.Tensor(0.8474656, shape=(), dtype=float32)
loss: tf.Tensor(0.83600175, shape=(), dtype=float32)
loss: tf.Tensor(0.9048706, shape=(), dtype=float32)
loss: tf.Tensor(0.85740846, shape=(), dtype=float32)
loss: tf.Tensor(0.8868891, shape=(), dtype=float32)
loss: tf.Tensor(0.91952574, shape=(), dtype=float32)
loss: tf.Tensor(0.78418386, shape=(), dtype=float32)
loss: tf.Tensor(0.7565084, shape=(), dtype=float32)
loss: tf.Tensor(0.8542001, shape=(), dtype=float32)
loss: tf.Tensor(0.8435661, shape=(), dtype=float32)
loss: tf.Tensor(0.81345725, shape=(), dtype=float32)
loss: tf.Tensor(0.9007146, shape=(), dtype=float32)
loss: tf.Tensor(0.9461408, shape=(), dtype=float32)
loss: tf.Tensor(0.78215647, shape=(), dtype=float32)
loss: tf.Tensor(0.81992394, shape=(), dtype=float32)
loss: tf.Tensor(0.6933089, shape=(), dtype=float32)
loss: tf.Tensor(0.78614116, shape=(), dtype=float32)
loss: tf.Tensor(0.7540978, shape=(), dtype=float32)
loss: tf.Tensor(0.8030275, shape=(), dtype=float32)
loss: tf.Tensor(0.8134425, shape=(), dtype=float32)
loss: tf.Tensor(0.8022022, shape=(), dtype=float32)
loss: tf.Tensor(0.77306294, shape=(), dtype=float32)
loss: tf.Tensor(0.8915662, shape=(), dtype=float32)
loss: tf.Tensor(0.83405846, shape=(), dtype=float32)
loss: tf.Tensor(0.818334, shape=(), dtype=float32)
loss: tf.Tensor(0.8660597, shape=(), dtype=float32)
loss: tf.Tensor(0.7699135, shape=(), dtype=float32)
loss: tf.Tensor(0.8456508, shape=(), dtype=float32)
loss: tf.Tensor(0.8407988, shape=(), dtype=float32)
loss: tf.Tensor(0.8302059, shape=(), dtype=float32)
loss: tf.Tensor(0.8009285, shape=(), dtype=float32)
loss: tf.Tensor(0.8346484, shape=(), dtype=float32)
loss: tf.Tensor(0.88549703, shape=(), dtype=float32)
loss: tf.Tensor(0.8631836, shape=(), dtype=float32)
loss: tf.Tensor(0.87254834, shape=(), dtype=float32)
loss: tf.Tensor(0.74126005, shape=(), dtype=float32)
loss: tf.Tensor(0.7759562, shape=(), dtype=float32)
loss: tf.Tensor(0.77039725, shape=(), dtype=float32)
loss: tf.Tensor(0.94019127, shape=(), dtype=float32)
loss: tf.Tensor(0.8026971, shape=(), dtype=float32)
loss: tf.Tensor(0.83160186, shape=(), dtype=float32)
loss: tf.Tensor(0.92283463, shape=(), dtype=float32)
loss: tf.Tensor(0.8190653, shape=(), dtype=float32)
loss: tf.Tensor(0.90835345, shape=(), dtype=float32)
loss: tf.Tensor(0.7807342, shape=(), dtype=float32)
loss: tf.Tensor(0.71832865, shape=(), dtype=float32)
loss: tf.Tensor(0.6972324, shape=(), dtype=float32)
loss: tf.Tensor(0.8508169, shape=(), dtype=float32)
loss: tf.Tensor(0.8369817, shape=(), dtype=float32)
loss: tf.Tensor(0.8032423, shape=(), dtype=float32)
loss: tf.Tensor(0.73620087, shape=(), dtype=float32)
loss: tf.Tensor(0.8758381, shape=(), dtype=float32)
loss: tf.Tensor(0.799095, shape=(), dtype=float32)
loss: tf.Tensor(0.75937796, shape=(), dtype=float32)
loss: tf.Tensor(0.67746705, shape=(), dtype=float32)
loss: tf.Tensor(0.9676979, shape=(), dtype=float32)
loss: tf.Tensor(0.79582113, shape=(), dtype=float32)
loss: tf.Tensor(0.69854164, shape=(), dtype=float32)
loss: tf.Tensor(0.8170374, shape=(), dtype=float32)
loss: tf.Tensor(0.6681021, shape=(), dtype=float32)
loss: tf.Tensor(0.7772539, shape=(), dtype=float32)
loss: tf.Tensor(0.13709544, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9584085, shape=(), dtype=float32)
F1 SCORE:
0.38360795
EPOCH  21 #################################
loss: tf.Tensor(0.7468775, shape=(), dtype=float32)
loss: tf.Tensor(0.9017362, shape=(), dtype=float32)
loss: tf.Tensor(0.8800709, shape=(), dtype=float32)
loss: tf.Tensor(0.89783746, shape=(), dtype=float32)
loss: tf.Tensor(0.70305705, shape=(), dtype=float32)
loss: tf.Tensor(0.8014472, shape=(), dtype=float32)
loss: tf.Tensor(0.8303482, shape=(), dtype=float32)
loss: tf.Tensor(0.84104174, shape=(), dtype=float32)
loss: tf.Tensor(0.75611573, shape=(), dtype=float32)
loss: tf.Tensor(0.81881404, shape=(), dtype=float32)
loss: tf.Tensor(0.7970328, shape=(), dtype=float32)
loss: tf.Tensor(0.80685645, shape=(), dtype=float32)
loss: tf.Tensor(0.7300382, shape=(), dtype=float32)
loss: tf.Tensor(0.90612334, shape=(), dtype=float32)
loss: tf.Tensor(0.7541664, shape=(), dtype=float32)
loss: tf.Tensor(0.9434191, shape=(), dtype=float32)
loss: tf.Tensor(0.75947934, shape=(), dtype=float32)
loss: tf.Tensor(0.9012751, shape=(), dtype=float32)
loss: tf.Tensor(0.8300948, shape=(), dtype=float32)
loss: tf.Tensor(0.80070746, shape=(), dtype=float32)
loss: tf.Tensor(0.7058737, shape=(), dtype=float32)
loss: tf.Tensor(0.8031423, shape=(), dtype=float32)
loss: tf.Tensor(0.8321737, shape=(), dtype=float32)
loss: tf.Tensor(0.8636391, shape=(), dtype=float32)
loss: tf.Tensor(0.75107414, shape=(), dtype=float32)
loss: tf.Tensor(0.96019775, shape=(), dtype=float32)
loss: tf.Tensor(0.7531278, shape=(), dtype=float32)
loss: tf.Tensor(0.7305609, shape=(), dtype=float32)
loss: tf.Tensor(0.7734971, shape=(), dtype=float32)
loss: tf.Tensor(0.79001915, shape=(), dtype=float32)
loss: tf.Tensor(0.8682175, shape=(), dtype=float32)
loss: tf.Tensor(0.8306155, shape=(), dtype=float32)
loss: tf.Tensor(0.76853186, shape=(), dtype=float32)
loss: tf.Tensor(0.76225835, shape=(), dtype=float32)
loss: tf.Tensor(0.6992779, shape=(), dtype=float32)
loss: tf.Tensor(0.8638245, shape=(), dtype=float32)
loss: tf.Tensor(0.8083998, shape=(), dtype=float32)
loss: tf.Tensor(0.79106665, shape=(), dtype=float32)
loss: tf.Tensor(0.9375697, shape=(), dtype=float32)
loss: tf.Tensor(0.7932413, shape=(), dtype=float32)
loss: tf.Tensor(0.79154605, shape=(), dtype=float32)
loss: tf.Tensor(0.7492885, shape=(), dtype=float32)
loss: tf.Tensor(0.8763375, shape=(), dtype=float32)
loss: tf.Tensor(0.8643873, shape=(), dtype=float32)
loss: tf.Tensor(0.82428604, shape=(), dtype=float32)
loss: tf.Tensor(0.7030756, shape=(), dtype=float32)
loss: tf.Tensor(0.8509821, shape=(), dtype=float32)
loss: tf.Tensor(0.817122, shape=(), dtype=float32)
loss: tf.Tensor(0.82550627, shape=(), dtype=float32)
loss: tf.Tensor(0.89571196, shape=(), dtype=float32)
loss: tf.Tensor(0.7864113, shape=(), dtype=float32)
loss: tf.Tensor(0.7746421, shape=(), dtype=float32)
loss: tf.Tensor(0.776986, shape=(), dtype=float32)
loss: tf.Tensor(0.76363784, shape=(), dtype=float32)
loss: tf.Tensor(0.76100904, shape=(), dtype=float32)
loss: tf.Tensor(0.87526476, shape=(), dtype=float32)
loss: tf.Tensor(0.7286316, shape=(), dtype=float32)
loss: tf.Tensor(0.7151317, shape=(), dtype=float32)
loss: tf.Tensor(0.8039919, shape=(), dtype=float32)
loss: tf.Tensor(0.69963783, shape=(), dtype=float32)
loss: tf.Tensor(0.84271765, shape=(), dtype=float32)
loss: tf.Tensor(0.75280577, shape=(), dtype=float32)
loss: tf.Tensor(0.7635165, shape=(), dtype=float32)
loss: tf.Tensor(0.77531624, shape=(), dtype=float32)
loss: tf.Tensor(0.73552847, shape=(), dtype=float32)
loss: tf.Tensor(0.92979604, shape=(), dtype=float32)
loss: tf.Tensor(0.90499586, shape=(), dtype=float32)
loss: tf.Tensor(0.7924397, shape=(), dtype=float32)
loss: tf.Tensor(0.8041191, shape=(), dtype=float32)
loss: tf.Tensor(0.8545109, shape=(), dtype=float32)
loss: tf.Tensor(0.7905434, shape=(), dtype=float32)
loss: tf.Tensor(0.8191387, shape=(), dtype=float32)
loss: tf.Tensor(0.7392939, shape=(), dtype=float32)
loss: tf.Tensor(0.15242355, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9674603, shape=(), dtype=float32)
F1 SCORE:
0.38271153
EPOCH  22 #################################
loss: tf.Tensor(0.7903543, shape=(), dtype=float32)
loss: tf.Tensor(0.9180613, shape=(), dtype=float32)
loss: tf.Tensor(0.7087595, shape=(), dtype=float32)
loss: tf.Tensor(0.8194217, shape=(), dtype=float32)
loss: tf.Tensor(0.7647015, shape=(), dtype=float32)
loss: tf.Tensor(0.9185335, shape=(), dtype=float32)
loss: tf.Tensor(0.856651, shape=(), dtype=float32)
loss: tf.Tensor(0.7629939, shape=(), dtype=float32)
loss: tf.Tensor(0.8393121, shape=(), dtype=float32)
loss: tf.Tensor(0.76099044, shape=(), dtype=float32)
loss: tf.Tensor(0.82157904, shape=(), dtype=float32)
loss: tf.Tensor(0.83698636, shape=(), dtype=float32)
loss: tf.Tensor(0.717805, shape=(), dtype=float32)
loss: tf.Tensor(0.8078646, shape=(), dtype=float32)
loss: tf.Tensor(0.8116348, shape=(), dtype=float32)
loss: tf.Tensor(0.71461314, shape=(), dtype=float32)
loss: tf.Tensor(0.74921685, shape=(), dtype=float32)
loss: tf.Tensor(0.63787276, shape=(), dtype=float32)
loss: tf.Tensor(0.662504, shape=(), dtype=float32)
loss: tf.Tensor(0.78289205, shape=(), dtype=float32)
loss: tf.Tensor(0.7346891, shape=(), dtype=float32)
loss: tf.Tensor(0.84571105, shape=(), dtype=float32)
loss: tf.Tensor(0.69430137, shape=(), dtype=float32)
loss: tf.Tensor(0.7408949, shape=(), dtype=float32)
loss: tf.Tensor(0.77189887, shape=(), dtype=float32)
loss: tf.Tensor(0.74993104, shape=(), dtype=float32)
loss: tf.Tensor(0.84852326, shape=(), dtype=float32)
loss: tf.Tensor(0.7740387, shape=(), dtype=float32)
loss: tf.Tensor(0.7537769, shape=(), dtype=float32)
loss: tf.Tensor(0.8397923, shape=(), dtype=float32)
loss: tf.Tensor(0.8672589, shape=(), dtype=float32)
loss: tf.Tensor(0.8409808, shape=(), dtype=float32)
loss: tf.Tensor(0.7910756, shape=(), dtype=float32)
loss: tf.Tensor(0.8416509, shape=(), dtype=float32)
loss: tf.Tensor(0.7804687, shape=(), dtype=float32)
loss: tf.Tensor(0.6869256, shape=(), dtype=float32)
loss: tf.Tensor(0.80755424, shape=(), dtype=float32)
loss: tf.Tensor(0.7954564, shape=(), dtype=float32)
loss: tf.Tensor(0.77821046, shape=(), dtype=float32)
loss: tf.Tensor(0.785663, shape=(), dtype=float32)
loss: tf.Tensor(0.7084122, shape=(), dtype=float32)
loss: tf.Tensor(0.7846548, shape=(), dtype=float32)
loss: tf.Tensor(0.9263219, shape=(), dtype=float32)
loss: tf.Tensor(0.7192913, shape=(), dtype=float32)
loss: tf.Tensor(0.8200285, shape=(), dtype=float32)
loss: tf.Tensor(0.6555918, shape=(), dtype=float32)
loss: tf.Tensor(0.8490149, shape=(), dtype=float32)
loss: tf.Tensor(0.83447325, shape=(), dtype=float32)
loss: tf.Tensor(0.7122541, shape=(), dtype=float32)
loss: tf.Tensor(0.877884, shape=(), dtype=float32)
loss: tf.Tensor(0.7917268, shape=(), dtype=float32)
loss: tf.Tensor(0.67635447, shape=(), dtype=float32)
loss: tf.Tensor(0.80950147, shape=(), dtype=float32)
loss: tf.Tensor(0.7962793, shape=(), dtype=float32)
loss: tf.Tensor(0.7262794, shape=(), dtype=float32)
loss: tf.Tensor(0.8433953, shape=(), dtype=float32)
loss: tf.Tensor(0.8497652, shape=(), dtype=float32)
loss: tf.Tensor(0.8587311, shape=(), dtype=float32)
loss: tf.Tensor(0.72806114, shape=(), dtype=float32)
loss: tf.Tensor(0.8348917, shape=(), dtype=float32)
loss: tf.Tensor(0.66449773, shape=(), dtype=float32)
loss: tf.Tensor(0.87493813, shape=(), dtype=float32)
loss: tf.Tensor(0.7865966, shape=(), dtype=float32)
loss: tf.Tensor(0.88782585, shape=(), dtype=float32)
loss: tf.Tensor(0.76658905, shape=(), dtype=float32)
loss: tf.Tensor(0.7781119, shape=(), dtype=float32)
loss: tf.Tensor(0.80319375, shape=(), dtype=float32)
loss: tf.Tensor(0.8032843, shape=(), dtype=float32)
loss: tf.Tensor(0.7426873, shape=(), dtype=float32)
loss: tf.Tensor(0.82989866, shape=(), dtype=float32)
loss: tf.Tensor(0.80094934, shape=(), dtype=float32)
loss: tf.Tensor(0.76117134, shape=(), dtype=float32)
loss: tf.Tensor(0.7689865, shape=(), dtype=float32)
loss: tf.Tensor(0.24367191, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.959752, shape=(), dtype=float32)
F1 SCORE:
0.383273
EPOCH  23 #################################
loss: tf.Tensor(0.9824619, shape=(), dtype=float32)
loss: tf.Tensor(0.89307463, shape=(), dtype=float32)
loss: tf.Tensor(0.8526963, shape=(), dtype=float32)
loss: tf.Tensor(0.8547184, shape=(), dtype=float32)
loss: tf.Tensor(0.7872472, shape=(), dtype=float32)
loss: tf.Tensor(0.91467166, shape=(), dtype=float32)
loss: tf.Tensor(0.73190314, shape=(), dtype=float32)
loss: tf.Tensor(0.8795978, shape=(), dtype=float32)
loss: tf.Tensor(0.81411934, shape=(), dtype=float32)
loss: tf.Tensor(0.7821604, shape=(), dtype=float32)
loss: tf.Tensor(0.90848875, shape=(), dtype=float32)
loss: tf.Tensor(0.812484, shape=(), dtype=float32)
loss: tf.Tensor(0.74224716, shape=(), dtype=float32)
loss: tf.Tensor(0.80873895, shape=(), dtype=float32)
loss: tf.Tensor(0.82401484, shape=(), dtype=float32)
loss: tf.Tensor(0.8179564, shape=(), dtype=float32)
loss: tf.Tensor(0.81431687, shape=(), dtype=float32)
loss: tf.Tensor(0.80054796, shape=(), dtype=float32)
loss: tf.Tensor(0.82812333, shape=(), dtype=float32)
loss: tf.Tensor(0.81990945, shape=(), dtype=float32)
loss: tf.Tensor(0.7396967, shape=(), dtype=float32)
loss: tf.Tensor(0.8235309, shape=(), dtype=float32)
loss: tf.Tensor(0.8431736, shape=(), dtype=float32)
loss: tf.Tensor(0.66707885, shape=(), dtype=float32)
loss: tf.Tensor(0.7264319, shape=(), dtype=float32)
loss: tf.Tensor(0.77108306, shape=(), dtype=float32)
loss: tf.Tensor(0.79579717, shape=(), dtype=float32)
loss: tf.Tensor(0.80340147, shape=(), dtype=float32)
loss: tf.Tensor(0.7048338, shape=(), dtype=float32)
loss: tf.Tensor(0.7939102, shape=(), dtype=float32)
loss: tf.Tensor(0.7210777, shape=(), dtype=float32)
loss: tf.Tensor(0.79075867, shape=(), dtype=float32)
loss: tf.Tensor(0.7713985, shape=(), dtype=float32)
loss: tf.Tensor(0.8672374, shape=(), dtype=float32)
loss: tf.Tensor(0.7081873, shape=(), dtype=float32)
loss: tf.Tensor(0.7690994, shape=(), dtype=float32)
loss: tf.Tensor(0.785961, shape=(), dtype=float32)
loss: tf.Tensor(0.85168666, shape=(), dtype=float32)
loss: tf.Tensor(0.7354493, shape=(), dtype=float32)
loss: tf.Tensor(0.734527, shape=(), dtype=float32)
loss: tf.Tensor(0.70951784, shape=(), dtype=float32)
loss: tf.Tensor(0.7864759, shape=(), dtype=float32)
loss: tf.Tensor(0.82550377, shape=(), dtype=float32)
loss: tf.Tensor(0.76664186, shape=(), dtype=float32)
loss: tf.Tensor(0.9182159, shape=(), dtype=float32)
loss: tf.Tensor(0.8083734, shape=(), dtype=float32)
loss: tf.Tensor(0.8521832, shape=(), dtype=float32)
loss: tf.Tensor(0.73519355, shape=(), dtype=float32)
loss: tf.Tensor(0.8368362, shape=(), dtype=float32)
loss: tf.Tensor(0.72422004, shape=(), dtype=float32)
loss: tf.Tensor(0.97878367, shape=(), dtype=float32)
loss: tf.Tensor(0.9008375, shape=(), dtype=float32)
loss: tf.Tensor(0.88421386, shape=(), dtype=float32)
loss: tf.Tensor(0.7733212, shape=(), dtype=float32)
loss: tf.Tensor(0.82892203, shape=(), dtype=float32)
loss: tf.Tensor(0.79935336, shape=(), dtype=float32)
loss: tf.Tensor(0.78384364, shape=(), dtype=float32)
loss: tf.Tensor(0.736914, shape=(), dtype=float32)
loss: tf.Tensor(0.75809157, shape=(), dtype=float32)
loss: tf.Tensor(0.69685316, shape=(), dtype=float32)
loss: tf.Tensor(0.67468977, shape=(), dtype=float32)
loss: tf.Tensor(0.87693894, shape=(), dtype=float32)
loss: tf.Tensor(0.9323283, shape=(), dtype=float32)
loss: tf.Tensor(0.7890055, shape=(), dtype=float32)
loss: tf.Tensor(0.6794508, shape=(), dtype=float32)
loss: tf.Tensor(0.8070197, shape=(), dtype=float32)
loss: tf.Tensor(0.87465686, shape=(), dtype=float32)
loss: tf.Tensor(0.73646605, shape=(), dtype=float32)
loss: tf.Tensor(0.74948484, shape=(), dtype=float32)
loss: tf.Tensor(0.70088845, shape=(), dtype=float32)
loss: tf.Tensor(0.68109435, shape=(), dtype=float32)
loss: tf.Tensor(0.7251622, shape=(), dtype=float32)
loss: tf.Tensor(0.798845, shape=(), dtype=float32)
loss: tf.Tensor(0.9368702, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9774592, shape=(), dtype=float32)
F1 SCORE:
0.3850466
EPOCH  24 #################################
loss: tf.Tensor(0.8505576, shape=(), dtype=float32)
loss: tf.Tensor(0.75238776, shape=(), dtype=float32)
loss: tf.Tensor(0.7747871, shape=(), dtype=float32)
loss: tf.Tensor(0.86627907, shape=(), dtype=float32)
loss: tf.Tensor(0.7946916, shape=(), dtype=float32)
loss: tf.Tensor(0.80064684, shape=(), dtype=float32)
loss: tf.Tensor(0.78081596, shape=(), dtype=float32)
loss: tf.Tensor(0.7381963, shape=(), dtype=float32)
loss: tf.Tensor(0.8627845, shape=(), dtype=float32)
loss: tf.Tensor(0.81770426, shape=(), dtype=float32)
loss: tf.Tensor(0.68438196, shape=(), dtype=float32)
loss: tf.Tensor(0.6572882, shape=(), dtype=float32)
loss: tf.Tensor(0.83123034, shape=(), dtype=float32)
loss: tf.Tensor(0.73627746, shape=(), dtype=float32)
loss: tf.Tensor(0.88038903, shape=(), dtype=float32)
loss: tf.Tensor(0.8831665, shape=(), dtype=float32)
loss: tf.Tensor(0.7533973, shape=(), dtype=float32)
loss: tf.Tensor(0.8898759, shape=(), dtype=float32)
loss: tf.Tensor(0.69360924, shape=(), dtype=float32)
loss: tf.Tensor(0.77186066, shape=(), dtype=float32)
loss: tf.Tensor(0.87467647, shape=(), dtype=float32)
loss: tf.Tensor(0.77928686, shape=(), dtype=float32)
loss: tf.Tensor(0.74878484, shape=(), dtype=float32)
loss: tf.Tensor(0.6870709, shape=(), dtype=float32)
loss: tf.Tensor(0.7759625, shape=(), dtype=float32)
loss: tf.Tensor(0.7818468, shape=(), dtype=float32)
loss: tf.Tensor(0.76119184, shape=(), dtype=float32)
loss: tf.Tensor(0.9097334, shape=(), dtype=float32)
loss: tf.Tensor(0.6834752, shape=(), dtype=float32)
loss: tf.Tensor(0.8100787, shape=(), dtype=float32)
loss: tf.Tensor(0.8289131, shape=(), dtype=float32)
loss: tf.Tensor(0.73658186, shape=(), dtype=float32)
loss: tf.Tensor(0.83685076, shape=(), dtype=float32)
loss: tf.Tensor(0.8384434, shape=(), dtype=float32)
loss: tf.Tensor(0.6655794, shape=(), dtype=float32)
loss: tf.Tensor(0.80107987, shape=(), dtype=float32)
loss: tf.Tensor(0.7434528, shape=(), dtype=float32)
loss: tf.Tensor(0.7780054, shape=(), dtype=float32)
loss: tf.Tensor(0.83184135, shape=(), dtype=float32)
loss: tf.Tensor(0.8726113, shape=(), dtype=float32)
loss: tf.Tensor(0.8045744, shape=(), dtype=float32)
loss: tf.Tensor(0.8360824, shape=(), dtype=float32)
loss: tf.Tensor(0.76965487, shape=(), dtype=float32)
loss: tf.Tensor(0.7936192, shape=(), dtype=float32)
loss: tf.Tensor(0.7950862, shape=(), dtype=float32)
loss: tf.Tensor(0.8179096, shape=(), dtype=float32)
loss: tf.Tensor(0.8196389, shape=(), dtype=float32)
loss: tf.Tensor(0.8591333, shape=(), dtype=float32)
loss: tf.Tensor(0.80690783, shape=(), dtype=float32)
loss: tf.Tensor(0.81033987, shape=(), dtype=float32)
loss: tf.Tensor(0.72219414, shape=(), dtype=float32)
loss: tf.Tensor(0.76103157, shape=(), dtype=float32)
loss: tf.Tensor(0.79999715, shape=(), dtype=float32)
loss: tf.Tensor(0.7945713, shape=(), dtype=float32)
loss: tf.Tensor(0.7950843, shape=(), dtype=float32)
loss: tf.Tensor(0.9141955, shape=(), dtype=float32)
loss: tf.Tensor(0.72244865, shape=(), dtype=float32)
loss: tf.Tensor(0.8381951, shape=(), dtype=float32)
loss: tf.Tensor(0.75608164, shape=(), dtype=float32)
loss: tf.Tensor(0.8561353, shape=(), dtype=float32)
loss: tf.Tensor(0.72113055, shape=(), dtype=float32)
loss: tf.Tensor(0.79092616, shape=(), dtype=float32)
loss: tf.Tensor(0.7604477, shape=(), dtype=float32)
loss: tf.Tensor(0.8038685, shape=(), dtype=float32)
loss: tf.Tensor(0.67774093, shape=(), dtype=float32)
loss: tf.Tensor(0.87013566, shape=(), dtype=float32)
loss: tf.Tensor(0.8571952, shape=(), dtype=float32)
loss: tf.Tensor(0.7122605, shape=(), dtype=float32)
loss: tf.Tensor(0.74956805, shape=(), dtype=float32)
loss: tf.Tensor(0.7759043, shape=(), dtype=float32)
loss: tf.Tensor(0.75985837, shape=(), dtype=float32)
loss: tf.Tensor(0.81472605, shape=(), dtype=float32)
loss: tf.Tensor(0.7854564, shape=(), dtype=float32)
loss: tf.Tensor(0.2745904, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9664537, shape=(), dtype=float32)
F1 SCORE:
0.38699612
EPOCH  25 #################################
loss: tf.Tensor(0.79171836, shape=(), dtype=float32)
loss: tf.Tensor(0.7595847, shape=(), dtype=float32)
loss: tf.Tensor(0.8778365, shape=(), dtype=float32)
loss: tf.Tensor(0.77032924, shape=(), dtype=float32)
loss: tf.Tensor(0.765826, shape=(), dtype=float32)
loss: tf.Tensor(0.82145095, shape=(), dtype=float32)
loss: tf.Tensor(0.8571305, shape=(), dtype=float32)
loss: tf.Tensor(0.7936303, shape=(), dtype=float32)
loss: tf.Tensor(0.670403, shape=(), dtype=float32)
loss: tf.Tensor(0.7424423, shape=(), dtype=float32)
loss: tf.Tensor(0.74656034, shape=(), dtype=float32)
loss: tf.Tensor(0.77532715, shape=(), dtype=float32)
loss: tf.Tensor(0.8081157, shape=(), dtype=float32)
loss: tf.Tensor(0.7893425, shape=(), dtype=float32)
loss: tf.Tensor(0.75116235, shape=(), dtype=float32)
loss: tf.Tensor(0.7416325, shape=(), dtype=float32)
loss: tf.Tensor(0.73026294, shape=(), dtype=float32)
loss: tf.Tensor(0.7704522, shape=(), dtype=float32)
loss: tf.Tensor(0.7560834, shape=(), dtype=float32)
loss: tf.Tensor(0.8414818, shape=(), dtype=float32)
loss: tf.Tensor(0.81841177, shape=(), dtype=float32)
loss: tf.Tensor(0.66562873, shape=(), dtype=float32)
loss: tf.Tensor(0.7181775, shape=(), dtype=float32)
loss: tf.Tensor(0.7530817, shape=(), dtype=float32)
loss: tf.Tensor(0.76879674, shape=(), dtype=float32)
loss: tf.Tensor(0.6718414, shape=(), dtype=float32)
loss: tf.Tensor(0.75214636, shape=(), dtype=float32)
loss: tf.Tensor(0.6847703, shape=(), dtype=float32)
loss: tf.Tensor(0.72200096, shape=(), dtype=float32)
loss: tf.Tensor(0.8141016, shape=(), dtype=float32)
loss: tf.Tensor(0.866757, shape=(), dtype=float32)
loss: tf.Tensor(0.68915373, shape=(), dtype=float32)
loss: tf.Tensor(0.9042767, shape=(), dtype=float32)
loss: tf.Tensor(0.7460421, shape=(), dtype=float32)
loss: tf.Tensor(0.72663856, shape=(), dtype=float32)
loss: tf.Tensor(0.79476297, shape=(), dtype=float32)
loss: tf.Tensor(0.65317553, shape=(), dtype=float32)
loss: tf.Tensor(0.739391, shape=(), dtype=float32)
loss: tf.Tensor(0.7773542, shape=(), dtype=float32)
loss: tf.Tensor(0.7738879, shape=(), dtype=float32)
loss: tf.Tensor(0.764473, shape=(), dtype=float32)
loss: tf.Tensor(0.9107917, shape=(), dtype=float32)
loss: tf.Tensor(0.83948255, shape=(), dtype=float32)
loss: tf.Tensor(0.7793071, shape=(), dtype=float32)
loss: tf.Tensor(0.8184838, shape=(), dtype=float32)
loss: tf.Tensor(0.85302633, shape=(), dtype=float32)
loss: tf.Tensor(0.7855778, shape=(), dtype=float32)
loss: tf.Tensor(0.83275145, shape=(), dtype=float32)
loss: tf.Tensor(0.80422264, shape=(), dtype=float32)
loss: tf.Tensor(0.78904754, shape=(), dtype=float32)
loss: tf.Tensor(0.8375711, shape=(), dtype=float32)
loss: tf.Tensor(0.84830004, shape=(), dtype=float32)
loss: tf.Tensor(0.8443611, shape=(), dtype=float32)
loss: tf.Tensor(0.72143906, shape=(), dtype=float32)
loss: tf.Tensor(0.7473798, shape=(), dtype=float32)
loss: tf.Tensor(0.6550637, shape=(), dtype=float32)
loss: tf.Tensor(0.7492847, shape=(), dtype=float32)
loss: tf.Tensor(0.84835035, shape=(), dtype=float32)
loss: tf.Tensor(0.84045905, shape=(), dtype=float32)
loss: tf.Tensor(0.790083, shape=(), dtype=float32)
loss: tf.Tensor(0.69365877, shape=(), dtype=float32)
loss: tf.Tensor(0.7263691, shape=(), dtype=float32)
loss: tf.Tensor(0.74323875, shape=(), dtype=float32)
loss: tf.Tensor(0.7229574, shape=(), dtype=float32)
loss: tf.Tensor(0.7213625, shape=(), dtype=float32)
loss: tf.Tensor(0.90441924, shape=(), dtype=float32)
loss: tf.Tensor(0.9982544, shape=(), dtype=float32)
loss: tf.Tensor(0.6986992, shape=(), dtype=float32)
loss: tf.Tensor(0.7915799, shape=(), dtype=float32)
loss: tf.Tensor(0.79342, shape=(), dtype=float32)
loss: tf.Tensor(0.7739219, shape=(), dtype=float32)
loss: tf.Tensor(0.883478, shape=(), dtype=float32)
loss: tf.Tensor(0.81566507, shape=(), dtype=float32)
loss: tf.Tensor(0.60406953, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9777096, shape=(), dtype=float32)
F1 SCORE:
0.38987967
EPOCH  26 #################################
loss: tf.Tensor(0.70193845, shape=(), dtype=float32)
loss: tf.Tensor(0.83021194, shape=(), dtype=float32)
loss: tf.Tensor(0.7569654, shape=(), dtype=float32)
loss: tf.Tensor(0.8771442, shape=(), dtype=float32)
loss: tf.Tensor(0.7043037, shape=(), dtype=float32)
loss: tf.Tensor(0.81321627, shape=(), dtype=float32)
loss: tf.Tensor(0.7088345, shape=(), dtype=float32)
loss: tf.Tensor(0.857285, shape=(), dtype=float32)
loss: tf.Tensor(0.5974769, shape=(), dtype=float32)
loss: tf.Tensor(0.85805243, shape=(), dtype=float32)
loss: tf.Tensor(0.855687, shape=(), dtype=float32)
loss: tf.Tensor(0.7349447, shape=(), dtype=float32)
loss: tf.Tensor(0.7954906, shape=(), dtype=float32)
loss: tf.Tensor(0.8630769, shape=(), dtype=float32)
loss: tf.Tensor(0.796501, shape=(), dtype=float32)
loss: tf.Tensor(0.9106732, shape=(), dtype=float32)
loss: tf.Tensor(0.8177591, shape=(), dtype=float32)
loss: tf.Tensor(0.7679735, shape=(), dtype=float32)
loss: tf.Tensor(0.8149596, shape=(), dtype=float32)
loss: tf.Tensor(0.76698714, shape=(), dtype=float32)
loss: tf.Tensor(0.7901442, shape=(), dtype=float32)
loss: tf.Tensor(0.67115957, shape=(), dtype=float32)
loss: tf.Tensor(0.6755019, shape=(), dtype=float32)
loss: tf.Tensor(0.75082564, shape=(), dtype=float32)
loss: tf.Tensor(0.7195988, shape=(), dtype=float32)
loss: tf.Tensor(0.9541905, shape=(), dtype=float32)
loss: tf.Tensor(0.80168945, shape=(), dtype=float32)
loss: tf.Tensor(0.64111936, shape=(), dtype=float32)
loss: tf.Tensor(0.8083172, shape=(), dtype=float32)
loss: tf.Tensor(0.7562204, shape=(), dtype=float32)
loss: tf.Tensor(0.76292145, shape=(), dtype=float32)
loss: tf.Tensor(0.77934647, shape=(), dtype=float32)
loss: tf.Tensor(0.7618326, shape=(), dtype=float32)
loss: tf.Tensor(0.8132295, shape=(), dtype=float32)
loss: tf.Tensor(0.8223661, shape=(), dtype=float32)
loss: tf.Tensor(0.8898872, shape=(), dtype=float32)
loss: tf.Tensor(0.6788532, shape=(), dtype=float32)
loss: tf.Tensor(0.8341476, shape=(), dtype=float32)
loss: tf.Tensor(0.65182394, shape=(), dtype=float32)
loss: tf.Tensor(0.79731977, shape=(), dtype=float32)
loss: tf.Tensor(0.7002632, shape=(), dtype=float32)
loss: tf.Tensor(0.6693981, shape=(), dtype=float32)
loss: tf.Tensor(0.74110574, shape=(), dtype=float32)
loss: tf.Tensor(0.6494583, shape=(), dtype=float32)
loss: tf.Tensor(0.7865676, shape=(), dtype=float32)
loss: tf.Tensor(0.82718635, shape=(), dtype=float32)
loss: tf.Tensor(0.67427343, shape=(), dtype=float32)
loss: tf.Tensor(0.8048019, shape=(), dtype=float32)
loss: tf.Tensor(0.73225814, shape=(), dtype=float32)
loss: tf.Tensor(0.7277502, shape=(), dtype=float32)
loss: tf.Tensor(0.7069872, shape=(), dtype=float32)
loss: tf.Tensor(0.8470031, shape=(), dtype=float32)
loss: tf.Tensor(0.9835781, shape=(), dtype=float32)
loss: tf.Tensor(0.74829125, shape=(), dtype=float32)
loss: tf.Tensor(0.77069235, shape=(), dtype=float32)
loss: tf.Tensor(0.76591855, shape=(), dtype=float32)
loss: tf.Tensor(0.7980534, shape=(), dtype=float32)
loss: tf.Tensor(0.73321396, shape=(), dtype=float32)
loss: tf.Tensor(0.9051336, shape=(), dtype=float32)
loss: tf.Tensor(0.79084533, shape=(), dtype=float32)
loss: tf.Tensor(0.8835383, shape=(), dtype=float32)
loss: tf.Tensor(0.7582545, shape=(), dtype=float32)
loss: tf.Tensor(0.65283227, shape=(), dtype=float32)
loss: tf.Tensor(0.8610392, shape=(), dtype=float32)
loss: tf.Tensor(0.70039266, shape=(), dtype=float32)
loss: tf.Tensor(0.9070323, shape=(), dtype=float32)
loss: tf.Tensor(0.75917053, shape=(), dtype=float32)
loss: tf.Tensor(0.738709, shape=(), dtype=float32)
loss: tf.Tensor(0.9327282, shape=(), dtype=float32)
loss: tf.Tensor(0.6277959, shape=(), dtype=float32)
loss: tf.Tensor(0.8170226, shape=(), dtype=float32)
loss: tf.Tensor(0.83495474, shape=(), dtype=float32)
loss: tf.Tensor(0.71145296, shape=(), dtype=float32)
loss: tf.Tensor(0.28159252, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9718163, shape=(), dtype=float32)
F1 SCORE:
0.39179435
EPOCH  27 #################################
loss: tf.Tensor(0.6748848, shape=(), dtype=float32)
loss: tf.Tensor(0.7167157, shape=(), dtype=float32)
loss: tf.Tensor(0.69977117, shape=(), dtype=float32)
loss: tf.Tensor(0.77264917, shape=(), dtype=float32)
loss: tf.Tensor(0.7583185, shape=(), dtype=float32)
loss: tf.Tensor(0.8165735, shape=(), dtype=float32)
loss: tf.Tensor(0.73235023, shape=(), dtype=float32)
loss: tf.Tensor(0.68150693, shape=(), dtype=float32)
loss: tf.Tensor(0.8635015, shape=(), dtype=float32)
loss: tf.Tensor(0.814269, shape=(), dtype=float32)
loss: tf.Tensor(0.7489654, shape=(), dtype=float32)
loss: tf.Tensor(0.7303515, shape=(), dtype=float32)
loss: tf.Tensor(0.72546464, shape=(), dtype=float32)
loss: tf.Tensor(0.7331398, shape=(), dtype=float32)
loss: tf.Tensor(0.6878044, shape=(), dtype=float32)
loss: tf.Tensor(0.7395305, shape=(), dtype=float32)
loss: tf.Tensor(0.7803917, shape=(), dtype=float32)
loss: tf.Tensor(0.80036074, shape=(), dtype=float32)
loss: tf.Tensor(0.70709014, shape=(), dtype=float32)
loss: tf.Tensor(0.78005874, shape=(), dtype=float32)
loss: tf.Tensor(0.7516989, shape=(), dtype=float32)
loss: tf.Tensor(0.804631, shape=(), dtype=float32)
loss: tf.Tensor(0.7032844, shape=(), dtype=float32)
loss: tf.Tensor(0.78808945, shape=(), dtype=float32)
loss: tf.Tensor(0.71027243, shape=(), dtype=float32)
loss: tf.Tensor(0.7959897, shape=(), dtype=float32)
loss: tf.Tensor(0.7773016, shape=(), dtype=float32)
loss: tf.Tensor(0.81563383, shape=(), dtype=float32)
loss: tf.Tensor(0.85731906, shape=(), dtype=float32)
loss: tf.Tensor(0.925736, shape=(), dtype=float32)
loss: tf.Tensor(0.68021363, shape=(), dtype=float32)
loss: tf.Tensor(0.7473368, shape=(), dtype=float32)
loss: tf.Tensor(0.7578823, shape=(), dtype=float32)
loss: tf.Tensor(0.71002316, shape=(), dtype=float32)
loss: tf.Tensor(0.81327224, shape=(), dtype=float32)
loss: tf.Tensor(0.7684475, shape=(), dtype=float32)
loss: tf.Tensor(0.7028484, shape=(), dtype=float32)
loss: tf.Tensor(0.7610775, shape=(), dtype=float32)
loss: tf.Tensor(0.78001213, shape=(), dtype=float32)
loss: tf.Tensor(0.7176102, shape=(), dtype=float32)
loss: tf.Tensor(0.833882, shape=(), dtype=float32)
loss: tf.Tensor(0.79854935, shape=(), dtype=float32)
loss: tf.Tensor(0.7285713, shape=(), dtype=float32)
loss: tf.Tensor(0.8584529, shape=(), dtype=float32)
loss: tf.Tensor(0.7504019, shape=(), dtype=float32)
loss: tf.Tensor(0.76670694, shape=(), dtype=float32)
loss: tf.Tensor(0.85409796, shape=(), dtype=float32)
loss: tf.Tensor(0.82166153, shape=(), dtype=float32)
loss: tf.Tensor(0.81933165, shape=(), dtype=float32)
loss: tf.Tensor(0.7269156, shape=(), dtype=float32)
loss: tf.Tensor(0.74694234, shape=(), dtype=float32)
loss: tf.Tensor(0.74651307, shape=(), dtype=float32)
loss: tf.Tensor(0.69485754, shape=(), dtype=float32)
loss: tf.Tensor(0.73192626, shape=(), dtype=float32)
loss: tf.Tensor(0.8807919, shape=(), dtype=float32)
loss: tf.Tensor(0.72902, shape=(), dtype=float32)
loss: tf.Tensor(0.62963074, shape=(), dtype=float32)
loss: tf.Tensor(0.87261164, shape=(), dtype=float32)
loss: tf.Tensor(0.9124154, shape=(), dtype=float32)
loss: tf.Tensor(0.7982131, shape=(), dtype=float32)
loss: tf.Tensor(0.81562096, shape=(), dtype=float32)
loss: tf.Tensor(0.8096128, shape=(), dtype=float32)
loss: tf.Tensor(0.84103996, shape=(), dtype=float32)
loss: tf.Tensor(0.82911384, shape=(), dtype=float32)
loss: tf.Tensor(0.7960138, shape=(), dtype=float32)
loss: tf.Tensor(0.7548286, shape=(), dtype=float32)
loss: tf.Tensor(0.7718444, shape=(), dtype=float32)
loss: tf.Tensor(0.77239656, shape=(), dtype=float32)
loss: tf.Tensor(0.8102883, shape=(), dtype=float32)
loss: tf.Tensor(0.8101052, shape=(), dtype=float32)
loss: tf.Tensor(0.7055454, shape=(), dtype=float32)
loss: tf.Tensor(0.67544574, shape=(), dtype=float32)
loss: tf.Tensor(0.78183854, shape=(), dtype=float32)
loss: tf.Tensor(0.5861364, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.96755093, shape=(), dtype=float32)
F1 SCORE:
0.3954034
EPOCH  28 #################################
loss: tf.Tensor(0.76864946, shape=(), dtype=float32)
loss: tf.Tensor(0.86942995, shape=(), dtype=float32)
loss: tf.Tensor(0.877908, shape=(), dtype=float32)
loss: tf.Tensor(0.8820108, shape=(), dtype=float32)
loss: tf.Tensor(0.7519323, shape=(), dtype=float32)
loss: tf.Tensor(0.7391335, shape=(), dtype=float32)
loss: tf.Tensor(0.787817, shape=(), dtype=float32)
loss: tf.Tensor(0.7298117, shape=(), dtype=float32)
loss: tf.Tensor(0.72863394, shape=(), dtype=float32)
loss: tf.Tensor(0.9089743, shape=(), dtype=float32)
loss: tf.Tensor(0.890429, shape=(), dtype=float32)
loss: tf.Tensor(0.85130364, shape=(), dtype=float32)
loss: tf.Tensor(0.80028886, shape=(), dtype=float32)
loss: tf.Tensor(0.7817186, shape=(), dtype=float32)
loss: tf.Tensor(0.7868832, shape=(), dtype=float32)
loss: tf.Tensor(0.8086281, shape=(), dtype=float32)
loss: tf.Tensor(0.8384498, shape=(), dtype=float32)
loss: tf.Tensor(0.79262614, shape=(), dtype=float32)
loss: tf.Tensor(0.8376442, shape=(), dtype=float32)
loss: tf.Tensor(0.81620455, shape=(), dtype=float32)
loss: tf.Tensor(0.67708117, shape=(), dtype=float32)
loss: tf.Tensor(0.7930843, shape=(), dtype=float32)
loss: tf.Tensor(0.8389877, shape=(), dtype=float32)
loss: tf.Tensor(0.7748971, shape=(), dtype=float32)
loss: tf.Tensor(0.7500822, shape=(), dtype=float32)
loss: tf.Tensor(0.81055677, shape=(), dtype=float32)
loss: tf.Tensor(0.77821237, shape=(), dtype=float32)
loss: tf.Tensor(0.7611387, shape=(), dtype=float32)
loss: tf.Tensor(0.85451204, shape=(), dtype=float32)
loss: tf.Tensor(0.6831915, shape=(), dtype=float32)
loss: tf.Tensor(0.8951607, shape=(), dtype=float32)
loss: tf.Tensor(0.74840325, shape=(), dtype=float32)
loss: tf.Tensor(0.76635575, shape=(), dtype=float32)
loss: tf.Tensor(0.79369247, shape=(), dtype=float32)
loss: tf.Tensor(0.8222264, shape=(), dtype=float32)
loss: tf.Tensor(0.76897544, shape=(), dtype=float32)
loss: tf.Tensor(0.86673325, shape=(), dtype=float32)
loss: tf.Tensor(0.77732766, shape=(), dtype=float32)
loss: tf.Tensor(0.7110062, shape=(), dtype=float32)
loss: tf.Tensor(0.75875366, shape=(), dtype=float32)
loss: tf.Tensor(0.7631135, shape=(), dtype=float32)
loss: tf.Tensor(0.8255389, shape=(), dtype=float32)
loss: tf.Tensor(0.7266979, shape=(), dtype=float32)
loss: tf.Tensor(0.80668527, shape=(), dtype=float32)
loss: tf.Tensor(0.7338008, shape=(), dtype=float32)
loss: tf.Tensor(0.810318, shape=(), dtype=float32)
loss: tf.Tensor(0.7640075, shape=(), dtype=float32)
loss: tf.Tensor(0.70897406, shape=(), dtype=float32)
loss: tf.Tensor(0.7185302, shape=(), dtype=float32)
loss: tf.Tensor(0.7882004, shape=(), dtype=float32)
loss: tf.Tensor(0.7837355, shape=(), dtype=float32)
loss: tf.Tensor(0.7526571, shape=(), dtype=float32)
loss: tf.Tensor(0.68271947, shape=(), dtype=float32)
loss: tf.Tensor(0.6237008, shape=(), dtype=float32)
loss: tf.Tensor(0.75737387, shape=(), dtype=float32)
loss: tf.Tensor(0.6860303, shape=(), dtype=float32)
loss: tf.Tensor(0.8520963, shape=(), dtype=float32)
loss: tf.Tensor(0.5993747, shape=(), dtype=float32)
loss: tf.Tensor(0.7966529, shape=(), dtype=float32)
loss: tf.Tensor(0.80893725, shape=(), dtype=float32)
loss: tf.Tensor(0.8294798, shape=(), dtype=float32)
loss: tf.Tensor(0.70253146, shape=(), dtype=float32)
loss: tf.Tensor(0.75435144, shape=(), dtype=float32)
loss: tf.Tensor(0.83471924, shape=(), dtype=float32)
loss: tf.Tensor(0.8136888, shape=(), dtype=float32)
loss: tf.Tensor(0.7032675, shape=(), dtype=float32)
loss: tf.Tensor(0.71421975, shape=(), dtype=float32)
loss: tf.Tensor(0.7302591, shape=(), dtype=float32)
loss: tf.Tensor(0.7021503, shape=(), dtype=float32)
loss: tf.Tensor(0.73994356, shape=(), dtype=float32)
loss: tf.Tensor(0.7635547, shape=(), dtype=float32)
loss: tf.Tensor(0.6565138, shape=(), dtype=float32)
loss: tf.Tensor(0.76830775, shape=(), dtype=float32)
loss: tf.Tensor(0.96389246, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.97445405, shape=(), dtype=float32)
F1 SCORE:
0.39588746
EPOCH  29 #################################
loss: tf.Tensor(0.7268385, shape=(), dtype=float32)
loss: tf.Tensor(0.8185657, shape=(), dtype=float32)
loss: tf.Tensor(0.7912908, shape=(), dtype=float32)
loss: tf.Tensor(0.61369395, shape=(), dtype=float32)
loss: tf.Tensor(0.82164574, shape=(), dtype=float32)
loss: tf.Tensor(0.7706339, shape=(), dtype=float32)
loss: tf.Tensor(0.686488, shape=(), dtype=float32)
loss: tf.Tensor(0.683749, shape=(), dtype=float32)
loss: tf.Tensor(0.77163255, shape=(), dtype=float32)
loss: tf.Tensor(0.722145, shape=(), dtype=float32)
loss: tf.Tensor(0.83311063, shape=(), dtype=float32)
loss: tf.Tensor(0.6933248, shape=(), dtype=float32)
loss: tf.Tensor(0.8435603, shape=(), dtype=float32)
loss: tf.Tensor(0.76088107, shape=(), dtype=float32)
loss: tf.Tensor(0.72165006, shape=(), dtype=float32)
loss: tf.Tensor(0.8365699, shape=(), dtype=float32)
loss: tf.Tensor(0.75310385, shape=(), dtype=float32)
loss: tf.Tensor(0.73516166, shape=(), dtype=float32)
loss: tf.Tensor(0.7488409, shape=(), dtype=float32)
loss: tf.Tensor(0.69819796, shape=(), dtype=float32)
loss: tf.Tensor(0.6752387, shape=(), dtype=float32)
loss: tf.Tensor(0.77983737, shape=(), dtype=float32)
loss: tf.Tensor(0.710121, shape=(), dtype=float32)
loss: tf.Tensor(0.72335565, shape=(), dtype=float32)
loss: tf.Tensor(0.8703548, shape=(), dtype=float32)
loss: tf.Tensor(0.7743893, shape=(), dtype=float32)
loss: tf.Tensor(0.6964515, shape=(), dtype=float32)
loss: tf.Tensor(0.6237721, shape=(), dtype=float32)
loss: tf.Tensor(0.7721024, shape=(), dtype=float32)
loss: tf.Tensor(0.69674736, shape=(), dtype=float32)
loss: tf.Tensor(0.84594727, shape=(), dtype=float32)
loss: tf.Tensor(0.76777345, shape=(), dtype=float32)
loss: tf.Tensor(0.7550815, shape=(), dtype=float32)
loss: tf.Tensor(0.6824453, shape=(), dtype=float32)
loss: tf.Tensor(0.8105047, shape=(), dtype=float32)
loss: tf.Tensor(0.7808195, shape=(), dtype=float32)
loss: tf.Tensor(0.7816846, shape=(), dtype=float32)
loss: tf.Tensor(0.7238568, shape=(), dtype=float32)
loss: tf.Tensor(0.72426957, shape=(), dtype=float32)
loss: tf.Tensor(0.8130972, shape=(), dtype=float32)
loss: tf.Tensor(0.7771641, shape=(), dtype=float32)
loss: tf.Tensor(0.80750084, shape=(), dtype=float32)
loss: tf.Tensor(0.81079936, shape=(), dtype=float32)
loss: tf.Tensor(0.7475573, shape=(), dtype=float32)
loss: tf.Tensor(0.63855916, shape=(), dtype=float32)
loss: tf.Tensor(0.80512094, shape=(), dtype=float32)
loss: tf.Tensor(0.73393023, shape=(), dtype=float32)
loss: tf.Tensor(0.7266878, shape=(), dtype=float32)
loss: tf.Tensor(0.7910864, shape=(), dtype=float32)
loss: tf.Tensor(0.7154495, shape=(), dtype=float32)
loss: tf.Tensor(0.70978266, shape=(), dtype=float32)
loss: tf.Tensor(0.75364685, shape=(), dtype=float32)
loss: tf.Tensor(0.8087453, shape=(), dtype=float32)
loss: tf.Tensor(0.7447666, shape=(), dtype=float32)
loss: tf.Tensor(0.8305064, shape=(), dtype=float32)
loss: tf.Tensor(0.82312083, shape=(), dtype=float32)
loss: tf.Tensor(0.7470074, shape=(), dtype=float32)
loss: tf.Tensor(0.7206484, shape=(), dtype=float32)
loss: tf.Tensor(0.7723479, shape=(), dtype=float32)
loss: tf.Tensor(0.75325674, shape=(), dtype=float32)
loss: tf.Tensor(0.8941963, shape=(), dtype=float32)
loss: tf.Tensor(0.7407764, shape=(), dtype=float32)
loss: tf.Tensor(0.82700753, shape=(), dtype=float32)
loss: tf.Tensor(0.78281176, shape=(), dtype=float32)
loss: tf.Tensor(0.762519, shape=(), dtype=float32)
loss: tf.Tensor(0.8094537, shape=(), dtype=float32)
loss: tf.Tensor(0.7903639, shape=(), dtype=float32)
loss: tf.Tensor(0.6466086, shape=(), dtype=float32)
loss: tf.Tensor(0.7861311, shape=(), dtype=float32)
loss: tf.Tensor(0.66198426, shape=(), dtype=float32)
loss: tf.Tensor(0.8269289, shape=(), dtype=float32)
loss: tf.Tensor(0.87662154, shape=(), dtype=float32)
loss: tf.Tensor(0.6859254, shape=(), dtype=float32)
loss: tf.Tensor(1.4039993, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.98122215, shape=(), dtype=float32)
F1 SCORE:
0.3986225
EPOCH  30 #################################
loss: tf.Tensor(0.7366118, shape=(), dtype=float32)
loss: tf.Tensor(0.7474886, shape=(), dtype=float32)
loss: tf.Tensor(0.83070517, shape=(), dtype=float32)
loss: tf.Tensor(0.9772431, shape=(), dtype=float32)
loss: tf.Tensor(0.78546315, shape=(), dtype=float32)
loss: tf.Tensor(0.7584256, shape=(), dtype=float32)
loss: tf.Tensor(0.9667645, shape=(), dtype=float32)
loss: tf.Tensor(0.75144213, shape=(), dtype=float32)
loss: tf.Tensor(0.94594413, shape=(), dtype=float32)
loss: tf.Tensor(0.7315785, shape=(), dtype=float32)
loss: tf.Tensor(0.7509297, shape=(), dtype=float32)
loss: tf.Tensor(0.78511435, shape=(), dtype=float32)
loss: tf.Tensor(0.759137, shape=(), dtype=float32)
loss: tf.Tensor(0.826471, shape=(), dtype=float32)
loss: tf.Tensor(0.7595928, shape=(), dtype=float32)
loss: tf.Tensor(0.69736403, shape=(), dtype=float32)
loss: tf.Tensor(0.77530503, shape=(), dtype=float32)
loss: tf.Tensor(0.8579752, shape=(), dtype=float32)
loss: tf.Tensor(0.7700411, shape=(), dtype=float32)
loss: tf.Tensor(0.74261355, shape=(), dtype=float32)
loss: tf.Tensor(0.7552101, shape=(), dtype=float32)
loss: tf.Tensor(0.7614898, shape=(), dtype=float32)
loss: tf.Tensor(0.7045553, shape=(), dtype=float32)
loss: tf.Tensor(0.7504494, shape=(), dtype=float32)
loss: tf.Tensor(0.6218579, shape=(), dtype=float32)
loss: tf.Tensor(0.7068553, shape=(), dtype=float32)
loss: tf.Tensor(0.70248175, shape=(), dtype=float32)
loss: tf.Tensor(0.73389333, shape=(), dtype=float32)
loss: tf.Tensor(0.7292725, shape=(), dtype=float32)
loss: tf.Tensor(0.77140474, shape=(), dtype=float32)
loss: tf.Tensor(0.81998014, shape=(), dtype=float32)
loss: tf.Tensor(0.7309098, shape=(), dtype=float32)
loss: tf.Tensor(0.6949027, shape=(), dtype=float32)
loss: tf.Tensor(0.8653488, shape=(), dtype=float32)
loss: tf.Tensor(0.6556532, shape=(), dtype=float32)
loss: tf.Tensor(0.7961705, shape=(), dtype=float32)
loss: tf.Tensor(0.8086229, shape=(), dtype=float32)
loss: tf.Tensor(0.66492623, shape=(), dtype=float32)
loss: tf.Tensor(0.8007541, shape=(), dtype=float32)
loss: tf.Tensor(0.76859915, shape=(), dtype=float32)
loss: tf.Tensor(0.70647866, shape=(), dtype=float32)
loss: tf.Tensor(0.6862698, shape=(), dtype=float32)
loss: tf.Tensor(0.6718346, shape=(), dtype=float32)
loss: tf.Tensor(0.6063248, shape=(), dtype=float32)
loss: tf.Tensor(0.8472288, shape=(), dtype=float32)
loss: tf.Tensor(0.6805333, shape=(), dtype=float32)
loss: tf.Tensor(0.7541049, shape=(), dtype=float32)
loss: tf.Tensor(0.8306198, shape=(), dtype=float32)
loss: tf.Tensor(0.77238756, shape=(), dtype=float32)
loss: tf.Tensor(0.81982344, shape=(), dtype=float32)
loss: tf.Tensor(0.64414454, shape=(), dtype=float32)
loss: tf.Tensor(0.74203473, shape=(), dtype=float32)
loss: tf.Tensor(0.72406876, shape=(), dtype=float32)
loss: tf.Tensor(0.7792058, shape=(), dtype=float32)
loss: tf.Tensor(0.7692451, shape=(), dtype=float32)
loss: tf.Tensor(0.93843096, shape=(), dtype=float32)
loss: tf.Tensor(0.7681089, shape=(), dtype=float32)
loss: tf.Tensor(0.74255186, shape=(), dtype=float32)
loss: tf.Tensor(0.6717918, shape=(), dtype=float32)
loss: tf.Tensor(0.6849066, shape=(), dtype=float32)
loss: tf.Tensor(0.7729672, shape=(), dtype=float32)
loss: tf.Tensor(0.77371806, shape=(), dtype=float32)
loss: tf.Tensor(0.7513478, shape=(), dtype=float32)
loss: tf.Tensor(0.68086404, shape=(), dtype=float32)
loss: tf.Tensor(0.80906594, shape=(), dtype=float32)
loss: tf.Tensor(0.81711435, shape=(), dtype=float32)
loss: tf.Tensor(0.776907, shape=(), dtype=float32)
loss: tf.Tensor(0.697142, shape=(), dtype=float32)
loss: tf.Tensor(0.8312346, shape=(), dtype=float32)
loss: tf.Tensor(0.6908148, shape=(), dtype=float32)
loss: tf.Tensor(0.7135591, shape=(), dtype=float32)
loss: tf.Tensor(0.7125533, shape=(), dtype=float32)
loss: tf.Tensor(0.8072638, shape=(), dtype=float32)
loss: tf.Tensor(0.043629367, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.96517277, shape=(), dtype=float32)
F1 SCORE:
0.40094483
EPOCH  31 #################################
loss: tf.Tensor(0.66633797, shape=(), dtype=float32)
loss: tf.Tensor(0.7703286, shape=(), dtype=float32)
loss: tf.Tensor(0.7888962, shape=(), dtype=float32)
loss: tf.Tensor(0.75946236, shape=(), dtype=float32)
loss: tf.Tensor(0.69254065, shape=(), dtype=float32)
loss: tf.Tensor(0.5868824, shape=(), dtype=float32)
loss: tf.Tensor(0.74480647, shape=(), dtype=float32)
loss: tf.Tensor(0.83283204, shape=(), dtype=float32)
loss: tf.Tensor(0.86849284, shape=(), dtype=float32)
loss: tf.Tensor(0.6879717, shape=(), dtype=float32)
loss: tf.Tensor(0.83360755, shape=(), dtype=float32)
loss: tf.Tensor(0.7143656, shape=(), dtype=float32)
loss: tf.Tensor(0.8522391, shape=(), dtype=float32)
loss: tf.Tensor(0.7425172, shape=(), dtype=float32)
loss: tf.Tensor(0.7116037, shape=(), dtype=float32)
loss: tf.Tensor(0.6679899, shape=(), dtype=float32)
loss: tf.Tensor(0.85676515, shape=(), dtype=float32)
loss: tf.Tensor(0.8087453, shape=(), dtype=float32)
loss: tf.Tensor(0.8183292, shape=(), dtype=float32)
loss: tf.Tensor(0.76249963, shape=(), dtype=float32)
loss: tf.Tensor(0.6751039, shape=(), dtype=float32)
loss: tf.Tensor(0.90329987, shape=(), dtype=float32)
loss: tf.Tensor(0.66247076, shape=(), dtype=float32)
loss: tf.Tensor(0.76163477, shape=(), dtype=float32)
loss: tf.Tensor(0.7325782, shape=(), dtype=float32)
loss: tf.Tensor(0.65312696, shape=(), dtype=float32)
loss: tf.Tensor(0.64538115, shape=(), dtype=float32)
loss: tf.Tensor(0.81873125, shape=(), dtype=float32)
loss: tf.Tensor(0.7411785, shape=(), dtype=float32)
loss: tf.Tensor(0.73429734, shape=(), dtype=float32)
loss: tf.Tensor(0.7993143, shape=(), dtype=float32)
loss: tf.Tensor(0.8262732, shape=(), dtype=float32)
loss: tf.Tensor(0.7389769, shape=(), dtype=float32)
loss: tf.Tensor(0.7155082, shape=(), dtype=float32)
loss: tf.Tensor(0.8469818, shape=(), dtype=float32)
loss: tf.Tensor(0.7184584, shape=(), dtype=float32)
loss: tf.Tensor(0.7326944, shape=(), dtype=float32)
loss: tf.Tensor(0.7414275, shape=(), dtype=float32)
loss: tf.Tensor(0.7478654, shape=(), dtype=float32)
loss: tf.Tensor(0.87137634, shape=(), dtype=float32)
loss: tf.Tensor(0.817097, shape=(), dtype=float32)
loss: tf.Tensor(0.65175706, shape=(), dtype=float32)
loss: tf.Tensor(0.6149638, shape=(), dtype=float32)
loss: tf.Tensor(0.75510424, shape=(), dtype=float32)
loss: tf.Tensor(0.64650744, shape=(), dtype=float32)
loss: tf.Tensor(0.7423605, shape=(), dtype=float32)
loss: tf.Tensor(0.76249045, shape=(), dtype=float32)
loss: tf.Tensor(0.7106821, shape=(), dtype=float32)
loss: tf.Tensor(0.76075083, shape=(), dtype=float32)
loss: tf.Tensor(0.75467813, shape=(), dtype=float32)
loss: tf.Tensor(0.6758561, shape=(), dtype=float32)
loss: tf.Tensor(0.82000077, shape=(), dtype=float32)
loss: tf.Tensor(0.86796415, shape=(), dtype=float32)
loss: tf.Tensor(0.75865775, shape=(), dtype=float32)
loss: tf.Tensor(0.77151895, shape=(), dtype=float32)
loss: tf.Tensor(0.69950366, shape=(), dtype=float32)
loss: tf.Tensor(0.8009439, shape=(), dtype=float32)
loss: tf.Tensor(0.6651585, shape=(), dtype=float32)
loss: tf.Tensor(0.7724913, shape=(), dtype=float32)
loss: tf.Tensor(0.64835775, shape=(), dtype=float32)
loss: tf.Tensor(0.7599828, shape=(), dtype=float32)
loss: tf.Tensor(0.7842251, shape=(), dtype=float32)
loss: tf.Tensor(0.8123248, shape=(), dtype=float32)
loss: tf.Tensor(0.7090603, shape=(), dtype=float32)
loss: tf.Tensor(0.7768906, shape=(), dtype=float32)
loss: tf.Tensor(0.77049357, shape=(), dtype=float32)
loss: tf.Tensor(0.76631117, shape=(), dtype=float32)
loss: tf.Tensor(0.63525635, shape=(), dtype=float32)
loss: tf.Tensor(0.738147, shape=(), dtype=float32)
loss: tf.Tensor(0.7625229, shape=(), dtype=float32)
loss: tf.Tensor(0.8219833, shape=(), dtype=float32)
loss: tf.Tensor(0.81210226, shape=(), dtype=float32)
loss: tf.Tensor(0.78063947, shape=(), dtype=float32)
loss: tf.Tensor(0.95684713, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.98772484, shape=(), dtype=float32)
F1 SCORE:
0.40537384
EPOCH  32 #################################
loss: tf.Tensor(0.64035887, shape=(), dtype=float32)
loss: tf.Tensor(0.80718493, shape=(), dtype=float32)
loss: tf.Tensor(0.76346046, shape=(), dtype=float32)
loss: tf.Tensor(0.8224094, shape=(), dtype=float32)
loss: tf.Tensor(0.8328507, shape=(), dtype=float32)
loss: tf.Tensor(0.6524276, shape=(), dtype=float32)
loss: tf.Tensor(0.78269213, shape=(), dtype=float32)
loss: tf.Tensor(0.68297464, shape=(), dtype=float32)
loss: tf.Tensor(0.87046933, shape=(), dtype=float32)
loss: tf.Tensor(0.77386016, shape=(), dtype=float32)
loss: tf.Tensor(0.7359366, shape=(), dtype=float32)
loss: tf.Tensor(0.7867209, shape=(), dtype=float32)
loss: tf.Tensor(0.74405724, shape=(), dtype=float32)
loss: tf.Tensor(0.8369637, shape=(), dtype=float32)
loss: tf.Tensor(0.8702108, shape=(), dtype=float32)
loss: tf.Tensor(0.75577426, shape=(), dtype=float32)
loss: tf.Tensor(0.7107944, shape=(), dtype=float32)
loss: tf.Tensor(0.70194864, shape=(), dtype=float32)
loss: tf.Tensor(0.7176587, shape=(), dtype=float32)
loss: tf.Tensor(0.8906945, shape=(), dtype=float32)
loss: tf.Tensor(0.7284983, shape=(), dtype=float32)
loss: tf.Tensor(0.8741166, shape=(), dtype=float32)
loss: tf.Tensor(0.7988943, shape=(), dtype=float32)
loss: tf.Tensor(0.74880743, shape=(), dtype=float32)
loss: tf.Tensor(0.7241445, shape=(), dtype=float32)
loss: tf.Tensor(0.77832556, shape=(), dtype=float32)
loss: tf.Tensor(0.973712, shape=(), dtype=float32)
loss: tf.Tensor(0.7392417, shape=(), dtype=float32)
loss: tf.Tensor(0.8409759, shape=(), dtype=float32)
loss: tf.Tensor(0.8653491, shape=(), dtype=float32)
loss: tf.Tensor(0.85759056, shape=(), dtype=float32)
loss: tf.Tensor(0.7384925, shape=(), dtype=float32)
loss: tf.Tensor(0.85443795, shape=(), dtype=float32)
loss: tf.Tensor(0.6864135, shape=(), dtype=float32)
loss: tf.Tensor(0.82767653, shape=(), dtype=float32)
loss: tf.Tensor(0.8165332, shape=(), dtype=float32)
loss: tf.Tensor(0.7740572, shape=(), dtype=float32)
loss: tf.Tensor(0.68091637, shape=(), dtype=float32)
loss: tf.Tensor(0.5753081, shape=(), dtype=float32)
loss: tf.Tensor(0.6901438, shape=(), dtype=float32)
loss: tf.Tensor(0.683355, shape=(), dtype=float32)
loss: tf.Tensor(0.81723195, shape=(), dtype=float32)
loss: tf.Tensor(0.6974111, shape=(), dtype=float32)
loss: tf.Tensor(0.67600775, shape=(), dtype=float32)
loss: tf.Tensor(0.79370826, shape=(), dtype=float32)
loss: tf.Tensor(0.70639336, shape=(), dtype=float32)
loss: tf.Tensor(0.7885473, shape=(), dtype=float32)
loss: tf.Tensor(0.7617509, shape=(), dtype=float32)
loss: tf.Tensor(0.8299921, shape=(), dtype=float32)
loss: tf.Tensor(0.8521913, shape=(), dtype=float32)
loss: tf.Tensor(0.7016408, shape=(), dtype=float32)
loss: tf.Tensor(0.8536722, shape=(), dtype=float32)
loss: tf.Tensor(0.76823354, shape=(), dtype=float32)
loss: tf.Tensor(0.81266576, shape=(), dtype=float32)
loss: tf.Tensor(0.8187103, shape=(), dtype=float32)
loss: tf.Tensor(0.6700187, shape=(), dtype=float32)
loss: tf.Tensor(0.6290588, shape=(), dtype=float32)
loss: tf.Tensor(0.70738, shape=(), dtype=float32)
loss: tf.Tensor(0.7011211, shape=(), dtype=float32)
loss: tf.Tensor(0.73338366, shape=(), dtype=float32)
loss: tf.Tensor(0.78315574, shape=(), dtype=float32)
loss: tf.Tensor(0.78337455, shape=(), dtype=float32)
loss: tf.Tensor(0.815966, shape=(), dtype=float32)
loss: tf.Tensor(0.75398546, shape=(), dtype=float32)
loss: tf.Tensor(0.7796215, shape=(), dtype=float32)
loss: tf.Tensor(0.7440382, shape=(), dtype=float32)
loss: tf.Tensor(0.6334723, shape=(), dtype=float32)
loss: tf.Tensor(0.72728807, shape=(), dtype=float32)
loss: tf.Tensor(0.7982385, shape=(), dtype=float32)
loss: tf.Tensor(0.91743284, shape=(), dtype=float32)
loss: tf.Tensor(0.775048, shape=(), dtype=float32)
loss: tf.Tensor(0.79333043, shape=(), dtype=float32)
loss: tf.Tensor(0.85979193, shape=(), dtype=float32)
loss: tf.Tensor(0.35364485, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(1.0035236, shape=(), dtype=float32)
F1 SCORE:
0.40784785
EPOCH  33 #################################
loss: tf.Tensor(0.7780666, shape=(), dtype=float32)
loss: tf.Tensor(0.79712796, shape=(), dtype=float32)
loss: tf.Tensor(0.8330958, shape=(), dtype=float32)
loss: tf.Tensor(0.67799294, shape=(), dtype=float32)
loss: tf.Tensor(0.8887492, shape=(), dtype=float32)
loss: tf.Tensor(0.81418455, shape=(), dtype=float32)
loss: tf.Tensor(0.73514414, shape=(), dtype=float32)
loss: tf.Tensor(0.6478655, shape=(), dtype=float32)
loss: tf.Tensor(0.8010335, shape=(), dtype=float32)
loss: tf.Tensor(0.71767676, shape=(), dtype=float32)
loss: tf.Tensor(0.6699495, shape=(), dtype=float32)
loss: tf.Tensor(0.729001, shape=(), dtype=float32)
loss: tf.Tensor(0.64103425, shape=(), dtype=float32)
loss: tf.Tensor(0.7981091, shape=(), dtype=float32)
loss: tf.Tensor(0.74140275, shape=(), dtype=float32)
loss: tf.Tensor(0.8688082, shape=(), dtype=float32)
loss: tf.Tensor(0.7519344, shape=(), dtype=float32)
loss: tf.Tensor(0.76501256, shape=(), dtype=float32)
loss: tf.Tensor(0.7101876, shape=(), dtype=float32)
loss: tf.Tensor(0.774228, shape=(), dtype=float32)
loss: tf.Tensor(0.68362296, shape=(), dtype=float32)
loss: tf.Tensor(0.6812856, shape=(), dtype=float32)
loss: tf.Tensor(0.7151191, shape=(), dtype=float32)
loss: tf.Tensor(0.8016388, shape=(), dtype=float32)
loss: tf.Tensor(0.84975046, shape=(), dtype=float32)
loss: tf.Tensor(0.7591433, shape=(), dtype=float32)
loss: tf.Tensor(0.808029, shape=(), dtype=float32)
loss: tf.Tensor(0.6280658, shape=(), dtype=float32)
loss: tf.Tensor(0.76557726, shape=(), dtype=float32)
loss: tf.Tensor(0.7906338, shape=(), dtype=float32)
loss: tf.Tensor(0.77741766, shape=(), dtype=float32)
loss: tf.Tensor(0.704465, shape=(), dtype=float32)
loss: tf.Tensor(0.7304221, shape=(), dtype=float32)
loss: tf.Tensor(0.76815605, shape=(), dtype=float32)
loss: tf.Tensor(0.65439063, shape=(), dtype=float32)
loss: tf.Tensor(0.7027384, shape=(), dtype=float32)
loss: tf.Tensor(0.81741124, shape=(), dtype=float32)
loss: tf.Tensor(0.74974394, shape=(), dtype=float32)
loss: tf.Tensor(0.81303215, shape=(), dtype=float32)
loss: tf.Tensor(0.6600566, shape=(), dtype=float32)
loss: tf.Tensor(0.9899976, shape=(), dtype=float32)
loss: tf.Tensor(0.75597143, shape=(), dtype=float32)
loss: tf.Tensor(0.82085687, shape=(), dtype=float32)
loss: tf.Tensor(0.81608796, shape=(), dtype=float32)
loss: tf.Tensor(0.86879766, shape=(), dtype=float32)
loss: tf.Tensor(0.766536, shape=(), dtype=float32)
loss: tf.Tensor(0.79697263, shape=(), dtype=float32)
loss: tf.Tensor(0.77950644, shape=(), dtype=float32)
loss: tf.Tensor(0.79124033, shape=(), dtype=float32)
loss: tf.Tensor(0.72778016, shape=(), dtype=float32)
loss: tf.Tensor(0.6987507, shape=(), dtype=float32)
loss: tf.Tensor(0.6637013, shape=(), dtype=float32)
loss: tf.Tensor(0.7974658, shape=(), dtype=float32)
loss: tf.Tensor(0.7656989, shape=(), dtype=float32)
loss: tf.Tensor(0.8129807, shape=(), dtype=float32)
loss: tf.Tensor(0.83284867, shape=(), dtype=float32)
loss: tf.Tensor(0.7611048, shape=(), dtype=float32)
loss: tf.Tensor(0.7346418, shape=(), dtype=float32)
loss: tf.Tensor(0.7352162, shape=(), dtype=float32)
loss: tf.Tensor(0.79237777, shape=(), dtype=float32)
loss: tf.Tensor(0.7471066, shape=(), dtype=float32)
loss: tf.Tensor(0.772067, shape=(), dtype=float32)
loss: tf.Tensor(0.6398019, shape=(), dtype=float32)
loss: tf.Tensor(0.80648005, shape=(), dtype=float32)
loss: tf.Tensor(0.71755755, shape=(), dtype=float32)
loss: tf.Tensor(0.7364779, shape=(), dtype=float32)
loss: tf.Tensor(0.79887056, shape=(), dtype=float32)
loss: tf.Tensor(0.75507045, shape=(), dtype=float32)
loss: tf.Tensor(0.6539135, shape=(), dtype=float32)
loss: tf.Tensor(0.71623534, shape=(), dtype=float32)
loss: tf.Tensor(0.82572234, shape=(), dtype=float32)
loss: tf.Tensor(0.795685, shape=(), dtype=float32)
loss: tf.Tensor(0.7234715, shape=(), dtype=float32)
loss: tf.Tensor(0.50266796, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.99253696, shape=(), dtype=float32)
F1 SCORE:
0.40993968
EPOCH  34 #################################
loss: tf.Tensor(0.70912904, shape=(), dtype=float32)
loss: tf.Tensor(0.7278325, shape=(), dtype=float32)
loss: tf.Tensor(0.7378819, shape=(), dtype=float32)
loss: tf.Tensor(0.85765874, shape=(), dtype=float32)
loss: tf.Tensor(0.72384393, shape=(), dtype=float32)
loss: tf.Tensor(0.8315037, shape=(), dtype=float32)
loss: tf.Tensor(0.78443956, shape=(), dtype=float32)
loss: tf.Tensor(0.80805314, shape=(), dtype=float32)
loss: tf.Tensor(0.8811566, shape=(), dtype=float32)
loss: tf.Tensor(0.79821646, shape=(), dtype=float32)
loss: tf.Tensor(0.7597433, shape=(), dtype=float32)
loss: tf.Tensor(0.72705674, shape=(), dtype=float32)
loss: tf.Tensor(0.7809469, shape=(), dtype=float32)
loss: tf.Tensor(0.7746117, shape=(), dtype=float32)
loss: tf.Tensor(0.7863488, shape=(), dtype=float32)
loss: tf.Tensor(0.9033878, shape=(), dtype=float32)
loss: tf.Tensor(0.80055785, shape=(), dtype=float32)
loss: tf.Tensor(0.916589, shape=(), dtype=float32)
loss: tf.Tensor(0.7874179, shape=(), dtype=float32)
loss: tf.Tensor(0.71358526, shape=(), dtype=float32)
loss: tf.Tensor(0.7195915, shape=(), dtype=float32)
loss: tf.Tensor(0.82091135, shape=(), dtype=float32)
loss: tf.Tensor(0.81763303, shape=(), dtype=float32)
loss: tf.Tensor(0.78092664, shape=(), dtype=float32)
loss: tf.Tensor(0.77452415, shape=(), dtype=float32)
loss: tf.Tensor(0.7512927, shape=(), dtype=float32)
loss: tf.Tensor(0.76789665, shape=(), dtype=float32)
loss: tf.Tensor(0.729541, shape=(), dtype=float32)
loss: tf.Tensor(0.83957887, shape=(), dtype=float32)
loss: tf.Tensor(0.71888846, shape=(), dtype=float32)
loss: tf.Tensor(0.82210183, shape=(), dtype=float32)
loss: tf.Tensor(0.74781764, shape=(), dtype=float32)
loss: tf.Tensor(0.8722267, shape=(), dtype=float32)
loss: tf.Tensor(0.6877129, shape=(), dtype=float32)
loss: tf.Tensor(0.75002533, shape=(), dtype=float32)
loss: tf.Tensor(0.7417271, shape=(), dtype=float32)
loss: tf.Tensor(0.8253214, shape=(), dtype=float32)
loss: tf.Tensor(0.7050258, shape=(), dtype=float32)
loss: tf.Tensor(0.74878156, shape=(), dtype=float32)
loss: tf.Tensor(0.8609412, shape=(), dtype=float32)
loss: tf.Tensor(0.5476538, shape=(), dtype=float32)
loss: tf.Tensor(0.8834232, shape=(), dtype=float32)
loss: tf.Tensor(0.8731954, shape=(), dtype=float32)
loss: tf.Tensor(0.7359205, shape=(), dtype=float32)
loss: tf.Tensor(0.76005, shape=(), dtype=float32)
loss: tf.Tensor(0.76729465, shape=(), dtype=float32)
loss: tf.Tensor(0.71658415, shape=(), dtype=float32)
loss: tf.Tensor(0.6939254, shape=(), dtype=float32)
loss: tf.Tensor(0.76722765, shape=(), dtype=float32)
loss: tf.Tensor(0.8046579, shape=(), dtype=float32)
loss: tf.Tensor(0.72576743, shape=(), dtype=float32)
loss: tf.Tensor(0.6985123, shape=(), dtype=float32)
loss: tf.Tensor(0.7529028, shape=(), dtype=float32)
loss: tf.Tensor(0.72722465, shape=(), dtype=float32)
loss: tf.Tensor(0.8597797, shape=(), dtype=float32)
loss: tf.Tensor(0.7081391, shape=(), dtype=float32)
loss: tf.Tensor(0.75229675, shape=(), dtype=float32)
loss: tf.Tensor(0.774657, shape=(), dtype=float32)
loss: tf.Tensor(0.66937095, shape=(), dtype=float32)
loss: tf.Tensor(0.66947633, shape=(), dtype=float32)
loss: tf.Tensor(0.6936401, shape=(), dtype=float32)
loss: tf.Tensor(0.7674304, shape=(), dtype=float32)
loss: tf.Tensor(0.79869443, shape=(), dtype=float32)
loss: tf.Tensor(0.72692055, shape=(), dtype=float32)
loss: tf.Tensor(0.9196786, shape=(), dtype=float32)
loss: tf.Tensor(0.76197416, shape=(), dtype=float32)
loss: tf.Tensor(0.69612825, shape=(), dtype=float32)
loss: tf.Tensor(0.7220064, shape=(), dtype=float32)
loss: tf.Tensor(0.80729485, shape=(), dtype=float32)
loss: tf.Tensor(0.8316, shape=(), dtype=float32)
loss: tf.Tensor(0.7703939, shape=(), dtype=float32)
loss: tf.Tensor(0.70257115, shape=(), dtype=float32)
loss: tf.Tensor(0.7814285, shape=(), dtype=float32)
loss: tf.Tensor(1.4056243, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(1.0113847, shape=(), dtype=float32)
F1 SCORE:
0.41328287
EPOCH  35 #################################
loss: tf.Tensor(0.83144045, shape=(), dtype=float32)
loss: tf.Tensor(0.89342725, shape=(), dtype=float32)
loss: tf.Tensor(0.96752304, shape=(), dtype=float32)
loss: tf.Tensor(0.9992244, shape=(), dtype=float32)
loss: tf.Tensor(0.91924304, shape=(), dtype=float32)
loss: tf.Tensor(0.871145, shape=(), dtype=float32)
loss: tf.Tensor(0.8755749, shape=(), dtype=float32)
loss: tf.Tensor(0.9465802, shape=(), dtype=float32)
loss: tf.Tensor(0.9676996, shape=(), dtype=float32)
loss: tf.Tensor(0.8424858, shape=(), dtype=float32)
loss: tf.Tensor(0.83677053, shape=(), dtype=float32)
loss: tf.Tensor(0.8112257, shape=(), dtype=float32)
loss: tf.Tensor(0.81850815, shape=(), dtype=float32)
loss: tf.Tensor(0.85370356, shape=(), dtype=float32)
loss: tf.Tensor(0.8751245, shape=(), dtype=float32)
loss: tf.Tensor(0.8941023, shape=(), dtype=float32)
loss: tf.Tensor(0.6737397, shape=(), dtype=float32)
loss: tf.Tensor(0.8707971, shape=(), dtype=float32)
loss: tf.Tensor(0.8891084, shape=(), dtype=float32)
loss: tf.Tensor(0.8107848, shape=(), dtype=float32)
loss: tf.Tensor(0.84506667, shape=(), dtype=float32)
loss: tf.Tensor(0.7502633, shape=(), dtype=float32)
loss: tf.Tensor(0.82172203, shape=(), dtype=float32)
loss: tf.Tensor(0.8687114, shape=(), dtype=float32)
loss: tf.Tensor(0.8469153, shape=(), dtype=float32)
loss: tf.Tensor(0.80931, shape=(), dtype=float32)
loss: tf.Tensor(0.7790748, shape=(), dtype=float32)
loss: tf.Tensor(0.82237923, shape=(), dtype=float32)
loss: tf.Tensor(0.84499556, shape=(), dtype=float32)
loss: tf.Tensor(0.94664556, shape=(), dtype=float32)
loss: tf.Tensor(0.77339965, shape=(), dtype=float32)
loss: tf.Tensor(0.7811298, shape=(), dtype=float32)
loss: tf.Tensor(0.694371, shape=(), dtype=float32)
loss: tf.Tensor(0.85480535, shape=(), dtype=float32)
loss: tf.Tensor(0.80041176, shape=(), dtype=float32)
loss: tf.Tensor(0.9011123, shape=(), dtype=float32)
loss: tf.Tensor(0.8320312, shape=(), dtype=float32)
loss: tf.Tensor(0.8303154, shape=(), dtype=float32)
loss: tf.Tensor(0.7585066, shape=(), dtype=float32)
loss: tf.Tensor(0.75509965, shape=(), dtype=float32)
loss: tf.Tensor(0.7375764, shape=(), dtype=float32)
loss: tf.Tensor(0.6362557, shape=(), dtype=float32)
loss: tf.Tensor(0.76373774, shape=(), dtype=float32)
loss: tf.Tensor(0.6829242, shape=(), dtype=float32)
loss: tf.Tensor(0.84700584, shape=(), dtype=float32)
loss: tf.Tensor(0.7955066, shape=(), dtype=float32)
loss: tf.Tensor(0.9488728, shape=(), dtype=float32)
loss: tf.Tensor(0.7385266, shape=(), dtype=float32)
loss: tf.Tensor(0.74282944, shape=(), dtype=float32)
loss: tf.Tensor(0.8467431, shape=(), dtype=float32)
loss: tf.Tensor(0.6901125, shape=(), dtype=float32)
loss: tf.Tensor(0.7542723, shape=(), dtype=float32)
loss: tf.Tensor(0.72608775, shape=(), dtype=float32)
loss: tf.Tensor(0.7230734, shape=(), dtype=float32)
loss: tf.Tensor(0.76029116, shape=(), dtype=float32)
loss: tf.Tensor(0.8160702, shape=(), dtype=float32)
loss: tf.Tensor(0.67898643, shape=(), dtype=float32)
loss: tf.Tensor(0.7405891, shape=(), dtype=float32)
loss: tf.Tensor(0.8987204, shape=(), dtype=float32)
loss: tf.Tensor(0.7290227, shape=(), dtype=float32)
loss: tf.Tensor(0.6948765, shape=(), dtype=float32)
loss: tf.Tensor(0.7374372, shape=(), dtype=float32)
loss: tf.Tensor(0.7481209, shape=(), dtype=float32)
loss: tf.Tensor(0.6572532, shape=(), dtype=float32)
loss: tf.Tensor(0.6161024, shape=(), dtype=float32)
loss: tf.Tensor(0.6506113, shape=(), dtype=float32)
loss: tf.Tensor(0.7623419, shape=(), dtype=float32)
loss: tf.Tensor(0.7299551, shape=(), dtype=float32)
loss: tf.Tensor(0.55463743, shape=(), dtype=float32)
loss: tf.Tensor(0.8198503, shape=(), dtype=float32)
loss: tf.Tensor(0.7886505, shape=(), dtype=float32)
loss: tf.Tensor(0.94633937, shape=(), dtype=float32)
loss: tf.Tensor(0.82749075, shape=(), dtype=float32)
loss: tf.Tensor(1.9490659, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(1.0071735, shape=(), dtype=float32)
F1 SCORE:
0.41595408
EPOCH  36 #################################
loss: tf.Tensor(0.8108532, shape=(), dtype=float32)
loss: tf.Tensor(0.936081, shape=(), dtype=float32)
loss: tf.Tensor(0.83663446, shape=(), dtype=float32)
loss: tf.Tensor(0.89355576, shape=(), dtype=float32)
loss: tf.Tensor(0.8651534, shape=(), dtype=float32)
loss: tf.Tensor(0.89007115, shape=(), dtype=float32)
loss: tf.Tensor(0.8841799, shape=(), dtype=float32)
loss: tf.Tensor(0.8809788, shape=(), dtype=float32)
loss: tf.Tensor(0.86344427, shape=(), dtype=float32)
loss: tf.Tensor(0.95853347, shape=(), dtype=float32)
loss: tf.Tensor(0.87363046, shape=(), dtype=float32)
loss: tf.Tensor(0.97697455, shape=(), dtype=float32)
loss: tf.Tensor(0.82622427, shape=(), dtype=float32)
loss: tf.Tensor(0.88749796, shape=(), dtype=float32)
loss: tf.Tensor(0.9648557, shape=(), dtype=float32)
loss: tf.Tensor(0.9440646, shape=(), dtype=float32)
loss: tf.Tensor(0.85583746, shape=(), dtype=float32)
loss: tf.Tensor(1.0516598, shape=(), dtype=float32)
loss: tf.Tensor(0.874625, shape=(), dtype=float32)
loss: tf.Tensor(0.77739805, shape=(), dtype=float32)
loss: tf.Tensor(0.85790443, shape=(), dtype=float32)
loss: tf.Tensor(1.0109597, shape=(), dtype=float32)
loss: tf.Tensor(0.88623846, shape=(), dtype=float32)
loss: tf.Tensor(0.8329674, shape=(), dtype=float32)
loss: tf.Tensor(0.8237495, shape=(), dtype=float32)
loss: tf.Tensor(0.9059522, shape=(), dtype=float32)
loss: tf.Tensor(0.82972336, shape=(), dtype=float32)
loss: tf.Tensor(0.90940356, shape=(), dtype=float32)
loss: tf.Tensor(0.8295068, shape=(), dtype=float32)
loss: tf.Tensor(0.8388396, shape=(), dtype=float32)
loss: tf.Tensor(0.787393, shape=(), dtype=float32)
loss: tf.Tensor(0.7862157, shape=(), dtype=float32)
loss: tf.Tensor(0.8320383, shape=(), dtype=float32)
loss: tf.Tensor(0.84117883, shape=(), dtype=float32)
loss: tf.Tensor(0.8560196, shape=(), dtype=float32)
loss: tf.Tensor(0.83480066, shape=(), dtype=float32)
loss: tf.Tensor(0.9835627, shape=(), dtype=float32)
loss: tf.Tensor(0.87599874, shape=(), dtype=float32)
loss: tf.Tensor(0.80983615, shape=(), dtype=float32)
loss: tf.Tensor(0.8799431, shape=(), dtype=float32)
loss: tf.Tensor(0.8867986, shape=(), dtype=float32)
loss: tf.Tensor(0.8418777, shape=(), dtype=float32)
loss: tf.Tensor(0.80467093, shape=(), dtype=float32)
loss: tf.Tensor(0.84896207, shape=(), dtype=float32)
loss: tf.Tensor(0.809269, shape=(), dtype=float32)
loss: tf.Tensor(0.76511335, shape=(), dtype=float32)
loss: tf.Tensor(0.87836534, shape=(), dtype=float32)
loss: tf.Tensor(0.85075307, shape=(), dtype=float32)
loss: tf.Tensor(0.87434494, shape=(), dtype=float32)
loss: tf.Tensor(0.91438943, shape=(), dtype=float32)
loss: tf.Tensor(0.796121, shape=(), dtype=float32)
loss: tf.Tensor(0.82125145, shape=(), dtype=float32)
loss: tf.Tensor(0.85811114, shape=(), dtype=float32)
loss: tf.Tensor(0.7522219, shape=(), dtype=float32)
loss: tf.Tensor(0.7858933, shape=(), dtype=float32)
loss: tf.Tensor(0.88020533, shape=(), dtype=float32)
loss: tf.Tensor(0.76474655, shape=(), dtype=float32)
loss: tf.Tensor(0.7555093, shape=(), dtype=float32)
loss: tf.Tensor(0.9064645, shape=(), dtype=float32)
loss: tf.Tensor(0.7843397, shape=(), dtype=float32)
loss: tf.Tensor(0.8054957, shape=(), dtype=float32)
loss: tf.Tensor(0.8087618, shape=(), dtype=float32)
loss: tf.Tensor(0.7231308, shape=(), dtype=float32)
loss: tf.Tensor(0.68781084, shape=(), dtype=float32)
loss: tf.Tensor(0.72180265, shape=(), dtype=float32)
loss: tf.Tensor(0.7649401, shape=(), dtype=float32)
loss: tf.Tensor(0.8581327, shape=(), dtype=float32)
loss: tf.Tensor(0.7880982, shape=(), dtype=float32)
loss: tf.Tensor(0.8323672, shape=(), dtype=float32)
loss: tf.Tensor(0.85689455, shape=(), dtype=float32)
loss: tf.Tensor(0.81493676, shape=(), dtype=float32)
loss: tf.Tensor(0.7844502, shape=(), dtype=float32)
loss: tf.Tensor(0.8598382, shape=(), dtype=float32)
loss: tf.Tensor(0.06641302, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9631846, shape=(), dtype=float32)
F1 SCORE:
0.41596362
EPOCH  37 #################################
loss: tf.Tensor(0.8472397, shape=(), dtype=float32)
loss: tf.Tensor(0.8239819, shape=(), dtype=float32)
loss: tf.Tensor(0.92250896, shape=(), dtype=float32)
loss: tf.Tensor(0.74434084, shape=(), dtype=float32)
loss: tf.Tensor(0.81592363, shape=(), dtype=float32)
loss: tf.Tensor(0.8595673, shape=(), dtype=float32)
loss: tf.Tensor(0.8327706, shape=(), dtype=float32)
loss: tf.Tensor(0.7239931, shape=(), dtype=float32)
loss: tf.Tensor(0.7659163, shape=(), dtype=float32)
loss: tf.Tensor(0.7870581, shape=(), dtype=float32)
loss: tf.Tensor(0.8656921, shape=(), dtype=float32)
loss: tf.Tensor(0.7550896, shape=(), dtype=float32)
loss: tf.Tensor(0.7637511, shape=(), dtype=float32)
loss: tf.Tensor(0.834998, shape=(), dtype=float32)
loss: tf.Tensor(0.74002457, shape=(), dtype=float32)
loss: tf.Tensor(0.8281267, shape=(), dtype=float32)
loss: tf.Tensor(0.87105584, shape=(), dtype=float32)
loss: tf.Tensor(0.83330184, shape=(), dtype=float32)
loss: tf.Tensor(0.79722893, shape=(), dtype=float32)
loss: tf.Tensor(0.7451802, shape=(), dtype=float32)
loss: tf.Tensor(0.8711183, shape=(), dtype=float32)
loss: tf.Tensor(0.85020393, shape=(), dtype=float32)
loss: tf.Tensor(0.813451, shape=(), dtype=float32)
loss: tf.Tensor(0.762574, shape=(), dtype=float32)
loss: tf.Tensor(0.83629507, shape=(), dtype=float32)
loss: tf.Tensor(0.74954826, shape=(), dtype=float32)
loss: tf.Tensor(0.7814019, shape=(), dtype=float32)
loss: tf.Tensor(0.85938543, shape=(), dtype=float32)
loss: tf.Tensor(0.64940184, shape=(), dtype=float32)
loss: tf.Tensor(0.8144169, shape=(), dtype=float32)
loss: tf.Tensor(0.76616377, shape=(), dtype=float32)
loss: tf.Tensor(0.8128641, shape=(), dtype=float32)
loss: tf.Tensor(0.7398763, shape=(), dtype=float32)
loss: tf.Tensor(0.96322525, shape=(), dtype=float32)
loss: tf.Tensor(0.74190575, shape=(), dtype=float32)
loss: tf.Tensor(0.78671175, shape=(), dtype=float32)
loss: tf.Tensor(0.66454935, shape=(), dtype=float32)
loss: tf.Tensor(0.828121, shape=(), dtype=float32)
loss: tf.Tensor(0.81367755, shape=(), dtype=float32)
loss: tf.Tensor(0.82032466, shape=(), dtype=float32)
loss: tf.Tensor(0.86597794, shape=(), dtype=float32)
loss: tf.Tensor(0.8357535, shape=(), dtype=float32)
loss: tf.Tensor(0.75918937, shape=(), dtype=float32)
loss: tf.Tensor(0.7597668, shape=(), dtype=float32)
loss: tf.Tensor(0.73388267, shape=(), dtype=float32)
loss: tf.Tensor(0.908363, shape=(), dtype=float32)
loss: tf.Tensor(0.7883415, shape=(), dtype=float32)
loss: tf.Tensor(0.8058194, shape=(), dtype=float32)
loss: tf.Tensor(0.7118999, shape=(), dtype=float32)
loss: tf.Tensor(0.827335, shape=(), dtype=float32)
loss: tf.Tensor(0.69195366, shape=(), dtype=float32)
loss: tf.Tensor(0.85900253, shape=(), dtype=float32)
loss: tf.Tensor(0.7702711, shape=(), dtype=float32)
loss: tf.Tensor(0.76744103, shape=(), dtype=float32)
loss: tf.Tensor(0.8587388, shape=(), dtype=float32)
loss: tf.Tensor(0.6863747, shape=(), dtype=float32)
loss: tf.Tensor(0.8189308, shape=(), dtype=float32)
loss: tf.Tensor(0.8569433, shape=(), dtype=float32)
loss: tf.Tensor(0.735197, shape=(), dtype=float32)
loss: tf.Tensor(0.67179924, shape=(), dtype=float32)
loss: tf.Tensor(0.65833724, shape=(), dtype=float32)
loss: tf.Tensor(0.8452404, shape=(), dtype=float32)
loss: tf.Tensor(0.65402246, shape=(), dtype=float32)
loss: tf.Tensor(0.8747468, shape=(), dtype=float32)
loss: tf.Tensor(0.7396315, shape=(), dtype=float32)
loss: tf.Tensor(0.73945373, shape=(), dtype=float32)
loss: tf.Tensor(0.8399589, shape=(), dtype=float32)
loss: tf.Tensor(0.705268, shape=(), dtype=float32)
loss: tf.Tensor(0.7738006, shape=(), dtype=float32)
loss: tf.Tensor(0.72889924, shape=(), dtype=float32)
loss: tf.Tensor(0.84433264, shape=(), dtype=float32)
loss: tf.Tensor(0.79822576, shape=(), dtype=float32)
loss: tf.Tensor(0.7907212, shape=(), dtype=float32)
loss: tf.Tensor(0.7626397, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9509726, shape=(), dtype=float32)
F1 SCORE:
0.41545793
EPOCH  38 #################################
loss: tf.Tensor(0.8418997, shape=(), dtype=float32)
loss: tf.Tensor(0.8236471, shape=(), dtype=float32)
loss: tf.Tensor(0.7054154, shape=(), dtype=float32)
loss: tf.Tensor(1.0033244, shape=(), dtype=float32)
loss: tf.Tensor(0.8486728, shape=(), dtype=float32)
loss: tf.Tensor(0.87148494, shape=(), dtype=float32)
loss: tf.Tensor(0.79720694, shape=(), dtype=float32)
loss: tf.Tensor(0.79479784, shape=(), dtype=float32)
loss: tf.Tensor(0.8364166, shape=(), dtype=float32)
loss: tf.Tensor(0.82781184, shape=(), dtype=float32)
loss: tf.Tensor(0.7656898, shape=(), dtype=float32)
loss: tf.Tensor(0.89077705, shape=(), dtype=float32)
loss: tf.Tensor(0.8532131, shape=(), dtype=float32)
loss: tf.Tensor(0.79223686, shape=(), dtype=float32)
loss: tf.Tensor(0.8176275, shape=(), dtype=float32)
loss: tf.Tensor(0.83512044, shape=(), dtype=float32)
loss: tf.Tensor(0.82026374, shape=(), dtype=float32)
loss: tf.Tensor(0.8317209, shape=(), dtype=float32)
loss: tf.Tensor(0.76229566, shape=(), dtype=float32)
loss: tf.Tensor(0.8315654, shape=(), dtype=float32)
loss: tf.Tensor(0.9133799, shape=(), dtype=float32)
loss: tf.Tensor(0.85844934, shape=(), dtype=float32)
loss: tf.Tensor(0.81298876, shape=(), dtype=float32)
loss: tf.Tensor(0.76547503, shape=(), dtype=float32)
loss: tf.Tensor(0.79895896, shape=(), dtype=float32)
loss: tf.Tensor(0.80758595, shape=(), dtype=float32)
loss: tf.Tensor(0.6931638, shape=(), dtype=float32)
loss: tf.Tensor(0.8223341, shape=(), dtype=float32)
loss: tf.Tensor(0.7122291, shape=(), dtype=float32)
loss: tf.Tensor(0.7479706, shape=(), dtype=float32)
loss: tf.Tensor(0.76028204, shape=(), dtype=float32)
loss: tf.Tensor(0.94333786, shape=(), dtype=float32)
loss: tf.Tensor(0.73352677, shape=(), dtype=float32)
loss: tf.Tensor(0.8315152, shape=(), dtype=float32)
loss: tf.Tensor(0.754114, shape=(), dtype=float32)
loss: tf.Tensor(0.81602883, shape=(), dtype=float32)
loss: tf.Tensor(0.7083641, shape=(), dtype=float32)
loss: tf.Tensor(0.74088216, shape=(), dtype=float32)
loss: tf.Tensor(0.7320241, shape=(), dtype=float32)
loss: tf.Tensor(0.80395544, shape=(), dtype=float32)
loss: tf.Tensor(0.73712265, shape=(), dtype=float32)
loss: tf.Tensor(0.7314422, shape=(), dtype=float32)
loss: tf.Tensor(0.7848201, shape=(), dtype=float32)
loss: tf.Tensor(0.8152149, shape=(), dtype=float32)
loss: tf.Tensor(0.87017983, shape=(), dtype=float32)
loss: tf.Tensor(0.8564903, shape=(), dtype=float32)
loss: tf.Tensor(0.81866074, shape=(), dtype=float32)
loss: tf.Tensor(0.7004245, shape=(), dtype=float32)
loss: tf.Tensor(0.7868052, shape=(), dtype=float32)
loss: tf.Tensor(0.95641273, shape=(), dtype=float32)
loss: tf.Tensor(0.7844862, shape=(), dtype=float32)
loss: tf.Tensor(0.7777121, shape=(), dtype=float32)
loss: tf.Tensor(0.8504866, shape=(), dtype=float32)
loss: tf.Tensor(0.7670901, shape=(), dtype=float32)
loss: tf.Tensor(0.71174294, shape=(), dtype=float32)
loss: tf.Tensor(0.7657552, shape=(), dtype=float32)
loss: tf.Tensor(0.7739873, shape=(), dtype=float32)
loss: tf.Tensor(0.7223368, shape=(), dtype=float32)
loss: tf.Tensor(0.80281466, shape=(), dtype=float32)
loss: tf.Tensor(0.7541055, shape=(), dtype=float32)
loss: tf.Tensor(0.84016746, shape=(), dtype=float32)
loss: tf.Tensor(0.69739133, shape=(), dtype=float32)
loss: tf.Tensor(0.74231523, shape=(), dtype=float32)
loss: tf.Tensor(0.6850663, shape=(), dtype=float32)
loss: tf.Tensor(0.7784378, shape=(), dtype=float32)
loss: tf.Tensor(0.7862795, shape=(), dtype=float32)
loss: tf.Tensor(0.7971542, shape=(), dtype=float32)
loss: tf.Tensor(0.79952276, shape=(), dtype=float32)
loss: tf.Tensor(0.7017651, shape=(), dtype=float32)
loss: tf.Tensor(0.8100951, shape=(), dtype=float32)
loss: tf.Tensor(0.81568724, shape=(), dtype=float32)
loss: tf.Tensor(0.75664216, shape=(), dtype=float32)
loss: tf.Tensor(0.82839835, shape=(), dtype=float32)
loss: tf.Tensor(0.728625, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9490211, shape=(), dtype=float32)
F1 SCORE:
0.41543606
EPOCH  39 #################################
loss: tf.Tensor(0.83241004, shape=(), dtype=float32)
loss: tf.Tensor(0.81254303, shape=(), dtype=float32)
loss: tf.Tensor(0.67735237, shape=(), dtype=float32)
loss: tf.Tensor(0.7055361, shape=(), dtype=float32)
loss: tf.Tensor(0.7324526, shape=(), dtype=float32)
loss: tf.Tensor(0.87637377, shape=(), dtype=float32)
loss: tf.Tensor(0.9483964, shape=(), dtype=float32)
loss: tf.Tensor(0.76905763, shape=(), dtype=float32)
loss: tf.Tensor(0.78959745, shape=(), dtype=float32)
loss: tf.Tensor(0.7512355, shape=(), dtype=float32)
loss: tf.Tensor(0.66147226, shape=(), dtype=float32)
loss: tf.Tensor(0.75709563, shape=(), dtype=float32)
loss: tf.Tensor(0.81828547, shape=(), dtype=float32)
loss: tf.Tensor(0.8378264, shape=(), dtype=float32)
loss: tf.Tensor(0.8655741, shape=(), dtype=float32)
loss: tf.Tensor(0.8445255, shape=(), dtype=float32)
loss: tf.Tensor(0.70821077, shape=(), dtype=float32)
loss: tf.Tensor(0.81323236, shape=(), dtype=float32)
loss: tf.Tensor(0.8536796, shape=(), dtype=float32)
loss: tf.Tensor(0.72039366, shape=(), dtype=float32)
loss: tf.Tensor(0.7109046, shape=(), dtype=float32)
loss: tf.Tensor(0.69361585, shape=(), dtype=float32)
loss: tf.Tensor(0.6948053, shape=(), dtype=float32)
loss: tf.Tensor(0.7494404, shape=(), dtype=float32)
loss: tf.Tensor(0.72322875, shape=(), dtype=float32)
loss: tf.Tensor(0.7628505, shape=(), dtype=float32)
loss: tf.Tensor(0.8226634, shape=(), dtype=float32)
loss: tf.Tensor(0.6255478, shape=(), dtype=float32)
loss: tf.Tensor(0.7712366, shape=(), dtype=float32)
loss: tf.Tensor(0.6872749, shape=(), dtype=float32)
loss: tf.Tensor(0.75143206, shape=(), dtype=float32)
loss: tf.Tensor(0.82813704, shape=(), dtype=float32)
loss: tf.Tensor(0.7383204, shape=(), dtype=float32)
loss: tf.Tensor(0.69765806, shape=(), dtype=float32)
loss: tf.Tensor(0.7530938, shape=(), dtype=float32)
loss: tf.Tensor(0.76328254, shape=(), dtype=float32)
loss: tf.Tensor(0.6536998, shape=(), dtype=float32)
loss: tf.Tensor(0.85733163, shape=(), dtype=float32)
loss: tf.Tensor(0.74328065, shape=(), dtype=float32)
loss: tf.Tensor(0.7965401, shape=(), dtype=float32)
loss: tf.Tensor(0.6317183, shape=(), dtype=float32)
loss: tf.Tensor(0.7890083, shape=(), dtype=float32)
loss: tf.Tensor(0.8717458, shape=(), dtype=float32)
loss: tf.Tensor(0.71718466, shape=(), dtype=float32)
loss: tf.Tensor(0.7028364, shape=(), dtype=float32)
loss: tf.Tensor(0.78771806, shape=(), dtype=float32)
loss: tf.Tensor(0.7903068, shape=(), dtype=float32)
loss: tf.Tensor(0.8580534, shape=(), dtype=float32)
loss: tf.Tensor(0.729069, shape=(), dtype=float32)
loss: tf.Tensor(0.8318372, shape=(), dtype=float32)
loss: tf.Tensor(0.80206186, shape=(), dtype=float32)
loss: tf.Tensor(0.68621963, shape=(), dtype=float32)
loss: tf.Tensor(0.67826897, shape=(), dtype=float32)
loss: tf.Tensor(0.65366197, shape=(), dtype=float32)
loss: tf.Tensor(0.64819056, shape=(), dtype=float32)
loss: tf.Tensor(0.79112345, shape=(), dtype=float32)
loss: tf.Tensor(0.771285, shape=(), dtype=float32)
loss: tf.Tensor(0.7849043, shape=(), dtype=float32)
loss: tf.Tensor(0.74221796, shape=(), dtype=float32)
loss: tf.Tensor(0.8143818, shape=(), dtype=float32)
loss: tf.Tensor(0.7902256, shape=(), dtype=float32)
loss: tf.Tensor(0.7463385, shape=(), dtype=float32)
loss: tf.Tensor(0.84316844, shape=(), dtype=float32)
loss: tf.Tensor(0.7451025, shape=(), dtype=float32)
loss: tf.Tensor(0.72857475, shape=(), dtype=float32)
loss: tf.Tensor(0.7055191, shape=(), dtype=float32)
loss: tf.Tensor(0.65210617, shape=(), dtype=float32)
loss: tf.Tensor(0.75469, shape=(), dtype=float32)
loss: tf.Tensor(0.85729086, shape=(), dtype=float32)
loss: tf.Tensor(0.78980684, shape=(), dtype=float32)
loss: tf.Tensor(0.68409944, shape=(), dtype=float32)
loss: tf.Tensor(0.8841856, shape=(), dtype=float32)
loss: tf.Tensor(0.7634128, shape=(), dtype=float32)
loss: tf.Tensor(0.05455794, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9671159, shape=(), dtype=float32)
F1 SCORE:
0.41580737
EPOCH  40 #################################
loss: tf.Tensor(0.8507399, shape=(), dtype=float32)
loss: tf.Tensor(0.6960109, shape=(), dtype=float32)
loss: tf.Tensor(0.7935696, shape=(), dtype=float32)
loss: tf.Tensor(0.8394328, shape=(), dtype=float32)
loss: tf.Tensor(0.7984965, shape=(), dtype=float32)
loss: tf.Tensor(0.79062355, shape=(), dtype=float32)
loss: tf.Tensor(0.570383, shape=(), dtype=float32)
loss: tf.Tensor(0.62520564, shape=(), dtype=float32)
loss: tf.Tensor(0.7776709, shape=(), dtype=float32)
loss: tf.Tensor(0.7404802, shape=(), dtype=float32)
loss: tf.Tensor(0.5693807, shape=(), dtype=float32)
loss: tf.Tensor(0.90048295, shape=(), dtype=float32)
loss: tf.Tensor(0.56209344, shape=(), dtype=float32)
loss: tf.Tensor(0.79218096, shape=(), dtype=float32)
loss: tf.Tensor(0.75118303, shape=(), dtype=float32)
loss: tf.Tensor(0.8074722, shape=(), dtype=float32)
loss: tf.Tensor(0.6752777, shape=(), dtype=float32)
loss: tf.Tensor(0.7333357, shape=(), dtype=float32)
loss: tf.Tensor(0.7174304, shape=(), dtype=float32)
loss: tf.Tensor(0.70599496, shape=(), dtype=float32)
loss: tf.Tensor(0.84178907, shape=(), dtype=float32)
loss: tf.Tensor(0.73922396, shape=(), dtype=float32)
loss: tf.Tensor(0.6988026, shape=(), dtype=float32)
loss: tf.Tensor(0.70680267, shape=(), dtype=float32)
loss: tf.Tensor(0.6789418, shape=(), dtype=float32)
loss: tf.Tensor(0.75312394, shape=(), dtype=float32)
loss: tf.Tensor(0.99219805, shape=(), dtype=float32)
loss: tf.Tensor(0.73373985, shape=(), dtype=float32)
loss: tf.Tensor(0.6974844, shape=(), dtype=float32)
loss: tf.Tensor(0.7679365, shape=(), dtype=float32)
loss: tf.Tensor(0.6632999, shape=(), dtype=float32)
loss: tf.Tensor(0.7258845, shape=(), dtype=float32)
loss: tf.Tensor(0.7953821, shape=(), dtype=float32)
loss: tf.Tensor(0.745033, shape=(), dtype=float32)
loss: tf.Tensor(0.73649156, shape=(), dtype=float32)
loss: tf.Tensor(0.75419444, shape=(), dtype=float32)
loss: tf.Tensor(0.7669849, shape=(), dtype=float32)
loss: tf.Tensor(0.7404487, shape=(), dtype=float32)
loss: tf.Tensor(0.8266046, shape=(), dtype=float32)
loss: tf.Tensor(0.65508354, shape=(), dtype=float32)
loss: tf.Tensor(0.7671501, shape=(), dtype=float32)
loss: tf.Tensor(0.607141, shape=(), dtype=float32)
loss: tf.Tensor(0.7151325, shape=(), dtype=float32)
loss: tf.Tensor(0.6557776, shape=(), dtype=float32)
loss: tf.Tensor(0.7148266, shape=(), dtype=float32)
loss: tf.Tensor(0.6759354, shape=(), dtype=float32)
loss: tf.Tensor(0.64590144, shape=(), dtype=float32)
loss: tf.Tensor(0.73381394, shape=(), dtype=float32)
loss: tf.Tensor(0.6949975, shape=(), dtype=float32)
loss: tf.Tensor(0.799557, shape=(), dtype=float32)
loss: tf.Tensor(0.79150945, shape=(), dtype=float32)
loss: tf.Tensor(0.78059906, shape=(), dtype=float32)
loss: tf.Tensor(0.76268137, shape=(), dtype=float32)
loss: tf.Tensor(0.7735569, shape=(), dtype=float32)
loss: tf.Tensor(0.7334071, shape=(), dtype=float32)
loss: tf.Tensor(0.72145545, shape=(), dtype=float32)
loss: tf.Tensor(0.6509043, shape=(), dtype=float32)
loss: tf.Tensor(0.8186679, shape=(), dtype=float32)
loss: tf.Tensor(0.7217279, shape=(), dtype=float32)
loss: tf.Tensor(0.8351633, shape=(), dtype=float32)
loss: tf.Tensor(0.7825868, shape=(), dtype=float32)
loss: tf.Tensor(0.7468645, shape=(), dtype=float32)
loss: tf.Tensor(0.7872401, shape=(), dtype=float32)
loss: tf.Tensor(0.74256325, shape=(), dtype=float32)
loss: tf.Tensor(0.7604375, shape=(), dtype=float32)
loss: tf.Tensor(0.75376, shape=(), dtype=float32)
loss: tf.Tensor(0.7093929, shape=(), dtype=float32)
loss: tf.Tensor(0.6590245, shape=(), dtype=float32)
loss: tf.Tensor(0.7054269, shape=(), dtype=float32)
loss: tf.Tensor(0.93998474, shape=(), dtype=float32)
loss: tf.Tensor(0.6551704, shape=(), dtype=float32)
loss: tf.Tensor(0.7107508, shape=(), dtype=float32)
loss: tf.Tensor(0.6535991, shape=(), dtype=float32)
loss: tf.Tensor(1.4583411, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(1.0221226, shape=(), dtype=float32)
F1 SCORE:
0.41644248
EPOCH  41 #################################
loss: tf.Tensor(0.84651977, shape=(), dtype=float32)
loss: tf.Tensor(1.2240624, shape=(), dtype=float32)
loss: tf.Tensor(1.1304988, shape=(), dtype=float32)
loss: tf.Tensor(0.8907934, shape=(), dtype=float32)
loss: tf.Tensor(0.8521911, shape=(), dtype=float32)
loss: tf.Tensor(0.9015462, shape=(), dtype=float32)
loss: tf.Tensor(0.8993298, shape=(), dtype=float32)
loss: tf.Tensor(0.8535884, shape=(), dtype=float32)
loss: tf.Tensor(0.88417006, shape=(), dtype=float32)
loss: tf.Tensor(1.0470561, shape=(), dtype=float32)
loss: tf.Tensor(0.95029473, shape=(), dtype=float32)
loss: tf.Tensor(0.890157, shape=(), dtype=float32)
loss: tf.Tensor(0.9290734, shape=(), dtype=float32)
loss: tf.Tensor(0.91986054, shape=(), dtype=float32)
loss: tf.Tensor(0.8908068, shape=(), dtype=float32)
loss: tf.Tensor(0.928114, shape=(), dtype=float32)
loss: tf.Tensor(0.93181175, shape=(), dtype=float32)
loss: tf.Tensor(0.9466188, shape=(), dtype=float32)
loss: tf.Tensor(0.9184721, shape=(), dtype=float32)
loss: tf.Tensor(0.9528288, shape=(), dtype=float32)
loss: tf.Tensor(0.99345016, shape=(), dtype=float32)
loss: tf.Tensor(0.88337535, shape=(), dtype=float32)
loss: tf.Tensor(0.9157946, shape=(), dtype=float32)
loss: tf.Tensor(0.9145688, shape=(), dtype=float32)
loss: tf.Tensor(0.8464641, shape=(), dtype=float32)
loss: tf.Tensor(0.84359545, shape=(), dtype=float32)
loss: tf.Tensor(0.9420938, shape=(), dtype=float32)
loss: tf.Tensor(0.8069058, shape=(), dtype=float32)
loss: tf.Tensor(0.7821383, shape=(), dtype=float32)
loss: tf.Tensor(0.8930683, shape=(), dtype=float32)
loss: tf.Tensor(0.8392949, shape=(), dtype=float32)
loss: tf.Tensor(0.9502041, shape=(), dtype=float32)
loss: tf.Tensor(1.0243593, shape=(), dtype=float32)
loss: tf.Tensor(0.82270586, shape=(), dtype=float32)
loss: tf.Tensor(0.83043325, shape=(), dtype=float32)
loss: tf.Tensor(0.8199661, shape=(), dtype=float32)
loss: tf.Tensor(0.82297987, shape=(), dtype=float32)
loss: tf.Tensor(0.8851105, shape=(), dtype=float32)
loss: tf.Tensor(0.9560042, shape=(), dtype=float32)
loss: tf.Tensor(0.90540993, shape=(), dtype=float32)
loss: tf.Tensor(0.8319053, shape=(), dtype=float32)
loss: tf.Tensor(0.8096842, shape=(), dtype=float32)
loss: tf.Tensor(0.88566595, shape=(), dtype=float32)
loss: tf.Tensor(0.8511383, shape=(), dtype=float32)
loss: tf.Tensor(0.9566378, shape=(), dtype=float32)
loss: tf.Tensor(0.9098291, shape=(), dtype=float32)
loss: tf.Tensor(0.81293696, shape=(), dtype=float32)
loss: tf.Tensor(0.925697, shape=(), dtype=float32)
loss: tf.Tensor(0.88313, shape=(), dtype=float32)
loss: tf.Tensor(0.9027988, shape=(), dtype=float32)
loss: tf.Tensor(0.9429996, shape=(), dtype=float32)
loss: tf.Tensor(0.79007745, shape=(), dtype=float32)
loss: tf.Tensor(0.88623565, shape=(), dtype=float32)
loss: tf.Tensor(0.9559656, shape=(), dtype=float32)
loss: tf.Tensor(0.8824847, shape=(), dtype=float32)
loss: tf.Tensor(0.887013, shape=(), dtype=float32)
loss: tf.Tensor(0.7981763, shape=(), dtype=float32)
loss: tf.Tensor(0.90576607, shape=(), dtype=float32)
loss: tf.Tensor(0.9787743, shape=(), dtype=float32)
loss: tf.Tensor(0.7757249, shape=(), dtype=float32)
loss: tf.Tensor(0.89561266, shape=(), dtype=float32)
loss: tf.Tensor(0.7305987, shape=(), dtype=float32)
loss: tf.Tensor(0.8644809, shape=(), dtype=float32)
loss: tf.Tensor(0.8979092, shape=(), dtype=float32)
loss: tf.Tensor(0.8916052, shape=(), dtype=float32)
loss: tf.Tensor(0.9917221, shape=(), dtype=float32)
loss: tf.Tensor(0.9565117, shape=(), dtype=float32)
loss: tf.Tensor(0.94691247, shape=(), dtype=float32)
loss: tf.Tensor(0.8314703, shape=(), dtype=float32)
loss: tf.Tensor(0.7870083, shape=(), dtype=float32)
loss: tf.Tensor(0.86611825, shape=(), dtype=float32)
loss: tf.Tensor(0.857266, shape=(), dtype=float32)
loss: tf.Tensor(0.7780087, shape=(), dtype=float32)
loss: tf.Tensor(0.7058921, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.98318547, shape=(), dtype=float32)
F1 SCORE:
0.41355634
EPOCH  42 #################################
loss: tf.Tensor(0.84044623, shape=(), dtype=float32)
loss: tf.Tensor(0.9591188, shape=(), dtype=float32)
loss: tf.Tensor(0.9843627, shape=(), dtype=float32)
loss: tf.Tensor(0.80010843, shape=(), dtype=float32)
loss: tf.Tensor(0.82646894, shape=(), dtype=float32)
loss: tf.Tensor(0.8171975, shape=(), dtype=float32)
loss: tf.Tensor(0.92164147, shape=(), dtype=float32)
loss: tf.Tensor(0.90438735, shape=(), dtype=float32)
loss: tf.Tensor(0.85849816, shape=(), dtype=float32)
loss: tf.Tensor(0.7833227, shape=(), dtype=float32)
loss: tf.Tensor(0.81554914, shape=(), dtype=float32)
loss: tf.Tensor(0.8719148, shape=(), dtype=float32)
loss: tf.Tensor(0.85271364, shape=(), dtype=float32)
loss: tf.Tensor(0.9137203, shape=(), dtype=float32)
loss: tf.Tensor(0.8189631, shape=(), dtype=float32)
loss: tf.Tensor(0.74750763, shape=(), dtype=float32)
loss: tf.Tensor(0.8811977, shape=(), dtype=float32)
loss: tf.Tensor(0.88264793, shape=(), dtype=float32)
loss: tf.Tensor(0.88463646, shape=(), dtype=float32)
loss: tf.Tensor(0.797526, shape=(), dtype=float32)
loss: tf.Tensor(0.79466593, shape=(), dtype=float32)
loss: tf.Tensor(0.7284216, shape=(), dtype=float32)
loss: tf.Tensor(0.87374175, shape=(), dtype=float32)
loss: tf.Tensor(0.846229, shape=(), dtype=float32)
loss: tf.Tensor(0.7888344, shape=(), dtype=float32)
loss: tf.Tensor(0.84276175, shape=(), dtype=float32)
loss: tf.Tensor(0.85639673, shape=(), dtype=float32)
loss: tf.Tensor(0.88581145, shape=(), dtype=float32)
loss: tf.Tensor(0.81317025, shape=(), dtype=float32)
loss: tf.Tensor(0.871693, shape=(), dtype=float32)
loss: tf.Tensor(0.8174425, shape=(), dtype=float32)
loss: tf.Tensor(0.92677087, shape=(), dtype=float32)
loss: tf.Tensor(0.8944689, shape=(), dtype=float32)
loss: tf.Tensor(0.8628834, shape=(), dtype=float32)
loss: tf.Tensor(0.8358621, shape=(), dtype=float32)
loss: tf.Tensor(0.81906915, shape=(), dtype=float32)
loss: tf.Tensor(0.8145783, shape=(), dtype=float32)
loss: tf.Tensor(0.8427699, shape=(), dtype=float32)
loss: tf.Tensor(0.79703546, shape=(), dtype=float32)
loss: tf.Tensor(0.83086795, shape=(), dtype=float32)
loss: tf.Tensor(0.8785259, shape=(), dtype=float32)
loss: tf.Tensor(0.8319695, shape=(), dtype=float32)
loss: tf.Tensor(0.7392154, shape=(), dtype=float32)
loss: tf.Tensor(0.8791248, shape=(), dtype=float32)
loss: tf.Tensor(0.7714307, shape=(), dtype=float32)
loss: tf.Tensor(0.80047804, shape=(), dtype=float32)
loss: tf.Tensor(0.71531844, shape=(), dtype=float32)
loss: tf.Tensor(0.85730416, shape=(), dtype=float32)
loss: tf.Tensor(0.9518168, shape=(), dtype=float32)
loss: tf.Tensor(0.8102965, shape=(), dtype=float32)
loss: tf.Tensor(0.80703163, shape=(), dtype=float32)
loss: tf.Tensor(0.8785379, shape=(), dtype=float32)
loss: tf.Tensor(0.8946241, shape=(), dtype=float32)
loss: tf.Tensor(0.82285917, shape=(), dtype=float32)
loss: tf.Tensor(0.8515811, shape=(), dtype=float32)
loss: tf.Tensor(0.95646787, shape=(), dtype=float32)
loss: tf.Tensor(0.81870925, shape=(), dtype=float32)
loss: tf.Tensor(0.84795785, shape=(), dtype=float32)
loss: tf.Tensor(0.75095713, shape=(), dtype=float32)
loss: tf.Tensor(0.89923894, shape=(), dtype=float32)
loss: tf.Tensor(0.7573404, shape=(), dtype=float32)
loss: tf.Tensor(0.8899473, shape=(), dtype=float32)
loss: tf.Tensor(0.8551456, shape=(), dtype=float32)
loss: tf.Tensor(0.915159, shape=(), dtype=float32)
loss: tf.Tensor(0.9254445, shape=(), dtype=float32)
loss: tf.Tensor(0.82499695, shape=(), dtype=float32)
loss: tf.Tensor(0.81529266, shape=(), dtype=float32)
loss: tf.Tensor(0.78969216, shape=(), dtype=float32)
loss: tf.Tensor(0.79423785, shape=(), dtype=float32)
loss: tf.Tensor(0.7571521, shape=(), dtype=float32)
loss: tf.Tensor(0.851846, shape=(), dtype=float32)
loss: tf.Tensor(0.75101936, shape=(), dtype=float32)
loss: tf.Tensor(0.7114696, shape=(), dtype=float32)
loss: tf.Tensor(0.1701904, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.96114033, shape=(), dtype=float32)
F1 SCORE:
0.41276634
EPOCH  43 #################################
loss: tf.Tensor(0.8498518, shape=(), dtype=float32)
loss: tf.Tensor(0.9808263, shape=(), dtype=float32)
loss: tf.Tensor(0.9545342, shape=(), dtype=float32)
loss: tf.Tensor(0.7968493, shape=(), dtype=float32)
loss: tf.Tensor(0.7326393, shape=(), dtype=float32)
loss: tf.Tensor(0.7538684, shape=(), dtype=float32)
loss: tf.Tensor(0.7954068, shape=(), dtype=float32)
loss: tf.Tensor(0.7549142, shape=(), dtype=float32)
loss: tf.Tensor(0.82183594, shape=(), dtype=float32)
loss: tf.Tensor(0.8113761, shape=(), dtype=float32)
loss: tf.Tensor(0.7376862, shape=(), dtype=float32)
loss: tf.Tensor(0.7297695, shape=(), dtype=float32)
loss: tf.Tensor(0.8438333, shape=(), dtype=float32)
loss: tf.Tensor(0.79255193, shape=(), dtype=float32)
loss: tf.Tensor(0.73358095, shape=(), dtype=float32)
loss: tf.Tensor(0.8432759, shape=(), dtype=float32)
loss: tf.Tensor(0.74238944, shape=(), dtype=float32)
loss: tf.Tensor(0.8168477, shape=(), dtype=float32)
loss: tf.Tensor(0.89136994, shape=(), dtype=float32)
loss: tf.Tensor(0.8743327, shape=(), dtype=float32)
loss: tf.Tensor(0.7750953, shape=(), dtype=float32)
loss: tf.Tensor(0.7917962, shape=(), dtype=float32)
loss: tf.Tensor(0.7790587, shape=(), dtype=float32)
loss: tf.Tensor(0.8113614, shape=(), dtype=float32)
loss: tf.Tensor(0.83061635, shape=(), dtype=float32)
loss: tf.Tensor(0.87648696, shape=(), dtype=float32)
loss: tf.Tensor(0.8462909, shape=(), dtype=float32)
loss: tf.Tensor(0.68835455, shape=(), dtype=float32)
loss: tf.Tensor(0.78689796, shape=(), dtype=float32)
loss: tf.Tensor(0.69882005, shape=(), dtype=float32)
loss: tf.Tensor(0.85817796, shape=(), dtype=float32)
loss: tf.Tensor(0.7867036, shape=(), dtype=float32)
loss: tf.Tensor(0.8078673, shape=(), dtype=float32)
loss: tf.Tensor(0.75179976, shape=(), dtype=float32)
loss: tf.Tensor(0.7755451, shape=(), dtype=float32)
loss: tf.Tensor(0.7747219, shape=(), dtype=float32)
loss: tf.Tensor(0.7480829, shape=(), dtype=float32)
loss: tf.Tensor(0.6731361, shape=(), dtype=float32)
loss: tf.Tensor(0.80089587, shape=(), dtype=float32)
loss: tf.Tensor(0.7416366, shape=(), dtype=float32)
loss: tf.Tensor(0.77786225, shape=(), dtype=float32)
loss: tf.Tensor(0.72812223, shape=(), dtype=float32)
loss: tf.Tensor(0.76190805, shape=(), dtype=float32)
loss: tf.Tensor(0.85470533, shape=(), dtype=float32)
loss: tf.Tensor(0.8952227, shape=(), dtype=float32)
loss: tf.Tensor(0.8428208, shape=(), dtype=float32)
loss: tf.Tensor(0.84505755, shape=(), dtype=float32)
loss: tf.Tensor(0.8761585, shape=(), dtype=float32)
loss: tf.Tensor(0.93029916, shape=(), dtype=float32)
loss: tf.Tensor(0.82406354, shape=(), dtype=float32)
loss: tf.Tensor(0.8476529, shape=(), dtype=float32)
loss: tf.Tensor(0.79325426, shape=(), dtype=float32)
loss: tf.Tensor(0.690725, shape=(), dtype=float32)
loss: tf.Tensor(0.8358996, shape=(), dtype=float32)
loss: tf.Tensor(0.93213737, shape=(), dtype=float32)
loss: tf.Tensor(0.9306091, shape=(), dtype=float32)
loss: tf.Tensor(0.7306631, shape=(), dtype=float32)
loss: tf.Tensor(0.9008408, shape=(), dtype=float32)
loss: tf.Tensor(0.7480711, shape=(), dtype=float32)
loss: tf.Tensor(0.82226044, shape=(), dtype=float32)
loss: tf.Tensor(0.82468504, shape=(), dtype=float32)
loss: tf.Tensor(0.9280543, shape=(), dtype=float32)
loss: tf.Tensor(0.78863543, shape=(), dtype=float32)
loss: tf.Tensor(0.8196812, shape=(), dtype=float32)
loss: tf.Tensor(0.7549556, shape=(), dtype=float32)
loss: tf.Tensor(0.9524089, shape=(), dtype=float32)
loss: tf.Tensor(0.80478746, shape=(), dtype=float32)
loss: tf.Tensor(0.84614503, shape=(), dtype=float32)
loss: tf.Tensor(0.84410197, shape=(), dtype=float32)
loss: tf.Tensor(0.8924717, shape=(), dtype=float32)
loss: tf.Tensor(0.68921995, shape=(), dtype=float32)
loss: tf.Tensor(0.73671323, shape=(), dtype=float32)
loss: tf.Tensor(0.7762975, shape=(), dtype=float32)
loss: tf.Tensor(1.4581835, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.99520844, shape=(), dtype=float32)
F1 SCORE:
0.41232416
EPOCH  44 #################################
loss: tf.Tensor(0.7380301, shape=(), dtype=float32)
loss: tf.Tensor(0.76149744, shape=(), dtype=float32)
loss: tf.Tensor(0.829656, shape=(), dtype=float32)
loss: tf.Tensor(0.7908214, shape=(), dtype=float32)
loss: tf.Tensor(0.7909095, shape=(), dtype=float32)
loss: tf.Tensor(0.8215563, shape=(), dtype=float32)
loss: tf.Tensor(0.79669845, shape=(), dtype=float32)
loss: tf.Tensor(0.77699226, shape=(), dtype=float32)
loss: tf.Tensor(0.9100113, shape=(), dtype=float32)
loss: tf.Tensor(0.76646423, shape=(), dtype=float32)
loss: tf.Tensor(0.7485851, shape=(), dtype=float32)
loss: tf.Tensor(0.9029318, shape=(), dtype=float32)
loss: tf.Tensor(0.8199428, shape=(), dtype=float32)
loss: tf.Tensor(0.7939933, shape=(), dtype=float32)
loss: tf.Tensor(0.7652628, shape=(), dtype=float32)
loss: tf.Tensor(0.7716467, shape=(), dtype=float32)
loss: tf.Tensor(0.67465854, shape=(), dtype=float32)
loss: tf.Tensor(0.76819605, shape=(), dtype=float32)
loss: tf.Tensor(0.81183374, shape=(), dtype=float32)
loss: tf.Tensor(0.7193165, shape=(), dtype=float32)
loss: tf.Tensor(0.63436204, shape=(), dtype=float32)
loss: tf.Tensor(0.7003199, shape=(), dtype=float32)
loss: tf.Tensor(0.62864375, shape=(), dtype=float32)
loss: tf.Tensor(0.9634911, shape=(), dtype=float32)
loss: tf.Tensor(0.7684479, shape=(), dtype=float32)
loss: tf.Tensor(0.9210311, shape=(), dtype=float32)
loss: tf.Tensor(0.7591729, shape=(), dtype=float32)
loss: tf.Tensor(0.83257747, shape=(), dtype=float32)
loss: tf.Tensor(0.94837594, shape=(), dtype=float32)
loss: tf.Tensor(0.80841476, shape=(), dtype=float32)
loss: tf.Tensor(0.83727014, shape=(), dtype=float32)
loss: tf.Tensor(0.84980494, shape=(), dtype=float32)
loss: tf.Tensor(0.8247924, shape=(), dtype=float32)
loss: tf.Tensor(0.7363124, shape=(), dtype=float32)
loss: tf.Tensor(0.8072792, shape=(), dtype=float32)
loss: tf.Tensor(0.7611338, shape=(), dtype=float32)
loss: tf.Tensor(0.869709, shape=(), dtype=float32)
loss: tf.Tensor(0.7657039, shape=(), dtype=float32)
loss: tf.Tensor(0.7454449, shape=(), dtype=float32)
loss: tf.Tensor(0.8174815, shape=(), dtype=float32)
loss: tf.Tensor(0.77373755, shape=(), dtype=float32)
loss: tf.Tensor(0.854183, shape=(), dtype=float32)
loss: tf.Tensor(0.75676024, shape=(), dtype=float32)
loss: tf.Tensor(0.7354205, shape=(), dtype=float32)
loss: tf.Tensor(0.8038665, shape=(), dtype=float32)
loss: tf.Tensor(0.78237295, shape=(), dtype=float32)
loss: tf.Tensor(0.80475944, shape=(), dtype=float32)
loss: tf.Tensor(0.83361536, shape=(), dtype=float32)
loss: tf.Tensor(0.74243736, shape=(), dtype=float32)
loss: tf.Tensor(0.7464439, shape=(), dtype=float32)
loss: tf.Tensor(0.745982, shape=(), dtype=float32)
loss: tf.Tensor(0.84303766, shape=(), dtype=float32)
loss: tf.Tensor(0.7079204, shape=(), dtype=float32)
loss: tf.Tensor(0.6357885, shape=(), dtype=float32)
loss: tf.Tensor(0.67995775, shape=(), dtype=float32)
loss: tf.Tensor(0.82857865, shape=(), dtype=float32)
loss: tf.Tensor(0.6843362, shape=(), dtype=float32)
loss: tf.Tensor(0.78874606, shape=(), dtype=float32)
loss: tf.Tensor(0.7599447, shape=(), dtype=float32)
loss: tf.Tensor(0.6697911, shape=(), dtype=float32)
loss: tf.Tensor(0.6802115, shape=(), dtype=float32)
loss: tf.Tensor(0.7442247, shape=(), dtype=float32)
loss: tf.Tensor(0.8110126, shape=(), dtype=float32)
loss: tf.Tensor(0.8860905, shape=(), dtype=float32)
loss: tf.Tensor(0.8027805, shape=(), dtype=float32)
loss: tf.Tensor(0.7168799, shape=(), dtype=float32)
loss: tf.Tensor(0.74936134, shape=(), dtype=float32)
loss: tf.Tensor(0.7929328, shape=(), dtype=float32)
loss: tf.Tensor(0.8459682, shape=(), dtype=float32)
loss: tf.Tensor(0.83539206, shape=(), dtype=float32)
loss: tf.Tensor(0.69241714, shape=(), dtype=float32)
loss: tf.Tensor(0.8072463, shape=(), dtype=float32)
loss: tf.Tensor(0.78596926, shape=(), dtype=float32)
loss: tf.Tensor(2.6417646, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(1.0235927, shape=(), dtype=float32)
F1 SCORE:
0.41630557
EPOCH  45 #################################
loss: tf.Tensor(0.81845754, shape=(), dtype=float32)
loss: tf.Tensor(1.0384501, shape=(), dtype=float32)
loss: tf.Tensor(1.0355381, shape=(), dtype=float32)
loss: tf.Tensor(1.0921935, shape=(), dtype=float32)
loss: tf.Tensor(0.99882066, shape=(), dtype=float32)
loss: tf.Tensor(0.9002287, shape=(), dtype=float32)
loss: tf.Tensor(0.8859626, shape=(), dtype=float32)
loss: tf.Tensor(0.89484215, shape=(), dtype=float32)
loss: tf.Tensor(0.9535756, shape=(), dtype=float32)
loss: tf.Tensor(0.9061663, shape=(), dtype=float32)
loss: tf.Tensor(0.8072897, shape=(), dtype=float32)
loss: tf.Tensor(0.9268025, shape=(), dtype=float32)
loss: tf.Tensor(0.8775436, shape=(), dtype=float32)
loss: tf.Tensor(0.93989915, shape=(), dtype=float32)
loss: tf.Tensor(0.9954822, shape=(), dtype=float32)
loss: tf.Tensor(0.89110726, shape=(), dtype=float32)
loss: tf.Tensor(0.8404445, shape=(), dtype=float32)
loss: tf.Tensor(0.8573986, shape=(), dtype=float32)
loss: tf.Tensor(0.94426036, shape=(), dtype=float32)
loss: tf.Tensor(0.9028282, shape=(), dtype=float32)
loss: tf.Tensor(0.7747595, shape=(), dtype=float32)
loss: tf.Tensor(0.8540155, shape=(), dtype=float32)
loss: tf.Tensor(0.77611023, shape=(), dtype=float32)
loss: tf.Tensor(0.76804155, shape=(), dtype=float32)
loss: tf.Tensor(0.71835196, shape=(), dtype=float32)
loss: tf.Tensor(0.85104233, shape=(), dtype=float32)
loss: tf.Tensor(0.8175014, shape=(), dtype=float32)
loss: tf.Tensor(0.8547317, shape=(), dtype=float32)
loss: tf.Tensor(0.88501227, shape=(), dtype=float32)
loss: tf.Tensor(0.87572026, shape=(), dtype=float32)
loss: tf.Tensor(0.85211754, shape=(), dtype=float32)
loss: tf.Tensor(0.90270334, shape=(), dtype=float32)
loss: tf.Tensor(0.7801996, shape=(), dtype=float32)
loss: tf.Tensor(0.87117416, shape=(), dtype=float32)
loss: tf.Tensor(0.938302, shape=(), dtype=float32)
loss: tf.Tensor(0.91310984, shape=(), dtype=float32)
loss: tf.Tensor(0.9075851, shape=(), dtype=float32)
loss: tf.Tensor(0.8312903, shape=(), dtype=float32)
loss: tf.Tensor(0.8466173, shape=(), dtype=float32)
loss: tf.Tensor(0.8415116, shape=(), dtype=float32)
loss: tf.Tensor(0.8162886, shape=(), dtype=float32)
loss: tf.Tensor(0.80183583, shape=(), dtype=float32)
loss: tf.Tensor(0.8278735, shape=(), dtype=float32)
loss: tf.Tensor(0.80897856, shape=(), dtype=float32)
loss: tf.Tensor(0.82386804, shape=(), dtype=float32)
loss: tf.Tensor(0.8687861, shape=(), dtype=float32)
loss: tf.Tensor(0.77714, shape=(), dtype=float32)
loss: tf.Tensor(0.75489366, shape=(), dtype=float32)
loss: tf.Tensor(0.8120896, shape=(), dtype=float32)
loss: tf.Tensor(0.81078357, shape=(), dtype=float32)
loss: tf.Tensor(0.88792455, shape=(), dtype=float32)
loss: tf.Tensor(0.78848, shape=(), dtype=float32)
loss: tf.Tensor(0.8220736, shape=(), dtype=float32)
loss: tf.Tensor(0.83693296, shape=(), dtype=float32)
loss: tf.Tensor(0.87850726, shape=(), dtype=float32)
loss: tf.Tensor(0.8720407, shape=(), dtype=float32)
loss: tf.Tensor(0.8586957, shape=(), dtype=float32)
loss: tf.Tensor(0.77507913, shape=(), dtype=float32)
loss: tf.Tensor(0.81516325, shape=(), dtype=float32)
loss: tf.Tensor(0.6800676, shape=(), dtype=float32)
loss: tf.Tensor(0.86632437, shape=(), dtype=float32)
loss: tf.Tensor(0.78575224, shape=(), dtype=float32)
loss: tf.Tensor(0.7703775, shape=(), dtype=float32)
loss: tf.Tensor(0.8856548, shape=(), dtype=float32)
loss: tf.Tensor(0.7434243, shape=(), dtype=float32)
loss: tf.Tensor(0.7702155, shape=(), dtype=float32)
loss: tf.Tensor(0.72437286, shape=(), dtype=float32)
loss: tf.Tensor(0.82376486, shape=(), dtype=float32)
loss: tf.Tensor(0.887859, shape=(), dtype=float32)
loss: tf.Tensor(0.901795, shape=(), dtype=float32)
loss: tf.Tensor(0.8594286, shape=(), dtype=float32)
loss: tf.Tensor(0.78489554, shape=(), dtype=float32)
loss: tf.Tensor(0.810202, shape=(), dtype=float32)
loss: tf.Tensor(0.6967646, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9765862, shape=(), dtype=float32)
F1 SCORE:
0.4164342
EPOCH  46 #################################
loss: tf.Tensor(0.7955701, shape=(), dtype=float32)
loss: tf.Tensor(0.7470111, shape=(), dtype=float32)
loss: tf.Tensor(0.728479, shape=(), dtype=float32)
loss: tf.Tensor(0.76227623, shape=(), dtype=float32)
loss: tf.Tensor(0.9447696, shape=(), dtype=float32)
loss: tf.Tensor(0.85061044, shape=(), dtype=float32)
loss: tf.Tensor(0.7612512, shape=(), dtype=float32)
loss: tf.Tensor(0.9064369, shape=(), dtype=float32)
loss: tf.Tensor(0.7990224, shape=(), dtype=float32)
loss: tf.Tensor(0.85027635, shape=(), dtype=float32)
loss: tf.Tensor(0.8448275, shape=(), dtype=float32)
loss: tf.Tensor(0.8255991, shape=(), dtype=float32)
loss: tf.Tensor(0.79164386, shape=(), dtype=float32)
loss: tf.Tensor(0.79608816, shape=(), dtype=float32)
loss: tf.Tensor(0.90893656, shape=(), dtype=float32)
loss: tf.Tensor(0.7976921, shape=(), dtype=float32)
loss: tf.Tensor(0.851581, shape=(), dtype=float32)
loss: tf.Tensor(0.81098956, shape=(), dtype=float32)
loss: tf.Tensor(0.74679095, shape=(), dtype=float32)
loss: tf.Tensor(0.725199, shape=(), dtype=float32)
loss: tf.Tensor(0.86536807, shape=(), dtype=float32)
loss: tf.Tensor(0.8562543, shape=(), dtype=float32)
loss: tf.Tensor(0.8406028, shape=(), dtype=float32)
loss: tf.Tensor(0.8128888, shape=(), dtype=float32)
loss: tf.Tensor(0.68112826, shape=(), dtype=float32)
loss: tf.Tensor(0.62646294, shape=(), dtype=float32)
loss: tf.Tensor(0.75632936, shape=(), dtype=float32)
loss: tf.Tensor(0.7857767, shape=(), dtype=float32)
loss: tf.Tensor(0.7532148, shape=(), dtype=float32)
loss: tf.Tensor(0.80341524, shape=(), dtype=float32)
loss: tf.Tensor(0.89073163, shape=(), dtype=float32)
loss: tf.Tensor(0.84305376, shape=(), dtype=float32)
loss: tf.Tensor(0.84341776, shape=(), dtype=float32)
loss: tf.Tensor(0.7839957, shape=(), dtype=float32)
loss: tf.Tensor(0.7386668, shape=(), dtype=float32)
loss: tf.Tensor(0.75313514, shape=(), dtype=float32)
loss: tf.Tensor(0.76456535, shape=(), dtype=float32)
loss: tf.Tensor(0.7347988, shape=(), dtype=float32)
loss: tf.Tensor(0.8110213, shape=(), dtype=float32)
loss: tf.Tensor(0.8291018, shape=(), dtype=float32)
loss: tf.Tensor(0.7894704, shape=(), dtype=float32)
loss: tf.Tensor(0.7633479, shape=(), dtype=float32)
loss: tf.Tensor(0.8354313, shape=(), dtype=float32)
loss: tf.Tensor(0.69734526, shape=(), dtype=float32)
loss: tf.Tensor(0.7975019, shape=(), dtype=float32)
loss: tf.Tensor(0.766031, shape=(), dtype=float32)
loss: tf.Tensor(0.78029144, shape=(), dtype=float32)
loss: tf.Tensor(0.82956725, shape=(), dtype=float32)
loss: tf.Tensor(0.81411433, shape=(), dtype=float32)
loss: tf.Tensor(0.6808205, shape=(), dtype=float32)
loss: tf.Tensor(0.73545134, shape=(), dtype=float32)
loss: tf.Tensor(0.7876453, shape=(), dtype=float32)
loss: tf.Tensor(0.8530047, shape=(), dtype=float32)
loss: tf.Tensor(0.88994056, shape=(), dtype=float32)
loss: tf.Tensor(0.64703226, shape=(), dtype=float32)
loss: tf.Tensor(0.7548397, shape=(), dtype=float32)
loss: tf.Tensor(0.81529945, shape=(), dtype=float32)
loss: tf.Tensor(0.8187819, shape=(), dtype=float32)
loss: tf.Tensor(0.64876956, shape=(), dtype=float32)
loss: tf.Tensor(0.7755715, shape=(), dtype=float32)
loss: tf.Tensor(0.80052805, shape=(), dtype=float32)
loss: tf.Tensor(0.80508333, shape=(), dtype=float32)
loss: tf.Tensor(0.7493112, shape=(), dtype=float32)
loss: tf.Tensor(0.89440465, shape=(), dtype=float32)
loss: tf.Tensor(0.79808635, shape=(), dtype=float32)
loss: tf.Tensor(0.7848789, shape=(), dtype=float32)
loss: tf.Tensor(0.7286609, shape=(), dtype=float32)
loss: tf.Tensor(0.6393416, shape=(), dtype=float32)
loss: tf.Tensor(0.825586, shape=(), dtype=float32)
loss: tf.Tensor(0.9031366, shape=(), dtype=float32)
loss: tf.Tensor(0.8466803, shape=(), dtype=float32)
loss: tf.Tensor(0.74969894, shape=(), dtype=float32)
loss: tf.Tensor(0.76680624, shape=(), dtype=float32)
loss: tf.Tensor(0.7707667, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9616248, shape=(), dtype=float32)
F1 SCORE:
0.41613233
EPOCH  47 #################################
loss: tf.Tensor(0.69452363, shape=(), dtype=float32)
loss: tf.Tensor(0.74864316, shape=(), dtype=float32)
loss: tf.Tensor(0.74022657, shape=(), dtype=float32)
loss: tf.Tensor(0.81677294, shape=(), dtype=float32)
loss: tf.Tensor(0.88581765, shape=(), dtype=float32)
loss: tf.Tensor(0.7792484, shape=(), dtype=float32)
loss: tf.Tensor(0.82543623, shape=(), dtype=float32)
loss: tf.Tensor(0.7875755, shape=(), dtype=float32)
loss: tf.Tensor(0.7874919, shape=(), dtype=float32)
loss: tf.Tensor(0.74633425, shape=(), dtype=float32)
loss: tf.Tensor(0.76265556, shape=(), dtype=float32)
loss: tf.Tensor(0.8482306, shape=(), dtype=float32)
loss: tf.Tensor(0.8399015, shape=(), dtype=float32)
loss: tf.Tensor(0.6724946, shape=(), dtype=float32)
loss: tf.Tensor(0.76880884, shape=(), dtype=float32)
loss: tf.Tensor(0.7845456, shape=(), dtype=float32)
loss: tf.Tensor(0.76875633, shape=(), dtype=float32)
loss: tf.Tensor(0.70779985, shape=(), dtype=float32)
loss: tf.Tensor(0.7736128, shape=(), dtype=float32)
loss: tf.Tensor(0.6760304, shape=(), dtype=float32)
loss: tf.Tensor(0.72767913, shape=(), dtype=float32)
loss: tf.Tensor(0.7410242, shape=(), dtype=float32)
loss: tf.Tensor(0.75240105, shape=(), dtype=float32)
loss: tf.Tensor(0.79127777, shape=(), dtype=float32)
loss: tf.Tensor(0.6975454, shape=(), dtype=float32)
loss: tf.Tensor(0.70738596, shape=(), dtype=float32)
loss: tf.Tensor(0.7462104, shape=(), dtype=float32)
loss: tf.Tensor(0.8130106, shape=(), dtype=float32)
loss: tf.Tensor(0.6576606, shape=(), dtype=float32)
loss: tf.Tensor(0.81077164, shape=(), dtype=float32)
loss: tf.Tensor(0.93175334, shape=(), dtype=float32)
loss: tf.Tensor(0.6845091, shape=(), dtype=float32)
loss: tf.Tensor(0.8046332, shape=(), dtype=float32)
loss: tf.Tensor(0.7856201, shape=(), dtype=float32)
loss: tf.Tensor(0.70530856, shape=(), dtype=float32)
loss: tf.Tensor(0.69443566, shape=(), dtype=float32)
loss: tf.Tensor(0.7579098, shape=(), dtype=float32)
loss: tf.Tensor(0.8083363, shape=(), dtype=float32)
loss: tf.Tensor(0.7051527, shape=(), dtype=float32)
loss: tf.Tensor(0.6767619, shape=(), dtype=float32)
loss: tf.Tensor(0.7170454, shape=(), dtype=float32)
loss: tf.Tensor(0.7113516, shape=(), dtype=float32)
loss: tf.Tensor(0.76384324, shape=(), dtype=float32)
loss: tf.Tensor(0.77839994, shape=(), dtype=float32)
loss: tf.Tensor(0.778677, shape=(), dtype=float32)
loss: tf.Tensor(0.74069566, shape=(), dtype=float32)
loss: tf.Tensor(0.9040432, shape=(), dtype=float32)
loss: tf.Tensor(0.783578, shape=(), dtype=float32)
loss: tf.Tensor(0.6920073, shape=(), dtype=float32)
loss: tf.Tensor(0.76449466, shape=(), dtype=float32)
loss: tf.Tensor(0.72885835, shape=(), dtype=float32)
loss: tf.Tensor(0.7230223, shape=(), dtype=float32)
loss: tf.Tensor(0.8249509, shape=(), dtype=float32)
loss: tf.Tensor(0.7220901, shape=(), dtype=float32)
loss: tf.Tensor(0.7221085, shape=(), dtype=float32)
loss: tf.Tensor(0.8275293, shape=(), dtype=float32)
loss: tf.Tensor(0.84091115, shape=(), dtype=float32)
loss: tf.Tensor(0.89078003, shape=(), dtype=float32)
loss: tf.Tensor(0.7573708, shape=(), dtype=float32)
loss: tf.Tensor(0.71724397, shape=(), dtype=float32)
loss: tf.Tensor(0.71726626, shape=(), dtype=float32)
loss: tf.Tensor(0.81541604, shape=(), dtype=float32)
loss: tf.Tensor(0.8080545, shape=(), dtype=float32)
loss: tf.Tensor(0.6677399, shape=(), dtype=float32)
loss: tf.Tensor(0.7745732, shape=(), dtype=float32)
loss: tf.Tensor(0.77486444, shape=(), dtype=float32)
loss: tf.Tensor(0.73160845, shape=(), dtype=float32)
loss: tf.Tensor(0.7670655, shape=(), dtype=float32)
loss: tf.Tensor(0.88673073, shape=(), dtype=float32)
loss: tf.Tensor(0.8162589, shape=(), dtype=float32)
loss: tf.Tensor(0.7517617, shape=(), dtype=float32)
loss: tf.Tensor(0.8669229, shape=(), dtype=float32)
loss: tf.Tensor(0.77272326, shape=(), dtype=float32)
loss: tf.Tensor(0.4366432, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9646098, shape=(), dtype=float32)
F1 SCORE:
0.4160953
EPOCH  48 #################################
loss: tf.Tensor(0.8405807, shape=(), dtype=float32)
loss: tf.Tensor(0.760656, shape=(), dtype=float32)
loss: tf.Tensor(0.8574392, shape=(), dtype=float32)
loss: tf.Tensor(0.89500076, shape=(), dtype=float32)
loss: tf.Tensor(0.62671995, shape=(), dtype=float32)
loss: tf.Tensor(0.6689356, shape=(), dtype=float32)
loss: tf.Tensor(0.83471847, shape=(), dtype=float32)
loss: tf.Tensor(0.6769326, shape=(), dtype=float32)
loss: tf.Tensor(0.81877166, shape=(), dtype=float32)
loss: tf.Tensor(0.7474883, shape=(), dtype=float32)
loss: tf.Tensor(0.7263988, shape=(), dtype=float32)
loss: tf.Tensor(0.636745, shape=(), dtype=float32)
loss: tf.Tensor(0.75269854, shape=(), dtype=float32)
loss: tf.Tensor(0.68013835, shape=(), dtype=float32)
loss: tf.Tensor(0.71377677, shape=(), dtype=float32)
loss: tf.Tensor(0.6579491, shape=(), dtype=float32)
loss: tf.Tensor(0.6046492, shape=(), dtype=float32)
loss: tf.Tensor(0.7174095, shape=(), dtype=float32)
loss: tf.Tensor(0.6975896, shape=(), dtype=float32)
loss: tf.Tensor(0.8474934, shape=(), dtype=float32)
loss: tf.Tensor(0.86069524, shape=(), dtype=float32)
loss: tf.Tensor(0.72062266, shape=(), dtype=float32)
loss: tf.Tensor(0.7973521, shape=(), dtype=float32)
loss: tf.Tensor(0.72681, shape=(), dtype=float32)
loss: tf.Tensor(0.6888111, shape=(), dtype=float32)
loss: tf.Tensor(0.7746593, shape=(), dtype=float32)
loss: tf.Tensor(0.8771281, shape=(), dtype=float32)
loss: tf.Tensor(0.69709724, shape=(), dtype=float32)
loss: tf.Tensor(0.6799992, shape=(), dtype=float32)
loss: tf.Tensor(0.7560209, shape=(), dtype=float32)
loss: tf.Tensor(0.7909279, shape=(), dtype=float32)
loss: tf.Tensor(0.6249329, shape=(), dtype=float32)
loss: tf.Tensor(0.7434815, shape=(), dtype=float32)
loss: tf.Tensor(0.74714655, shape=(), dtype=float32)
loss: tf.Tensor(0.70859575, shape=(), dtype=float32)
loss: tf.Tensor(0.7882255, shape=(), dtype=float32)
loss: tf.Tensor(0.8338472, shape=(), dtype=float32)
loss: tf.Tensor(0.85238487, shape=(), dtype=float32)
loss: tf.Tensor(0.8043747, shape=(), dtype=float32)
loss: tf.Tensor(0.68448675, shape=(), dtype=float32)
loss: tf.Tensor(0.7927425, shape=(), dtype=float32)
loss: tf.Tensor(0.6753377, shape=(), dtype=float32)
loss: tf.Tensor(0.7772596, shape=(), dtype=float32)
loss: tf.Tensor(0.8514582, shape=(), dtype=float32)
loss: tf.Tensor(0.80788094, shape=(), dtype=float32)
loss: tf.Tensor(0.6851733, shape=(), dtype=float32)
loss: tf.Tensor(0.7687713, shape=(), dtype=float32)
loss: tf.Tensor(0.73945737, shape=(), dtype=float32)
loss: tf.Tensor(0.7595972, shape=(), dtype=float32)
loss: tf.Tensor(0.67678785, shape=(), dtype=float32)
loss: tf.Tensor(0.80879426, shape=(), dtype=float32)
loss: tf.Tensor(0.76386964, shape=(), dtype=float32)
loss: tf.Tensor(0.7005244, shape=(), dtype=float32)
loss: tf.Tensor(0.7398374, shape=(), dtype=float32)
loss: tf.Tensor(0.80145955, shape=(), dtype=float32)
loss: tf.Tensor(0.7899451, shape=(), dtype=float32)
loss: tf.Tensor(0.78867126, shape=(), dtype=float32)
loss: tf.Tensor(0.73827255, shape=(), dtype=float32)
loss: tf.Tensor(0.70009005, shape=(), dtype=float32)
loss: tf.Tensor(0.66840607, shape=(), dtype=float32)
loss: tf.Tensor(0.8302582, shape=(), dtype=float32)
loss: tf.Tensor(0.61762, shape=(), dtype=float32)
loss: tf.Tensor(0.85133743, shape=(), dtype=float32)
loss: tf.Tensor(0.80206895, shape=(), dtype=float32)
loss: tf.Tensor(0.7305624, shape=(), dtype=float32)
loss: tf.Tensor(0.8956741, shape=(), dtype=float32)
loss: tf.Tensor(0.6042006, shape=(), dtype=float32)
loss: tf.Tensor(0.7079296, shape=(), dtype=float32)
loss: tf.Tensor(0.7055864, shape=(), dtype=float32)
loss: tf.Tensor(0.7282479, shape=(), dtype=float32)
loss: tf.Tensor(0.7967541, shape=(), dtype=float32)
loss: tf.Tensor(0.7688421, shape=(), dtype=float32)
loss: tf.Tensor(0.81279683, shape=(), dtype=float32)
loss: tf.Tensor(1.1830359, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9721982, shape=(), dtype=float32)
F1 SCORE:
0.41594747
EPOCH  49 #################################
loss: tf.Tensor(0.691877, shape=(), dtype=float32)
loss: tf.Tensor(0.7359543, shape=(), dtype=float32)
loss: tf.Tensor(0.67116034, shape=(), dtype=float32)
loss: tf.Tensor(0.72170824, shape=(), dtype=float32)
loss: tf.Tensor(0.9596711, shape=(), dtype=float32)
loss: tf.Tensor(0.8782258, shape=(), dtype=float32)
loss: tf.Tensor(0.6536399, shape=(), dtype=float32)
loss: tf.Tensor(0.9187682, shape=(), dtype=float32)
loss: tf.Tensor(0.68196183, shape=(), dtype=float32)
loss: tf.Tensor(0.8360393, shape=(), dtype=float32)
loss: tf.Tensor(0.7250285, shape=(), dtype=float32)
loss: tf.Tensor(0.7167611, shape=(), dtype=float32)
loss: tf.Tensor(0.84714186, shape=(), dtype=float32)
loss: tf.Tensor(0.7602443, shape=(), dtype=float32)
loss: tf.Tensor(0.75960624, shape=(), dtype=float32)
loss: tf.Tensor(0.7474166, shape=(), dtype=float32)
loss: tf.Tensor(0.8291452, shape=(), dtype=float32)
loss: tf.Tensor(0.8070016, shape=(), dtype=float32)
loss: tf.Tensor(0.7010247, shape=(), dtype=float32)
loss: tf.Tensor(0.6510394, shape=(), dtype=float32)
loss: tf.Tensor(0.7168302, shape=(), dtype=float32)
loss: tf.Tensor(0.740628, shape=(), dtype=float32)
loss: tf.Tensor(0.7110898, shape=(), dtype=float32)
loss: tf.Tensor(0.677809, shape=(), dtype=float32)
loss: tf.Tensor(0.7052787, shape=(), dtype=float32)
loss: tf.Tensor(0.726984, shape=(), dtype=float32)
loss: tf.Tensor(0.8265449, shape=(), dtype=float32)
loss: tf.Tensor(0.82536715, shape=(), dtype=float32)
loss: tf.Tensor(0.7252429, shape=(), dtype=float32)
loss: tf.Tensor(0.7500878, shape=(), dtype=float32)
loss: tf.Tensor(0.6307467, shape=(), dtype=float32)
loss: tf.Tensor(0.69026697, shape=(), dtype=float32)
loss: tf.Tensor(0.74949366, shape=(), dtype=float32)
loss: tf.Tensor(0.86181474, shape=(), dtype=float32)
loss: tf.Tensor(0.85870314, shape=(), dtype=float32)
loss: tf.Tensor(0.7139214, shape=(), dtype=float32)
loss: tf.Tensor(0.7368719, shape=(), dtype=float32)
loss: tf.Tensor(0.8385527, shape=(), dtype=float32)
loss: tf.Tensor(0.82637405, shape=(), dtype=float32)
loss: tf.Tensor(0.79818696, shape=(), dtype=float32)
loss: tf.Tensor(0.7751848, shape=(), dtype=float32)
loss: tf.Tensor(0.7280258, shape=(), dtype=float32)
loss: tf.Tensor(0.67045295, shape=(), dtype=float32)
loss: tf.Tensor(0.6969784, shape=(), dtype=float32)
loss: tf.Tensor(0.7172404, shape=(), dtype=float32)
loss: tf.Tensor(0.87950355, shape=(), dtype=float32)
loss: tf.Tensor(0.6750953, shape=(), dtype=float32)
loss: tf.Tensor(0.64980996, shape=(), dtype=float32)
loss: tf.Tensor(0.82563645, shape=(), dtype=float32)
loss: tf.Tensor(0.76498336, shape=(), dtype=float32)
loss: tf.Tensor(0.66685677, shape=(), dtype=float32)
loss: tf.Tensor(0.9051725, shape=(), dtype=float32)
loss: tf.Tensor(0.63669115, shape=(), dtype=float32)
loss: tf.Tensor(0.714219, shape=(), dtype=float32)
loss: tf.Tensor(0.78087866, shape=(), dtype=float32)
loss: tf.Tensor(0.5771673, shape=(), dtype=float32)
loss: tf.Tensor(0.68454134, shape=(), dtype=float32)
loss: tf.Tensor(0.66653514, shape=(), dtype=float32)
loss: tf.Tensor(0.6712718, shape=(), dtype=float32)
loss: tf.Tensor(0.7772238, shape=(), dtype=float32)
loss: tf.Tensor(0.79492414, shape=(), dtype=float32)
loss: tf.Tensor(0.78288823, shape=(), dtype=float32)
loss: tf.Tensor(0.8289057, shape=(), dtype=float32)
loss: tf.Tensor(0.7183595, shape=(), dtype=float32)
loss: tf.Tensor(0.74643713, shape=(), dtype=float32)
loss: tf.Tensor(0.86165595, shape=(), dtype=float32)
loss: tf.Tensor(0.77042985, shape=(), dtype=float32)
loss: tf.Tensor(0.82332575, shape=(), dtype=float32)
loss: tf.Tensor(0.71214265, shape=(), dtype=float32)
loss: tf.Tensor(0.7492103, shape=(), dtype=float32)
loss: tf.Tensor(0.7719253, shape=(), dtype=float32)
loss: tf.Tensor(0.7641275, shape=(), dtype=float32)
loss: tf.Tensor(0.86554235, shape=(), dtype=float32)
loss: tf.Tensor(0.032580845, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f0c41152bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.9592731, shape=(), dtype=float32)
F1 SCORE:
0.41668102
