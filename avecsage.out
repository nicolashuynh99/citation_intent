2021-03-02 14:43:11.980714: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-03-02 14:43:11.980781: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
LOADING DICO FINI
1000 edges added on 111397   --------   1 % 
2000 edges added on 111397   --------   2 % 
3000 edges added on 111397   --------   3 % 
4000 edges added on 111397   --------   4 % 
5000 edges added on 111397   --------   4 % 
6000 edges added on 111397   --------   5 % 
7000 edges added on 111397   --------   6 % 
8000 edges added on 111397   --------   7 % 
9000 edges added on 111397   --------   8 % 
10000 edges added on 111397   --------   9 % 
11000 edges added on 111397   --------   10 % 
12000 edges added on 111397   --------   11 % 
13000 edges added on 111397   --------   12 % 
14000 edges added on 111397   --------   13 % 
15000 edges added on 111397   --------   13 % 
16000 edges added on 111397   --------   14 % 
17000 edges added on 111397   --------   15 % 
18000 edges added on 111397   --------   16 % 
19000 edges added on 111397   --------   17 % 
20000 edges added on 111397   --------   18 % 
21000 edges added on 111397   --------   19 % 
22000 edges added on 111397   --------   20 % 
23000 edges added on 111397   --------   21 % 
24000 edges added on 111397   --------   22 % 
25000 edges added on 111397   --------   22 % 
26000 edges added on 111397   --------   23 % 
27000 edges added on 111397   --------   24 % 
28000 edges added on 111397   --------   25 % 
29000 edges added on 111397   --------   26 % 
30000 edges added on 111397   --------   27 % 
31000 edges added on 111397   --------   28 % 
32000 edges added on 111397   --------   29 % 
33000 edges added on 111397   --------   30 % 
34000 edges added on 111397   --------   31 % 
35000 edges added on 111397   --------   31 % 
36000 edges added on 111397   --------   32 % 
37000 edges added on 111397   --------   33 % 
38000 edges added on 111397   --------   34 % 
39000 edges added on 111397   --------   35 % 
40000 edges added on 111397   --------   36 % 
41000 edges added on 111397   --------   37 % 
42000 edges added on 111397   --------   38 % 
43000 edges added on 111397   --------   39 % 
44000 edges added on 111397   --------   39 % 
45000 edges added on 111397   --------   40 % 
46000 edges added on 111397   --------   41 % 
47000 edges added on 111397   --------   42 % 
48000 edges added on 111397   --------   43 % 
49000 edges added on 111397   --------   44 % 
50000 edges added on 111397   --------   45 % 
51000 edges added on 111397   --------   46 % 
52000 edges added on 111397   --------   47 % 
53000 edges added on 111397   --------   48 % 
54000 edges added on 111397   --------   48 % 
55000 edges added on 111397   --------   49 % 
56000 edges added on 111397   --------   50 % 
57000 edges added on 111397   --------   51 % 
58000 edges added on 111397   --------   52 % 
59000 edges added on 111397   --------   53 % 
60000 edges added on 111397   --------   54 % 
61000 edges added on 111397   --------   55 % 
62000 edges added on 111397   --------   56 % 
63000 edges added on 111397   --------   57 % 
64000 edges added on 111397   --------   57 % 
65000 edges added on 111397   --------   58 % 
66000 edges added on 111397   --------   59 % 
67000 edges added on 111397   --------   60 % 
68000 edges added on 111397   --------   61 % 
69000 edges added on 111397   --------   62 % 
70000 edges added on 111397   --------   63 % 
71000 edges added on 111397   --------   64 % 
72000 edges added on 111397   --------   65 % 
73000 edges added on 111397   --------   66 % 
74000 edges added on 111397   --------   66 % 
75000 edges added on 111397   --------   67 % 
76000 edges added on 111397   --------   68 % 
77000 edges added on 111397   --------   69 % 
78000 edges added on 111397   --------   70 % 
79000 edges added on 111397   --------   71 % 
80000 edges added on 111397   --------   72 % 
81000 edges added on 111397   --------   73 % 
82000 edges added on 111397   --------   74 % 
83000 edges added on 111397   --------   75 % 
84000 edges added on 111397   --------   75 % 
85000 edges added on 111397   --------   76 % 
86000 edges added on 111397   --------   77 % 
87000 edges added on 111397   --------   78 % 
88000 edges added on 111397   --------   79 % 
89000 edges added on 111397   --------   80 % 
90000 edges added on 111397   --------   81 % 
91000 edges added on 111397   --------   82 % 
92000 edges added on 111397   --------   83 % 
93000 edges added on 111397   --------   83 % 
94000 edges added on 111397   --------   84 % 
95000 edges added on 111397   --------   85 % 
96000 edges added on 111397   --------   86 % 
97000 edges added on 111397   --------   87 % 
98000 edges added on 111397   --------   88 % 
99000 edges added on 111397   --------   89 % 
100000 edges added on 111397   --------   90 % 
101000 edges added on 111397   --------   91 % 
102000 edges added on 111397   --------   92 % 
103000 edges added on 111397   --------   92 % 
104000 edges added on 111397   --------   93 % 
105000 edges added on 111397   --------   94 % 
106000 edges added on 111397   --------   95 % 
107000 edges added on 111397   --------   96 % 
108000 edges added on 111397   --------   97 % 
109000 edges added on 111397   --------   98 % 
110000 edges added on 111397   --------   99 % 
111000 edges added on 111397   --------   100 % 
487
avant: 7685
apres: 7301
2021-03-02 14:43:45.704211: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-02 14:43:45.705397: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-03-02 14:43:45.705460: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-03-02 14:43:45.705520: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (cedar006.saclay.inria.fr): /proc/driver/nvidia/version does not exist
2021-03-02 14:43:45.710807: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
EPOCH  0 #################################
/data/projet_citations/sage/edgeMinibatch.py:119: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.train_edges[i][2])
509
loss: tf.Tensor(1.0963467, shape=(), dtype=float32)
loss: tf.Tensor(0.95962065, shape=(), dtype=float32)
loss: tf.Tensor(0.7555559, shape=(), dtype=float32)
loss: tf.Tensor(0.8878364, shape=(), dtype=float32)
loss: tf.Tensor(0.8501526, shape=(), dtype=float32)
loss: tf.Tensor(0.9529296, shape=(), dtype=float32)
loss: tf.Tensor(0.865418, shape=(), dtype=float32)
loss: tf.Tensor(0.80708015, shape=(), dtype=float32)
loss: tf.Tensor(0.82537514, shape=(), dtype=float32)
loss: tf.Tensor(0.6691143, shape=(), dtype=float32)
loss: tf.Tensor(0.6855009, shape=(), dtype=float32)
loss: tf.Tensor(0.78139305, shape=(), dtype=float32)
loss: tf.Tensor(0.60299414, shape=(), dtype=float32)
loss: tf.Tensor(0.6339365, shape=(), dtype=float32)
loss: tf.Tensor(0.5446146, shape=(), dtype=float32)
loss: tf.Tensor(0.5635301, shape=(), dtype=float32)
loss: tf.Tensor(0.6642645, shape=(), dtype=float32)
loss: tf.Tensor(0.39376256, shape=(), dtype=float32)
loss: tf.Tensor(0.6510441, shape=(), dtype=float32)
loss: tf.Tensor(0.42049637, shape=(), dtype=float32)
loss: tf.Tensor(0.44737923, shape=(), dtype=float32)
loss: tf.Tensor(0.5325763, shape=(), dtype=float32)
loss: tf.Tensor(0.47761494, shape=(), dtype=float32)
loss: tf.Tensor(0.4305282, shape=(), dtype=float32)
loss: tf.Tensor(0.49276552, shape=(), dtype=float32)
loss: tf.Tensor(0.41868168, shape=(), dtype=float32)
loss: tf.Tensor(0.40527573, shape=(), dtype=float32)
loss: tf.Tensor(0.2980791, shape=(), dtype=float32)
loss: tf.Tensor(0.43748492, shape=(), dtype=float32)
loss: tf.Tensor(0.5329372, shape=(), dtype=float32)
loss: tf.Tensor(0.40237573, shape=(), dtype=float32)
loss: tf.Tensor(0.32925868, shape=(), dtype=float32)
loss: tf.Tensor(0.5353741, shape=(), dtype=float32)
loss: tf.Tensor(0.5009295, shape=(), dtype=float32)
loss: tf.Tensor(0.5926239, shape=(), dtype=float32)
loss: tf.Tensor(0.57271147, shape=(), dtype=float32)
loss: tf.Tensor(0.35036838, shape=(), dtype=float32)
loss: tf.Tensor(0.48461482, shape=(), dtype=float32)
loss: tf.Tensor(0.5979157, shape=(), dtype=float32)
loss: tf.Tensor(0.4964688, shape=(), dtype=float32)
loss: tf.Tensor(0.4850596, shape=(), dtype=float32)
loss: tf.Tensor(0.62365216, shape=(), dtype=float32)
loss: tf.Tensor(0.3859666, shape=(), dtype=float32)
loss: tf.Tensor(0.54311204, shape=(), dtype=float32)
loss: tf.Tensor(0.46719238, shape=(), dtype=float32)
loss: tf.Tensor(0.43757233, shape=(), dtype=float32)
loss: tf.Tensor(0.4738188, shape=(), dtype=float32)
loss: tf.Tensor(0.55446696, shape=(), dtype=float32)
loss: tf.Tensor(0.4518513, shape=(), dtype=float32)
loss: tf.Tensor(0.45375323, shape=(), dtype=float32)
loss: tf.Tensor(0.36784926, shape=(), dtype=float32)
loss: tf.Tensor(0.53124833, shape=(), dtype=float32)
loss: tf.Tensor(0.41476452, shape=(), dtype=float32)
loss: tf.Tensor(0.47101453, shape=(), dtype=float32)
loss: tf.Tensor(0.6548193, shape=(), dtype=float32)
loss: tf.Tensor(0.4707526, shape=(), dtype=float32)
loss: tf.Tensor(0.32181138, shape=(), dtype=float32)
loss: tf.Tensor(0.34791782, shape=(), dtype=float32)
loss: tf.Tensor(0.41046974, shape=(), dtype=float32)
loss: tf.Tensor(0.5120909, shape=(), dtype=float32)
loss: tf.Tensor(0.44251746, shape=(), dtype=float32)
loss: tf.Tensor(0.48498213, shape=(), dtype=float32)
loss: tf.Tensor(0.38641334, shape=(), dtype=float32)
loss: tf.Tensor(0.3447797, shape=(), dtype=float32)
loss: tf.Tensor(0.35616407, shape=(), dtype=float32)
loss: tf.Tensor(0.44416836, shape=(), dtype=float32)
loss: tf.Tensor(0.48462227, shape=(), dtype=float32)
loss: tf.Tensor(0.44973165, shape=(), dtype=float32)
loss: tf.Tensor(0.38817525, shape=(), dtype=float32)
loss: tf.Tensor(0.5795923, shape=(), dtype=float32)
loss: tf.Tensor(0.32146817, shape=(), dtype=float32)
loss: tf.Tensor(0.4641354, shape=(), dtype=float32)
loss: tf.Tensor(0.5205244, shape=(), dtype=float32)
loss: tf.Tensor(0.1174669, shape=(), dtype=float32)
TEST LOSS: #####################################
/data/projet_citations/sage/edgeMinibatch.py:163: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.test_edges[i][2])
2021-03-02 15:05:49.889850: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-03-02 15:05:49.890917: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2399860000 Hz
tf.Tensor(0.74162227, shape=(), dtype=float32)
F1 SCORE:
0.80569625
EPOCH  1 #################################
loss: tf.Tensor(0.430982, shape=(), dtype=float32)
loss: tf.Tensor(0.39628524, shape=(), dtype=float32)
loss: tf.Tensor(0.39152992, shape=(), dtype=float32)
loss: tf.Tensor(0.23909214, shape=(), dtype=float32)
loss: tf.Tensor(0.30137438, shape=(), dtype=float32)
loss: tf.Tensor(0.4895081, shape=(), dtype=float32)
loss: tf.Tensor(0.5126609, shape=(), dtype=float32)
loss: tf.Tensor(0.434888, shape=(), dtype=float32)
loss: tf.Tensor(0.5096368, shape=(), dtype=float32)
loss: tf.Tensor(0.42127773, shape=(), dtype=float32)
loss: tf.Tensor(0.38268077, shape=(), dtype=float32)
loss: tf.Tensor(0.34380844, shape=(), dtype=float32)
loss: tf.Tensor(0.35333332, shape=(), dtype=float32)
loss: tf.Tensor(0.25961363, shape=(), dtype=float32)
loss: tf.Tensor(0.32921323, shape=(), dtype=float32)
loss: tf.Tensor(0.430056, shape=(), dtype=float32)
loss: tf.Tensor(0.4329834, shape=(), dtype=float32)
loss: tf.Tensor(0.3576813, shape=(), dtype=float32)
loss: tf.Tensor(0.50929517, shape=(), dtype=float32)
loss: tf.Tensor(0.41790184, shape=(), dtype=float32)
loss: tf.Tensor(0.38712433, shape=(), dtype=float32)
loss: tf.Tensor(0.3380034, shape=(), dtype=float32)
loss: tf.Tensor(0.55859786, shape=(), dtype=float32)
loss: tf.Tensor(0.5889641, shape=(), dtype=float32)
loss: tf.Tensor(0.2698932, shape=(), dtype=float32)
loss: tf.Tensor(0.41824567, shape=(), dtype=float32)
loss: tf.Tensor(0.3098806, shape=(), dtype=float32)
loss: tf.Tensor(0.4186441, shape=(), dtype=float32)
loss: tf.Tensor(0.42232817, shape=(), dtype=float32)
loss: tf.Tensor(0.46795425, shape=(), dtype=float32)
loss: tf.Tensor(0.57004863, shape=(), dtype=float32)
loss: tf.Tensor(0.35336438, shape=(), dtype=float32)
loss: tf.Tensor(0.42412266, shape=(), dtype=float32)
loss: tf.Tensor(0.39785492, shape=(), dtype=float32)
loss: tf.Tensor(0.39729172, shape=(), dtype=float32)
loss: tf.Tensor(0.35889876, shape=(), dtype=float32)
loss: tf.Tensor(0.39631283, shape=(), dtype=float32)
loss: tf.Tensor(0.2996028, shape=(), dtype=float32)
loss: tf.Tensor(0.35693812, shape=(), dtype=float32)
loss: tf.Tensor(0.30116603, shape=(), dtype=float32)
loss: tf.Tensor(0.42055386, shape=(), dtype=float32)
loss: tf.Tensor(0.37969497, shape=(), dtype=float32)
loss: tf.Tensor(0.4201726, shape=(), dtype=float32)
loss: tf.Tensor(0.51305014, shape=(), dtype=float32)
loss: tf.Tensor(0.55305785, shape=(), dtype=float32)
loss: tf.Tensor(0.31466365, shape=(), dtype=float32)
loss: tf.Tensor(0.28952953, shape=(), dtype=float32)
loss: tf.Tensor(0.5394081, shape=(), dtype=float32)
loss: tf.Tensor(0.3374303, shape=(), dtype=float32)
loss: tf.Tensor(0.35475174, shape=(), dtype=float32)
loss: tf.Tensor(0.4099467, shape=(), dtype=float32)
loss: tf.Tensor(0.49201035, shape=(), dtype=float32)
loss: tf.Tensor(0.5031693, shape=(), dtype=float32)
loss: tf.Tensor(0.31115168, shape=(), dtype=float32)
loss: tf.Tensor(0.6151611, shape=(), dtype=float32)
loss: tf.Tensor(0.37395844, shape=(), dtype=float32)
loss: tf.Tensor(0.42163682, shape=(), dtype=float32)
loss: tf.Tensor(0.47427338, shape=(), dtype=float32)
loss: tf.Tensor(0.5155962, shape=(), dtype=float32)
loss: tf.Tensor(0.41896793, shape=(), dtype=float32)
loss: tf.Tensor(0.36413285, shape=(), dtype=float32)
loss: tf.Tensor(0.3038612, shape=(), dtype=float32)
loss: tf.Tensor(0.39980328, shape=(), dtype=float32)
loss: tf.Tensor(0.5953829, shape=(), dtype=float32)
loss: tf.Tensor(0.29198167, shape=(), dtype=float32)
loss: tf.Tensor(0.45280093, shape=(), dtype=float32)
loss: tf.Tensor(0.38756508, shape=(), dtype=float32)
loss: tf.Tensor(0.5431221, shape=(), dtype=float32)
loss: tf.Tensor(0.28666896, shape=(), dtype=float32)
loss: tf.Tensor(0.44357514, shape=(), dtype=float32)
loss: tf.Tensor(0.5049521, shape=(), dtype=float32)
loss: tf.Tensor(0.25636402, shape=(), dtype=float32)
loss: tf.Tensor(0.39993027, shape=(), dtype=float32)
loss: tf.Tensor(0.6510469, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.72984475, shape=(), dtype=float32)
F1 SCORE:
0.8093529
EPOCH  2 #################################
loss: tf.Tensor(0.4087907, shape=(), dtype=float32)
loss: tf.Tensor(0.4416268, shape=(), dtype=float32)
loss: tf.Tensor(0.5655879, shape=(), dtype=float32)
loss: tf.Tensor(0.53817713, shape=(), dtype=float32)
loss: tf.Tensor(0.50737214, shape=(), dtype=float32)
loss: tf.Tensor(0.5957256, shape=(), dtype=float32)
loss: tf.Tensor(0.43895134, shape=(), dtype=float32)
loss: tf.Tensor(0.30941612, shape=(), dtype=float32)
loss: tf.Tensor(0.33595565, shape=(), dtype=float32)
loss: tf.Tensor(0.62947893, shape=(), dtype=float32)
loss: tf.Tensor(0.37084034, shape=(), dtype=float32)
loss: tf.Tensor(0.34487495, shape=(), dtype=float32)
loss: tf.Tensor(0.3904976, shape=(), dtype=float32)
loss: tf.Tensor(0.31422395, shape=(), dtype=float32)
loss: tf.Tensor(0.26480588, shape=(), dtype=float32)
loss: tf.Tensor(0.32726917, shape=(), dtype=float32)
loss: tf.Tensor(0.5598, shape=(), dtype=float32)
loss: tf.Tensor(0.37514213, shape=(), dtype=float32)
loss: tf.Tensor(0.5125871, shape=(), dtype=float32)
loss: tf.Tensor(0.38255033, shape=(), dtype=float32)
loss: tf.Tensor(0.250815, shape=(), dtype=float32)
loss: tf.Tensor(0.29306474, shape=(), dtype=float32)
loss: tf.Tensor(0.45492658, shape=(), dtype=float32)
loss: tf.Tensor(0.27423605, shape=(), dtype=float32)
loss: tf.Tensor(0.36906865, shape=(), dtype=float32)
loss: tf.Tensor(0.33949053, shape=(), dtype=float32)
loss: tf.Tensor(0.46848083, shape=(), dtype=float32)
loss: tf.Tensor(0.28520003, shape=(), dtype=float32)
loss: tf.Tensor(0.33991912, shape=(), dtype=float32)
loss: tf.Tensor(0.38080224, shape=(), dtype=float32)
loss: tf.Tensor(0.28635696, shape=(), dtype=float32)
loss: tf.Tensor(0.452524, shape=(), dtype=float32)
loss: tf.Tensor(0.38090554, shape=(), dtype=float32)
loss: tf.Tensor(0.36004043, shape=(), dtype=float32)
loss: tf.Tensor(0.29805657, shape=(), dtype=float32)
loss: tf.Tensor(0.26711258, shape=(), dtype=float32)
loss: tf.Tensor(0.4195758, shape=(), dtype=float32)
loss: tf.Tensor(0.36048716, shape=(), dtype=float32)
loss: tf.Tensor(0.32596394, shape=(), dtype=float32)
loss: tf.Tensor(0.37120256, shape=(), dtype=float32)
loss: tf.Tensor(0.35268798, shape=(), dtype=float32)
loss: tf.Tensor(0.2476919, shape=(), dtype=float32)
loss: tf.Tensor(0.19250625, shape=(), dtype=float32)
loss: tf.Tensor(0.42899978, shape=(), dtype=float32)
loss: tf.Tensor(0.31984252, shape=(), dtype=float32)
loss: tf.Tensor(0.41885877, shape=(), dtype=float32)
loss: tf.Tensor(0.589843, shape=(), dtype=float32)
loss: tf.Tensor(0.38825318, shape=(), dtype=float32)
loss: tf.Tensor(0.4057307, shape=(), dtype=float32)
loss: tf.Tensor(0.28302768, shape=(), dtype=float32)
loss: tf.Tensor(0.32303703, shape=(), dtype=float32)
loss: tf.Tensor(0.40164176, shape=(), dtype=float32)
loss: tf.Tensor(0.2592442, shape=(), dtype=float32)
loss: tf.Tensor(0.4719749, shape=(), dtype=float32)
loss: tf.Tensor(0.3843332, shape=(), dtype=float32)
loss: tf.Tensor(0.2712423, shape=(), dtype=float32)
loss: tf.Tensor(0.4217033, shape=(), dtype=float32)
loss: tf.Tensor(0.3877877, shape=(), dtype=float32)
loss: tf.Tensor(0.41580594, shape=(), dtype=float32)
loss: tf.Tensor(0.3231726, shape=(), dtype=float32)
loss: tf.Tensor(0.34396788, shape=(), dtype=float32)
loss: tf.Tensor(0.34703448, shape=(), dtype=float32)
loss: tf.Tensor(0.38931048, shape=(), dtype=float32)
loss: tf.Tensor(0.36960685, shape=(), dtype=float32)
loss: tf.Tensor(0.5403454, shape=(), dtype=float32)
loss: tf.Tensor(0.32813427, shape=(), dtype=float32)
loss: tf.Tensor(0.43937507, shape=(), dtype=float32)
loss: tf.Tensor(0.39538142, shape=(), dtype=float32)
loss: tf.Tensor(0.39627144, shape=(), dtype=float32)
loss: tf.Tensor(0.41854626, shape=(), dtype=float32)
loss: tf.Tensor(0.50344056, shape=(), dtype=float32)
loss: tf.Tensor(0.4563762, shape=(), dtype=float32)
loss: tf.Tensor(0.5211165, shape=(), dtype=float32)
loss: tf.Tensor(0.085716754, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.7053093, shape=(), dtype=float32)
F1 SCORE:
0.8221297
EPOCH  3 #################################
loss: tf.Tensor(0.42319384, shape=(), dtype=float32)
loss: tf.Tensor(0.28430974, shape=(), dtype=float32)
loss: tf.Tensor(0.3588501, shape=(), dtype=float32)
loss: tf.Tensor(0.40354705, shape=(), dtype=float32)
loss: tf.Tensor(0.2759181, shape=(), dtype=float32)
loss: tf.Tensor(0.37914354, shape=(), dtype=float32)
loss: tf.Tensor(0.33149156, shape=(), dtype=float32)
loss: tf.Tensor(0.39597508, shape=(), dtype=float32)
loss: tf.Tensor(0.2737927, shape=(), dtype=float32)
loss: tf.Tensor(0.35158893, shape=(), dtype=float32)
loss: tf.Tensor(0.30706322, shape=(), dtype=float32)
loss: tf.Tensor(0.32257396, shape=(), dtype=float32)
loss: tf.Tensor(0.23540308, shape=(), dtype=float32)
loss: tf.Tensor(0.27877343, shape=(), dtype=float32)
loss: tf.Tensor(0.3411338, shape=(), dtype=float32)
loss: tf.Tensor(0.4642507, shape=(), dtype=float32)
loss: tf.Tensor(0.39338952, shape=(), dtype=float32)
loss: tf.Tensor(0.2308144, shape=(), dtype=float32)
loss: tf.Tensor(0.23901455, shape=(), dtype=float32)
loss: tf.Tensor(0.32440525, shape=(), dtype=float32)
loss: tf.Tensor(0.26056463, shape=(), dtype=float32)
loss: tf.Tensor(0.27721232, shape=(), dtype=float32)
loss: tf.Tensor(0.40200406, shape=(), dtype=float32)
loss: tf.Tensor(0.32698303, shape=(), dtype=float32)
loss: tf.Tensor(0.37186378, shape=(), dtype=float32)
loss: tf.Tensor(0.54950875, shape=(), dtype=float32)
loss: tf.Tensor(0.49121112, shape=(), dtype=float32)
loss: tf.Tensor(0.2714649, shape=(), dtype=float32)
loss: tf.Tensor(0.5895851, shape=(), dtype=float32)
loss: tf.Tensor(0.2647074, shape=(), dtype=float32)
loss: tf.Tensor(0.31434816, shape=(), dtype=float32)
loss: tf.Tensor(0.3683841, shape=(), dtype=float32)
loss: tf.Tensor(0.34386644, shape=(), dtype=float32)
loss: tf.Tensor(0.32887, shape=(), dtype=float32)
loss: tf.Tensor(0.28263927, shape=(), dtype=float32)
loss: tf.Tensor(0.32856533, shape=(), dtype=float32)
loss: tf.Tensor(0.2542137, shape=(), dtype=float32)
loss: tf.Tensor(0.28678706, shape=(), dtype=float32)
loss: tf.Tensor(0.3446157, shape=(), dtype=float32)
loss: tf.Tensor(0.27677777, shape=(), dtype=float32)
loss: tf.Tensor(0.3210077, shape=(), dtype=float32)
loss: tf.Tensor(0.40447357, shape=(), dtype=float32)
loss: tf.Tensor(0.28117886, shape=(), dtype=float32)
loss: tf.Tensor(0.39961678, shape=(), dtype=float32)
loss: tf.Tensor(0.24964559, shape=(), dtype=float32)
loss: tf.Tensor(0.49339375, shape=(), dtype=float32)
loss: tf.Tensor(0.3022366, shape=(), dtype=float32)
loss: tf.Tensor(0.3594814, shape=(), dtype=float32)
loss: tf.Tensor(0.3416486, shape=(), dtype=float32)
loss: tf.Tensor(0.40931094, shape=(), dtype=float32)
loss: tf.Tensor(0.43483424, shape=(), dtype=float32)
loss: tf.Tensor(0.33240962, shape=(), dtype=float32)
loss: tf.Tensor(0.32862836, shape=(), dtype=float32)
loss: tf.Tensor(0.40395162, shape=(), dtype=float32)
loss: tf.Tensor(0.25949726, shape=(), dtype=float32)
loss: tf.Tensor(0.5608276, shape=(), dtype=float32)
loss: tf.Tensor(0.50484085, shape=(), dtype=float32)
loss: tf.Tensor(0.30710807, shape=(), dtype=float32)
loss: tf.Tensor(0.40068245, shape=(), dtype=float32)
loss: tf.Tensor(0.3331825, shape=(), dtype=float32)
loss: tf.Tensor(0.262302, shape=(), dtype=float32)
loss: tf.Tensor(0.35389042, shape=(), dtype=float32)
loss: tf.Tensor(0.4211905, shape=(), dtype=float32)
loss: tf.Tensor(0.3560476, shape=(), dtype=float32)
loss: tf.Tensor(0.39670914, shape=(), dtype=float32)
loss: tf.Tensor(0.36389607, shape=(), dtype=float32)
loss: tf.Tensor(0.4447468, shape=(), dtype=float32)
loss: tf.Tensor(0.34269455, shape=(), dtype=float32)
loss: tf.Tensor(0.4077934, shape=(), dtype=float32)
loss: tf.Tensor(0.4602201, shape=(), dtype=float32)
loss: tf.Tensor(0.314417, shape=(), dtype=float32)
loss: tf.Tensor(0.3143505, shape=(), dtype=float32)
loss: tf.Tensor(0.3347921, shape=(), dtype=float32)
loss: tf.Tensor(2.5083213, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.7146394, shape=(), dtype=float32)
F1 SCORE:
0.82728416
EPOCH  4 #################################
loss: tf.Tensor(0.3063332, shape=(), dtype=float32)
loss: tf.Tensor(0.3125311, shape=(), dtype=float32)
loss: tf.Tensor(0.35882026, shape=(), dtype=float32)
loss: tf.Tensor(0.3611426, shape=(), dtype=float32)
loss: tf.Tensor(0.3020624, shape=(), dtype=float32)
loss: tf.Tensor(0.4008162, shape=(), dtype=float32)
loss: tf.Tensor(0.40110326, shape=(), dtype=float32)
loss: tf.Tensor(0.31749716, shape=(), dtype=float32)
loss: tf.Tensor(0.27132168, shape=(), dtype=float32)
loss: tf.Tensor(0.5216496, shape=(), dtype=float32)
loss: tf.Tensor(0.34857577, shape=(), dtype=float32)
loss: tf.Tensor(0.36893013, shape=(), dtype=float32)
loss: tf.Tensor(0.4045044, shape=(), dtype=float32)
loss: tf.Tensor(0.34044567, shape=(), dtype=float32)
loss: tf.Tensor(0.25623667, shape=(), dtype=float32)
loss: tf.Tensor(0.3826353, shape=(), dtype=float32)
loss: tf.Tensor(0.35508215, shape=(), dtype=float32)
loss: tf.Tensor(0.4221029, shape=(), dtype=float32)
loss: tf.Tensor(0.36561063, shape=(), dtype=float32)
loss: tf.Tensor(0.5142397, shape=(), dtype=float32)
loss: tf.Tensor(0.34371185, shape=(), dtype=float32)
loss: tf.Tensor(0.30193183, shape=(), dtype=float32)
loss: tf.Tensor(0.25358406, shape=(), dtype=float32)
loss: tf.Tensor(0.21949163, shape=(), dtype=float32)
loss: tf.Tensor(0.37644947, shape=(), dtype=float32)
loss: tf.Tensor(0.4337576, shape=(), dtype=float32)
loss: tf.Tensor(0.30678007, shape=(), dtype=float32)
loss: tf.Tensor(0.4161669, shape=(), dtype=float32)
loss: tf.Tensor(0.29986754, shape=(), dtype=float32)
loss: tf.Tensor(0.4079854, shape=(), dtype=float32)
loss: tf.Tensor(0.32858598, shape=(), dtype=float32)
loss: tf.Tensor(0.27615654, shape=(), dtype=float32)
loss: tf.Tensor(0.35892498, shape=(), dtype=float32)
loss: tf.Tensor(0.389463, shape=(), dtype=float32)
loss: tf.Tensor(0.34249774, shape=(), dtype=float32)
loss: tf.Tensor(0.24599159, shape=(), dtype=float32)
loss: tf.Tensor(0.2868145, shape=(), dtype=float32)
loss: tf.Tensor(0.30992162, shape=(), dtype=float32)
loss: tf.Tensor(0.30569828, shape=(), dtype=float32)
loss: tf.Tensor(0.54417354, shape=(), dtype=float32)
loss: tf.Tensor(0.3476907, shape=(), dtype=float32)
loss: tf.Tensor(0.22854552, shape=(), dtype=float32)
loss: tf.Tensor(0.51221055, shape=(), dtype=float32)
loss: tf.Tensor(0.32687604, shape=(), dtype=float32)
loss: tf.Tensor(0.41039714, shape=(), dtype=float32)
loss: tf.Tensor(0.48609647, shape=(), dtype=float32)
loss: tf.Tensor(0.2954545, shape=(), dtype=float32)
loss: tf.Tensor(0.34218022, shape=(), dtype=float32)
loss: tf.Tensor(0.19734646, shape=(), dtype=float32)
loss: tf.Tensor(0.3965556, shape=(), dtype=float32)
loss: tf.Tensor(0.40114293, shape=(), dtype=float32)
loss: tf.Tensor(0.42951357, shape=(), dtype=float32)
loss: tf.Tensor(0.27862892, shape=(), dtype=float32)
loss: tf.Tensor(0.42263028, shape=(), dtype=float32)
loss: tf.Tensor(0.34546742, shape=(), dtype=float32)
loss: tf.Tensor(0.2998132, shape=(), dtype=float32)
loss: tf.Tensor(0.455593, shape=(), dtype=float32)
loss: tf.Tensor(0.37630257, shape=(), dtype=float32)
loss: tf.Tensor(0.32660282, shape=(), dtype=float32)
loss: tf.Tensor(0.242723, shape=(), dtype=float32)
loss: tf.Tensor(0.35316825, shape=(), dtype=float32)
loss: tf.Tensor(0.26409325, shape=(), dtype=float32)
loss: tf.Tensor(0.36219683, shape=(), dtype=float32)
loss: tf.Tensor(0.31599036, shape=(), dtype=float32)
loss: tf.Tensor(0.33726382, shape=(), dtype=float32)
loss: tf.Tensor(0.34624144, shape=(), dtype=float32)
loss: tf.Tensor(0.34831348, shape=(), dtype=float32)
loss: tf.Tensor(0.40174857, shape=(), dtype=float32)
loss: tf.Tensor(0.4982931, shape=(), dtype=float32)
loss: tf.Tensor(0.25941476, shape=(), dtype=float32)
loss: tf.Tensor(0.36626202, shape=(), dtype=float32)
loss: tf.Tensor(0.22167449, shape=(), dtype=float32)
loss: tf.Tensor(0.39778897, shape=(), dtype=float32)
loss: tf.Tensor(0.030325817, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:5 out of the last 5 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.704815, shape=(), dtype=float32)
F1 SCORE:
0.8309606
EPOCH  5 #################################
loss: tf.Tensor(0.22232117, shape=(), dtype=float32)
loss: tf.Tensor(0.2548586, shape=(), dtype=float32)
loss: tf.Tensor(0.3143737, shape=(), dtype=float32)
loss: tf.Tensor(0.3407838, shape=(), dtype=float32)
loss: tf.Tensor(0.38493058, shape=(), dtype=float32)
loss: tf.Tensor(0.21820328, shape=(), dtype=float32)
loss: tf.Tensor(0.32457173, shape=(), dtype=float32)
loss: tf.Tensor(0.25972804, shape=(), dtype=float32)
loss: tf.Tensor(0.33311966, shape=(), dtype=float32)
loss: tf.Tensor(0.28154328, shape=(), dtype=float32)
loss: tf.Tensor(0.49899998, shape=(), dtype=float32)
loss: tf.Tensor(0.16942137, shape=(), dtype=float32)
loss: tf.Tensor(0.28751233, shape=(), dtype=float32)
loss: tf.Tensor(0.28020903, shape=(), dtype=float32)
loss: tf.Tensor(0.25722083, shape=(), dtype=float32)
loss: tf.Tensor(0.3572055, shape=(), dtype=float32)
loss: tf.Tensor(0.2882613, shape=(), dtype=float32)
loss: tf.Tensor(0.18117385, shape=(), dtype=float32)
loss: tf.Tensor(0.41788188, shape=(), dtype=float32)
loss: tf.Tensor(0.38512743, shape=(), dtype=float32)
loss: tf.Tensor(0.3688605, shape=(), dtype=float32)
loss: tf.Tensor(0.27329293, shape=(), dtype=float32)
loss: tf.Tensor(0.41686067, shape=(), dtype=float32)
loss: tf.Tensor(0.381893, shape=(), dtype=float32)
loss: tf.Tensor(0.26263753, shape=(), dtype=float32)
loss: tf.Tensor(0.23484018, shape=(), dtype=float32)
loss: tf.Tensor(0.3578483, shape=(), dtype=float32)
loss: tf.Tensor(0.21569681, shape=(), dtype=float32)
loss: tf.Tensor(0.22865577, shape=(), dtype=float32)
loss: tf.Tensor(0.3038789, shape=(), dtype=float32)
loss: tf.Tensor(0.205339, shape=(), dtype=float32)
loss: tf.Tensor(0.32552505, shape=(), dtype=float32)
loss: tf.Tensor(0.2643843, shape=(), dtype=float32)
loss: tf.Tensor(0.24992986, shape=(), dtype=float32)
loss: tf.Tensor(0.36079824, shape=(), dtype=float32)
loss: tf.Tensor(0.3945002, shape=(), dtype=float32)
loss: tf.Tensor(0.29875502, shape=(), dtype=float32)
loss: tf.Tensor(0.2842839, shape=(), dtype=float32)
loss: tf.Tensor(0.27259436, shape=(), dtype=float32)
loss: tf.Tensor(0.36273822, shape=(), dtype=float32)
loss: tf.Tensor(0.26765153, shape=(), dtype=float32)
loss: tf.Tensor(0.20949304, shape=(), dtype=float32)
loss: tf.Tensor(0.3362928, shape=(), dtype=float32)
loss: tf.Tensor(0.1793841, shape=(), dtype=float32)
loss: tf.Tensor(0.20402445, shape=(), dtype=float32)
loss: tf.Tensor(0.3291105, shape=(), dtype=float32)
loss: tf.Tensor(0.37839606, shape=(), dtype=float32)
loss: tf.Tensor(0.28802863, shape=(), dtype=float32)
loss: tf.Tensor(0.2708661, shape=(), dtype=float32)
loss: tf.Tensor(0.33343494, shape=(), dtype=float32)
loss: tf.Tensor(0.28798077, shape=(), dtype=float32)
loss: tf.Tensor(0.33923677, shape=(), dtype=float32)
loss: tf.Tensor(0.329243, shape=(), dtype=float32)
loss: tf.Tensor(0.24406268, shape=(), dtype=float32)
loss: tf.Tensor(0.39398557, shape=(), dtype=float32)
loss: tf.Tensor(0.3528712, shape=(), dtype=float32)
loss: tf.Tensor(0.3261377, shape=(), dtype=float32)
loss: tf.Tensor(0.27585638, shape=(), dtype=float32)
loss: tf.Tensor(0.24724768, shape=(), dtype=float32)
loss: tf.Tensor(0.26451802, shape=(), dtype=float32)
loss: tf.Tensor(0.30231336, shape=(), dtype=float32)
loss: tf.Tensor(0.30079845, shape=(), dtype=float32)
loss: tf.Tensor(0.38954753, shape=(), dtype=float32)
loss: tf.Tensor(0.22646719, shape=(), dtype=float32)
loss: tf.Tensor(0.3148637, shape=(), dtype=float32)
loss: tf.Tensor(0.35227582, shape=(), dtype=float32)
loss: tf.Tensor(0.36853534, shape=(), dtype=float32)
loss: tf.Tensor(0.37032565, shape=(), dtype=float32)
loss: tf.Tensor(0.28306824, shape=(), dtype=float32)
loss: tf.Tensor(0.33351192, shape=(), dtype=float32)
loss: tf.Tensor(0.37586838, shape=(), dtype=float32)
loss: tf.Tensor(0.39151073, shape=(), dtype=float32)
loss: tf.Tensor(0.34143218, shape=(), dtype=float32)
loss: tf.Tensor(0.073020965, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:6 out of the last 6 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7152143, shape=(), dtype=float32)
F1 SCORE:
0.8306365
EPOCH  6 #################################
loss: tf.Tensor(0.30013224, shape=(), dtype=float32)
loss: tf.Tensor(0.22905493, shape=(), dtype=float32)
loss: tf.Tensor(0.2962365, shape=(), dtype=float32)
loss: tf.Tensor(0.25408122, shape=(), dtype=float32)
loss: tf.Tensor(0.27298355, shape=(), dtype=float32)
loss: tf.Tensor(0.31824642, shape=(), dtype=float32)
loss: tf.Tensor(0.22176512, shape=(), dtype=float32)
loss: tf.Tensor(0.22383219, shape=(), dtype=float32)
loss: tf.Tensor(0.31056988, shape=(), dtype=float32)
loss: tf.Tensor(0.29005906, shape=(), dtype=float32)
loss: tf.Tensor(0.27840224, shape=(), dtype=float32)
loss: tf.Tensor(0.3137415, shape=(), dtype=float32)
loss: tf.Tensor(0.27295697, shape=(), dtype=float32)
loss: tf.Tensor(0.26703092, shape=(), dtype=float32)
loss: tf.Tensor(0.24869627, shape=(), dtype=float32)
loss: tf.Tensor(0.31384614, shape=(), dtype=float32)
loss: tf.Tensor(0.24293832, shape=(), dtype=float32)
loss: tf.Tensor(0.29352486, shape=(), dtype=float32)
loss: tf.Tensor(0.29410055, shape=(), dtype=float32)
loss: tf.Tensor(0.2894515, shape=(), dtype=float32)
loss: tf.Tensor(0.30552274, shape=(), dtype=float32)
loss: tf.Tensor(0.2652626, shape=(), dtype=float32)
loss: tf.Tensor(0.26661396, shape=(), dtype=float32)
loss: tf.Tensor(0.2858491, shape=(), dtype=float32)
loss: tf.Tensor(0.30341586, shape=(), dtype=float32)
loss: tf.Tensor(0.26926124, shape=(), dtype=float32)
loss: tf.Tensor(0.32348752, shape=(), dtype=float32)
loss: tf.Tensor(0.2062812, shape=(), dtype=float32)
loss: tf.Tensor(0.2381803, shape=(), dtype=float32)
loss: tf.Tensor(0.17192607, shape=(), dtype=float32)
loss: tf.Tensor(0.26884973, shape=(), dtype=float32)
loss: tf.Tensor(0.3420136, shape=(), dtype=float32)
loss: tf.Tensor(0.3136117, shape=(), dtype=float32)
loss: tf.Tensor(0.28685033, shape=(), dtype=float32)
loss: tf.Tensor(0.2501843, shape=(), dtype=float32)
loss: tf.Tensor(0.29674977, shape=(), dtype=float32)
loss: tf.Tensor(0.33030048, shape=(), dtype=float32)
loss: tf.Tensor(0.3191903, shape=(), dtype=float32)
loss: tf.Tensor(0.31115985, shape=(), dtype=float32)
loss: tf.Tensor(0.38239327, shape=(), dtype=float32)
loss: tf.Tensor(0.27137294, shape=(), dtype=float32)
loss: tf.Tensor(0.36058968, shape=(), dtype=float32)
loss: tf.Tensor(0.32734412, shape=(), dtype=float32)
loss: tf.Tensor(0.28566658, shape=(), dtype=float32)
loss: tf.Tensor(0.3791639, shape=(), dtype=float32)
loss: tf.Tensor(0.28502885, shape=(), dtype=float32)
loss: tf.Tensor(0.27527145, shape=(), dtype=float32)
loss: tf.Tensor(0.33532318, shape=(), dtype=float32)
loss: tf.Tensor(0.29439247, shape=(), dtype=float32)
loss: tf.Tensor(0.29248622, shape=(), dtype=float32)
loss: tf.Tensor(0.3278611, shape=(), dtype=float32)
loss: tf.Tensor(0.39647925, shape=(), dtype=float32)
loss: tf.Tensor(0.37572873, shape=(), dtype=float32)
loss: tf.Tensor(0.13597085, shape=(), dtype=float32)
loss: tf.Tensor(0.38676703, shape=(), dtype=float32)
loss: tf.Tensor(0.28531432, shape=(), dtype=float32)
loss: tf.Tensor(0.22571509, shape=(), dtype=float32)
loss: tf.Tensor(0.3077777, shape=(), dtype=float32)
loss: tf.Tensor(0.24233164, shape=(), dtype=float32)
loss: tf.Tensor(0.33147445, shape=(), dtype=float32)
loss: tf.Tensor(0.3439164, shape=(), dtype=float32)
loss: tf.Tensor(0.32836986, shape=(), dtype=float32)
loss: tf.Tensor(0.39521885, shape=(), dtype=float32)
loss: tf.Tensor(0.17010984, shape=(), dtype=float32)
loss: tf.Tensor(0.24600376, shape=(), dtype=float32)
loss: tf.Tensor(0.18107334, shape=(), dtype=float32)
loss: tf.Tensor(0.29909253, shape=(), dtype=float32)
loss: tf.Tensor(0.32939044, shape=(), dtype=float32)
loss: tf.Tensor(0.2967191, shape=(), dtype=float32)
loss: tf.Tensor(0.29582578, shape=(), dtype=float32)
loss: tf.Tensor(0.2792895, shape=(), dtype=float32)
loss: tf.Tensor(0.29790676, shape=(), dtype=float32)
loss: tf.Tensor(0.24595587, shape=(), dtype=float32)
loss: tf.Tensor(0.7011981, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:7 out of the last 7 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7091269, shape=(), dtype=float32)
F1 SCORE:
0.8304258
EPOCH  7 #################################
loss: tf.Tensor(0.34925893, shape=(), dtype=float32)
loss: tf.Tensor(0.45510465, shape=(), dtype=float32)
loss: tf.Tensor(0.4133148, shape=(), dtype=float32)
loss: tf.Tensor(0.5254373, shape=(), dtype=float32)
loss: tf.Tensor(0.30558962, shape=(), dtype=float32)
loss: tf.Tensor(0.29442072, shape=(), dtype=float32)
loss: tf.Tensor(0.34762028, shape=(), dtype=float32)
loss: tf.Tensor(0.2599637, shape=(), dtype=float32)
loss: tf.Tensor(0.2822666, shape=(), dtype=float32)
loss: tf.Tensor(0.37330085, shape=(), dtype=float32)
loss: tf.Tensor(0.37781718, shape=(), dtype=float32)
loss: tf.Tensor(0.44332713, shape=(), dtype=float32)
loss: tf.Tensor(0.37627435, shape=(), dtype=float32)
loss: tf.Tensor(0.28695, shape=(), dtype=float32)
loss: tf.Tensor(0.29197228, shape=(), dtype=float32)
loss: tf.Tensor(0.27753744, shape=(), dtype=float32)
loss: tf.Tensor(0.28634205, shape=(), dtype=float32)
loss: tf.Tensor(0.35472792, shape=(), dtype=float32)
loss: tf.Tensor(0.3473191, shape=(), dtype=float32)
loss: tf.Tensor(0.2803806, shape=(), dtype=float32)
loss: tf.Tensor(0.30240017, shape=(), dtype=float32)
loss: tf.Tensor(0.3955126, shape=(), dtype=float32)
loss: tf.Tensor(0.35682252, shape=(), dtype=float32)
loss: tf.Tensor(0.30147025, shape=(), dtype=float32)
loss: tf.Tensor(0.3020409, shape=(), dtype=float32)
loss: tf.Tensor(0.3550154, shape=(), dtype=float32)
loss: tf.Tensor(0.2719633, shape=(), dtype=float32)
loss: tf.Tensor(0.23757377, shape=(), dtype=float32)
loss: tf.Tensor(0.17916991, shape=(), dtype=float32)
loss: tf.Tensor(0.3312358, shape=(), dtype=float32)
loss: tf.Tensor(0.24169992, shape=(), dtype=float32)
loss: tf.Tensor(0.2362055, shape=(), dtype=float32)
loss: tf.Tensor(0.29837346, shape=(), dtype=float32)
loss: tf.Tensor(0.3485072, shape=(), dtype=float32)
loss: tf.Tensor(0.3440952, shape=(), dtype=float32)
loss: tf.Tensor(0.37097445, shape=(), dtype=float32)
loss: tf.Tensor(0.28312948, shape=(), dtype=float32)
loss: tf.Tensor(0.2510746, shape=(), dtype=float32)
loss: tf.Tensor(0.22792374, shape=(), dtype=float32)
loss: tf.Tensor(0.15090972, shape=(), dtype=float32)
loss: tf.Tensor(0.32017314, shape=(), dtype=float32)
loss: tf.Tensor(0.28383446, shape=(), dtype=float32)
loss: tf.Tensor(0.20744656, shape=(), dtype=float32)
loss: tf.Tensor(0.4752028, shape=(), dtype=float32)
loss: tf.Tensor(0.37196538, shape=(), dtype=float32)
loss: tf.Tensor(0.28272578, shape=(), dtype=float32)
loss: tf.Tensor(0.18930279, shape=(), dtype=float32)
loss: tf.Tensor(0.33731776, shape=(), dtype=float32)
loss: tf.Tensor(0.22625917, shape=(), dtype=float32)
loss: tf.Tensor(0.25617096, shape=(), dtype=float32)
loss: tf.Tensor(0.17950043, shape=(), dtype=float32)
loss: tf.Tensor(0.2470524, shape=(), dtype=float32)
loss: tf.Tensor(0.24363165, shape=(), dtype=float32)
loss: tf.Tensor(0.26457098, shape=(), dtype=float32)
loss: tf.Tensor(0.21692714, shape=(), dtype=float32)
loss: tf.Tensor(0.28980124, shape=(), dtype=float32)
loss: tf.Tensor(0.32171988, shape=(), dtype=float32)
loss: tf.Tensor(0.22059372, shape=(), dtype=float32)
loss: tf.Tensor(0.17908697, shape=(), dtype=float32)
loss: tf.Tensor(0.2819855, shape=(), dtype=float32)
loss: tf.Tensor(0.34399998, shape=(), dtype=float32)
loss: tf.Tensor(0.30538267, shape=(), dtype=float32)
loss: tf.Tensor(0.3274889, shape=(), dtype=float32)
loss: tf.Tensor(0.25561965, shape=(), dtype=float32)
loss: tf.Tensor(0.23880486, shape=(), dtype=float32)
loss: tf.Tensor(0.35953835, shape=(), dtype=float32)
loss: tf.Tensor(0.25551704, shape=(), dtype=float32)
loss: tf.Tensor(0.20589828, shape=(), dtype=float32)
loss: tf.Tensor(0.32051018, shape=(), dtype=float32)
loss: tf.Tensor(0.26943532, shape=(), dtype=float32)
loss: tf.Tensor(0.34134856, shape=(), dtype=float32)
loss: tf.Tensor(0.23952308, shape=(), dtype=float32)
loss: tf.Tensor(0.29909742, shape=(), dtype=float32)
loss: tf.Tensor(0.24746785, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:8 out of the last 8 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.696213, shape=(), dtype=float32)
F1 SCORE:
0.83189774
EPOCH  8 #################################
loss: tf.Tensor(0.18363965, shape=(), dtype=float32)
loss: tf.Tensor(0.23044139, shape=(), dtype=float32)
loss: tf.Tensor(0.2685505, shape=(), dtype=float32)
loss: tf.Tensor(0.4110267, shape=(), dtype=float32)
loss: tf.Tensor(0.28730232, shape=(), dtype=float32)
loss: tf.Tensor(0.24900484, shape=(), dtype=float32)
loss: tf.Tensor(0.19422628, shape=(), dtype=float32)
loss: tf.Tensor(0.29067785, shape=(), dtype=float32)
loss: tf.Tensor(0.24481544, shape=(), dtype=float32)
loss: tf.Tensor(0.16723748, shape=(), dtype=float32)
loss: tf.Tensor(0.31135288, shape=(), dtype=float32)
loss: tf.Tensor(0.13948002, shape=(), dtype=float32)
loss: tf.Tensor(0.2427255, shape=(), dtype=float32)
loss: tf.Tensor(0.22600837, shape=(), dtype=float32)
loss: tf.Tensor(0.25588012, shape=(), dtype=float32)
loss: tf.Tensor(0.28169835, shape=(), dtype=float32)
loss: tf.Tensor(0.19873255, shape=(), dtype=float32)
loss: tf.Tensor(0.37673473, shape=(), dtype=float32)
loss: tf.Tensor(0.23377664, shape=(), dtype=float32)
loss: tf.Tensor(0.30686045, shape=(), dtype=float32)
loss: tf.Tensor(0.22883159, shape=(), dtype=float32)
loss: tf.Tensor(0.27303392, shape=(), dtype=float32)
loss: tf.Tensor(0.28389648, shape=(), dtype=float32)
loss: tf.Tensor(0.3477802, shape=(), dtype=float32)
loss: tf.Tensor(0.30478135, shape=(), dtype=float32)
loss: tf.Tensor(0.2565363, shape=(), dtype=float32)
loss: tf.Tensor(0.3073434, shape=(), dtype=float32)
loss: tf.Tensor(0.27472764, shape=(), dtype=float32)
loss: tf.Tensor(0.30194876, shape=(), dtype=float32)
loss: tf.Tensor(0.44780532, shape=(), dtype=float32)
loss: tf.Tensor(0.37756848, shape=(), dtype=float32)
loss: tf.Tensor(0.2381452, shape=(), dtype=float32)
loss: tf.Tensor(0.17905779, shape=(), dtype=float32)
loss: tf.Tensor(0.242446, shape=(), dtype=float32)
loss: tf.Tensor(0.31984413, shape=(), dtype=float32)
loss: tf.Tensor(0.22159564, shape=(), dtype=float32)
loss: tf.Tensor(0.31470728, shape=(), dtype=float32)
loss: tf.Tensor(0.25722593, shape=(), dtype=float32)
loss: tf.Tensor(0.260087, shape=(), dtype=float32)
loss: tf.Tensor(0.27542597, shape=(), dtype=float32)
loss: tf.Tensor(0.28417256, shape=(), dtype=float32)
loss: tf.Tensor(0.30907717, shape=(), dtype=float32)
loss: tf.Tensor(0.25345954, shape=(), dtype=float32)
loss: tf.Tensor(0.20875789, shape=(), dtype=float32)
loss: tf.Tensor(0.3059037, shape=(), dtype=float32)
loss: tf.Tensor(0.24313816, shape=(), dtype=float32)
loss: tf.Tensor(0.19199738, shape=(), dtype=float32)
loss: tf.Tensor(0.3321934, shape=(), dtype=float32)
loss: tf.Tensor(0.28294328, shape=(), dtype=float32)
loss: tf.Tensor(0.2530851, shape=(), dtype=float32)
loss: tf.Tensor(0.39373782, shape=(), dtype=float32)
loss: tf.Tensor(0.28524578, shape=(), dtype=float32)
loss: tf.Tensor(0.32344255, shape=(), dtype=float32)
loss: tf.Tensor(0.2574389, shape=(), dtype=float32)
loss: tf.Tensor(0.22652249, shape=(), dtype=float32)
loss: tf.Tensor(0.22794825, shape=(), dtype=float32)
loss: tf.Tensor(0.16854826, shape=(), dtype=float32)
loss: tf.Tensor(0.26880267, shape=(), dtype=float32)
loss: tf.Tensor(0.18506652, shape=(), dtype=float32)
loss: tf.Tensor(0.26721573, shape=(), dtype=float32)
loss: tf.Tensor(0.26057056, shape=(), dtype=float32)
loss: tf.Tensor(0.19524466, shape=(), dtype=float32)
loss: tf.Tensor(0.27765024, shape=(), dtype=float32)
loss: tf.Tensor(0.32176968, shape=(), dtype=float32)
loss: tf.Tensor(0.3414605, shape=(), dtype=float32)
loss: tf.Tensor(0.34379914, shape=(), dtype=float32)
loss: tf.Tensor(0.38059455, shape=(), dtype=float32)
loss: tf.Tensor(0.33335876, shape=(), dtype=float32)
loss: tf.Tensor(0.27721366, shape=(), dtype=float32)
loss: tf.Tensor(0.22809832, shape=(), dtype=float32)
loss: tf.Tensor(0.41210797, shape=(), dtype=float32)
loss: tf.Tensor(0.29096195, shape=(), dtype=float32)
loss: tf.Tensor(0.14741251, shape=(), dtype=float32)
loss: tf.Tensor(0.011026874, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:9 out of the last 9 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7120344, shape=(), dtype=float32)
F1 SCORE:
0.8323431
EPOCH  9 #################################
loss: tf.Tensor(0.21930435, shape=(), dtype=float32)
loss: tf.Tensor(0.18061979, shape=(), dtype=float32)
loss: tf.Tensor(0.19995701, shape=(), dtype=float32)
loss: tf.Tensor(0.24665214, shape=(), dtype=float32)
loss: tf.Tensor(0.20379181, shape=(), dtype=float32)
loss: tf.Tensor(0.176636, shape=(), dtype=float32)
loss: tf.Tensor(0.24235359, shape=(), dtype=float32)
loss: tf.Tensor(0.2510965, shape=(), dtype=float32)
loss: tf.Tensor(0.26107702, shape=(), dtype=float32)
loss: tf.Tensor(0.18182822, shape=(), dtype=float32)
loss: tf.Tensor(0.21588854, shape=(), dtype=float32)
loss: tf.Tensor(0.16461197, shape=(), dtype=float32)
loss: tf.Tensor(0.27304745, shape=(), dtype=float32)
loss: tf.Tensor(0.22243561, shape=(), dtype=float32)
loss: tf.Tensor(0.3474205, shape=(), dtype=float32)
loss: tf.Tensor(0.25770834, shape=(), dtype=float32)
loss: tf.Tensor(0.10745301, shape=(), dtype=float32)
loss: tf.Tensor(0.28608647, shape=(), dtype=float32)
loss: tf.Tensor(0.25945014, shape=(), dtype=float32)
loss: tf.Tensor(0.17477341, shape=(), dtype=float32)
loss: tf.Tensor(0.26460537, shape=(), dtype=float32)
loss: tf.Tensor(0.29446775, shape=(), dtype=float32)
loss: tf.Tensor(0.22166763, shape=(), dtype=float32)
loss: tf.Tensor(0.18326148, shape=(), dtype=float32)
loss: tf.Tensor(0.24520451, shape=(), dtype=float32)
loss: tf.Tensor(0.25589797, shape=(), dtype=float32)
loss: tf.Tensor(0.24080029, shape=(), dtype=float32)
loss: tf.Tensor(0.14147562, shape=(), dtype=float32)
loss: tf.Tensor(0.32679904, shape=(), dtype=float32)
loss: tf.Tensor(0.21639502, shape=(), dtype=float32)
loss: tf.Tensor(0.26173136, shape=(), dtype=float32)
loss: tf.Tensor(0.23182657, shape=(), dtype=float32)
loss: tf.Tensor(0.08906187, shape=(), dtype=float32)
loss: tf.Tensor(0.17347215, shape=(), dtype=float32)
loss: tf.Tensor(0.14349118, shape=(), dtype=float32)
loss: tf.Tensor(0.20248348, shape=(), dtype=float32)
loss: tf.Tensor(0.3504343, shape=(), dtype=float32)
loss: tf.Tensor(0.32312804, shape=(), dtype=float32)
loss: tf.Tensor(0.18732448, shape=(), dtype=float32)
loss: tf.Tensor(0.24566336, shape=(), dtype=float32)
loss: tf.Tensor(0.20468895, shape=(), dtype=float32)
loss: tf.Tensor(0.1217885, shape=(), dtype=float32)
loss: tf.Tensor(0.19937418, shape=(), dtype=float32)
loss: tf.Tensor(0.21958445, shape=(), dtype=float32)
loss: tf.Tensor(0.3472205, shape=(), dtype=float32)
loss: tf.Tensor(0.27277172, shape=(), dtype=float32)
loss: tf.Tensor(0.22568421, shape=(), dtype=float32)
loss: tf.Tensor(0.2591951, shape=(), dtype=float32)
loss: tf.Tensor(0.10629423, shape=(), dtype=float32)
loss: tf.Tensor(0.24962816, shape=(), dtype=float32)
loss: tf.Tensor(0.31827542, shape=(), dtype=float32)
loss: tf.Tensor(0.2640003, shape=(), dtype=float32)
loss: tf.Tensor(0.17472915, shape=(), dtype=float32)
loss: tf.Tensor(0.41332966, shape=(), dtype=float32)
loss: tf.Tensor(0.16252033, shape=(), dtype=float32)
loss: tf.Tensor(0.20974924, shape=(), dtype=float32)
loss: tf.Tensor(0.25248435, shape=(), dtype=float32)
loss: tf.Tensor(0.18975726, shape=(), dtype=float32)
loss: tf.Tensor(0.3182763, shape=(), dtype=float32)
loss: tf.Tensor(0.21790516, shape=(), dtype=float32)
loss: tf.Tensor(0.30308032, shape=(), dtype=float32)
loss: tf.Tensor(0.26980335, shape=(), dtype=float32)
loss: tf.Tensor(0.35854244, shape=(), dtype=float32)
loss: tf.Tensor(0.2643621, shape=(), dtype=float32)
loss: tf.Tensor(0.23718253, shape=(), dtype=float32)
loss: tf.Tensor(0.27364302, shape=(), dtype=float32)
loss: tf.Tensor(0.3096239, shape=(), dtype=float32)
loss: tf.Tensor(0.3332679, shape=(), dtype=float32)
loss: tf.Tensor(0.23708256, shape=(), dtype=float32)
loss: tf.Tensor(0.23559304, shape=(), dtype=float32)
loss: tf.Tensor(0.15480793, shape=(), dtype=float32)
loss: tf.Tensor(0.17893356, shape=(), dtype=float32)
loss: tf.Tensor(0.22064033, shape=(), dtype=float32)
loss: tf.Tensor(0.0012506767, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:10 out of the last 10 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71451175, shape=(), dtype=float32)
F1 SCORE:
0.830597
EPOCH  10 #################################
loss: tf.Tensor(0.18637004, shape=(), dtype=float32)
loss: tf.Tensor(0.288365, shape=(), dtype=float32)
loss: tf.Tensor(0.27205065, shape=(), dtype=float32)
loss: tf.Tensor(0.25011694, shape=(), dtype=float32)
loss: tf.Tensor(0.18606192, shape=(), dtype=float32)
loss: tf.Tensor(0.14353845, shape=(), dtype=float32)
loss: tf.Tensor(0.21249636, shape=(), dtype=float32)
loss: tf.Tensor(0.2854266, shape=(), dtype=float32)
loss: tf.Tensor(0.29725048, shape=(), dtype=float32)
loss: tf.Tensor(0.26212502, shape=(), dtype=float32)
loss: tf.Tensor(0.19786039, shape=(), dtype=float32)
loss: tf.Tensor(0.21856806, shape=(), dtype=float32)
loss: tf.Tensor(0.19608888, shape=(), dtype=float32)
loss: tf.Tensor(0.16458325, shape=(), dtype=float32)
loss: tf.Tensor(0.19082603, shape=(), dtype=float32)
loss: tf.Tensor(0.2948221, shape=(), dtype=float32)
loss: tf.Tensor(0.30760065, shape=(), dtype=float32)
loss: tf.Tensor(0.11275701, shape=(), dtype=float32)
loss: tf.Tensor(0.18185472, shape=(), dtype=float32)
loss: tf.Tensor(0.21765432, shape=(), dtype=float32)
loss: tf.Tensor(0.19926144, shape=(), dtype=float32)
loss: tf.Tensor(0.27087563, shape=(), dtype=float32)
loss: tf.Tensor(0.13269052, shape=(), dtype=float32)
loss: tf.Tensor(0.17070356, shape=(), dtype=float32)
loss: tf.Tensor(0.25271308, shape=(), dtype=float32)
loss: tf.Tensor(0.21759246, shape=(), dtype=float32)
loss: tf.Tensor(0.14985447, shape=(), dtype=float32)
loss: tf.Tensor(0.14621614, shape=(), dtype=float32)
loss: tf.Tensor(0.27129185, shape=(), dtype=float32)
loss: tf.Tensor(0.1978388, shape=(), dtype=float32)
loss: tf.Tensor(0.20460278, shape=(), dtype=float32)
loss: tf.Tensor(0.3524197, shape=(), dtype=float32)
loss: tf.Tensor(0.13634172, shape=(), dtype=float32)
loss: tf.Tensor(0.20511451, shape=(), dtype=float32)
loss: tf.Tensor(0.22241537, shape=(), dtype=float32)
loss: tf.Tensor(0.2049085, shape=(), dtype=float32)
loss: tf.Tensor(0.2184368, shape=(), dtype=float32)
loss: tf.Tensor(0.16385446, shape=(), dtype=float32)
loss: tf.Tensor(0.28605866, shape=(), dtype=float32)
loss: tf.Tensor(0.20533825, shape=(), dtype=float32)
loss: tf.Tensor(0.2752273, shape=(), dtype=float32)
loss: tf.Tensor(0.22877596, shape=(), dtype=float32)
loss: tf.Tensor(0.20117408, shape=(), dtype=float32)
loss: tf.Tensor(0.3124138, shape=(), dtype=float32)
loss: tf.Tensor(0.25248176, shape=(), dtype=float32)
loss: tf.Tensor(0.22153977, shape=(), dtype=float32)
loss: tf.Tensor(0.23227496, shape=(), dtype=float32)
loss: tf.Tensor(0.29319918, shape=(), dtype=float32)
loss: tf.Tensor(0.24520683, shape=(), dtype=float32)
loss: tf.Tensor(0.21217857, shape=(), dtype=float32)
loss: tf.Tensor(0.1693595, shape=(), dtype=float32)
loss: tf.Tensor(0.26660973, shape=(), dtype=float32)
loss: tf.Tensor(0.23379707, shape=(), dtype=float32)
loss: tf.Tensor(0.16888918, shape=(), dtype=float32)
loss: tf.Tensor(0.20667852, shape=(), dtype=float32)
loss: tf.Tensor(0.17735161, shape=(), dtype=float32)
loss: tf.Tensor(0.24815765, shape=(), dtype=float32)
loss: tf.Tensor(0.2947233, shape=(), dtype=float32)
loss: tf.Tensor(0.24701874, shape=(), dtype=float32)
loss: tf.Tensor(0.19509493, shape=(), dtype=float32)
loss: tf.Tensor(0.21701841, shape=(), dtype=float32)
loss: tf.Tensor(0.21656567, shape=(), dtype=float32)
loss: tf.Tensor(0.29923645, shape=(), dtype=float32)
loss: tf.Tensor(0.29452404, shape=(), dtype=float32)
loss: tf.Tensor(0.30579183, shape=(), dtype=float32)
loss: tf.Tensor(0.1605736, shape=(), dtype=float32)
loss: tf.Tensor(0.29821146, shape=(), dtype=float32)
loss: tf.Tensor(0.19243854, shape=(), dtype=float32)
loss: tf.Tensor(0.17932962, shape=(), dtype=float32)
loss: tf.Tensor(0.19769228, shape=(), dtype=float32)
loss: tf.Tensor(0.31500936, shape=(), dtype=float32)
loss: tf.Tensor(0.1390281, shape=(), dtype=float32)
loss: tf.Tensor(0.21142626, shape=(), dtype=float32)
loss: tf.Tensor(0.012105096, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70177114, shape=(), dtype=float32)
F1 SCORE:
0.83164436
EPOCH  11 #################################
loss: tf.Tensor(0.2352966, shape=(), dtype=float32)
loss: tf.Tensor(0.24835686, shape=(), dtype=float32)
loss: tf.Tensor(0.21984273, shape=(), dtype=float32)
loss: tf.Tensor(0.21065213, shape=(), dtype=float32)
loss: tf.Tensor(0.28391606, shape=(), dtype=float32)
loss: tf.Tensor(0.19343035, shape=(), dtype=float32)
loss: tf.Tensor(0.18798454, shape=(), dtype=float32)
loss: tf.Tensor(0.1912159, shape=(), dtype=float32)
loss: tf.Tensor(0.22456525, shape=(), dtype=float32)
loss: tf.Tensor(0.21357575, shape=(), dtype=float32)
loss: tf.Tensor(0.28486145, shape=(), dtype=float32)
loss: tf.Tensor(0.21080312, shape=(), dtype=float32)
loss: tf.Tensor(0.23963842, shape=(), dtype=float32)
loss: tf.Tensor(0.111386105, shape=(), dtype=float32)
loss: tf.Tensor(0.13615912, shape=(), dtype=float32)
loss: tf.Tensor(0.31098217, shape=(), dtype=float32)
loss: tf.Tensor(0.35416588, shape=(), dtype=float32)
loss: tf.Tensor(0.14517865, shape=(), dtype=float32)
loss: tf.Tensor(0.2203462, shape=(), dtype=float32)
loss: tf.Tensor(0.17315893, shape=(), dtype=float32)
loss: tf.Tensor(0.15398778, shape=(), dtype=float32)
loss: tf.Tensor(0.12613837, shape=(), dtype=float32)
loss: tf.Tensor(0.18700999, shape=(), dtype=float32)
loss: tf.Tensor(0.23612219, shape=(), dtype=float32)
loss: tf.Tensor(0.06740984, shape=(), dtype=float32)
loss: tf.Tensor(0.17015368, shape=(), dtype=float32)
loss: tf.Tensor(0.24795008, shape=(), dtype=float32)
loss: tf.Tensor(0.16809046, shape=(), dtype=float32)
loss: tf.Tensor(0.16361932, shape=(), dtype=float32)
loss: tf.Tensor(0.22998442, shape=(), dtype=float32)
loss: tf.Tensor(0.18422577, shape=(), dtype=float32)
loss: tf.Tensor(0.1350487, shape=(), dtype=float32)
loss: tf.Tensor(0.17342447, shape=(), dtype=float32)
loss: tf.Tensor(0.18074317, shape=(), dtype=float32)
loss: tf.Tensor(0.20017748, shape=(), dtype=float32)
loss: tf.Tensor(0.103133544, shape=(), dtype=float32)
loss: tf.Tensor(0.16534337, shape=(), dtype=float32)
loss: tf.Tensor(0.22404501, shape=(), dtype=float32)
loss: tf.Tensor(0.21658093, shape=(), dtype=float32)
loss: tf.Tensor(0.29021695, shape=(), dtype=float32)
loss: tf.Tensor(0.22377162, shape=(), dtype=float32)
loss: tf.Tensor(0.23528771, shape=(), dtype=float32)
loss: tf.Tensor(0.22087541, shape=(), dtype=float32)
loss: tf.Tensor(0.22546461, shape=(), dtype=float32)
loss: tf.Tensor(0.29827613, shape=(), dtype=float32)
loss: tf.Tensor(0.22871359, shape=(), dtype=float32)
loss: tf.Tensor(0.20308591, shape=(), dtype=float32)
loss: tf.Tensor(0.2507114, shape=(), dtype=float32)
loss: tf.Tensor(0.15104929, shape=(), dtype=float32)
loss: tf.Tensor(0.13073981, shape=(), dtype=float32)
loss: tf.Tensor(0.19529827, shape=(), dtype=float32)
loss: tf.Tensor(0.31622338, shape=(), dtype=float32)
loss: tf.Tensor(0.29851484, shape=(), dtype=float32)
loss: tf.Tensor(0.15000242, shape=(), dtype=float32)
loss: tf.Tensor(0.17339191, shape=(), dtype=float32)
loss: tf.Tensor(0.14863989, shape=(), dtype=float32)
loss: tf.Tensor(0.13668437, shape=(), dtype=float32)
loss: tf.Tensor(0.18137684, shape=(), dtype=float32)
loss: tf.Tensor(0.22053598, shape=(), dtype=float32)
loss: tf.Tensor(0.21485119, shape=(), dtype=float32)
loss: tf.Tensor(0.16573273, shape=(), dtype=float32)
loss: tf.Tensor(0.21477357, shape=(), dtype=float32)
loss: tf.Tensor(0.1481322, shape=(), dtype=float32)
loss: tf.Tensor(0.3360021, shape=(), dtype=float32)
loss: tf.Tensor(0.32193807, shape=(), dtype=float32)
loss: tf.Tensor(0.17811006, shape=(), dtype=float32)
loss: tf.Tensor(0.15572852, shape=(), dtype=float32)
loss: tf.Tensor(0.26145226, shape=(), dtype=float32)
loss: tf.Tensor(0.15521294, shape=(), dtype=float32)
loss: tf.Tensor(0.33664426, shape=(), dtype=float32)
loss: tf.Tensor(0.28707987, shape=(), dtype=float32)
loss: tf.Tensor(0.13039365, shape=(), dtype=float32)
loss: tf.Tensor(0.17657118, shape=(), dtype=float32)
loss: tf.Tensor(0.071440496, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6959548, shape=(), dtype=float32)
F1 SCORE:
0.832251
EPOCH  12 #################################
loss: tf.Tensor(0.18626492, shape=(), dtype=float32)
loss: tf.Tensor(0.25246385, shape=(), dtype=float32)
loss: tf.Tensor(0.1060219, shape=(), dtype=float32)
loss: tf.Tensor(0.13446778, shape=(), dtype=float32)
loss: tf.Tensor(0.21026178, shape=(), dtype=float32)
loss: tf.Tensor(0.26367673, shape=(), dtype=float32)
loss: tf.Tensor(0.25828236, shape=(), dtype=float32)
loss: tf.Tensor(0.16217571, shape=(), dtype=float32)
loss: tf.Tensor(0.20094806, shape=(), dtype=float32)
loss: tf.Tensor(0.23664719, shape=(), dtype=float32)
loss: tf.Tensor(0.15659791, shape=(), dtype=float32)
loss: tf.Tensor(0.17260626, shape=(), dtype=float32)
loss: tf.Tensor(0.21829231, shape=(), dtype=float32)
loss: tf.Tensor(0.076782584, shape=(), dtype=float32)
loss: tf.Tensor(0.21988568, shape=(), dtype=float32)
loss: tf.Tensor(0.07789272, shape=(), dtype=float32)
loss: tf.Tensor(0.29319385, shape=(), dtype=float32)
loss: tf.Tensor(0.12878351, shape=(), dtype=float32)
loss: tf.Tensor(0.17555752, shape=(), dtype=float32)
loss: tf.Tensor(0.19363607, shape=(), dtype=float32)
loss: tf.Tensor(0.25840154, shape=(), dtype=float32)
loss: tf.Tensor(0.1214847, shape=(), dtype=float32)
loss: tf.Tensor(0.2391294, shape=(), dtype=float32)
loss: tf.Tensor(0.17733297, shape=(), dtype=float32)
loss: tf.Tensor(0.07514854, shape=(), dtype=float32)
loss: tf.Tensor(0.24235372, shape=(), dtype=float32)
loss: tf.Tensor(0.15434016, shape=(), dtype=float32)
loss: tf.Tensor(0.26690874, shape=(), dtype=float32)
loss: tf.Tensor(0.31601763, shape=(), dtype=float32)
loss: tf.Tensor(0.12971011, shape=(), dtype=float32)
loss: tf.Tensor(0.23797329, shape=(), dtype=float32)
loss: tf.Tensor(0.20641656, shape=(), dtype=float32)
loss: tf.Tensor(0.13308269, shape=(), dtype=float32)
loss: tf.Tensor(0.29128596, shape=(), dtype=float32)
loss: tf.Tensor(0.21280213, shape=(), dtype=float32)
loss: tf.Tensor(0.14339255, shape=(), dtype=float32)
loss: tf.Tensor(0.28844976, shape=(), dtype=float32)
loss: tf.Tensor(0.19265531, shape=(), dtype=float32)
loss: tf.Tensor(0.1522737, shape=(), dtype=float32)
loss: tf.Tensor(0.28315845, shape=(), dtype=float32)
loss: tf.Tensor(0.11867211, shape=(), dtype=float32)
loss: tf.Tensor(0.13724402, shape=(), dtype=float32)
loss: tf.Tensor(0.19762737, shape=(), dtype=float32)
loss: tf.Tensor(0.22905692, shape=(), dtype=float32)
loss: tf.Tensor(0.18872066, shape=(), dtype=float32)
loss: tf.Tensor(0.22339205, shape=(), dtype=float32)
loss: tf.Tensor(0.130931, shape=(), dtype=float32)
loss: tf.Tensor(0.099454135, shape=(), dtype=float32)
loss: tf.Tensor(0.13483982, shape=(), dtype=float32)
loss: tf.Tensor(0.22998373, shape=(), dtype=float32)
loss: tf.Tensor(0.116224416, shape=(), dtype=float32)
loss: tf.Tensor(0.16349998, shape=(), dtype=float32)
loss: tf.Tensor(0.24331778, shape=(), dtype=float32)
loss: tf.Tensor(0.14743787, shape=(), dtype=float32)
loss: tf.Tensor(0.20900752, shape=(), dtype=float32)
loss: tf.Tensor(0.18927553, shape=(), dtype=float32)
loss: tf.Tensor(0.190905, shape=(), dtype=float32)
loss: tf.Tensor(0.34591308, shape=(), dtype=float32)
loss: tf.Tensor(0.20126274, shape=(), dtype=float32)
loss: tf.Tensor(0.3510458, shape=(), dtype=float32)
loss: tf.Tensor(0.17144454, shape=(), dtype=float32)
loss: tf.Tensor(0.18108205, shape=(), dtype=float32)
loss: tf.Tensor(0.084693596, shape=(), dtype=float32)
loss: tf.Tensor(0.23308562, shape=(), dtype=float32)
loss: tf.Tensor(0.0897822, shape=(), dtype=float32)
loss: tf.Tensor(0.15868115, shape=(), dtype=float32)
loss: tf.Tensor(0.16289736, shape=(), dtype=float32)
loss: tf.Tensor(0.215652, shape=(), dtype=float32)
loss: tf.Tensor(0.1932234, shape=(), dtype=float32)
loss: tf.Tensor(0.24439614, shape=(), dtype=float32)
loss: tf.Tensor(0.15605396, shape=(), dtype=float32)
loss: tf.Tensor(0.14854243, shape=(), dtype=float32)
loss: tf.Tensor(0.15822436, shape=(), dtype=float32)
loss: tf.Tensor(0.0010164577, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7104215, shape=(), dtype=float32)
F1 SCORE:
0.831352
EPOCH  13 #################################
loss: tf.Tensor(0.3035894, shape=(), dtype=float32)
loss: tf.Tensor(0.1313762, shape=(), dtype=float32)
loss: tf.Tensor(0.118794225, shape=(), dtype=float32)
loss: tf.Tensor(0.10967814, shape=(), dtype=float32)
loss: tf.Tensor(0.20095389, shape=(), dtype=float32)
loss: tf.Tensor(0.20348595, shape=(), dtype=float32)
loss: tf.Tensor(0.17104226, shape=(), dtype=float32)
loss: tf.Tensor(0.09328517, shape=(), dtype=float32)
loss: tf.Tensor(0.11153193, shape=(), dtype=float32)
loss: tf.Tensor(0.28216735, shape=(), dtype=float32)
loss: tf.Tensor(0.1512346, shape=(), dtype=float32)
loss: tf.Tensor(0.117110245, shape=(), dtype=float32)
loss: tf.Tensor(0.22736609, shape=(), dtype=float32)
loss: tf.Tensor(0.15292366, shape=(), dtype=float32)
loss: tf.Tensor(0.16633421, shape=(), dtype=float32)
loss: tf.Tensor(0.1622262, shape=(), dtype=float32)
loss: tf.Tensor(0.1095674, shape=(), dtype=float32)
loss: tf.Tensor(0.1537982, shape=(), dtype=float32)
loss: tf.Tensor(0.16013336, shape=(), dtype=float32)
loss: tf.Tensor(0.14494863, shape=(), dtype=float32)
loss: tf.Tensor(0.077491604, shape=(), dtype=float32)
loss: tf.Tensor(0.28726214, shape=(), dtype=float32)
loss: tf.Tensor(0.15154077, shape=(), dtype=float32)
loss: tf.Tensor(0.12870105, shape=(), dtype=float32)
loss: tf.Tensor(0.09098687, shape=(), dtype=float32)
loss: tf.Tensor(0.21524645, shape=(), dtype=float32)
loss: tf.Tensor(0.2118134, shape=(), dtype=float32)
loss: tf.Tensor(0.28041634, shape=(), dtype=float32)
loss: tf.Tensor(0.15010951, shape=(), dtype=float32)
loss: tf.Tensor(0.13854635, shape=(), dtype=float32)
loss: tf.Tensor(0.20576973, shape=(), dtype=float32)
loss: tf.Tensor(0.28651997, shape=(), dtype=float32)
loss: tf.Tensor(0.24202876, shape=(), dtype=float32)
loss: tf.Tensor(0.07649635, shape=(), dtype=float32)
loss: tf.Tensor(0.08323203, shape=(), dtype=float32)
loss: tf.Tensor(0.16058968, shape=(), dtype=float32)
loss: tf.Tensor(0.18192114, shape=(), dtype=float32)
loss: tf.Tensor(0.07902481, shape=(), dtype=float32)
loss: tf.Tensor(0.15625732, shape=(), dtype=float32)
loss: tf.Tensor(0.101073414, shape=(), dtype=float32)
loss: tf.Tensor(0.20907503, shape=(), dtype=float32)
loss: tf.Tensor(0.2068285, shape=(), dtype=float32)
loss: tf.Tensor(0.16506678, shape=(), dtype=float32)
loss: tf.Tensor(0.22892582, shape=(), dtype=float32)
loss: tf.Tensor(0.14895926, shape=(), dtype=float32)
loss: tf.Tensor(0.29595032, shape=(), dtype=float32)
loss: tf.Tensor(0.13862342, shape=(), dtype=float32)
loss: tf.Tensor(0.2755735, shape=(), dtype=float32)
loss: tf.Tensor(0.19246598, shape=(), dtype=float32)
loss: tf.Tensor(0.1585237, shape=(), dtype=float32)
loss: tf.Tensor(0.1368341, shape=(), dtype=float32)
loss: tf.Tensor(0.116471164, shape=(), dtype=float32)
loss: tf.Tensor(0.11513743, shape=(), dtype=float32)
loss: tf.Tensor(0.21643507, shape=(), dtype=float32)
loss: tf.Tensor(0.10702014, shape=(), dtype=float32)
loss: tf.Tensor(0.17998226, shape=(), dtype=float32)
loss: tf.Tensor(0.21386032, shape=(), dtype=float32)
loss: tf.Tensor(0.24646965, shape=(), dtype=float32)
loss: tf.Tensor(0.21297987, shape=(), dtype=float32)
loss: tf.Tensor(0.107794054, shape=(), dtype=float32)
loss: tf.Tensor(0.13668454, shape=(), dtype=float32)
loss: tf.Tensor(0.21327528, shape=(), dtype=float32)
loss: tf.Tensor(0.29170203, shape=(), dtype=float32)
loss: tf.Tensor(0.090616256, shape=(), dtype=float32)
loss: tf.Tensor(0.1820334, shape=(), dtype=float32)
loss: tf.Tensor(0.12515724, shape=(), dtype=float32)
loss: tf.Tensor(0.13157207, shape=(), dtype=float32)
loss: tf.Tensor(0.11342328, shape=(), dtype=float32)
loss: tf.Tensor(0.17664059, shape=(), dtype=float32)
loss: tf.Tensor(0.19365092, shape=(), dtype=float32)
loss: tf.Tensor(0.11382826, shape=(), dtype=float32)
loss: tf.Tensor(0.17101385, shape=(), dtype=float32)
loss: tf.Tensor(0.20677036, shape=(), dtype=float32)
loss: tf.Tensor(0.01856768, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7115926, shape=(), dtype=float32)
F1 SCORE:
0.83025306
EPOCH  14 #################################
loss: tf.Tensor(0.17775753, shape=(), dtype=float32)
loss: tf.Tensor(0.13277546, shape=(), dtype=float32)
loss: tf.Tensor(0.16423541, shape=(), dtype=float32)
loss: tf.Tensor(0.15266407, shape=(), dtype=float32)
loss: tf.Tensor(0.11540624, shape=(), dtype=float32)
loss: tf.Tensor(0.20689884, shape=(), dtype=float32)
loss: tf.Tensor(0.19883911, shape=(), dtype=float32)
loss: tf.Tensor(0.11834825, shape=(), dtype=float32)
loss: tf.Tensor(0.1335303, shape=(), dtype=float32)
loss: tf.Tensor(0.11477134, shape=(), dtype=float32)
loss: tf.Tensor(0.1911841, shape=(), dtype=float32)
loss: tf.Tensor(0.18549001, shape=(), dtype=float32)
loss: tf.Tensor(0.12025545, shape=(), dtype=float32)
loss: tf.Tensor(0.15818512, shape=(), dtype=float32)
loss: tf.Tensor(0.1786265, shape=(), dtype=float32)
loss: tf.Tensor(0.16936722, shape=(), dtype=float32)
loss: tf.Tensor(0.24932447, shape=(), dtype=float32)
loss: tf.Tensor(0.11707228, shape=(), dtype=float32)
loss: tf.Tensor(0.084395535, shape=(), dtype=float32)
loss: tf.Tensor(0.101189405, shape=(), dtype=float32)
loss: tf.Tensor(0.22786902, shape=(), dtype=float32)
loss: tf.Tensor(0.24649395, shape=(), dtype=float32)
loss: tf.Tensor(0.22020087, shape=(), dtype=float32)
loss: tf.Tensor(0.10220229, shape=(), dtype=float32)
loss: tf.Tensor(0.18086888, shape=(), dtype=float32)
loss: tf.Tensor(0.10743652, shape=(), dtype=float32)
loss: tf.Tensor(0.084999226, shape=(), dtype=float32)
loss: tf.Tensor(0.17833115, shape=(), dtype=float32)
loss: tf.Tensor(0.17466593, shape=(), dtype=float32)
loss: tf.Tensor(0.13905656, shape=(), dtype=float32)
loss: tf.Tensor(0.16529565, shape=(), dtype=float32)
loss: tf.Tensor(0.1168988, shape=(), dtype=float32)
loss: tf.Tensor(0.16129269, shape=(), dtype=float32)
loss: tf.Tensor(0.1657014, shape=(), dtype=float32)
loss: tf.Tensor(0.08585958, shape=(), dtype=float32)
loss: tf.Tensor(0.105787955, shape=(), dtype=float32)
loss: tf.Tensor(0.14480002, shape=(), dtype=float32)
loss: tf.Tensor(0.1777061, shape=(), dtype=float32)
loss: tf.Tensor(0.15025158, shape=(), dtype=float32)
loss: tf.Tensor(0.16804557, shape=(), dtype=float32)
loss: tf.Tensor(0.11127279, shape=(), dtype=float32)
loss: tf.Tensor(0.17885278, shape=(), dtype=float32)
loss: tf.Tensor(0.12117171, shape=(), dtype=float32)
loss: tf.Tensor(0.15811773, shape=(), dtype=float32)
loss: tf.Tensor(0.114294164, shape=(), dtype=float32)
loss: tf.Tensor(0.20754962, shape=(), dtype=float32)
loss: tf.Tensor(0.2622234, shape=(), dtype=float32)
loss: tf.Tensor(0.07780549, shape=(), dtype=float32)
loss: tf.Tensor(0.065417066, shape=(), dtype=float32)
loss: tf.Tensor(0.19541316, shape=(), dtype=float32)
loss: tf.Tensor(0.14608938, shape=(), dtype=float32)
loss: tf.Tensor(0.2663953, shape=(), dtype=float32)
loss: tf.Tensor(0.13801824, shape=(), dtype=float32)
loss: tf.Tensor(0.09964719, shape=(), dtype=float32)
loss: tf.Tensor(0.11044641, shape=(), dtype=float32)
loss: tf.Tensor(0.17455488, shape=(), dtype=float32)
loss: tf.Tensor(0.16227227, shape=(), dtype=float32)
loss: tf.Tensor(0.14935005, shape=(), dtype=float32)
loss: tf.Tensor(0.224989, shape=(), dtype=float32)
loss: tf.Tensor(0.1288079, shape=(), dtype=float32)
loss: tf.Tensor(0.13028347, shape=(), dtype=float32)
loss: tf.Tensor(0.18533856, shape=(), dtype=float32)
loss: tf.Tensor(0.13250849, shape=(), dtype=float32)
loss: tf.Tensor(0.13577145, shape=(), dtype=float32)
loss: tf.Tensor(0.10422025, shape=(), dtype=float32)
loss: tf.Tensor(0.11009683, shape=(), dtype=float32)
loss: tf.Tensor(0.136496, shape=(), dtype=float32)
loss: tf.Tensor(0.15038216, shape=(), dtype=float32)
loss: tf.Tensor(0.15019199, shape=(), dtype=float32)
loss: tf.Tensor(0.20171793, shape=(), dtype=float32)
loss: tf.Tensor(0.1956946, shape=(), dtype=float32)
loss: tf.Tensor(0.089712985, shape=(), dtype=float32)
loss: tf.Tensor(0.10635088, shape=(), dtype=float32)
loss: tf.Tensor(0.17188157, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71512675, shape=(), dtype=float32)
F1 SCORE:
0.82938415
EPOCH  15 #################################
loss: tf.Tensor(0.13948226, shape=(), dtype=float32)
loss: tf.Tensor(0.15472241, shape=(), dtype=float32)
loss: tf.Tensor(0.10024511, shape=(), dtype=float32)
loss: tf.Tensor(0.11244807, shape=(), dtype=float32)
loss: tf.Tensor(0.15739919, shape=(), dtype=float32)
loss: tf.Tensor(0.060319453, shape=(), dtype=float32)
loss: tf.Tensor(0.1540536, shape=(), dtype=float32)
loss: tf.Tensor(0.15644532, shape=(), dtype=float32)
loss: tf.Tensor(0.10406173, shape=(), dtype=float32)
loss: tf.Tensor(0.07964683, shape=(), dtype=float32)
loss: tf.Tensor(0.08884947, shape=(), dtype=float32)
loss: tf.Tensor(0.096174434, shape=(), dtype=float32)
loss: tf.Tensor(0.18182999, shape=(), dtype=float32)
loss: tf.Tensor(0.20844972, shape=(), dtype=float32)
loss: tf.Tensor(0.05313901, shape=(), dtype=float32)
loss: tf.Tensor(0.098695606, shape=(), dtype=float32)
loss: tf.Tensor(0.060886078, shape=(), dtype=float32)
loss: tf.Tensor(0.08506619, shape=(), dtype=float32)
loss: tf.Tensor(0.28477928, shape=(), dtype=float32)
loss: tf.Tensor(0.29880232, shape=(), dtype=float32)
loss: tf.Tensor(0.09876684, shape=(), dtype=float32)
loss: tf.Tensor(0.060652766, shape=(), dtype=float32)
loss: tf.Tensor(0.08398046, shape=(), dtype=float32)
loss: tf.Tensor(0.0928488, shape=(), dtype=float32)
loss: tf.Tensor(0.11243532, shape=(), dtype=float32)
loss: tf.Tensor(0.13312672, shape=(), dtype=float32)
loss: tf.Tensor(0.079019405, shape=(), dtype=float32)
loss: tf.Tensor(0.2052314, shape=(), dtype=float32)
loss: tf.Tensor(0.14453574, shape=(), dtype=float32)
loss: tf.Tensor(0.22856459, shape=(), dtype=float32)
loss: tf.Tensor(0.15601057, shape=(), dtype=float32)
loss: tf.Tensor(0.086566254, shape=(), dtype=float32)
loss: tf.Tensor(0.13650052, shape=(), dtype=float32)
loss: tf.Tensor(0.16141666, shape=(), dtype=float32)
loss: tf.Tensor(0.117545426, shape=(), dtype=float32)
loss: tf.Tensor(0.23351637, shape=(), dtype=float32)
loss: tf.Tensor(0.23717368, shape=(), dtype=float32)
loss: tf.Tensor(0.12226783, shape=(), dtype=float32)
loss: tf.Tensor(0.09216497, shape=(), dtype=float32)
loss: tf.Tensor(0.15536411, shape=(), dtype=float32)
loss: tf.Tensor(0.12366577, shape=(), dtype=float32)
loss: tf.Tensor(0.1762533, shape=(), dtype=float32)
loss: tf.Tensor(0.13921176, shape=(), dtype=float32)
loss: tf.Tensor(0.16080263, shape=(), dtype=float32)
loss: tf.Tensor(0.19978705, shape=(), dtype=float32)
loss: tf.Tensor(0.0982739, shape=(), dtype=float32)
loss: tf.Tensor(0.22169143, shape=(), dtype=float32)
loss: tf.Tensor(0.1383484, shape=(), dtype=float32)
loss: tf.Tensor(0.08436203, shape=(), dtype=float32)
loss: tf.Tensor(0.16743703, shape=(), dtype=float32)
loss: tf.Tensor(0.2050383, shape=(), dtype=float32)
loss: tf.Tensor(0.16468221, shape=(), dtype=float32)
loss: tf.Tensor(0.18310341, shape=(), dtype=float32)
loss: tf.Tensor(0.10694034, shape=(), dtype=float32)
loss: tf.Tensor(0.10995631, shape=(), dtype=float32)
loss: tf.Tensor(0.110546, shape=(), dtype=float32)
loss: tf.Tensor(0.0725629, shape=(), dtype=float32)
loss: tf.Tensor(0.13459069, shape=(), dtype=float32)
loss: tf.Tensor(0.1151968, shape=(), dtype=float32)
loss: tf.Tensor(0.29137436, shape=(), dtype=float32)
loss: tf.Tensor(0.19941753, shape=(), dtype=float32)
loss: tf.Tensor(0.12603423, shape=(), dtype=float32)
loss: tf.Tensor(0.08490092, shape=(), dtype=float32)
loss: tf.Tensor(0.10395142, shape=(), dtype=float32)
loss: tf.Tensor(0.15476361, shape=(), dtype=float32)
loss: tf.Tensor(0.16152911, shape=(), dtype=float32)
loss: tf.Tensor(0.15100288, shape=(), dtype=float32)
loss: tf.Tensor(0.1503158, shape=(), dtype=float32)
loss: tf.Tensor(0.2081796, shape=(), dtype=float32)
loss: tf.Tensor(0.12770678, shape=(), dtype=float32)
loss: tf.Tensor(0.074083865, shape=(), dtype=float32)
loss: tf.Tensor(0.10865257, shape=(), dtype=float32)
loss: tf.Tensor(0.16097374, shape=(), dtype=float32)
loss: tf.Tensor(0.016420117, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70372117, shape=(), dtype=float32)
F1 SCORE:
0.82954556
EPOCH  16 #################################
loss: tf.Tensor(0.12010793, shape=(), dtype=float32)
loss: tf.Tensor(0.10681902, shape=(), dtype=float32)
loss: tf.Tensor(0.09358075, shape=(), dtype=float32)
loss: tf.Tensor(0.10305691, shape=(), dtype=float32)
loss: tf.Tensor(0.043696303, shape=(), dtype=float32)
loss: tf.Tensor(0.07508556, shape=(), dtype=float32)
loss: tf.Tensor(0.09492853, shape=(), dtype=float32)
loss: tf.Tensor(0.088851586, shape=(), dtype=float32)
loss: tf.Tensor(0.12878561, shape=(), dtype=float32)
loss: tf.Tensor(0.09148966, shape=(), dtype=float32)
loss: tf.Tensor(0.08634806, shape=(), dtype=float32)
loss: tf.Tensor(0.06064297, shape=(), dtype=float32)
loss: tf.Tensor(0.073381245, shape=(), dtype=float32)
loss: tf.Tensor(0.20095906, shape=(), dtype=float32)
loss: tf.Tensor(0.057238933, shape=(), dtype=float32)
loss: tf.Tensor(0.07326202, shape=(), dtype=float32)
loss: tf.Tensor(0.21030128, shape=(), dtype=float32)
loss: tf.Tensor(0.13717936, shape=(), dtype=float32)
loss: tf.Tensor(0.07276532, shape=(), dtype=float32)
loss: tf.Tensor(0.14960614, shape=(), dtype=float32)
loss: tf.Tensor(0.15999538, shape=(), dtype=float32)
loss: tf.Tensor(0.12624358, shape=(), dtype=float32)
loss: tf.Tensor(0.07770033, shape=(), dtype=float32)
loss: tf.Tensor(0.15587564, shape=(), dtype=float32)
loss: tf.Tensor(0.10907506, shape=(), dtype=float32)
loss: tf.Tensor(0.06761496, shape=(), dtype=float32)
loss: tf.Tensor(0.12678461, shape=(), dtype=float32)
loss: tf.Tensor(0.20797293, shape=(), dtype=float32)
loss: tf.Tensor(0.11405533, shape=(), dtype=float32)
loss: tf.Tensor(0.057000905, shape=(), dtype=float32)
loss: tf.Tensor(0.092818, shape=(), dtype=float32)
loss: tf.Tensor(0.15722644, shape=(), dtype=float32)
loss: tf.Tensor(0.10354999, shape=(), dtype=float32)
loss: tf.Tensor(0.16044489, shape=(), dtype=float32)
loss: tf.Tensor(0.16728882, shape=(), dtype=float32)
loss: tf.Tensor(0.12793206, shape=(), dtype=float32)
loss: tf.Tensor(0.06143158, shape=(), dtype=float32)
loss: tf.Tensor(0.14324692, shape=(), dtype=float32)
loss: tf.Tensor(0.17184332, shape=(), dtype=float32)
loss: tf.Tensor(0.16145861, shape=(), dtype=float32)
loss: tf.Tensor(0.14613138, shape=(), dtype=float32)
loss: tf.Tensor(0.18166971, shape=(), dtype=float32)
loss: tf.Tensor(0.097916745, shape=(), dtype=float32)
loss: tf.Tensor(0.27366272, shape=(), dtype=float32)
loss: tf.Tensor(0.2164146, shape=(), dtype=float32)
loss: tf.Tensor(0.09965818, shape=(), dtype=float32)
loss: tf.Tensor(0.14032885, shape=(), dtype=float32)
loss: tf.Tensor(0.16517252, shape=(), dtype=float32)
loss: tf.Tensor(0.23403127, shape=(), dtype=float32)
loss: tf.Tensor(0.10069277, shape=(), dtype=float32)
loss: tf.Tensor(0.1204325, shape=(), dtype=float32)
loss: tf.Tensor(0.16537607, shape=(), dtype=float32)
loss: tf.Tensor(0.067779325, shape=(), dtype=float32)
loss: tf.Tensor(0.15742503, shape=(), dtype=float32)
loss: tf.Tensor(0.099126644, shape=(), dtype=float32)
loss: tf.Tensor(0.12056786, shape=(), dtype=float32)
loss: tf.Tensor(0.16817568, shape=(), dtype=float32)
loss: tf.Tensor(0.028459825, shape=(), dtype=float32)
loss: tf.Tensor(0.17331465, shape=(), dtype=float32)
loss: tf.Tensor(0.076372996, shape=(), dtype=float32)
loss: tf.Tensor(0.15307197, shape=(), dtype=float32)
loss: tf.Tensor(0.19968124, shape=(), dtype=float32)
loss: tf.Tensor(0.217163, shape=(), dtype=float32)
loss: tf.Tensor(0.10681198, shape=(), dtype=float32)
loss: tf.Tensor(0.12448534, shape=(), dtype=float32)
loss: tf.Tensor(0.09229084, shape=(), dtype=float32)
loss: tf.Tensor(0.097338475, shape=(), dtype=float32)
loss: tf.Tensor(0.17688641, shape=(), dtype=float32)
loss: tf.Tensor(0.093703225, shape=(), dtype=float32)
loss: tf.Tensor(0.12888199, shape=(), dtype=float32)
loss: tf.Tensor(0.096144825, shape=(), dtype=float32)
loss: tf.Tensor(0.11645072, shape=(), dtype=float32)
loss: tf.Tensor(0.1573225, shape=(), dtype=float32)
loss: tf.Tensor(9.250213e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70267063, shape=(), dtype=float32)
F1 SCORE:
0.82908267
EPOCH  17 #################################
loss: tf.Tensor(0.08463929, shape=(), dtype=float32)
loss: tf.Tensor(0.10255357, shape=(), dtype=float32)
loss: tf.Tensor(0.08011654, shape=(), dtype=float32)
loss: tf.Tensor(0.09333839, shape=(), dtype=float32)
loss: tf.Tensor(0.0695266, shape=(), dtype=float32)
loss: tf.Tensor(0.1757099, shape=(), dtype=float32)
loss: tf.Tensor(0.078426294, shape=(), dtype=float32)
loss: tf.Tensor(0.033908457, shape=(), dtype=float32)
loss: tf.Tensor(0.08841495, shape=(), dtype=float32)
loss: tf.Tensor(0.15438442, shape=(), dtype=float32)
loss: tf.Tensor(0.0496762, shape=(), dtype=float32)
loss: tf.Tensor(0.05314887, shape=(), dtype=float32)
loss: tf.Tensor(0.12111523, shape=(), dtype=float32)
loss: tf.Tensor(0.12433212, shape=(), dtype=float32)
loss: tf.Tensor(0.1017345, shape=(), dtype=float32)
loss: tf.Tensor(0.12686683, shape=(), dtype=float32)
loss: tf.Tensor(0.08407972, shape=(), dtype=float32)
loss: tf.Tensor(0.12944232, shape=(), dtype=float32)
loss: tf.Tensor(0.17781824, shape=(), dtype=float32)
loss: tf.Tensor(0.12689433, shape=(), dtype=float32)
loss: tf.Tensor(0.106413916, shape=(), dtype=float32)
loss: tf.Tensor(0.116890065, shape=(), dtype=float32)
loss: tf.Tensor(0.070309035, shape=(), dtype=float32)
loss: tf.Tensor(0.07017146, shape=(), dtype=float32)
loss: tf.Tensor(0.07472842, shape=(), dtype=float32)
loss: tf.Tensor(0.083077155, shape=(), dtype=float32)
loss: tf.Tensor(0.099867456, shape=(), dtype=float32)
loss: tf.Tensor(0.08547371, shape=(), dtype=float32)
loss: tf.Tensor(0.102510005, shape=(), dtype=float32)
loss: tf.Tensor(0.13639814, shape=(), dtype=float32)
loss: tf.Tensor(0.09683142, shape=(), dtype=float32)
loss: tf.Tensor(0.11500225, shape=(), dtype=float32)
loss: tf.Tensor(0.1352721, shape=(), dtype=float32)
loss: tf.Tensor(0.08688582, shape=(), dtype=float32)
loss: tf.Tensor(0.033352006, shape=(), dtype=float32)
loss: tf.Tensor(0.15797909, shape=(), dtype=float32)
loss: tf.Tensor(0.12421847, shape=(), dtype=float32)
loss: tf.Tensor(0.07844322, shape=(), dtype=float32)
loss: tf.Tensor(0.08153943, shape=(), dtype=float32)
loss: tf.Tensor(0.20002577, shape=(), dtype=float32)
loss: tf.Tensor(0.10250654, shape=(), dtype=float32)
loss: tf.Tensor(0.11141991, shape=(), dtype=float32)
loss: tf.Tensor(0.113845155, shape=(), dtype=float32)
loss: tf.Tensor(0.11620492, shape=(), dtype=float32)
loss: tf.Tensor(0.08301759, shape=(), dtype=float32)
loss: tf.Tensor(0.14772978, shape=(), dtype=float32)
loss: tf.Tensor(0.1724417, shape=(), dtype=float32)
loss: tf.Tensor(0.14833649, shape=(), dtype=float32)
loss: tf.Tensor(0.13830373, shape=(), dtype=float32)
loss: tf.Tensor(0.1325972, shape=(), dtype=float32)
loss: tf.Tensor(0.26954702, shape=(), dtype=float32)
loss: tf.Tensor(0.215946, shape=(), dtype=float32)
loss: tf.Tensor(0.12850009, shape=(), dtype=float32)
loss: tf.Tensor(0.17122807, shape=(), dtype=float32)
loss: tf.Tensor(0.08726147, shape=(), dtype=float32)
loss: tf.Tensor(0.11548586, shape=(), dtype=float32)
loss: tf.Tensor(0.10996413, shape=(), dtype=float32)
loss: tf.Tensor(0.19875248, shape=(), dtype=float32)
loss: tf.Tensor(0.102228746, shape=(), dtype=float32)
loss: tf.Tensor(0.13345712, shape=(), dtype=float32)
loss: tf.Tensor(0.13308448, shape=(), dtype=float32)
loss: tf.Tensor(0.12325037, shape=(), dtype=float32)
loss: tf.Tensor(0.119000025, shape=(), dtype=float32)
loss: tf.Tensor(0.18964776, shape=(), dtype=float32)
loss: tf.Tensor(0.17375678, shape=(), dtype=float32)
loss: tf.Tensor(0.0730637, shape=(), dtype=float32)
loss: tf.Tensor(0.1353281, shape=(), dtype=float32)
loss: tf.Tensor(0.14810152, shape=(), dtype=float32)
loss: tf.Tensor(0.057337236, shape=(), dtype=float32)
loss: tf.Tensor(0.16514906, shape=(), dtype=float32)
loss: tf.Tensor(0.20250982, shape=(), dtype=float32)
loss: tf.Tensor(0.09754361, shape=(), dtype=float32)
loss: tf.Tensor(0.095222026, shape=(), dtype=float32)
loss: tf.Tensor(0.00036554807, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7220008, shape=(), dtype=float32)
F1 SCORE:
0.82806605
EPOCH  18 #################################
loss: tf.Tensor(0.12692767, shape=(), dtype=float32)
loss: tf.Tensor(0.1727436, shape=(), dtype=float32)
loss: tf.Tensor(0.08266438, shape=(), dtype=float32)
loss: tf.Tensor(0.07189901, shape=(), dtype=float32)
loss: tf.Tensor(0.10281524, shape=(), dtype=float32)
loss: tf.Tensor(0.111820154, shape=(), dtype=float32)
loss: tf.Tensor(0.11949283, shape=(), dtype=float32)
loss: tf.Tensor(0.18606415, shape=(), dtype=float32)
loss: tf.Tensor(0.12901476, shape=(), dtype=float32)
loss: tf.Tensor(0.13907358, shape=(), dtype=float32)
loss: tf.Tensor(0.040907353, shape=(), dtype=float32)
loss: tf.Tensor(0.15938161, shape=(), dtype=float32)
loss: tf.Tensor(0.054483395, shape=(), dtype=float32)
loss: tf.Tensor(0.044398602, shape=(), dtype=float32)
loss: tf.Tensor(0.09060976, shape=(), dtype=float32)
loss: tf.Tensor(0.07932542, shape=(), dtype=float32)
loss: tf.Tensor(0.17998642, shape=(), dtype=float32)
loss: tf.Tensor(0.06636603, shape=(), dtype=float32)
loss: tf.Tensor(0.040185537, shape=(), dtype=float32)
loss: tf.Tensor(0.08642412, shape=(), dtype=float32)
loss: tf.Tensor(0.041558523, shape=(), dtype=float32)
loss: tf.Tensor(0.14956856, shape=(), dtype=float32)
loss: tf.Tensor(0.13121459, shape=(), dtype=float32)
loss: tf.Tensor(0.1651191, shape=(), dtype=float32)
loss: tf.Tensor(0.073429726, shape=(), dtype=float32)
loss: tf.Tensor(0.19151716, shape=(), dtype=float32)
loss: tf.Tensor(0.14698456, shape=(), dtype=float32)
loss: tf.Tensor(0.107325114, shape=(), dtype=float32)
loss: tf.Tensor(0.16671617, shape=(), dtype=float32)
loss: tf.Tensor(0.07097228, shape=(), dtype=float32)
loss: tf.Tensor(0.13375945, shape=(), dtype=float32)
loss: tf.Tensor(0.088088185, shape=(), dtype=float32)
loss: tf.Tensor(0.09968601, shape=(), dtype=float32)
loss: tf.Tensor(0.056574713, shape=(), dtype=float32)
loss: tf.Tensor(0.11076518, shape=(), dtype=float32)
loss: tf.Tensor(0.09989986, shape=(), dtype=float32)
loss: tf.Tensor(0.044989575, shape=(), dtype=float32)
loss: tf.Tensor(0.098579414, shape=(), dtype=float32)
loss: tf.Tensor(0.12318782, shape=(), dtype=float32)
loss: tf.Tensor(0.058638096, shape=(), dtype=float32)
loss: tf.Tensor(0.08295118, shape=(), dtype=float32)
loss: tf.Tensor(0.07616207, shape=(), dtype=float32)
loss: tf.Tensor(0.063367836, shape=(), dtype=float32)
loss: tf.Tensor(0.14551476, shape=(), dtype=float32)
loss: tf.Tensor(0.14963989, shape=(), dtype=float32)
loss: tf.Tensor(0.091985315, shape=(), dtype=float32)
loss: tf.Tensor(0.10373127, shape=(), dtype=float32)
loss: tf.Tensor(0.06291693, shape=(), dtype=float32)
loss: tf.Tensor(0.022748362, shape=(), dtype=float32)
loss: tf.Tensor(0.09310148, shape=(), dtype=float32)
loss: tf.Tensor(0.016838519, shape=(), dtype=float32)
loss: tf.Tensor(0.17134319, shape=(), dtype=float32)
loss: tf.Tensor(0.20167276, shape=(), dtype=float32)
loss: tf.Tensor(0.0803609, shape=(), dtype=float32)
loss: tf.Tensor(0.041089416, shape=(), dtype=float32)
loss: tf.Tensor(0.12897684, shape=(), dtype=float32)
loss: tf.Tensor(0.07892992, shape=(), dtype=float32)
loss: tf.Tensor(0.087343544, shape=(), dtype=float32)
loss: tf.Tensor(0.08487286, shape=(), dtype=float32)
loss: tf.Tensor(0.11588935, shape=(), dtype=float32)
loss: tf.Tensor(0.16038388, shape=(), dtype=float32)
loss: tf.Tensor(0.11419757, shape=(), dtype=float32)
loss: tf.Tensor(0.055055723, shape=(), dtype=float32)
loss: tf.Tensor(0.123646736, shape=(), dtype=float32)
loss: tf.Tensor(0.061255794, shape=(), dtype=float32)
loss: tf.Tensor(0.14262179, shape=(), dtype=float32)
loss: tf.Tensor(0.07071445, shape=(), dtype=float32)
loss: tf.Tensor(0.0923401, shape=(), dtype=float32)
loss: tf.Tensor(0.17352685, shape=(), dtype=float32)
loss: tf.Tensor(0.15220566, shape=(), dtype=float32)
loss: tf.Tensor(0.08273296, shape=(), dtype=float32)
loss: tf.Tensor(0.06779809, shape=(), dtype=float32)
loss: tf.Tensor(0.16564164, shape=(), dtype=float32)
loss: tf.Tensor(0.008800648, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7085569, shape=(), dtype=float32)
F1 SCORE:
0.8278973
EPOCH  19 #################################
loss: tf.Tensor(0.11976643, shape=(), dtype=float32)
loss: tf.Tensor(0.06784312, shape=(), dtype=float32)
loss: tf.Tensor(0.06955639, shape=(), dtype=float32)
loss: tf.Tensor(0.025847463, shape=(), dtype=float32)
loss: tf.Tensor(0.08413642, shape=(), dtype=float32)
loss: tf.Tensor(0.0199421, shape=(), dtype=float32)
loss: tf.Tensor(0.074141115, shape=(), dtype=float32)
loss: tf.Tensor(0.17695685, shape=(), dtype=float32)
loss: tf.Tensor(0.065936945, shape=(), dtype=float32)
loss: tf.Tensor(0.09966013, shape=(), dtype=float32)
loss: tf.Tensor(0.08866789, shape=(), dtype=float32)
loss: tf.Tensor(0.036741577, shape=(), dtype=float32)
loss: tf.Tensor(0.1147152, shape=(), dtype=float32)
loss: tf.Tensor(0.20017181, shape=(), dtype=float32)
loss: tf.Tensor(0.09899532, shape=(), dtype=float32)
loss: tf.Tensor(0.073486306, shape=(), dtype=float32)
loss: tf.Tensor(0.06663298, shape=(), dtype=float32)
loss: tf.Tensor(0.08255093, shape=(), dtype=float32)
loss: tf.Tensor(0.04271383, shape=(), dtype=float32)
loss: tf.Tensor(0.17163084, shape=(), dtype=float32)
loss: tf.Tensor(0.06456931, shape=(), dtype=float32)
loss: tf.Tensor(0.09419987, shape=(), dtype=float32)
loss: tf.Tensor(0.039227653, shape=(), dtype=float32)
loss: tf.Tensor(0.04073965, shape=(), dtype=float32)
loss: tf.Tensor(0.06171158, shape=(), dtype=float32)
loss: tf.Tensor(0.11076412, shape=(), dtype=float32)
loss: tf.Tensor(0.17048432, shape=(), dtype=float32)
loss: tf.Tensor(0.089508034, shape=(), dtype=float32)
loss: tf.Tensor(0.12691851, shape=(), dtype=float32)
loss: tf.Tensor(0.08309715, shape=(), dtype=float32)
loss: tf.Tensor(0.074755326, shape=(), dtype=float32)
loss: tf.Tensor(0.11127558, shape=(), dtype=float32)
loss: tf.Tensor(0.041704122, shape=(), dtype=float32)
loss: tf.Tensor(0.05021741, shape=(), dtype=float32)
loss: tf.Tensor(0.05453605, shape=(), dtype=float32)
loss: tf.Tensor(0.20167686, shape=(), dtype=float32)
loss: tf.Tensor(0.13035204, shape=(), dtype=float32)
loss: tf.Tensor(0.10367428, shape=(), dtype=float32)
loss: tf.Tensor(0.14364408, shape=(), dtype=float32)
loss: tf.Tensor(0.092048295, shape=(), dtype=float32)
loss: tf.Tensor(0.039692506, shape=(), dtype=float32)
loss: tf.Tensor(0.036839183, shape=(), dtype=float32)
loss: tf.Tensor(0.13400137, shape=(), dtype=float32)
loss: tf.Tensor(0.0777603, shape=(), dtype=float32)
loss: tf.Tensor(0.08330962, shape=(), dtype=float32)
loss: tf.Tensor(0.062357977, shape=(), dtype=float32)
loss: tf.Tensor(0.033537306, shape=(), dtype=float32)
loss: tf.Tensor(0.06452009, shape=(), dtype=float32)
loss: tf.Tensor(0.076563634, shape=(), dtype=float32)
loss: tf.Tensor(0.02449777, shape=(), dtype=float32)
loss: tf.Tensor(0.1403239, shape=(), dtype=float32)
loss: tf.Tensor(0.18297173, shape=(), dtype=float32)
loss: tf.Tensor(0.1290673, shape=(), dtype=float32)
loss: tf.Tensor(0.05671195, shape=(), dtype=float32)
loss: tf.Tensor(0.12729298, shape=(), dtype=float32)
loss: tf.Tensor(0.05495553, shape=(), dtype=float32)
loss: tf.Tensor(0.09880133, shape=(), dtype=float32)
loss: tf.Tensor(0.16348995, shape=(), dtype=float32)
loss: tf.Tensor(0.045717373, shape=(), dtype=float32)
loss: tf.Tensor(0.080583446, shape=(), dtype=float32)
loss: tf.Tensor(0.15345544, shape=(), dtype=float32)
loss: tf.Tensor(0.08330372, shape=(), dtype=float32)
loss: tf.Tensor(0.11985788, shape=(), dtype=float32)
loss: tf.Tensor(0.14988965, shape=(), dtype=float32)
loss: tf.Tensor(0.11562515, shape=(), dtype=float32)
loss: tf.Tensor(0.119954735, shape=(), dtype=float32)
loss: tf.Tensor(0.045904428, shape=(), dtype=float32)
loss: tf.Tensor(0.034992762, shape=(), dtype=float32)
loss: tf.Tensor(0.06631461, shape=(), dtype=float32)
loss: tf.Tensor(0.13461013, shape=(), dtype=float32)
loss: tf.Tensor(0.06662451, shape=(), dtype=float32)
loss: tf.Tensor(0.16689184, shape=(), dtype=float32)
loss: tf.Tensor(0.11818542, shape=(), dtype=float32)
loss: tf.Tensor(8.737659e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70561016, shape=(), dtype=float32)
F1 SCORE:
0.8280309
EPOCH  20 #################################
loss: tf.Tensor(0.055754542, shape=(), dtype=float32)
loss: tf.Tensor(0.06611475, shape=(), dtype=float32)
loss: tf.Tensor(0.119021714, shape=(), dtype=float32)
loss: tf.Tensor(0.029294653, shape=(), dtype=float32)
loss: tf.Tensor(0.043930996, shape=(), dtype=float32)
loss: tf.Tensor(0.07952867, shape=(), dtype=float32)
loss: tf.Tensor(0.023533328, shape=(), dtype=float32)
loss: tf.Tensor(0.06512124, shape=(), dtype=float32)
loss: tf.Tensor(0.13926, shape=(), dtype=float32)
loss: tf.Tensor(0.09007538, shape=(), dtype=float32)
loss: tf.Tensor(0.07206414, shape=(), dtype=float32)
loss: tf.Tensor(0.12746663, shape=(), dtype=float32)
loss: tf.Tensor(0.07276999, shape=(), dtype=float32)
loss: tf.Tensor(0.21244588, shape=(), dtype=float32)
loss: tf.Tensor(0.062893435, shape=(), dtype=float32)
loss: tf.Tensor(0.11741356, shape=(), dtype=float32)
loss: tf.Tensor(0.07908229, shape=(), dtype=float32)
loss: tf.Tensor(0.055276856, shape=(), dtype=float32)
loss: tf.Tensor(0.13772453, shape=(), dtype=float32)
loss: tf.Tensor(0.075906016, shape=(), dtype=float32)
loss: tf.Tensor(0.05930333, shape=(), dtype=float32)
loss: tf.Tensor(0.108494215, shape=(), dtype=float32)
loss: tf.Tensor(0.10399244, shape=(), dtype=float32)
loss: tf.Tensor(0.09171226, shape=(), dtype=float32)
loss: tf.Tensor(0.0803901, shape=(), dtype=float32)
loss: tf.Tensor(0.04307377, shape=(), dtype=float32)
loss: tf.Tensor(0.03814432, shape=(), dtype=float32)
loss: tf.Tensor(0.099694245, shape=(), dtype=float32)
loss: tf.Tensor(0.044219766, shape=(), dtype=float32)
loss: tf.Tensor(0.037322182, shape=(), dtype=float32)
loss: tf.Tensor(0.075015076, shape=(), dtype=float32)
loss: tf.Tensor(0.040007792, shape=(), dtype=float32)
loss: tf.Tensor(0.11107686, shape=(), dtype=float32)
loss: tf.Tensor(0.077132694, shape=(), dtype=float32)
loss: tf.Tensor(0.05872742, shape=(), dtype=float32)
loss: tf.Tensor(0.07063076, shape=(), dtype=float32)
loss: tf.Tensor(0.018104857, shape=(), dtype=float32)
loss: tf.Tensor(0.066486984, shape=(), dtype=float32)
loss: tf.Tensor(0.06342728, shape=(), dtype=float32)
loss: tf.Tensor(0.10110006, shape=(), dtype=float32)
loss: tf.Tensor(0.046739176, shape=(), dtype=float32)
loss: tf.Tensor(0.028892739, shape=(), dtype=float32)
loss: tf.Tensor(0.08639678, shape=(), dtype=float32)
loss: tf.Tensor(0.06919909, shape=(), dtype=float32)
loss: tf.Tensor(0.15767388, shape=(), dtype=float32)
loss: tf.Tensor(0.10561537, shape=(), dtype=float32)
loss: tf.Tensor(0.048400473, shape=(), dtype=float32)
loss: tf.Tensor(0.051558074, shape=(), dtype=float32)
loss: tf.Tensor(0.11515519, shape=(), dtype=float32)
loss: tf.Tensor(0.07849348, shape=(), dtype=float32)
loss: tf.Tensor(0.041286696, shape=(), dtype=float32)
loss: tf.Tensor(0.10169117, shape=(), dtype=float32)
loss: tf.Tensor(0.17461674, shape=(), dtype=float32)
loss: tf.Tensor(0.1632197, shape=(), dtype=float32)
loss: tf.Tensor(0.037475567, shape=(), dtype=float32)
loss: tf.Tensor(0.03161866, shape=(), dtype=float32)
loss: tf.Tensor(0.074950464, shape=(), dtype=float32)
loss: tf.Tensor(0.06946481, shape=(), dtype=float32)
loss: tf.Tensor(0.10330322, shape=(), dtype=float32)
loss: tf.Tensor(0.1241202, shape=(), dtype=float32)
loss: tf.Tensor(0.10211112, shape=(), dtype=float32)
loss: tf.Tensor(0.119631656, shape=(), dtype=float32)
loss: tf.Tensor(0.13654879, shape=(), dtype=float32)
loss: tf.Tensor(0.060695704, shape=(), dtype=float32)
loss: tf.Tensor(0.06351704, shape=(), dtype=float32)
loss: tf.Tensor(0.06316424, shape=(), dtype=float32)
loss: tf.Tensor(0.10442113, shape=(), dtype=float32)
loss: tf.Tensor(0.15914181, shape=(), dtype=float32)
loss: tf.Tensor(0.032713365, shape=(), dtype=float32)
loss: tf.Tensor(0.20616587, shape=(), dtype=float32)
loss: tf.Tensor(0.07743845, shape=(), dtype=float32)
loss: tf.Tensor(0.17413509, shape=(), dtype=float32)
loss: tf.Tensor(0.12854353, shape=(), dtype=float32)
loss: tf.Tensor(0.0030156157, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71277934, shape=(), dtype=float32)
F1 SCORE:
0.8273644
EPOCH  21 #################################
loss: tf.Tensor(0.045610957, shape=(), dtype=float32)
loss: tf.Tensor(0.08009267, shape=(), dtype=float32)
loss: tf.Tensor(0.09913078, shape=(), dtype=float32)
loss: tf.Tensor(0.043587357, shape=(), dtype=float32)
loss: tf.Tensor(0.104330435, shape=(), dtype=float32)
loss: tf.Tensor(0.13019004, shape=(), dtype=float32)
loss: tf.Tensor(0.06119547, shape=(), dtype=float32)
loss: tf.Tensor(0.085309975, shape=(), dtype=float32)
loss: tf.Tensor(0.07940146, shape=(), dtype=float32)
loss: tf.Tensor(0.053952135, shape=(), dtype=float32)
loss: tf.Tensor(0.077279836, shape=(), dtype=float32)
loss: tf.Tensor(0.0745086, shape=(), dtype=float32)
loss: tf.Tensor(0.0453959, shape=(), dtype=float32)
loss: tf.Tensor(0.17001995, shape=(), dtype=float32)
loss: tf.Tensor(0.04184576, shape=(), dtype=float32)
loss: tf.Tensor(0.022322845, shape=(), dtype=float32)
loss: tf.Tensor(0.060671024, shape=(), dtype=float32)
loss: tf.Tensor(0.08059962, shape=(), dtype=float32)
loss: tf.Tensor(0.097201586, shape=(), dtype=float32)
loss: tf.Tensor(0.15719458, shape=(), dtype=float32)
loss: tf.Tensor(0.09482681, shape=(), dtype=float32)
loss: tf.Tensor(0.06278584, shape=(), dtype=float32)
loss: tf.Tensor(0.102636226, shape=(), dtype=float32)
loss: tf.Tensor(0.021475619, shape=(), dtype=float32)
loss: tf.Tensor(0.018111251, shape=(), dtype=float32)
loss: tf.Tensor(0.07797089, shape=(), dtype=float32)
loss: tf.Tensor(0.098296344, shape=(), dtype=float32)
loss: tf.Tensor(0.06541147, shape=(), dtype=float32)
loss: tf.Tensor(0.09392106, shape=(), dtype=float32)
loss: tf.Tensor(0.12158388, shape=(), dtype=float32)
loss: tf.Tensor(0.08209589, shape=(), dtype=float32)
loss: tf.Tensor(0.030638302, shape=(), dtype=float32)
loss: tf.Tensor(0.15065935, shape=(), dtype=float32)
loss: tf.Tensor(0.13910864, shape=(), dtype=float32)
loss: tf.Tensor(0.09584361, shape=(), dtype=float32)
loss: tf.Tensor(0.1470068, shape=(), dtype=float32)
loss: tf.Tensor(0.0637077, shape=(), dtype=float32)
loss: tf.Tensor(0.079520896, shape=(), dtype=float32)
loss: tf.Tensor(0.0259514, shape=(), dtype=float32)
loss: tf.Tensor(0.0870755, shape=(), dtype=float32)
loss: tf.Tensor(0.03366016, shape=(), dtype=float32)
loss: tf.Tensor(0.07804108, shape=(), dtype=float32)
loss: tf.Tensor(0.14743413, shape=(), dtype=float32)
loss: tf.Tensor(0.104974784, shape=(), dtype=float32)
loss: tf.Tensor(0.10207924, shape=(), dtype=float32)
loss: tf.Tensor(0.063986, shape=(), dtype=float32)
loss: tf.Tensor(0.11904001, shape=(), dtype=float32)
loss: tf.Tensor(0.053139877, shape=(), dtype=float32)
loss: tf.Tensor(0.12617587, shape=(), dtype=float32)
loss: tf.Tensor(0.1541178, shape=(), dtype=float32)
loss: tf.Tensor(0.14752084, shape=(), dtype=float32)
loss: tf.Tensor(0.1585204, shape=(), dtype=float32)
loss: tf.Tensor(0.048973463, shape=(), dtype=float32)
loss: tf.Tensor(0.063541695, shape=(), dtype=float32)
loss: tf.Tensor(0.02569339, shape=(), dtype=float32)
loss: tf.Tensor(0.10102278, shape=(), dtype=float32)
loss: tf.Tensor(0.10517798, shape=(), dtype=float32)
loss: tf.Tensor(0.07389969, shape=(), dtype=float32)
loss: tf.Tensor(0.11650402, shape=(), dtype=float32)
loss: tf.Tensor(0.024730945, shape=(), dtype=float32)
loss: tf.Tensor(0.05850058, shape=(), dtype=float32)
loss: tf.Tensor(0.067857884, shape=(), dtype=float32)
loss: tf.Tensor(0.051238243, shape=(), dtype=float32)
loss: tf.Tensor(0.14363788, shape=(), dtype=float32)
loss: tf.Tensor(0.06360002, shape=(), dtype=float32)
loss: tf.Tensor(0.037363082, shape=(), dtype=float32)
loss: tf.Tensor(0.0322091, shape=(), dtype=float32)
loss: tf.Tensor(0.11417917, shape=(), dtype=float32)
loss: tf.Tensor(0.12402645, shape=(), dtype=float32)
loss: tf.Tensor(0.065577075, shape=(), dtype=float32)
loss: tf.Tensor(0.050741702, shape=(), dtype=float32)
loss: tf.Tensor(0.05061491, shape=(), dtype=float32)
loss: tf.Tensor(0.08944109, shape=(), dtype=float32)
loss: tf.Tensor(0.33860743, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.712579, shape=(), dtype=float32)
F1 SCORE:
0.82660466
EPOCH  22 #################################
loss: tf.Tensor(0.19705369, shape=(), dtype=float32)
loss: tf.Tensor(0.098533705, shape=(), dtype=float32)
loss: tf.Tensor(0.28690723, shape=(), dtype=float32)
loss: tf.Tensor(0.1635492, shape=(), dtype=float32)
loss: tf.Tensor(0.27009758, shape=(), dtype=float32)
loss: tf.Tensor(0.26712286, shape=(), dtype=float32)
loss: tf.Tensor(0.09741454, shape=(), dtype=float32)
loss: tf.Tensor(0.24471855, shape=(), dtype=float32)
loss: tf.Tensor(0.24119028, shape=(), dtype=float32)
loss: tf.Tensor(0.18343537, shape=(), dtype=float32)
loss: tf.Tensor(0.096288145, shape=(), dtype=float32)
loss: tf.Tensor(0.072498135, shape=(), dtype=float32)
loss: tf.Tensor(0.16714826, shape=(), dtype=float32)
loss: tf.Tensor(0.1735855, shape=(), dtype=float32)
loss: tf.Tensor(0.12612818, shape=(), dtype=float32)
loss: tf.Tensor(0.22217344, shape=(), dtype=float32)
loss: tf.Tensor(0.084507026, shape=(), dtype=float32)
loss: tf.Tensor(0.12223659, shape=(), dtype=float32)
loss: tf.Tensor(0.15956423, shape=(), dtype=float32)
loss: tf.Tensor(0.09797824, shape=(), dtype=float32)
loss: tf.Tensor(0.11008772, shape=(), dtype=float32)
loss: tf.Tensor(0.14534768, shape=(), dtype=float32)
loss: tf.Tensor(0.22238481, shape=(), dtype=float32)
loss: tf.Tensor(0.13005947, shape=(), dtype=float32)
loss: tf.Tensor(0.17541346, shape=(), dtype=float32)
loss: tf.Tensor(0.07880866, shape=(), dtype=float32)
loss: tf.Tensor(0.18586786, shape=(), dtype=float32)
loss: tf.Tensor(0.16390242, shape=(), dtype=float32)
loss: tf.Tensor(0.14320773, shape=(), dtype=float32)
loss: tf.Tensor(0.14737757, shape=(), dtype=float32)
loss: tf.Tensor(0.065499924, shape=(), dtype=float32)
loss: tf.Tensor(0.08809055, shape=(), dtype=float32)
loss: tf.Tensor(0.105335735, shape=(), dtype=float32)
loss: tf.Tensor(0.1220819, shape=(), dtype=float32)
loss: tf.Tensor(0.14488092, shape=(), dtype=float32)
loss: tf.Tensor(0.095265344, shape=(), dtype=float32)
loss: tf.Tensor(0.20469815, shape=(), dtype=float32)
loss: tf.Tensor(0.08395848, shape=(), dtype=float32)
loss: tf.Tensor(0.23693883, shape=(), dtype=float32)
loss: tf.Tensor(0.15932122, shape=(), dtype=float32)
loss: tf.Tensor(0.0497535, shape=(), dtype=float32)
loss: tf.Tensor(0.19707973, shape=(), dtype=float32)
loss: tf.Tensor(0.14893728, shape=(), dtype=float32)
loss: tf.Tensor(0.13774851, shape=(), dtype=float32)
loss: tf.Tensor(0.10417081, shape=(), dtype=float32)
loss: tf.Tensor(0.18206072, shape=(), dtype=float32)
loss: tf.Tensor(0.13702987, shape=(), dtype=float32)
loss: tf.Tensor(0.042339534, shape=(), dtype=float32)
loss: tf.Tensor(0.07215026, shape=(), dtype=float32)
loss: tf.Tensor(0.07610287, shape=(), dtype=float32)
loss: tf.Tensor(0.1300116, shape=(), dtype=float32)
loss: tf.Tensor(0.12130873, shape=(), dtype=float32)
loss: tf.Tensor(0.050809875, shape=(), dtype=float32)
loss: tf.Tensor(0.20452096, shape=(), dtype=float32)
loss: tf.Tensor(0.08967927, shape=(), dtype=float32)
loss: tf.Tensor(0.074277185, shape=(), dtype=float32)
loss: tf.Tensor(0.22424267, shape=(), dtype=float32)
loss: tf.Tensor(0.21830374, shape=(), dtype=float32)
loss: tf.Tensor(0.07616127, shape=(), dtype=float32)
loss: tf.Tensor(0.08952073, shape=(), dtype=float32)
loss: tf.Tensor(0.15692846, shape=(), dtype=float32)
loss: tf.Tensor(0.12896939, shape=(), dtype=float32)
loss: tf.Tensor(0.093932554, shape=(), dtype=float32)
loss: tf.Tensor(0.13247752, shape=(), dtype=float32)
loss: tf.Tensor(0.15763313, shape=(), dtype=float32)
loss: tf.Tensor(0.12393474, shape=(), dtype=float32)
loss: tf.Tensor(0.08307944, shape=(), dtype=float32)
loss: tf.Tensor(0.08559884, shape=(), dtype=float32)
loss: tf.Tensor(0.061597813, shape=(), dtype=float32)
loss: tf.Tensor(0.19359529, shape=(), dtype=float32)
loss: tf.Tensor(0.080982305, shape=(), dtype=float32)
loss: tf.Tensor(0.15102048, shape=(), dtype=float32)
loss: tf.Tensor(0.12568523, shape=(), dtype=float32)
loss: tf.Tensor(0.025833208, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7034557, shape=(), dtype=float32)
F1 SCORE:
0.8263886
EPOCH  23 #################################
loss: tf.Tensor(0.07761982, shape=(), dtype=float32)
loss: tf.Tensor(0.13703734, shape=(), dtype=float32)
loss: tf.Tensor(0.08155832, shape=(), dtype=float32)
loss: tf.Tensor(0.07646897, shape=(), dtype=float32)
loss: tf.Tensor(0.056774262, shape=(), dtype=float32)
loss: tf.Tensor(0.031069081, shape=(), dtype=float32)
loss: tf.Tensor(0.07067737, shape=(), dtype=float32)
loss: tf.Tensor(0.041431546, shape=(), dtype=float32)
loss: tf.Tensor(0.10074613, shape=(), dtype=float32)
loss: tf.Tensor(0.032516137, shape=(), dtype=float32)
loss: tf.Tensor(0.07746859, shape=(), dtype=float32)
loss: tf.Tensor(0.05173843, shape=(), dtype=float32)
loss: tf.Tensor(0.085939206, shape=(), dtype=float32)
loss: tf.Tensor(0.07241989, shape=(), dtype=float32)
loss: tf.Tensor(0.11289225, shape=(), dtype=float32)
loss: tf.Tensor(0.061234627, shape=(), dtype=float32)
loss: tf.Tensor(0.055069122, shape=(), dtype=float32)
loss: tf.Tensor(0.037380107, shape=(), dtype=float32)
loss: tf.Tensor(0.06684089, shape=(), dtype=float32)
loss: tf.Tensor(0.07924079, shape=(), dtype=float32)
loss: tf.Tensor(0.10602543, shape=(), dtype=float32)
loss: tf.Tensor(0.049681935, shape=(), dtype=float32)
loss: tf.Tensor(0.080314435, shape=(), dtype=float32)
loss: tf.Tensor(0.054604664, shape=(), dtype=float32)
loss: tf.Tensor(0.066108644, shape=(), dtype=float32)
loss: tf.Tensor(0.04620913, shape=(), dtype=float32)
loss: tf.Tensor(0.10934265, shape=(), dtype=float32)
loss: tf.Tensor(0.09218089, shape=(), dtype=float32)
loss: tf.Tensor(0.11603981, shape=(), dtype=float32)
loss: tf.Tensor(0.07585251, shape=(), dtype=float32)
loss: tf.Tensor(0.039185468, shape=(), dtype=float32)
loss: tf.Tensor(0.08164102, shape=(), dtype=float32)
loss: tf.Tensor(0.1378697, shape=(), dtype=float32)
loss: tf.Tensor(0.065004334, shape=(), dtype=float32)
loss: tf.Tensor(0.14368819, shape=(), dtype=float32)
loss: tf.Tensor(0.07984497, shape=(), dtype=float32)
loss: tf.Tensor(0.11046907, shape=(), dtype=float32)
loss: tf.Tensor(0.065195605, shape=(), dtype=float32)
loss: tf.Tensor(0.052952122, shape=(), dtype=float32)
loss: tf.Tensor(0.03958925, shape=(), dtype=float32)
loss: tf.Tensor(0.053968478, shape=(), dtype=float32)
loss: tf.Tensor(0.0368698, shape=(), dtype=float32)
loss: tf.Tensor(0.088257425, shape=(), dtype=float32)
loss: tf.Tensor(0.073132746, shape=(), dtype=float32)
loss: tf.Tensor(0.09905269, shape=(), dtype=float32)
loss: tf.Tensor(0.15990919, shape=(), dtype=float32)
loss: tf.Tensor(0.084115684, shape=(), dtype=float32)
loss: tf.Tensor(0.094109625, shape=(), dtype=float32)
loss: tf.Tensor(0.10409914, shape=(), dtype=float32)
loss: tf.Tensor(0.07095687, shape=(), dtype=float32)
loss: tf.Tensor(0.08158844, shape=(), dtype=float32)
loss: tf.Tensor(0.11773366, shape=(), dtype=float32)
loss: tf.Tensor(0.10086617, shape=(), dtype=float32)
loss: tf.Tensor(0.15036851, shape=(), dtype=float32)
loss: tf.Tensor(0.05669594, shape=(), dtype=float32)
loss: tf.Tensor(0.09033957, shape=(), dtype=float32)
loss: tf.Tensor(0.07369003, shape=(), dtype=float32)
loss: tf.Tensor(0.12777619, shape=(), dtype=float32)
loss: tf.Tensor(0.10914405, shape=(), dtype=float32)
loss: tf.Tensor(0.036953036, shape=(), dtype=float32)
loss: tf.Tensor(0.050814837, shape=(), dtype=float32)
loss: tf.Tensor(0.0805851, shape=(), dtype=float32)
loss: tf.Tensor(0.08721034, shape=(), dtype=float32)
loss: tf.Tensor(0.09308178, shape=(), dtype=float32)
loss: tf.Tensor(0.11999331, shape=(), dtype=float32)
loss: tf.Tensor(0.048549384, shape=(), dtype=float32)
loss: tf.Tensor(0.061563816, shape=(), dtype=float32)
loss: tf.Tensor(0.089200124, shape=(), dtype=float32)
loss: tf.Tensor(0.13798183, shape=(), dtype=float32)
loss: tf.Tensor(0.16655262, shape=(), dtype=float32)
loss: tf.Tensor(0.046386547, shape=(), dtype=float32)
loss: tf.Tensor(0.08410495, shape=(), dtype=float32)
loss: tf.Tensor(0.052661672, shape=(), dtype=float32)
loss: tf.Tensor(0.0005525016, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6979911, shape=(), dtype=float32)
F1 SCORE:
0.826749
EPOCH  24 #################################
loss: tf.Tensor(0.02489266, shape=(), dtype=float32)
loss: tf.Tensor(0.04657172, shape=(), dtype=float32)
loss: tf.Tensor(0.06563085, shape=(), dtype=float32)
loss: tf.Tensor(0.2512355, shape=(), dtype=float32)
loss: tf.Tensor(0.08527169, shape=(), dtype=float32)
loss: tf.Tensor(0.057357684, shape=(), dtype=float32)
loss: tf.Tensor(0.04982008, shape=(), dtype=float32)
loss: tf.Tensor(0.0542186, shape=(), dtype=float32)
loss: tf.Tensor(0.03283099, shape=(), dtype=float32)
loss: tf.Tensor(0.0582512, shape=(), dtype=float32)
loss: tf.Tensor(0.08409409, shape=(), dtype=float32)
loss: tf.Tensor(0.030425154, shape=(), dtype=float32)
loss: tf.Tensor(0.07153469, shape=(), dtype=float32)
loss: tf.Tensor(0.08413015, shape=(), dtype=float32)
loss: tf.Tensor(0.10650871, shape=(), dtype=float32)
loss: tf.Tensor(0.04049715, shape=(), dtype=float32)
loss: tf.Tensor(0.044308376, shape=(), dtype=float32)
loss: tf.Tensor(0.08712158, shape=(), dtype=float32)
loss: tf.Tensor(0.09098806, shape=(), dtype=float32)
loss: tf.Tensor(0.07518938, shape=(), dtype=float32)
loss: tf.Tensor(0.044994842, shape=(), dtype=float32)
loss: tf.Tensor(0.1493443, shape=(), dtype=float32)
loss: tf.Tensor(0.036975328, shape=(), dtype=float32)
loss: tf.Tensor(0.109872125, shape=(), dtype=float32)
loss: tf.Tensor(0.06715309, shape=(), dtype=float32)
loss: tf.Tensor(0.0511417, shape=(), dtype=float32)
loss: tf.Tensor(0.0465101, shape=(), dtype=float32)
loss: tf.Tensor(0.10610919, shape=(), dtype=float32)
loss: tf.Tensor(0.11868745, shape=(), dtype=float32)
loss: tf.Tensor(0.04049351, shape=(), dtype=float32)
loss: tf.Tensor(0.1009492, shape=(), dtype=float32)
loss: tf.Tensor(0.038629793, shape=(), dtype=float32)
loss: tf.Tensor(0.05484755, shape=(), dtype=float32)
loss: tf.Tensor(0.05024922, shape=(), dtype=float32)
loss: tf.Tensor(0.09846432, shape=(), dtype=float32)
loss: tf.Tensor(0.09715608, shape=(), dtype=float32)
loss: tf.Tensor(0.048352852, shape=(), dtype=float32)
loss: tf.Tensor(0.05511851, shape=(), dtype=float32)
loss: tf.Tensor(0.12152419, shape=(), dtype=float32)
loss: tf.Tensor(0.2289782, shape=(), dtype=float32)
loss: tf.Tensor(0.061148115, shape=(), dtype=float32)
loss: tf.Tensor(0.07112488, shape=(), dtype=float32)
loss: tf.Tensor(0.1550476, shape=(), dtype=float32)
loss: tf.Tensor(0.15750019, shape=(), dtype=float32)
loss: tf.Tensor(0.08120396, shape=(), dtype=float32)
loss: tf.Tensor(0.07188427, shape=(), dtype=float32)
loss: tf.Tensor(0.058858883, shape=(), dtype=float32)
loss: tf.Tensor(0.06343149, shape=(), dtype=float32)
loss: tf.Tensor(0.06942772, shape=(), dtype=float32)
loss: tf.Tensor(0.06566021, shape=(), dtype=float32)
loss: tf.Tensor(0.063760884, shape=(), dtype=float32)
loss: tf.Tensor(0.060145255, shape=(), dtype=float32)
loss: tf.Tensor(0.064607546, shape=(), dtype=float32)
loss: tf.Tensor(0.05851614, shape=(), dtype=float32)
loss: tf.Tensor(0.05483208, shape=(), dtype=float32)
loss: tf.Tensor(0.0417477, shape=(), dtype=float32)
loss: tf.Tensor(0.09969761, shape=(), dtype=float32)
loss: tf.Tensor(0.10790982, shape=(), dtype=float32)
loss: tf.Tensor(0.07197622, shape=(), dtype=float32)
loss: tf.Tensor(0.06517939, shape=(), dtype=float32)
loss: tf.Tensor(0.09765256, shape=(), dtype=float32)
loss: tf.Tensor(0.058596168, shape=(), dtype=float32)
loss: tf.Tensor(0.079912856, shape=(), dtype=float32)
loss: tf.Tensor(0.109582275, shape=(), dtype=float32)
loss: tf.Tensor(0.06668902, shape=(), dtype=float32)
loss: tf.Tensor(0.030925894, shape=(), dtype=float32)
loss: tf.Tensor(0.12579598, shape=(), dtype=float32)
loss: tf.Tensor(0.01774197, shape=(), dtype=float32)
loss: tf.Tensor(0.037606124, shape=(), dtype=float32)
loss: tf.Tensor(0.09131387, shape=(), dtype=float32)
loss: tf.Tensor(0.10835664, shape=(), dtype=float32)
loss: tf.Tensor(0.049693216, shape=(), dtype=float32)
loss: tf.Tensor(0.08280206, shape=(), dtype=float32)
loss: tf.Tensor(0.000745138, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70340437, shape=(), dtype=float32)
F1 SCORE:
0.82696265
EPOCH  25 #################################
loss: tf.Tensor(0.05541599, shape=(), dtype=float32)
loss: tf.Tensor(0.08506769, shape=(), dtype=float32)
loss: tf.Tensor(0.1494358, shape=(), dtype=float32)
loss: tf.Tensor(0.071256086, shape=(), dtype=float32)
loss: tf.Tensor(0.052283537, shape=(), dtype=float32)
loss: tf.Tensor(0.044154078, shape=(), dtype=float32)
loss: tf.Tensor(0.09120239, shape=(), dtype=float32)
loss: tf.Tensor(0.050555862, shape=(), dtype=float32)
loss: tf.Tensor(0.053214706, shape=(), dtype=float32)
loss: tf.Tensor(0.04291088, shape=(), dtype=float32)
loss: tf.Tensor(0.059260592, shape=(), dtype=float32)
loss: tf.Tensor(0.08212632, shape=(), dtype=float32)
loss: tf.Tensor(0.117553495, shape=(), dtype=float32)
loss: tf.Tensor(0.06400746, shape=(), dtype=float32)
loss: tf.Tensor(0.012348034, shape=(), dtype=float32)
loss: tf.Tensor(0.10512412, shape=(), dtype=float32)
loss: tf.Tensor(0.06799525, shape=(), dtype=float32)
loss: tf.Tensor(0.07798574, shape=(), dtype=float32)
loss: tf.Tensor(0.08609691, shape=(), dtype=float32)
loss: tf.Tensor(0.063415565, shape=(), dtype=float32)
loss: tf.Tensor(0.05007807, shape=(), dtype=float32)
loss: tf.Tensor(0.06889079, shape=(), dtype=float32)
loss: tf.Tensor(0.026934149, shape=(), dtype=float32)
loss: tf.Tensor(0.16581848, shape=(), dtype=float32)
loss: tf.Tensor(0.098167956, shape=(), dtype=float32)
loss: tf.Tensor(0.06540057, shape=(), dtype=float32)
loss: tf.Tensor(0.063759014, shape=(), dtype=float32)
loss: tf.Tensor(0.032783914, shape=(), dtype=float32)
loss: tf.Tensor(0.04594345, shape=(), dtype=float32)
loss: tf.Tensor(0.078497365, shape=(), dtype=float32)
loss: tf.Tensor(0.08534501, shape=(), dtype=float32)
loss: tf.Tensor(0.0562511, shape=(), dtype=float32)
loss: tf.Tensor(0.04068436, shape=(), dtype=float32)
loss: tf.Tensor(0.007772959, shape=(), dtype=float32)
loss: tf.Tensor(0.062178746, shape=(), dtype=float32)
loss: tf.Tensor(0.062319197, shape=(), dtype=float32)
loss: tf.Tensor(0.028820345, shape=(), dtype=float32)
loss: tf.Tensor(0.07388709, shape=(), dtype=float32)
loss: tf.Tensor(0.046054162, shape=(), dtype=float32)
loss: tf.Tensor(0.091503404, shape=(), dtype=float32)
loss: tf.Tensor(0.04981595, shape=(), dtype=float32)
loss: tf.Tensor(0.053753782, shape=(), dtype=float32)
loss: tf.Tensor(0.08095146, shape=(), dtype=float32)
loss: tf.Tensor(0.025579838, shape=(), dtype=float32)
loss: tf.Tensor(0.022191644, shape=(), dtype=float32)
loss: tf.Tensor(0.11329, shape=(), dtype=float32)
loss: tf.Tensor(0.09986063, shape=(), dtype=float32)
loss: tf.Tensor(0.042968906, shape=(), dtype=float32)
loss: tf.Tensor(0.079119936, shape=(), dtype=float32)
loss: tf.Tensor(0.14155495, shape=(), dtype=float32)
loss: tf.Tensor(0.043687697, shape=(), dtype=float32)
loss: tf.Tensor(0.14284964, shape=(), dtype=float32)
loss: tf.Tensor(0.059594873, shape=(), dtype=float32)
loss: tf.Tensor(0.041927148, shape=(), dtype=float32)
loss: tf.Tensor(0.0458988, shape=(), dtype=float32)
loss: tf.Tensor(0.025026212, shape=(), dtype=float32)
loss: tf.Tensor(0.07253072, shape=(), dtype=float32)
loss: tf.Tensor(0.08347593, shape=(), dtype=float32)
loss: tf.Tensor(0.040531453, shape=(), dtype=float32)
loss: tf.Tensor(0.053657543, shape=(), dtype=float32)
loss: tf.Tensor(0.062463846, shape=(), dtype=float32)
loss: tf.Tensor(0.073469564, shape=(), dtype=float32)
loss: tf.Tensor(0.08397232, shape=(), dtype=float32)
loss: tf.Tensor(0.04436747, shape=(), dtype=float32)
loss: tf.Tensor(0.07564494, shape=(), dtype=float32)
loss: tf.Tensor(0.0783948, shape=(), dtype=float32)
loss: tf.Tensor(0.061021827, shape=(), dtype=float32)
loss: tf.Tensor(0.07287398, shape=(), dtype=float32)
loss: tf.Tensor(0.037739486, shape=(), dtype=float32)
loss: tf.Tensor(0.07088552, shape=(), dtype=float32)
loss: tf.Tensor(0.046964362, shape=(), dtype=float32)
loss: tf.Tensor(0.05505294, shape=(), dtype=float32)
loss: tf.Tensor(0.08946356, shape=(), dtype=float32)
loss: tf.Tensor(0.0014507971, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71717477, shape=(), dtype=float32)
F1 SCORE:
0.82640666
EPOCH  26 #################################
loss: tf.Tensor(0.08790858, shape=(), dtype=float32)
loss: tf.Tensor(0.033867992, shape=(), dtype=float32)
loss: tf.Tensor(0.047994066, shape=(), dtype=float32)
loss: tf.Tensor(0.032956347, shape=(), dtype=float32)
loss: tf.Tensor(0.055865206, shape=(), dtype=float32)
loss: tf.Tensor(0.09163468, shape=(), dtype=float32)
loss: tf.Tensor(0.042431343, shape=(), dtype=float32)
loss: tf.Tensor(0.057855148, shape=(), dtype=float32)
loss: tf.Tensor(0.02555349, shape=(), dtype=float32)
loss: tf.Tensor(0.024620002, shape=(), dtype=float32)
loss: tf.Tensor(0.06461017, shape=(), dtype=float32)
loss: tf.Tensor(0.065060206, shape=(), dtype=float32)
loss: tf.Tensor(0.06784493, shape=(), dtype=float32)
loss: tf.Tensor(0.04677873, shape=(), dtype=float32)
loss: tf.Tensor(0.01954789, shape=(), dtype=float32)
loss: tf.Tensor(0.08653197, shape=(), dtype=float32)
loss: tf.Tensor(0.053097185, shape=(), dtype=float32)
loss: tf.Tensor(0.07803845, shape=(), dtype=float32)
loss: tf.Tensor(0.05111508, shape=(), dtype=float32)
loss: tf.Tensor(0.07480028, shape=(), dtype=float32)
loss: tf.Tensor(0.06073458, shape=(), dtype=float32)
loss: tf.Tensor(0.09024454, shape=(), dtype=float32)
loss: tf.Tensor(0.10925013, shape=(), dtype=float32)
loss: tf.Tensor(0.11823418, shape=(), dtype=float32)
loss: tf.Tensor(0.09926717, shape=(), dtype=float32)
loss: tf.Tensor(0.024091635, shape=(), dtype=float32)
loss: tf.Tensor(0.042394023, shape=(), dtype=float32)
loss: tf.Tensor(0.040959835, shape=(), dtype=float32)
loss: tf.Tensor(0.05173741, shape=(), dtype=float32)
loss: tf.Tensor(0.031112947, shape=(), dtype=float32)
loss: tf.Tensor(0.12483471, shape=(), dtype=float32)
loss: tf.Tensor(0.07461717, shape=(), dtype=float32)
loss: tf.Tensor(0.16932003, shape=(), dtype=float32)
loss: tf.Tensor(0.047876924, shape=(), dtype=float32)
loss: tf.Tensor(0.09870271, shape=(), dtype=float32)
loss: tf.Tensor(0.0926194, shape=(), dtype=float32)
loss: tf.Tensor(0.1596734, shape=(), dtype=float32)
loss: tf.Tensor(0.044504903, shape=(), dtype=float32)
loss: tf.Tensor(0.026657326, shape=(), dtype=float32)
loss: tf.Tensor(0.02299343, shape=(), dtype=float32)
loss: tf.Tensor(0.026985083, shape=(), dtype=float32)
loss: tf.Tensor(0.060234003, shape=(), dtype=float32)
loss: tf.Tensor(0.067278236, shape=(), dtype=float32)
loss: tf.Tensor(0.053392686, shape=(), dtype=float32)
loss: tf.Tensor(0.01956311, shape=(), dtype=float32)
loss: tf.Tensor(0.064167544, shape=(), dtype=float32)
loss: tf.Tensor(0.03689533, shape=(), dtype=float32)
loss: tf.Tensor(0.072421834, shape=(), dtype=float32)
loss: tf.Tensor(0.034554664, shape=(), dtype=float32)
loss: tf.Tensor(0.02328452, shape=(), dtype=float32)
loss: tf.Tensor(0.07512111, shape=(), dtype=float32)
loss: tf.Tensor(0.045141097, shape=(), dtype=float32)
loss: tf.Tensor(0.017981814, shape=(), dtype=float32)
loss: tf.Tensor(0.0845212, shape=(), dtype=float32)
loss: tf.Tensor(0.09150898, shape=(), dtype=float32)
loss: tf.Tensor(0.091471165, shape=(), dtype=float32)
loss: tf.Tensor(0.111238755, shape=(), dtype=float32)
loss: tf.Tensor(0.14391801, shape=(), dtype=float32)
loss: tf.Tensor(0.025673755, shape=(), dtype=float32)
loss: tf.Tensor(0.054608297, shape=(), dtype=float32)
loss: tf.Tensor(0.104181185, shape=(), dtype=float32)
loss: tf.Tensor(0.028728848, shape=(), dtype=float32)
loss: tf.Tensor(0.14179373, shape=(), dtype=float32)
loss: tf.Tensor(0.048380796, shape=(), dtype=float32)
loss: tf.Tensor(0.040399138, shape=(), dtype=float32)
loss: tf.Tensor(0.062449142, shape=(), dtype=float32)
loss: tf.Tensor(0.08708209, shape=(), dtype=float32)
loss: tf.Tensor(0.10511372, shape=(), dtype=float32)
loss: tf.Tensor(0.03098239, shape=(), dtype=float32)
loss: tf.Tensor(0.07186579, shape=(), dtype=float32)
loss: tf.Tensor(0.07655591, shape=(), dtype=float32)
loss: tf.Tensor(0.03433023, shape=(), dtype=float32)
loss: tf.Tensor(0.06523576, shape=(), dtype=float32)
loss: tf.Tensor(7.867782e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6996376, shape=(), dtype=float32)
F1 SCORE:
0.8268234
EPOCH  27 #################################
loss: tf.Tensor(0.016528923, shape=(), dtype=float32)
loss: tf.Tensor(0.0148464255, shape=(), dtype=float32)
loss: tf.Tensor(0.017854951, shape=(), dtype=float32)
loss: tf.Tensor(0.052926887, shape=(), dtype=float32)
loss: tf.Tensor(0.11113241, shape=(), dtype=float32)
loss: tf.Tensor(0.04429467, shape=(), dtype=float32)
loss: tf.Tensor(0.0342622, shape=(), dtype=float32)
loss: tf.Tensor(0.045246147, shape=(), dtype=float32)
loss: tf.Tensor(0.04005596, shape=(), dtype=float32)
loss: tf.Tensor(0.052464467, shape=(), dtype=float32)
loss: tf.Tensor(0.065966785, shape=(), dtype=float32)
loss: tf.Tensor(0.05278172, shape=(), dtype=float32)
loss: tf.Tensor(0.066852555, shape=(), dtype=float32)
loss: tf.Tensor(0.03963102, shape=(), dtype=float32)
loss: tf.Tensor(0.03638147, shape=(), dtype=float32)
loss: tf.Tensor(0.057408378, shape=(), dtype=float32)
loss: tf.Tensor(0.03518938, shape=(), dtype=float32)
loss: tf.Tensor(0.082373895, shape=(), dtype=float32)
loss: tf.Tensor(0.062751845, shape=(), dtype=float32)
loss: tf.Tensor(0.061925855, shape=(), dtype=float32)
loss: tf.Tensor(0.03401746, shape=(), dtype=float32)
loss: tf.Tensor(0.013079375, shape=(), dtype=float32)
loss: tf.Tensor(0.0801742, shape=(), dtype=float32)
loss: tf.Tensor(0.13943703, shape=(), dtype=float32)
loss: tf.Tensor(0.055201717, shape=(), dtype=float32)
loss: tf.Tensor(0.023254769, shape=(), dtype=float32)
loss: tf.Tensor(0.053379547, shape=(), dtype=float32)
loss: tf.Tensor(0.059498157, shape=(), dtype=float32)
loss: tf.Tensor(0.022009594, shape=(), dtype=float32)
loss: tf.Tensor(0.09339197, shape=(), dtype=float32)
loss: tf.Tensor(0.113401406, shape=(), dtype=float32)
loss: tf.Tensor(0.13580212, shape=(), dtype=float32)
loss: tf.Tensor(0.06874597, shape=(), dtype=float32)
loss: tf.Tensor(0.10166843, shape=(), dtype=float32)
loss: tf.Tensor(0.036056496, shape=(), dtype=float32)
loss: tf.Tensor(0.0786301, shape=(), dtype=float32)
loss: tf.Tensor(0.10818412, shape=(), dtype=float32)
loss: tf.Tensor(0.082318716, shape=(), dtype=float32)
loss: tf.Tensor(0.06286705, shape=(), dtype=float32)
loss: tf.Tensor(0.108335234, shape=(), dtype=float32)
loss: tf.Tensor(0.053996608, shape=(), dtype=float32)
loss: tf.Tensor(0.05969424, shape=(), dtype=float32)
loss: tf.Tensor(0.06958141, shape=(), dtype=float32)
loss: tf.Tensor(0.058533266, shape=(), dtype=float32)
loss: tf.Tensor(0.057399493, shape=(), dtype=float32)
loss: tf.Tensor(0.045493513, shape=(), dtype=float32)
loss: tf.Tensor(0.061621733, shape=(), dtype=float32)
loss: tf.Tensor(0.026536107, shape=(), dtype=float32)
loss: tf.Tensor(0.066317186, shape=(), dtype=float32)
loss: tf.Tensor(0.086369775, shape=(), dtype=float32)
loss: tf.Tensor(0.038797934, shape=(), dtype=float32)
loss: tf.Tensor(0.025782118, shape=(), dtype=float32)
loss: tf.Tensor(0.021912245, shape=(), dtype=float32)
loss: tf.Tensor(0.08169313, shape=(), dtype=float32)
loss: tf.Tensor(0.0699504, shape=(), dtype=float32)
loss: tf.Tensor(0.024381964, shape=(), dtype=float32)
loss: tf.Tensor(0.061908063, shape=(), dtype=float32)
loss: tf.Tensor(0.022544486, shape=(), dtype=float32)
loss: tf.Tensor(0.03141001, shape=(), dtype=float32)
loss: tf.Tensor(0.036714785, shape=(), dtype=float32)
loss: tf.Tensor(0.019073715, shape=(), dtype=float32)
loss: tf.Tensor(0.04293574, shape=(), dtype=float32)
loss: tf.Tensor(0.036568757, shape=(), dtype=float32)
loss: tf.Tensor(0.05133011, shape=(), dtype=float32)
loss: tf.Tensor(0.1307589, shape=(), dtype=float32)
loss: tf.Tensor(0.028952971, shape=(), dtype=float32)
loss: tf.Tensor(0.06267392, shape=(), dtype=float32)
loss: tf.Tensor(0.019117827, shape=(), dtype=float32)
loss: tf.Tensor(0.1054992, shape=(), dtype=float32)
loss: tf.Tensor(0.08003645, shape=(), dtype=float32)
loss: tf.Tensor(0.023081155, shape=(), dtype=float32)
loss: tf.Tensor(0.03432374, shape=(), dtype=float32)
loss: tf.Tensor(0.031574935, shape=(), dtype=float32)
loss: tf.Tensor(0.3661917, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.727991, shape=(), dtype=float32)
F1 SCORE:
0.8259881
EPOCH  28 #################################
loss: tf.Tensor(0.10218526, shape=(), dtype=float32)
loss: tf.Tensor(0.54483217, shape=(), dtype=float32)
loss: tf.Tensor(0.59925395, shape=(), dtype=float32)
loss: tf.Tensor(0.6240844, shape=(), dtype=float32)
loss: tf.Tensor(0.42924023, shape=(), dtype=float32)
loss: tf.Tensor(0.1223823, shape=(), dtype=float32)
loss: tf.Tensor(0.24839626, shape=(), dtype=float32)
loss: tf.Tensor(0.2693791, shape=(), dtype=float32)
loss: tf.Tensor(0.44153145, shape=(), dtype=float32)
loss: tf.Tensor(0.24806118, shape=(), dtype=float32)
loss: tf.Tensor(0.15568207, shape=(), dtype=float32)
loss: tf.Tensor(0.10994822, shape=(), dtype=float32)
loss: tf.Tensor(0.061623164, shape=(), dtype=float32)
loss: tf.Tensor(0.2631346, shape=(), dtype=float32)
loss: tf.Tensor(0.2571846, shape=(), dtype=float32)
loss: tf.Tensor(0.3072046, shape=(), dtype=float32)
loss: tf.Tensor(0.15154156, shape=(), dtype=float32)
loss: tf.Tensor(0.09645359, shape=(), dtype=float32)
loss: tf.Tensor(0.20985958, shape=(), dtype=float32)
loss: tf.Tensor(0.14597619, shape=(), dtype=float32)
loss: tf.Tensor(0.15656424, shape=(), dtype=float32)
loss: tf.Tensor(0.13559204, shape=(), dtype=float32)
loss: tf.Tensor(0.13062543, shape=(), dtype=float32)
loss: tf.Tensor(0.12883018, shape=(), dtype=float32)
loss: tf.Tensor(0.1712506, shape=(), dtype=float32)
loss: tf.Tensor(0.13277239, shape=(), dtype=float32)
loss: tf.Tensor(0.2018427, shape=(), dtype=float32)
loss: tf.Tensor(0.14360388, shape=(), dtype=float32)
loss: tf.Tensor(0.1291629, shape=(), dtype=float32)
loss: tf.Tensor(0.15827347, shape=(), dtype=float32)
loss: tf.Tensor(0.12185058, shape=(), dtype=float32)
loss: tf.Tensor(0.07237952, shape=(), dtype=float32)
loss: tf.Tensor(0.16486679, shape=(), dtype=float32)
loss: tf.Tensor(0.20002425, shape=(), dtype=float32)
loss: tf.Tensor(0.12351432, shape=(), dtype=float32)
loss: tf.Tensor(0.15959598, shape=(), dtype=float32)
loss: tf.Tensor(0.068811186, shape=(), dtype=float32)
loss: tf.Tensor(0.14093116, shape=(), dtype=float32)
loss: tf.Tensor(0.14559974, shape=(), dtype=float32)
loss: tf.Tensor(0.14860493, shape=(), dtype=float32)
loss: tf.Tensor(0.088595755, shape=(), dtype=float32)
loss: tf.Tensor(0.2953037, shape=(), dtype=float32)
loss: tf.Tensor(0.13036567, shape=(), dtype=float32)
loss: tf.Tensor(0.18095185, shape=(), dtype=float32)
loss: tf.Tensor(0.12899816, shape=(), dtype=float32)
loss: tf.Tensor(0.108476676, shape=(), dtype=float32)
loss: tf.Tensor(0.10416744, shape=(), dtype=float32)
loss: tf.Tensor(0.14890102, shape=(), dtype=float32)
loss: tf.Tensor(0.0665576, shape=(), dtype=float32)
loss: tf.Tensor(0.12701887, shape=(), dtype=float32)
loss: tf.Tensor(0.12576962, shape=(), dtype=float32)
loss: tf.Tensor(0.10742437, shape=(), dtype=float32)
loss: tf.Tensor(0.08181838, shape=(), dtype=float32)
loss: tf.Tensor(0.11085662, shape=(), dtype=float32)
loss: tf.Tensor(0.04990996, shape=(), dtype=float32)
loss: tf.Tensor(0.05639744, shape=(), dtype=float32)
loss: tf.Tensor(0.11457492, shape=(), dtype=float32)
loss: tf.Tensor(0.122086324, shape=(), dtype=float32)
loss: tf.Tensor(0.2042955, shape=(), dtype=float32)
loss: tf.Tensor(0.23190391, shape=(), dtype=float32)
loss: tf.Tensor(0.18193333, shape=(), dtype=float32)
loss: tf.Tensor(0.096434094, shape=(), dtype=float32)
loss: tf.Tensor(0.0905232, shape=(), dtype=float32)
loss: tf.Tensor(0.07171771, shape=(), dtype=float32)
loss: tf.Tensor(0.08448207, shape=(), dtype=float32)
loss: tf.Tensor(0.10490747, shape=(), dtype=float32)
loss: tf.Tensor(0.10001117, shape=(), dtype=float32)
loss: tf.Tensor(0.08403058, shape=(), dtype=float32)
loss: tf.Tensor(0.09983315, shape=(), dtype=float32)
loss: tf.Tensor(0.04214374, shape=(), dtype=float32)
loss: tf.Tensor(0.08689629, shape=(), dtype=float32)
loss: tf.Tensor(0.17566894, shape=(), dtype=float32)
loss: tf.Tensor(0.1829616, shape=(), dtype=float32)
loss: tf.Tensor(0.021587634, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7134844, shape=(), dtype=float32)
F1 SCORE:
0.82575965
EPOCH  29 #################################
loss: tf.Tensor(0.04298098, shape=(), dtype=float32)
loss: tf.Tensor(0.15326771, shape=(), dtype=float32)
loss: tf.Tensor(0.10948996, shape=(), dtype=float32)
loss: tf.Tensor(0.08858123, shape=(), dtype=float32)
loss: tf.Tensor(0.06845504, shape=(), dtype=float32)
loss: tf.Tensor(0.069883265, shape=(), dtype=float32)
loss: tf.Tensor(0.1034174, shape=(), dtype=float32)
loss: tf.Tensor(0.07622818, shape=(), dtype=float32)
loss: tf.Tensor(0.035025287, shape=(), dtype=float32)
loss: tf.Tensor(0.064529665, shape=(), dtype=float32)
loss: tf.Tensor(0.06378005, shape=(), dtype=float32)
loss: tf.Tensor(0.054608878, shape=(), dtype=float32)
loss: tf.Tensor(0.07021048, shape=(), dtype=float32)
loss: tf.Tensor(0.085731916, shape=(), dtype=float32)
loss: tf.Tensor(0.2140782, shape=(), dtype=float32)
loss: tf.Tensor(0.03891171, shape=(), dtype=float32)
loss: tf.Tensor(0.074228436, shape=(), dtype=float32)
loss: tf.Tensor(0.04546328, shape=(), dtype=float32)
loss: tf.Tensor(0.025815833, shape=(), dtype=float32)
loss: tf.Tensor(0.03410611, shape=(), dtype=float32)
loss: tf.Tensor(0.037875574, shape=(), dtype=float32)
loss: tf.Tensor(0.06942667, shape=(), dtype=float32)
loss: tf.Tensor(0.1664885, shape=(), dtype=float32)
loss: tf.Tensor(0.08986206, shape=(), dtype=float32)
loss: tf.Tensor(0.07576471, shape=(), dtype=float32)
loss: tf.Tensor(0.044424538, shape=(), dtype=float32)
loss: tf.Tensor(0.04537364, shape=(), dtype=float32)
loss: tf.Tensor(0.045240987, shape=(), dtype=float32)
loss: tf.Tensor(0.0490965, shape=(), dtype=float32)
loss: tf.Tensor(0.04759531, shape=(), dtype=float32)
loss: tf.Tensor(0.09786038, shape=(), dtype=float32)
loss: tf.Tensor(0.04094677, shape=(), dtype=float32)
loss: tf.Tensor(0.1451334, shape=(), dtype=float32)
loss: tf.Tensor(0.050367597, shape=(), dtype=float32)
loss: tf.Tensor(0.059315, shape=(), dtype=float32)
loss: tf.Tensor(0.091372706, shape=(), dtype=float32)
loss: tf.Tensor(0.06403121, shape=(), dtype=float32)
loss: tf.Tensor(0.0915649, shape=(), dtype=float32)
loss: tf.Tensor(0.03985014, shape=(), dtype=float32)
loss: tf.Tensor(0.04110322, shape=(), dtype=float32)
loss: tf.Tensor(0.039756626, shape=(), dtype=float32)
loss: tf.Tensor(0.060786262, shape=(), dtype=float32)
loss: tf.Tensor(0.051065084, shape=(), dtype=float32)
loss: tf.Tensor(0.042065218, shape=(), dtype=float32)
loss: tf.Tensor(0.03481405, shape=(), dtype=float32)
loss: tf.Tensor(0.071966074, shape=(), dtype=float32)
loss: tf.Tensor(0.10881996, shape=(), dtype=float32)
loss: tf.Tensor(0.10685043, shape=(), dtype=float32)
loss: tf.Tensor(0.15854266, shape=(), dtype=float32)
loss: tf.Tensor(0.036723107, shape=(), dtype=float32)
loss: tf.Tensor(0.08215389, shape=(), dtype=float32)
loss: tf.Tensor(0.040468726, shape=(), dtype=float32)
loss: tf.Tensor(0.09941145, shape=(), dtype=float32)
loss: tf.Tensor(0.06384437, shape=(), dtype=float32)
loss: tf.Tensor(0.028970074, shape=(), dtype=float32)
loss: tf.Tensor(0.0650407, shape=(), dtype=float32)
loss: tf.Tensor(0.06277322, shape=(), dtype=float32)
loss: tf.Tensor(0.059555303, shape=(), dtype=float32)
loss: tf.Tensor(0.046487313, shape=(), dtype=float32)
loss: tf.Tensor(0.06495163, shape=(), dtype=float32)
loss: tf.Tensor(0.03250389, shape=(), dtype=float32)
loss: tf.Tensor(0.042807005, shape=(), dtype=float32)
loss: tf.Tensor(0.06899284, shape=(), dtype=float32)
loss: tf.Tensor(0.025517406, shape=(), dtype=float32)
loss: tf.Tensor(0.07905635, shape=(), dtype=float32)
loss: tf.Tensor(0.07430657, shape=(), dtype=float32)
loss: tf.Tensor(0.049117938, shape=(), dtype=float32)
loss: tf.Tensor(0.14986418, shape=(), dtype=float32)
loss: tf.Tensor(0.08922845, shape=(), dtype=float32)
loss: tf.Tensor(0.02195095, shape=(), dtype=float32)
loss: tf.Tensor(0.09712864, shape=(), dtype=float32)
loss: tf.Tensor(0.042030524, shape=(), dtype=float32)
loss: tf.Tensor(0.06132746, shape=(), dtype=float32)
loss: tf.Tensor(2.8610189e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7000984, shape=(), dtype=float32)
F1 SCORE:
0.8258373
EPOCH  30 #################################
loss: tf.Tensor(0.0468697, shape=(), dtype=float32)
loss: tf.Tensor(0.06508106, shape=(), dtype=float32)
loss: tf.Tensor(0.07029997, shape=(), dtype=float32)
loss: tf.Tensor(0.060442742, shape=(), dtype=float32)
loss: tf.Tensor(0.020358944, shape=(), dtype=float32)
loss: tf.Tensor(0.018348526, shape=(), dtype=float32)
loss: tf.Tensor(0.036463767, shape=(), dtype=float32)
loss: tf.Tensor(0.07363017, shape=(), dtype=float32)
loss: tf.Tensor(0.13350217, shape=(), dtype=float32)
loss: tf.Tensor(0.028279314, shape=(), dtype=float32)
loss: tf.Tensor(0.038249917, shape=(), dtype=float32)
loss: tf.Tensor(0.021705704, shape=(), dtype=float32)
loss: tf.Tensor(0.031023262, shape=(), dtype=float32)
loss: tf.Tensor(0.04361653, shape=(), dtype=float32)
loss: tf.Tensor(0.05113102, shape=(), dtype=float32)
loss: tf.Tensor(0.18873256, shape=(), dtype=float32)
loss: tf.Tensor(0.09456482, shape=(), dtype=float32)
loss: tf.Tensor(0.009173224, shape=(), dtype=float32)
loss: tf.Tensor(0.0653478, shape=(), dtype=float32)
loss: tf.Tensor(0.049122285, shape=(), dtype=float32)
loss: tf.Tensor(0.020822678, shape=(), dtype=float32)
loss: tf.Tensor(0.031865582, shape=(), dtype=float32)
loss: tf.Tensor(0.15162395, shape=(), dtype=float32)
loss: tf.Tensor(0.0806678, shape=(), dtype=float32)
loss: tf.Tensor(0.036813702, shape=(), dtype=float32)
loss: tf.Tensor(0.058480617, shape=(), dtype=float32)
loss: tf.Tensor(0.050029155, shape=(), dtype=float32)
loss: tf.Tensor(0.111813374, shape=(), dtype=float32)
loss: tf.Tensor(0.034158237, shape=(), dtype=float32)
loss: tf.Tensor(0.0725233, shape=(), dtype=float32)
loss: tf.Tensor(0.027203068, shape=(), dtype=float32)
loss: tf.Tensor(0.038672037, shape=(), dtype=float32)
loss: tf.Tensor(0.018807223, shape=(), dtype=float32)
loss: tf.Tensor(0.025921177, shape=(), dtype=float32)
loss: tf.Tensor(0.022856515, shape=(), dtype=float32)
loss: tf.Tensor(0.030817961, shape=(), dtype=float32)
loss: tf.Tensor(0.0788795, shape=(), dtype=float32)
loss: tf.Tensor(0.04845746, shape=(), dtype=float32)
loss: tf.Tensor(0.155632, shape=(), dtype=float32)
loss: tf.Tensor(0.05116512, shape=(), dtype=float32)
loss: tf.Tensor(0.027644342, shape=(), dtype=float32)
loss: tf.Tensor(0.040625945, shape=(), dtype=float32)
loss: tf.Tensor(0.050412234, shape=(), dtype=float32)
loss: tf.Tensor(0.047738615, shape=(), dtype=float32)
loss: tf.Tensor(0.05289443, shape=(), dtype=float32)
loss: tf.Tensor(0.068388194, shape=(), dtype=float32)
loss: tf.Tensor(0.06263711, shape=(), dtype=float32)
loss: tf.Tensor(0.053804323, shape=(), dtype=float32)
loss: tf.Tensor(0.041702732, shape=(), dtype=float32)
loss: tf.Tensor(0.06555293, shape=(), dtype=float32)
loss: tf.Tensor(0.028139966, shape=(), dtype=float32)
loss: tf.Tensor(0.07801035, shape=(), dtype=float32)
loss: tf.Tensor(0.07984158, shape=(), dtype=float32)
loss: tf.Tensor(0.10546242, shape=(), dtype=float32)
loss: tf.Tensor(0.049230576, shape=(), dtype=float32)
loss: tf.Tensor(0.090703666, shape=(), dtype=float32)
loss: tf.Tensor(0.07514314, shape=(), dtype=float32)
loss: tf.Tensor(0.08340906, shape=(), dtype=float32)
loss: tf.Tensor(0.04130061, shape=(), dtype=float32)
loss: tf.Tensor(0.073661484, shape=(), dtype=float32)
loss: tf.Tensor(0.035919856, shape=(), dtype=float32)
loss: tf.Tensor(0.037827842, shape=(), dtype=float32)
loss: tf.Tensor(0.09654126, shape=(), dtype=float32)
loss: tf.Tensor(0.045263205, shape=(), dtype=float32)
loss: tf.Tensor(0.10213349, shape=(), dtype=float32)
loss: tf.Tensor(0.10002795, shape=(), dtype=float32)
loss: tf.Tensor(0.04429535, shape=(), dtype=float32)
loss: tf.Tensor(0.058825906, shape=(), dtype=float32)
loss: tf.Tensor(0.047163405, shape=(), dtype=float32)
loss: tf.Tensor(0.029948518, shape=(), dtype=float32)
loss: tf.Tensor(0.025174227, shape=(), dtype=float32)
loss: tf.Tensor(0.0564894, shape=(), dtype=float32)
loss: tf.Tensor(0.023215283, shape=(), dtype=float32)
loss: tf.Tensor(0.0013712775, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7039961, shape=(), dtype=float32)
F1 SCORE:
0.8260541
EPOCH  31 #################################
loss: tf.Tensor(0.023194041, shape=(), dtype=float32)
loss: tf.Tensor(0.10179315, shape=(), dtype=float32)
loss: tf.Tensor(0.07074052, shape=(), dtype=float32)
loss: tf.Tensor(0.032325517, shape=(), dtype=float32)
loss: tf.Tensor(0.03747851, shape=(), dtype=float32)
loss: tf.Tensor(0.024291672, shape=(), dtype=float32)
loss: tf.Tensor(0.026330216, shape=(), dtype=float32)
loss: tf.Tensor(0.058109228, shape=(), dtype=float32)
loss: tf.Tensor(0.026999982, shape=(), dtype=float32)
loss: tf.Tensor(0.030103311, shape=(), dtype=float32)
loss: tf.Tensor(0.020280318, shape=(), dtype=float32)
loss: tf.Tensor(0.03141044, shape=(), dtype=float32)
loss: tf.Tensor(0.03344596, shape=(), dtype=float32)
loss: tf.Tensor(0.06738236, shape=(), dtype=float32)
loss: tf.Tensor(0.035770174, shape=(), dtype=float32)
loss: tf.Tensor(0.06894156, shape=(), dtype=float32)
loss: tf.Tensor(0.025582587, shape=(), dtype=float32)
loss: tf.Tensor(0.023827624, shape=(), dtype=float32)
loss: tf.Tensor(0.0708878, shape=(), dtype=float32)
loss: tf.Tensor(0.09228819, shape=(), dtype=float32)
loss: tf.Tensor(0.08022363, shape=(), dtype=float32)
loss: tf.Tensor(0.044586882, shape=(), dtype=float32)
loss: tf.Tensor(0.04113014, shape=(), dtype=float32)
loss: tf.Tensor(0.017016055, shape=(), dtype=float32)
loss: tf.Tensor(0.08908467, shape=(), dtype=float32)
loss: tf.Tensor(0.05434556, shape=(), dtype=float32)
loss: tf.Tensor(0.06549383, shape=(), dtype=float32)
loss: tf.Tensor(0.09907461, shape=(), dtype=float32)
loss: tf.Tensor(0.16783579, shape=(), dtype=float32)
loss: tf.Tensor(0.058566567, shape=(), dtype=float32)
loss: tf.Tensor(0.030189926, shape=(), dtype=float32)
loss: tf.Tensor(0.063606136, shape=(), dtype=float32)
loss: tf.Tensor(0.041053616, shape=(), dtype=float32)
loss: tf.Tensor(0.088416636, shape=(), dtype=float32)
loss: tf.Tensor(0.055497847, shape=(), dtype=float32)
loss: tf.Tensor(0.04512036, shape=(), dtype=float32)
loss: tf.Tensor(0.02594254, shape=(), dtype=float32)
loss: tf.Tensor(0.08363494, shape=(), dtype=float32)
loss: tf.Tensor(0.04113115, shape=(), dtype=float32)
loss: tf.Tensor(0.08407534, shape=(), dtype=float32)
loss: tf.Tensor(0.037606172, shape=(), dtype=float32)
loss: tf.Tensor(0.06929606, shape=(), dtype=float32)
loss: tf.Tensor(0.037014708, shape=(), dtype=float32)
loss: tf.Tensor(0.110602304, shape=(), dtype=float32)
loss: tf.Tensor(0.035595275, shape=(), dtype=float32)
loss: tf.Tensor(0.023922075, shape=(), dtype=float32)
loss: tf.Tensor(0.055806495, shape=(), dtype=float32)
loss: tf.Tensor(0.04224108, shape=(), dtype=float32)
loss: tf.Tensor(0.045643706, shape=(), dtype=float32)
loss: tf.Tensor(0.024496268, shape=(), dtype=float32)
loss: tf.Tensor(0.07185931, shape=(), dtype=float32)
loss: tf.Tensor(0.024885908, shape=(), dtype=float32)
loss: tf.Tensor(0.060180526, shape=(), dtype=float32)
loss: tf.Tensor(0.028655143, shape=(), dtype=float32)
loss: tf.Tensor(0.15948962, shape=(), dtype=float32)
loss: tf.Tensor(0.038207714, shape=(), dtype=float32)
loss: tf.Tensor(0.075964816, shape=(), dtype=float32)
loss: tf.Tensor(0.07129708, shape=(), dtype=float32)
loss: tf.Tensor(0.12738864, shape=(), dtype=float32)
loss: tf.Tensor(0.054415684, shape=(), dtype=float32)
loss: tf.Tensor(0.058974516, shape=(), dtype=float32)
loss: tf.Tensor(0.13853337, shape=(), dtype=float32)
loss: tf.Tensor(0.053667217, shape=(), dtype=float32)
loss: tf.Tensor(0.07362903, shape=(), dtype=float32)
loss: tf.Tensor(0.041555725, shape=(), dtype=float32)
loss: tf.Tensor(0.040287584, shape=(), dtype=float32)
loss: tf.Tensor(0.1946365, shape=(), dtype=float32)
loss: tf.Tensor(0.06023407, shape=(), dtype=float32)
loss: tf.Tensor(0.032412514, shape=(), dtype=float32)
loss: tf.Tensor(0.021077385, shape=(), dtype=float32)
loss: tf.Tensor(0.06965085, shape=(), dtype=float32)
loss: tf.Tensor(0.06147511, shape=(), dtype=float32)
loss: tf.Tensor(0.013849151, shape=(), dtype=float32)
loss: tf.Tensor(0.00025710138, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7032974, shape=(), dtype=float32)
F1 SCORE:
0.8259918
EPOCH  32 #################################
loss: tf.Tensor(0.060700927, shape=(), dtype=float32)
loss: tf.Tensor(0.026402403, shape=(), dtype=float32)
loss: tf.Tensor(0.04803928, shape=(), dtype=float32)
loss: tf.Tensor(0.038081974, shape=(), dtype=float32)
loss: tf.Tensor(0.04413068, shape=(), dtype=float32)
loss: tf.Tensor(0.021286547, shape=(), dtype=float32)
loss: tf.Tensor(0.019987326, shape=(), dtype=float32)
loss: tf.Tensor(0.051199913, shape=(), dtype=float32)
loss: tf.Tensor(0.068016164, shape=(), dtype=float32)
loss: tf.Tensor(0.048115164, shape=(), dtype=float32)
loss: tf.Tensor(0.06781209, shape=(), dtype=float32)
loss: tf.Tensor(0.030472971, shape=(), dtype=float32)
loss: tf.Tensor(0.05996483, shape=(), dtype=float32)
loss: tf.Tensor(0.007976887, shape=(), dtype=float32)
loss: tf.Tensor(0.02558881, shape=(), dtype=float32)
loss: tf.Tensor(0.04632459, shape=(), dtype=float32)
loss: tf.Tensor(0.11133705, shape=(), dtype=float32)
loss: tf.Tensor(0.02721281, shape=(), dtype=float32)
loss: tf.Tensor(0.07410827, shape=(), dtype=float32)
loss: tf.Tensor(0.05472611, shape=(), dtype=float32)
loss: tf.Tensor(0.011743141, shape=(), dtype=float32)
loss: tf.Tensor(0.047035817, shape=(), dtype=float32)
loss: tf.Tensor(0.074213155, shape=(), dtype=float32)
loss: tf.Tensor(0.020844981, shape=(), dtype=float32)
loss: tf.Tensor(0.040718757, shape=(), dtype=float32)
loss: tf.Tensor(0.044619992, shape=(), dtype=float32)
loss: tf.Tensor(0.06427158, shape=(), dtype=float32)
loss: tf.Tensor(0.049392745, shape=(), dtype=float32)
loss: tf.Tensor(0.044693884, shape=(), dtype=float32)
loss: tf.Tensor(0.033596843, shape=(), dtype=float32)
loss: tf.Tensor(0.0453268, shape=(), dtype=float32)
loss: tf.Tensor(0.024849944, shape=(), dtype=float32)
loss: tf.Tensor(0.013430833, shape=(), dtype=float32)
loss: tf.Tensor(0.03223181, shape=(), dtype=float32)
loss: tf.Tensor(0.026918758, shape=(), dtype=float32)
loss: tf.Tensor(0.03693829, shape=(), dtype=float32)
loss: tf.Tensor(0.09145826, shape=(), dtype=float32)
loss: tf.Tensor(0.04560306, shape=(), dtype=float32)
loss: tf.Tensor(0.008681022, shape=(), dtype=float32)
loss: tf.Tensor(0.06554503, shape=(), dtype=float32)
loss: tf.Tensor(0.036333848, shape=(), dtype=float32)
loss: tf.Tensor(0.082142495, shape=(), dtype=float32)
loss: tf.Tensor(0.10146219, shape=(), dtype=float32)
loss: tf.Tensor(0.015334839, shape=(), dtype=float32)
loss: tf.Tensor(0.047534846, shape=(), dtype=float32)
loss: tf.Tensor(0.037187718, shape=(), dtype=float32)
loss: tf.Tensor(0.009346443, shape=(), dtype=float32)
loss: tf.Tensor(0.04159243, shape=(), dtype=float32)
loss: tf.Tensor(0.005248161, shape=(), dtype=float32)
loss: tf.Tensor(0.062307533, shape=(), dtype=float32)
loss: tf.Tensor(0.02446193, shape=(), dtype=float32)
loss: tf.Tensor(0.031745583, shape=(), dtype=float32)
loss: tf.Tensor(0.12281295, shape=(), dtype=float32)
loss: tf.Tensor(0.04796234, shape=(), dtype=float32)
loss: tf.Tensor(0.05771473, shape=(), dtype=float32)
loss: tf.Tensor(0.15009089, shape=(), dtype=float32)
loss: tf.Tensor(0.021656506, shape=(), dtype=float32)
loss: tf.Tensor(0.06358682, shape=(), dtype=float32)
loss: tf.Tensor(0.059766427, shape=(), dtype=float32)
loss: tf.Tensor(0.10610011, shape=(), dtype=float32)
loss: tf.Tensor(0.037662506, shape=(), dtype=float32)
loss: tf.Tensor(0.14403059, shape=(), dtype=float32)
loss: tf.Tensor(0.042719673, shape=(), dtype=float32)
loss: tf.Tensor(0.023560552, shape=(), dtype=float32)
loss: tf.Tensor(0.07785047, shape=(), dtype=float32)
loss: tf.Tensor(0.041399784, shape=(), dtype=float32)
loss: tf.Tensor(0.07787652, shape=(), dtype=float32)
loss: tf.Tensor(0.037686758, shape=(), dtype=float32)
loss: tf.Tensor(0.072985545, shape=(), dtype=float32)
loss: tf.Tensor(0.16804962, shape=(), dtype=float32)
loss: tf.Tensor(0.034899622, shape=(), dtype=float32)
loss: tf.Tensor(0.08448494, shape=(), dtype=float32)
loss: tf.Tensor(0.041754916, shape=(), dtype=float32)
loss: tf.Tensor(0.4971722, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7065691, shape=(), dtype=float32)
F1 SCORE:
0.82597524
EPOCH  33 #################################
loss: tf.Tensor(0.02227242, shape=(), dtype=float32)
loss: tf.Tensor(0.14752063, shape=(), dtype=float32)
loss: tf.Tensor(0.1255477, shape=(), dtype=float32)
loss: tf.Tensor(0.27587697, shape=(), dtype=float32)
loss: tf.Tensor(0.30850777, shape=(), dtype=float32)
loss: tf.Tensor(0.2041175, shape=(), dtype=float32)
loss: tf.Tensor(0.23697852, shape=(), dtype=float32)
loss: tf.Tensor(0.22042525, shape=(), dtype=float32)
loss: tf.Tensor(0.13516119, shape=(), dtype=float32)
loss: tf.Tensor(0.10156264, shape=(), dtype=float32)
loss: tf.Tensor(0.24368444, shape=(), dtype=float32)
loss: tf.Tensor(0.20441416, shape=(), dtype=float32)
loss: tf.Tensor(0.13162588, shape=(), dtype=float32)
loss: tf.Tensor(0.18870887, shape=(), dtype=float32)
loss: tf.Tensor(0.14106126, shape=(), dtype=float32)
loss: tf.Tensor(0.18280418, shape=(), dtype=float32)
loss: tf.Tensor(0.100615405, shape=(), dtype=float32)
loss: tf.Tensor(0.10654358, shape=(), dtype=float32)
loss: tf.Tensor(0.09758872, shape=(), dtype=float32)
loss: tf.Tensor(0.06463245, shape=(), dtype=float32)
loss: tf.Tensor(0.19834, shape=(), dtype=float32)
loss: tf.Tensor(0.10589303, shape=(), dtype=float32)
loss: tf.Tensor(0.11705124, shape=(), dtype=float32)
loss: tf.Tensor(0.08323171, shape=(), dtype=float32)
loss: tf.Tensor(0.1372663, shape=(), dtype=float32)
loss: tf.Tensor(0.12230693, shape=(), dtype=float32)
loss: tf.Tensor(0.24344873, shape=(), dtype=float32)
loss: tf.Tensor(0.1246168, shape=(), dtype=float32)
loss: tf.Tensor(0.11713164, shape=(), dtype=float32)
loss: tf.Tensor(0.10082427, shape=(), dtype=float32)
loss: tf.Tensor(0.12719432, shape=(), dtype=float32)
loss: tf.Tensor(0.08397781, shape=(), dtype=float32)
loss: tf.Tensor(0.17563935, shape=(), dtype=float32)
loss: tf.Tensor(0.07875863, shape=(), dtype=float32)
loss: tf.Tensor(0.16541453, shape=(), dtype=float32)
loss: tf.Tensor(0.17036442, shape=(), dtype=float32)
loss: tf.Tensor(0.11733203, shape=(), dtype=float32)
loss: tf.Tensor(0.1971431, shape=(), dtype=float32)
loss: tf.Tensor(0.15285644, shape=(), dtype=float32)
loss: tf.Tensor(0.12519315, shape=(), dtype=float32)
loss: tf.Tensor(0.09557706, shape=(), dtype=float32)
loss: tf.Tensor(0.15493032, shape=(), dtype=float32)
loss: tf.Tensor(0.09886785, shape=(), dtype=float32)
loss: tf.Tensor(0.10354182, shape=(), dtype=float32)
loss: tf.Tensor(0.09436658, shape=(), dtype=float32)
loss: tf.Tensor(0.19612494, shape=(), dtype=float32)
loss: tf.Tensor(0.088398874, shape=(), dtype=float32)
loss: tf.Tensor(0.0793243, shape=(), dtype=float32)
loss: tf.Tensor(0.141998, shape=(), dtype=float32)
loss: tf.Tensor(0.1754368, shape=(), dtype=float32)
loss: tf.Tensor(0.07872367, shape=(), dtype=float32)
loss: tf.Tensor(0.072521694, shape=(), dtype=float32)
loss: tf.Tensor(0.123827785, shape=(), dtype=float32)
loss: tf.Tensor(0.15489216, shape=(), dtype=float32)
loss: tf.Tensor(0.05793917, shape=(), dtype=float32)
loss: tf.Tensor(0.12041535, shape=(), dtype=float32)
loss: tf.Tensor(0.070972025, shape=(), dtype=float32)
loss: tf.Tensor(0.11280355, shape=(), dtype=float32)
loss: tf.Tensor(0.14200167, shape=(), dtype=float32)
loss: tf.Tensor(0.06668826, shape=(), dtype=float32)
loss: tf.Tensor(0.045332257, shape=(), dtype=float32)
loss: tf.Tensor(0.0914491, shape=(), dtype=float32)
loss: tf.Tensor(0.09860983, shape=(), dtype=float32)
loss: tf.Tensor(0.16490863, shape=(), dtype=float32)
loss: tf.Tensor(0.1208205, shape=(), dtype=float32)
loss: tf.Tensor(0.06734369, shape=(), dtype=float32)
loss: tf.Tensor(0.10451022, shape=(), dtype=float32)
loss: tf.Tensor(0.020639839, shape=(), dtype=float32)
loss: tf.Tensor(0.052808058, shape=(), dtype=float32)
loss: tf.Tensor(0.050285373, shape=(), dtype=float32)
loss: tf.Tensor(0.10779274, shape=(), dtype=float32)
loss: tf.Tensor(0.05354707, shape=(), dtype=float32)
loss: tf.Tensor(0.05793888, shape=(), dtype=float32)
loss: tf.Tensor(1.1920928e-07, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69891226, shape=(), dtype=float32)
F1 SCORE:
0.82615453
EPOCH  34 #################################
loss: tf.Tensor(0.17652577, shape=(), dtype=float32)
loss: tf.Tensor(0.07265403, shape=(), dtype=float32)
loss: tf.Tensor(0.05024823, shape=(), dtype=float32)
loss: tf.Tensor(0.042406376, shape=(), dtype=float32)
loss: tf.Tensor(0.08646065, shape=(), dtype=float32)
loss: tf.Tensor(0.0381993, shape=(), dtype=float32)
loss: tf.Tensor(0.07141032, shape=(), dtype=float32)
loss: tf.Tensor(0.07718542, shape=(), dtype=float32)
loss: tf.Tensor(0.036604468, shape=(), dtype=float32)
loss: tf.Tensor(0.09295313, shape=(), dtype=float32)
loss: tf.Tensor(0.019518627, shape=(), dtype=float32)
loss: tf.Tensor(0.09743303, shape=(), dtype=float32)
loss: tf.Tensor(0.015218313, shape=(), dtype=float32)
loss: tf.Tensor(0.091460064, shape=(), dtype=float32)
loss: tf.Tensor(0.055952635, shape=(), dtype=float32)
loss: tf.Tensor(0.035145294, shape=(), dtype=float32)
loss: tf.Tensor(0.09352017, shape=(), dtype=float32)
loss: tf.Tensor(0.038516525, shape=(), dtype=float32)
loss: tf.Tensor(0.08436679, shape=(), dtype=float32)
loss: tf.Tensor(0.11104883, shape=(), dtype=float32)
loss: tf.Tensor(0.08626342, shape=(), dtype=float32)
loss: tf.Tensor(0.034149043, shape=(), dtype=float32)
loss: tf.Tensor(0.038065244, shape=(), dtype=float32)
loss: tf.Tensor(0.04118921, shape=(), dtype=float32)
loss: tf.Tensor(0.042494047, shape=(), dtype=float32)
loss: tf.Tensor(0.047547545, shape=(), dtype=float32)
loss: tf.Tensor(0.15370314, shape=(), dtype=float32)
loss: tf.Tensor(0.052538764, shape=(), dtype=float32)
loss: tf.Tensor(0.09371407, shape=(), dtype=float32)
loss: tf.Tensor(0.03505848, shape=(), dtype=float32)
loss: tf.Tensor(0.04019462, shape=(), dtype=float32)
loss: tf.Tensor(0.11429085, shape=(), dtype=float32)
loss: tf.Tensor(0.04583256, shape=(), dtype=float32)
loss: tf.Tensor(0.16916779, shape=(), dtype=float32)
loss: tf.Tensor(0.040198527, shape=(), dtype=float32)
loss: tf.Tensor(0.049758542, shape=(), dtype=float32)
loss: tf.Tensor(0.08135352, shape=(), dtype=float32)
loss: tf.Tensor(0.023460932, shape=(), dtype=float32)
loss: tf.Tensor(0.058174048, shape=(), dtype=float32)
loss: tf.Tensor(0.08664513, shape=(), dtype=float32)
loss: tf.Tensor(0.07077525, shape=(), dtype=float32)
loss: tf.Tensor(0.037462242, shape=(), dtype=float32)
loss: tf.Tensor(0.08545514, shape=(), dtype=float32)
loss: tf.Tensor(0.12868719, shape=(), dtype=float32)
loss: tf.Tensor(0.10062918, shape=(), dtype=float32)
loss: tf.Tensor(0.052435994, shape=(), dtype=float32)
loss: tf.Tensor(0.030282585, shape=(), dtype=float32)
loss: tf.Tensor(0.115548395, shape=(), dtype=float32)
loss: tf.Tensor(0.058893412, shape=(), dtype=float32)
loss: tf.Tensor(0.11150679, shape=(), dtype=float32)
loss: tf.Tensor(0.025590025, shape=(), dtype=float32)
loss: tf.Tensor(0.098516226, shape=(), dtype=float32)
loss: tf.Tensor(0.031661157, shape=(), dtype=float32)
loss: tf.Tensor(0.08435062, shape=(), dtype=float32)
loss: tf.Tensor(0.014468124, shape=(), dtype=float32)
loss: tf.Tensor(0.04734538, shape=(), dtype=float32)
loss: tf.Tensor(0.049660012, shape=(), dtype=float32)
loss: tf.Tensor(0.029135995, shape=(), dtype=float32)
loss: tf.Tensor(0.03280289, shape=(), dtype=float32)
loss: tf.Tensor(0.04378129, shape=(), dtype=float32)
loss: tf.Tensor(0.12268707, shape=(), dtype=float32)
loss: tf.Tensor(0.03256807, shape=(), dtype=float32)
loss: tf.Tensor(0.06190424, shape=(), dtype=float32)
loss: tf.Tensor(0.033608798, shape=(), dtype=float32)
loss: tf.Tensor(0.08033401, shape=(), dtype=float32)
loss: tf.Tensor(0.061163254, shape=(), dtype=float32)
loss: tf.Tensor(0.047677822, shape=(), dtype=float32)
loss: tf.Tensor(0.059159547, shape=(), dtype=float32)
loss: tf.Tensor(0.05832349, shape=(), dtype=float32)
loss: tf.Tensor(0.016204633, shape=(), dtype=float32)
loss: tf.Tensor(0.075676076, shape=(), dtype=float32)
loss: tf.Tensor(0.040226884, shape=(), dtype=float32)
loss: tf.Tensor(0.039449237, shape=(), dtype=float32)
loss: tf.Tensor(0.10388576, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70115286, shape=(), dtype=float32)
F1 SCORE:
0.8261497
EPOCH  35 #################################
loss: tf.Tensor(0.014808783, shape=(), dtype=float32)
loss: tf.Tensor(0.06484114, shape=(), dtype=float32)
loss: tf.Tensor(0.120555595, shape=(), dtype=float32)
loss: tf.Tensor(0.023264723, shape=(), dtype=float32)
loss: tf.Tensor(0.1248292, shape=(), dtype=float32)
loss: tf.Tensor(0.045190312, shape=(), dtype=float32)
loss: tf.Tensor(0.13565324, shape=(), dtype=float32)
loss: tf.Tensor(0.031429242, shape=(), dtype=float32)
loss: tf.Tensor(0.04595147, shape=(), dtype=float32)
loss: tf.Tensor(0.057036318, shape=(), dtype=float32)
loss: tf.Tensor(0.029676085, shape=(), dtype=float32)
loss: tf.Tensor(0.080859624, shape=(), dtype=float32)
loss: tf.Tensor(0.11034987, shape=(), dtype=float32)
loss: tf.Tensor(0.051403478, shape=(), dtype=float32)
loss: tf.Tensor(0.017513784, shape=(), dtype=float32)
loss: tf.Tensor(0.05843918, shape=(), dtype=float32)
loss: tf.Tensor(0.13305454, shape=(), dtype=float32)
loss: tf.Tensor(0.046032224, shape=(), dtype=float32)
loss: tf.Tensor(0.024909524, shape=(), dtype=float32)
loss: tf.Tensor(0.073016725, shape=(), dtype=float32)
loss: tf.Tensor(0.056433965, shape=(), dtype=float32)
loss: tf.Tensor(0.08698249, shape=(), dtype=float32)
loss: tf.Tensor(0.07203631, shape=(), dtype=float32)
loss: tf.Tensor(0.015297489, shape=(), dtype=float32)
loss: tf.Tensor(0.025641035, shape=(), dtype=float32)
loss: tf.Tensor(0.05433173, shape=(), dtype=float32)
loss: tf.Tensor(0.0075669377, shape=(), dtype=float32)
loss: tf.Tensor(0.0452114, shape=(), dtype=float32)
loss: tf.Tensor(0.056002256, shape=(), dtype=float32)
loss: tf.Tensor(0.047530513, shape=(), dtype=float32)
loss: tf.Tensor(0.1651124, shape=(), dtype=float32)
loss: tf.Tensor(0.031296186, shape=(), dtype=float32)
loss: tf.Tensor(0.042778924, shape=(), dtype=float32)
loss: tf.Tensor(0.053438302, shape=(), dtype=float32)
loss: tf.Tensor(0.040719777, shape=(), dtype=float32)
loss: tf.Tensor(0.08981262, shape=(), dtype=float32)
loss: tf.Tensor(0.07009442, shape=(), dtype=float32)
loss: tf.Tensor(0.07812288, shape=(), dtype=float32)
loss: tf.Tensor(0.045548655, shape=(), dtype=float32)
loss: tf.Tensor(0.016485693, shape=(), dtype=float32)
loss: tf.Tensor(0.0480642, shape=(), dtype=float32)
loss: tf.Tensor(0.048702307, shape=(), dtype=float32)
loss: tf.Tensor(0.031188741, shape=(), dtype=float32)
loss: tf.Tensor(0.07395618, shape=(), dtype=float32)
loss: tf.Tensor(0.09151095, shape=(), dtype=float32)
loss: tf.Tensor(0.12576625, shape=(), dtype=float32)
loss: tf.Tensor(0.08885934, shape=(), dtype=float32)
loss: tf.Tensor(0.05229495, shape=(), dtype=float32)
loss: tf.Tensor(0.050828207, shape=(), dtype=float32)
loss: tf.Tensor(0.043487582, shape=(), dtype=float32)
loss: tf.Tensor(0.039956417, shape=(), dtype=float32)
loss: tf.Tensor(0.010611439, shape=(), dtype=float32)
loss: tf.Tensor(0.056467835, shape=(), dtype=float32)
loss: tf.Tensor(0.05768422, shape=(), dtype=float32)
loss: tf.Tensor(0.024017716, shape=(), dtype=float32)
loss: tf.Tensor(0.021504736, shape=(), dtype=float32)
loss: tf.Tensor(0.04576784, shape=(), dtype=float32)
loss: tf.Tensor(0.054908376, shape=(), dtype=float32)
loss: tf.Tensor(0.14723617, shape=(), dtype=float32)
loss: tf.Tensor(0.02722975, shape=(), dtype=float32)
loss: tf.Tensor(0.058154747, shape=(), dtype=float32)
loss: tf.Tensor(0.04589132, shape=(), dtype=float32)
loss: tf.Tensor(0.050554525, shape=(), dtype=float32)
loss: tf.Tensor(0.018851556, shape=(), dtype=float32)
loss: tf.Tensor(0.08500454, shape=(), dtype=float32)
loss: tf.Tensor(0.09424006, shape=(), dtype=float32)
loss: tf.Tensor(0.057172168, shape=(), dtype=float32)
loss: tf.Tensor(0.04818474, shape=(), dtype=float32)
loss: tf.Tensor(0.009290414, shape=(), dtype=float32)
loss: tf.Tensor(0.034531094, shape=(), dtype=float32)
loss: tf.Tensor(0.060770463, shape=(), dtype=float32)
loss: tf.Tensor(0.069685675, shape=(), dtype=float32)
loss: tf.Tensor(0.054516725, shape=(), dtype=float32)
loss: tf.Tensor(0.0001840422, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7031314, shape=(), dtype=float32)
F1 SCORE:
0.8260972
EPOCH  36 #################################
loss: tf.Tensor(0.05462573, shape=(), dtype=float32)
loss: tf.Tensor(0.041652266, shape=(), dtype=float32)
loss: tf.Tensor(0.066583574, shape=(), dtype=float32)
loss: tf.Tensor(0.020322904, shape=(), dtype=float32)
loss: tf.Tensor(0.03373753, shape=(), dtype=float32)
loss: tf.Tensor(0.04609107, shape=(), dtype=float32)
loss: tf.Tensor(0.024286106, shape=(), dtype=float32)
loss: tf.Tensor(0.05426487, shape=(), dtype=float32)
loss: tf.Tensor(0.017322177, shape=(), dtype=float32)
loss: tf.Tensor(0.0143973855, shape=(), dtype=float32)
loss: tf.Tensor(0.057996444, shape=(), dtype=float32)
loss: tf.Tensor(0.07077463, shape=(), dtype=float32)
loss: tf.Tensor(0.07376889, shape=(), dtype=float32)
loss: tf.Tensor(0.011828085, shape=(), dtype=float32)
loss: tf.Tensor(0.043012336, shape=(), dtype=float32)
loss: tf.Tensor(0.107311144, shape=(), dtype=float32)
loss: tf.Tensor(0.022381032, shape=(), dtype=float32)
loss: tf.Tensor(0.049858447, shape=(), dtype=float32)
loss: tf.Tensor(0.014388138, shape=(), dtype=float32)
loss: tf.Tensor(0.030866332, shape=(), dtype=float32)
loss: tf.Tensor(0.09989445, shape=(), dtype=float32)
loss: tf.Tensor(0.08622299, shape=(), dtype=float32)
loss: tf.Tensor(0.04959922, shape=(), dtype=float32)
loss: tf.Tensor(0.018095361, shape=(), dtype=float32)
loss: tf.Tensor(0.017309869, shape=(), dtype=float32)
loss: tf.Tensor(0.03384272, shape=(), dtype=float32)
loss: tf.Tensor(0.030279443, shape=(), dtype=float32)
loss: tf.Tensor(0.013864953, shape=(), dtype=float32)
loss: tf.Tensor(0.06812972, shape=(), dtype=float32)
loss: tf.Tensor(0.020397466, shape=(), dtype=float32)
loss: tf.Tensor(0.011349988, shape=(), dtype=float32)
loss: tf.Tensor(0.09613021, shape=(), dtype=float32)
loss: tf.Tensor(0.07333238, shape=(), dtype=float32)
loss: tf.Tensor(0.048833188, shape=(), dtype=float32)
loss: tf.Tensor(0.08648856, shape=(), dtype=float32)
loss: tf.Tensor(0.09093905, shape=(), dtype=float32)
loss: tf.Tensor(0.018841691, shape=(), dtype=float32)
loss: tf.Tensor(0.054590326, shape=(), dtype=float32)
loss: tf.Tensor(0.040851083, shape=(), dtype=float32)
loss: tf.Tensor(0.05253591, shape=(), dtype=float32)
loss: tf.Tensor(0.09231349, shape=(), dtype=float32)
loss: tf.Tensor(0.060511783, shape=(), dtype=float32)
loss: tf.Tensor(0.053188287, shape=(), dtype=float32)
loss: tf.Tensor(0.06795937, shape=(), dtype=float32)
loss: tf.Tensor(0.10182333, shape=(), dtype=float32)
loss: tf.Tensor(0.012369249, shape=(), dtype=float32)
loss: tf.Tensor(0.012743338, shape=(), dtype=float32)
loss: tf.Tensor(0.03206963, shape=(), dtype=float32)
loss: tf.Tensor(0.04248754, shape=(), dtype=float32)
loss: tf.Tensor(0.014847501, shape=(), dtype=float32)
loss: tf.Tensor(0.077617384, shape=(), dtype=float32)
loss: tf.Tensor(0.021823509, shape=(), dtype=float32)
loss: tf.Tensor(0.053282667, shape=(), dtype=float32)
loss: tf.Tensor(0.03610412, shape=(), dtype=float32)
loss: tf.Tensor(0.04154122, shape=(), dtype=float32)
loss: tf.Tensor(0.028309995, shape=(), dtype=float32)
loss: tf.Tensor(0.027451752, shape=(), dtype=float32)
loss: tf.Tensor(0.03309006, shape=(), dtype=float32)
loss: tf.Tensor(0.04237449, shape=(), dtype=float32)
loss: tf.Tensor(0.041400228, shape=(), dtype=float32)
loss: tf.Tensor(0.010704327, shape=(), dtype=float32)
loss: tf.Tensor(0.10040288, shape=(), dtype=float32)
loss: tf.Tensor(0.01063257, shape=(), dtype=float32)
loss: tf.Tensor(0.056983985, shape=(), dtype=float32)
loss: tf.Tensor(0.027580028, shape=(), dtype=float32)
loss: tf.Tensor(0.035759546, shape=(), dtype=float32)
loss: tf.Tensor(0.006125848, shape=(), dtype=float32)
loss: tf.Tensor(0.034399495, shape=(), dtype=float32)
loss: tf.Tensor(0.03162471, shape=(), dtype=float32)
loss: tf.Tensor(0.013541885, shape=(), dtype=float32)
loss: tf.Tensor(0.034417387, shape=(), dtype=float32)
loss: tf.Tensor(0.029056199, shape=(), dtype=float32)
loss: tf.Tensor(0.043936003, shape=(), dtype=float32)
loss: tf.Tensor(1.8238856e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69914746, shape=(), dtype=float32)
F1 SCORE:
0.8261607
EPOCH  37 #################################
loss: tf.Tensor(0.010228169, shape=(), dtype=float32)
loss: tf.Tensor(0.006977024, shape=(), dtype=float32)
loss: tf.Tensor(0.026631901, shape=(), dtype=float32)
loss: tf.Tensor(0.009235367, shape=(), dtype=float32)
loss: tf.Tensor(0.024254229, shape=(), dtype=float32)
loss: tf.Tensor(0.02326037, shape=(), dtype=float32)
loss: tf.Tensor(0.012150005, shape=(), dtype=float32)
loss: tf.Tensor(0.017577633, shape=(), dtype=float32)
loss: tf.Tensor(0.089470804, shape=(), dtype=float32)
loss: tf.Tensor(0.052701846, shape=(), dtype=float32)
loss: tf.Tensor(0.037690233, shape=(), dtype=float32)
loss: tf.Tensor(0.015985, shape=(), dtype=float32)
loss: tf.Tensor(0.022299344, shape=(), dtype=float32)
loss: tf.Tensor(0.025240526, shape=(), dtype=float32)
loss: tf.Tensor(0.023565913, shape=(), dtype=float32)
loss: tf.Tensor(0.035980567, shape=(), dtype=float32)
loss: tf.Tensor(0.093461685, shape=(), dtype=float32)
loss: tf.Tensor(0.011365422, shape=(), dtype=float32)
loss: tf.Tensor(0.056347236, shape=(), dtype=float32)
loss: tf.Tensor(0.018897107, shape=(), dtype=float32)
loss: tf.Tensor(0.07171287, shape=(), dtype=float32)
loss: tf.Tensor(0.11822485, shape=(), dtype=float32)
loss: tf.Tensor(0.04034988, shape=(), dtype=float32)
loss: tf.Tensor(0.086891614, shape=(), dtype=float32)
loss: tf.Tensor(0.03326567, shape=(), dtype=float32)
loss: tf.Tensor(0.038729392, shape=(), dtype=float32)
loss: tf.Tensor(0.013367334, shape=(), dtype=float32)
loss: tf.Tensor(0.022700367, shape=(), dtype=float32)
loss: tf.Tensor(0.07611134, shape=(), dtype=float32)
loss: tf.Tensor(0.06650398, shape=(), dtype=float32)
loss: tf.Tensor(0.03394341, shape=(), dtype=float32)
loss: tf.Tensor(0.023470957, shape=(), dtype=float32)
loss: tf.Tensor(0.021080742, shape=(), dtype=float32)
loss: tf.Tensor(0.014414562, shape=(), dtype=float32)
loss: tf.Tensor(0.014464204, shape=(), dtype=float32)
loss: tf.Tensor(0.043716785, shape=(), dtype=float32)
loss: tf.Tensor(0.02130127, shape=(), dtype=float32)
loss: tf.Tensor(0.05746423, shape=(), dtype=float32)
loss: tf.Tensor(0.05555646, shape=(), dtype=float32)
loss: tf.Tensor(0.06258087, shape=(), dtype=float32)
loss: tf.Tensor(0.035784114, shape=(), dtype=float32)
loss: tf.Tensor(0.11499351, shape=(), dtype=float32)
loss: tf.Tensor(0.016454102, shape=(), dtype=float32)
loss: tf.Tensor(0.09168812, shape=(), dtype=float32)
loss: tf.Tensor(0.04716848, shape=(), dtype=float32)
loss: tf.Tensor(0.028022734, shape=(), dtype=float32)
loss: tf.Tensor(0.038719136, shape=(), dtype=float32)
loss: tf.Tensor(0.065405756, shape=(), dtype=float32)
loss: tf.Tensor(0.012739479, shape=(), dtype=float32)
loss: tf.Tensor(0.012083462, shape=(), dtype=float32)
loss: tf.Tensor(0.009663642, shape=(), dtype=float32)
loss: tf.Tensor(0.08955927, shape=(), dtype=float32)
loss: tf.Tensor(0.049727082, shape=(), dtype=float32)
loss: tf.Tensor(0.010445433, shape=(), dtype=float32)
loss: tf.Tensor(0.009254798, shape=(), dtype=float32)
loss: tf.Tensor(0.042068068, shape=(), dtype=float32)
loss: tf.Tensor(0.025832118, shape=(), dtype=float32)
loss: tf.Tensor(0.008963116, shape=(), dtype=float32)
loss: tf.Tensor(0.07224884, shape=(), dtype=float32)
loss: tf.Tensor(0.013392933, shape=(), dtype=float32)
loss: tf.Tensor(0.014393196, shape=(), dtype=float32)
loss: tf.Tensor(0.0069427663, shape=(), dtype=float32)
loss: tf.Tensor(0.025569063, shape=(), dtype=float32)
loss: tf.Tensor(0.045397267, shape=(), dtype=float32)
loss: tf.Tensor(0.016065275, shape=(), dtype=float32)
loss: tf.Tensor(0.06346052, shape=(), dtype=float32)
loss: tf.Tensor(0.04638823, shape=(), dtype=float32)
loss: tf.Tensor(0.012098073, shape=(), dtype=float32)
loss: tf.Tensor(0.03508791, shape=(), dtype=float32)
loss: tf.Tensor(0.05931623, shape=(), dtype=float32)
loss: tf.Tensor(0.02790515, shape=(), dtype=float32)
loss: tf.Tensor(0.09580845, shape=(), dtype=float32)
loss: tf.Tensor(0.014714059, shape=(), dtype=float32)
loss: tf.Tensor(0.00045396513, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70721245, shape=(), dtype=float32)
F1 SCORE:
0.82604074
EPOCH  38 #################################
loss: tf.Tensor(0.010705259, shape=(), dtype=float32)
loss: tf.Tensor(0.035824835, shape=(), dtype=float32)
loss: tf.Tensor(0.03527265, shape=(), dtype=float32)
loss: tf.Tensor(0.025063658, shape=(), dtype=float32)
loss: tf.Tensor(0.023721747, shape=(), dtype=float32)
loss: tf.Tensor(0.09742869, shape=(), dtype=float32)
loss: tf.Tensor(0.10668911, shape=(), dtype=float32)
loss: tf.Tensor(0.029445566, shape=(), dtype=float32)
loss: tf.Tensor(0.018381132, shape=(), dtype=float32)
loss: tf.Tensor(0.0387507, shape=(), dtype=float32)
loss: tf.Tensor(0.044118606, shape=(), dtype=float32)
loss: tf.Tensor(0.010418202, shape=(), dtype=float32)
loss: tf.Tensor(0.027110945, shape=(), dtype=float32)
loss: tf.Tensor(0.009653746, shape=(), dtype=float32)
loss: tf.Tensor(0.13210611, shape=(), dtype=float32)
loss: tf.Tensor(0.052313436, shape=(), dtype=float32)
loss: tf.Tensor(0.025876164, shape=(), dtype=float32)
loss: tf.Tensor(0.012792017, shape=(), dtype=float32)
loss: tf.Tensor(0.005679241, shape=(), dtype=float32)
loss: tf.Tensor(0.025664983, shape=(), dtype=float32)
loss: tf.Tensor(0.036320847, shape=(), dtype=float32)
loss: tf.Tensor(0.066171154, shape=(), dtype=float32)
loss: tf.Tensor(0.10349402, shape=(), dtype=float32)
loss: tf.Tensor(0.014739723, shape=(), dtype=float32)
loss: tf.Tensor(0.037499852, shape=(), dtype=float32)
loss: tf.Tensor(0.03321637, shape=(), dtype=float32)
loss: tf.Tensor(0.008808336, shape=(), dtype=float32)
loss: tf.Tensor(0.09246425, shape=(), dtype=float32)
loss: tf.Tensor(0.08360025, shape=(), dtype=float32)
loss: tf.Tensor(0.035018943, shape=(), dtype=float32)
loss: tf.Tensor(0.05166941, shape=(), dtype=float32)
loss: tf.Tensor(0.014154149, shape=(), dtype=float32)
loss: tf.Tensor(0.05536173, shape=(), dtype=float32)
loss: tf.Tensor(0.02685989, shape=(), dtype=float32)
loss: tf.Tensor(0.0062992657, shape=(), dtype=float32)
loss: tf.Tensor(0.017910026, shape=(), dtype=float32)
loss: tf.Tensor(0.1582713, shape=(), dtype=float32)
loss: tf.Tensor(0.014481285, shape=(), dtype=float32)
loss: tf.Tensor(0.022642992, shape=(), dtype=float32)
loss: tf.Tensor(0.02468178, shape=(), dtype=float32)
loss: tf.Tensor(0.020146668, shape=(), dtype=float32)
loss: tf.Tensor(0.008417695, shape=(), dtype=float32)
loss: tf.Tensor(0.015761081, shape=(), dtype=float32)
loss: tf.Tensor(0.03620489, shape=(), dtype=float32)
loss: tf.Tensor(0.052672967, shape=(), dtype=float32)
loss: tf.Tensor(0.014935043, shape=(), dtype=float32)
loss: tf.Tensor(0.01088145, shape=(), dtype=float32)
loss: tf.Tensor(0.013619001, shape=(), dtype=float32)
loss: tf.Tensor(0.018367302, shape=(), dtype=float32)
loss: tf.Tensor(0.021054363, shape=(), dtype=float32)
loss: tf.Tensor(0.00790537, shape=(), dtype=float32)
loss: tf.Tensor(0.050963353, shape=(), dtype=float32)
loss: tf.Tensor(0.059540115, shape=(), dtype=float32)
loss: tf.Tensor(0.03665111, shape=(), dtype=float32)
loss: tf.Tensor(0.02041588, shape=(), dtype=float32)
loss: tf.Tensor(0.040210113, shape=(), dtype=float32)
loss: tf.Tensor(0.09382309, shape=(), dtype=float32)
loss: tf.Tensor(0.051038694, shape=(), dtype=float32)
loss: tf.Tensor(0.044015292, shape=(), dtype=float32)
loss: tf.Tensor(0.011656555, shape=(), dtype=float32)
loss: tf.Tensor(0.09443233, shape=(), dtype=float32)
loss: tf.Tensor(0.04223091, shape=(), dtype=float32)
loss: tf.Tensor(0.06407057, shape=(), dtype=float32)
loss: tf.Tensor(0.037772246, shape=(), dtype=float32)
loss: tf.Tensor(0.10237812, shape=(), dtype=float32)
loss: tf.Tensor(0.0576663, shape=(), dtype=float32)
loss: tf.Tensor(0.041320182, shape=(), dtype=float32)
loss: tf.Tensor(0.040783986, shape=(), dtype=float32)
loss: tf.Tensor(0.058863062, shape=(), dtype=float32)
loss: tf.Tensor(0.031452883, shape=(), dtype=float32)
loss: tf.Tensor(0.03196384, shape=(), dtype=float32)
loss: tf.Tensor(0.07048725, shape=(), dtype=float32)
loss: tf.Tensor(0.059040986, shape=(), dtype=float32)
loss: tf.Tensor(0.00024589853, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7059819, shape=(), dtype=float32)
F1 SCORE:
0.8257819
EPOCH  39 #################################
loss: tf.Tensor(0.015052411, shape=(), dtype=float32)
loss: tf.Tensor(0.02839645, shape=(), dtype=float32)
loss: tf.Tensor(0.045927, shape=(), dtype=float32)
loss: tf.Tensor(0.027889268, shape=(), dtype=float32)
loss: tf.Tensor(0.022756131, shape=(), dtype=float32)
loss: tf.Tensor(0.035648566, shape=(), dtype=float32)
loss: tf.Tensor(0.09858365, shape=(), dtype=float32)
loss: tf.Tensor(0.04444735, shape=(), dtype=float32)
loss: tf.Tensor(0.0272199, shape=(), dtype=float32)
loss: tf.Tensor(0.01888527, shape=(), dtype=float32)
loss: tf.Tensor(0.0340047, shape=(), dtype=float32)
loss: tf.Tensor(0.021333935, shape=(), dtype=float32)
loss: tf.Tensor(0.0271877, shape=(), dtype=float32)
loss: tf.Tensor(0.05211947, shape=(), dtype=float32)
loss: tf.Tensor(0.05004581, shape=(), dtype=float32)
loss: tf.Tensor(0.0726191, shape=(), dtype=float32)
loss: tf.Tensor(0.025908362, shape=(), dtype=float32)
loss: tf.Tensor(0.0353825, shape=(), dtype=float32)
loss: tf.Tensor(0.026944619, shape=(), dtype=float32)
loss: tf.Tensor(0.014854524, shape=(), dtype=float32)
loss: tf.Tensor(0.016427064, shape=(), dtype=float32)
loss: tf.Tensor(0.024607226, shape=(), dtype=float32)
loss: tf.Tensor(0.011107739, shape=(), dtype=float32)
loss: tf.Tensor(0.026711702, shape=(), dtype=float32)
loss: tf.Tensor(0.005028537, shape=(), dtype=float32)
loss: tf.Tensor(0.014700644, shape=(), dtype=float32)
loss: tf.Tensor(0.013943787, shape=(), dtype=float32)
loss: tf.Tensor(0.00527733, shape=(), dtype=float32)
loss: tf.Tensor(0.0359512, shape=(), dtype=float32)
loss: tf.Tensor(0.046957668, shape=(), dtype=float32)
loss: tf.Tensor(0.008937156, shape=(), dtype=float32)
loss: tf.Tensor(0.017290385, shape=(), dtype=float32)
loss: tf.Tensor(0.041448206, shape=(), dtype=float32)
loss: tf.Tensor(0.03964176, shape=(), dtype=float32)
loss: tf.Tensor(0.015066071, shape=(), dtype=float32)
loss: tf.Tensor(0.019945422, shape=(), dtype=float32)
loss: tf.Tensor(0.00468664, shape=(), dtype=float32)
loss: tf.Tensor(0.008337092, shape=(), dtype=float32)
loss: tf.Tensor(0.064577065, shape=(), dtype=float32)
loss: tf.Tensor(0.027840411, shape=(), dtype=float32)
loss: tf.Tensor(0.066375405, shape=(), dtype=float32)
loss: tf.Tensor(0.0056728553, shape=(), dtype=float32)
loss: tf.Tensor(0.013248018, shape=(), dtype=float32)
loss: tf.Tensor(0.022276264, shape=(), dtype=float32)
loss: tf.Tensor(0.011903545, shape=(), dtype=float32)
loss: tf.Tensor(0.009855742, shape=(), dtype=float32)
loss: tf.Tensor(0.009437952, shape=(), dtype=float32)
loss: tf.Tensor(0.027742013, shape=(), dtype=float32)
loss: tf.Tensor(0.027117133, shape=(), dtype=float32)
loss: tf.Tensor(0.045016404, shape=(), dtype=float32)
loss: tf.Tensor(0.023082094, shape=(), dtype=float32)
loss: tf.Tensor(0.07406613, shape=(), dtype=float32)
loss: tf.Tensor(0.017279007, shape=(), dtype=float32)
loss: tf.Tensor(0.047471095, shape=(), dtype=float32)
loss: tf.Tensor(0.010223789, shape=(), dtype=float32)
loss: tf.Tensor(0.01616953, shape=(), dtype=float32)
loss: tf.Tensor(0.0053898436, shape=(), dtype=float32)
loss: tf.Tensor(0.01884364, shape=(), dtype=float32)
loss: tf.Tensor(0.03644613, shape=(), dtype=float32)
loss: tf.Tensor(0.08332293, shape=(), dtype=float32)
loss: tf.Tensor(0.025429528, shape=(), dtype=float32)
loss: tf.Tensor(0.05707536, shape=(), dtype=float32)
loss: tf.Tensor(0.045286242, shape=(), dtype=float32)
loss: tf.Tensor(0.007817095, shape=(), dtype=float32)
loss: tf.Tensor(0.03008287, shape=(), dtype=float32)
loss: tf.Tensor(0.020420609, shape=(), dtype=float32)
loss: tf.Tensor(0.047186505, shape=(), dtype=float32)
loss: tf.Tensor(0.11141419, shape=(), dtype=float32)
loss: tf.Tensor(0.01393036, shape=(), dtype=float32)
loss: tf.Tensor(0.039431464, shape=(), dtype=float32)
loss: tf.Tensor(0.016547218, shape=(), dtype=float32)
loss: tf.Tensor(0.05266803, shape=(), dtype=float32)
loss: tf.Tensor(0.0443928, shape=(), dtype=float32)
loss: tf.Tensor(0.0, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7272592, shape=(), dtype=float32)
F1 SCORE:
0.8250691
EPOCH  40 #################################
loss: tf.Tensor(0.05661838, shape=(), dtype=float32)
loss: tf.Tensor(0.03031637, shape=(), dtype=float32)
loss: tf.Tensor(0.07461164, shape=(), dtype=float32)
loss: tf.Tensor(0.16211203, shape=(), dtype=float32)
loss: tf.Tensor(0.032551244, shape=(), dtype=float32)
loss: tf.Tensor(0.014907585, shape=(), dtype=float32)
loss: tf.Tensor(0.014627555, shape=(), dtype=float32)
loss: tf.Tensor(0.009885711, shape=(), dtype=float32)
loss: tf.Tensor(0.006702792, shape=(), dtype=float32)
loss: tf.Tensor(0.08777705, shape=(), dtype=float32)
loss: tf.Tensor(0.11551473, shape=(), dtype=float32)
loss: tf.Tensor(0.007354672, shape=(), dtype=float32)
loss: tf.Tensor(0.031923205, shape=(), dtype=float32)
loss: tf.Tensor(0.098120354, shape=(), dtype=float32)
loss: tf.Tensor(0.055809155, shape=(), dtype=float32)
loss: tf.Tensor(0.023707129, shape=(), dtype=float32)
loss: tf.Tensor(0.03023935, shape=(), dtype=float32)
loss: tf.Tensor(0.015723955, shape=(), dtype=float32)
loss: tf.Tensor(0.028696664, shape=(), dtype=float32)
loss: tf.Tensor(0.021965701, shape=(), dtype=float32)
loss: tf.Tensor(0.00796141, shape=(), dtype=float32)
loss: tf.Tensor(0.040235564, shape=(), dtype=float32)
loss: tf.Tensor(0.011936087, shape=(), dtype=float32)
loss: tf.Tensor(0.12827657, shape=(), dtype=float32)
loss: tf.Tensor(0.052246667, shape=(), dtype=float32)
loss: tf.Tensor(0.01259299, shape=(), dtype=float32)
loss: tf.Tensor(0.009414523, shape=(), dtype=float32)
loss: tf.Tensor(0.02613231, shape=(), dtype=float32)
loss: tf.Tensor(0.010530635, shape=(), dtype=float32)
loss: tf.Tensor(0.042075418, shape=(), dtype=float32)
loss: tf.Tensor(0.0024422563, shape=(), dtype=float32)
loss: tf.Tensor(0.060765196, shape=(), dtype=float32)
loss: tf.Tensor(0.04045437, shape=(), dtype=float32)
loss: tf.Tensor(0.025146272, shape=(), dtype=float32)
loss: tf.Tensor(0.02016173, shape=(), dtype=float32)
loss: tf.Tensor(0.012203113, shape=(), dtype=float32)
loss: tf.Tensor(0.022417204, shape=(), dtype=float32)
loss: tf.Tensor(0.022684904, shape=(), dtype=float32)
loss: tf.Tensor(0.07128757, shape=(), dtype=float32)
loss: tf.Tensor(0.020699969, shape=(), dtype=float32)
loss: tf.Tensor(0.043911897, shape=(), dtype=float32)
loss: tf.Tensor(0.009664098, shape=(), dtype=float32)
loss: tf.Tensor(0.054816075, shape=(), dtype=float32)
loss: tf.Tensor(0.022712715, shape=(), dtype=float32)
loss: tf.Tensor(0.019062607, shape=(), dtype=float32)
loss: tf.Tensor(0.041087985, shape=(), dtype=float32)
loss: tf.Tensor(0.060736727, shape=(), dtype=float32)
loss: tf.Tensor(0.035291046, shape=(), dtype=float32)
loss: tf.Tensor(0.005658058, shape=(), dtype=float32)
loss: tf.Tensor(0.020914597, shape=(), dtype=float32)
loss: tf.Tensor(0.09326025, shape=(), dtype=float32)
loss: tf.Tensor(0.053466365, shape=(), dtype=float32)
loss: tf.Tensor(0.0028294406, shape=(), dtype=float32)
loss: tf.Tensor(0.18462282, shape=(), dtype=float32)
loss: tf.Tensor(0.064588614, shape=(), dtype=float32)
loss: tf.Tensor(0.026166389, shape=(), dtype=float32)
loss: tf.Tensor(0.0688456, shape=(), dtype=float32)
loss: tf.Tensor(0.0670091, shape=(), dtype=float32)
loss: tf.Tensor(0.03278256, shape=(), dtype=float32)
loss: tf.Tensor(0.034689557, shape=(), dtype=float32)
loss: tf.Tensor(0.08770728, shape=(), dtype=float32)
loss: tf.Tensor(0.04476244, shape=(), dtype=float32)
loss: tf.Tensor(0.04169749, shape=(), dtype=float32)
loss: tf.Tensor(0.08061085, shape=(), dtype=float32)
loss: tf.Tensor(0.11915078, shape=(), dtype=float32)
loss: tf.Tensor(0.034718346, shape=(), dtype=float32)
loss: tf.Tensor(0.04240726, shape=(), dtype=float32)
loss: tf.Tensor(0.0305723, shape=(), dtype=float32)
loss: tf.Tensor(0.0060852254, shape=(), dtype=float32)
loss: tf.Tensor(0.066463254, shape=(), dtype=float32)
loss: tf.Tensor(0.03522703, shape=(), dtype=float32)
loss: tf.Tensor(0.08382353, shape=(), dtype=float32)
loss: tf.Tensor(0.09436772, shape=(), dtype=float32)
loss: tf.Tensor(0.00015257625, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70778584, shape=(), dtype=float32)
F1 SCORE:
0.82497525
EPOCH  41 #################################
loss: tf.Tensor(0.07009806, shape=(), dtype=float32)
loss: tf.Tensor(0.016357265, shape=(), dtype=float32)
loss: tf.Tensor(0.07933357, shape=(), dtype=float32)
loss: tf.Tensor(0.07054804, shape=(), dtype=float32)
loss: tf.Tensor(0.10495483, shape=(), dtype=float32)
loss: tf.Tensor(0.05017977, shape=(), dtype=float32)
loss: tf.Tensor(0.06416393, shape=(), dtype=float32)
loss: tf.Tensor(0.08413491, shape=(), dtype=float32)
loss: tf.Tensor(0.018562706, shape=(), dtype=float32)
loss: tf.Tensor(0.034730997, shape=(), dtype=float32)
loss: tf.Tensor(0.031185107, shape=(), dtype=float32)
loss: tf.Tensor(0.026936233, shape=(), dtype=float32)
loss: tf.Tensor(0.02934062, shape=(), dtype=float32)
loss: tf.Tensor(0.14027856, shape=(), dtype=float32)
loss: tf.Tensor(0.017105697, shape=(), dtype=float32)
loss: tf.Tensor(0.06340321, shape=(), dtype=float32)
loss: tf.Tensor(0.11956769, shape=(), dtype=float32)
loss: tf.Tensor(0.11708746, shape=(), dtype=float32)
loss: tf.Tensor(0.08069604, shape=(), dtype=float32)
loss: tf.Tensor(0.013043946, shape=(), dtype=float32)
loss: tf.Tensor(0.14467517, shape=(), dtype=float32)
loss: tf.Tensor(0.1203714, shape=(), dtype=float32)
loss: tf.Tensor(0.13050967, shape=(), dtype=float32)
loss: tf.Tensor(0.035679754, shape=(), dtype=float32)
loss: tf.Tensor(0.029190795, shape=(), dtype=float32)
loss: tf.Tensor(0.0092505785, shape=(), dtype=float32)
loss: tf.Tensor(0.038249783, shape=(), dtype=float32)
loss: tf.Tensor(0.02095393, shape=(), dtype=float32)
loss: tf.Tensor(0.0083723795, shape=(), dtype=float32)
loss: tf.Tensor(0.046088982, shape=(), dtype=float32)
loss: tf.Tensor(0.07451045, shape=(), dtype=float32)
loss: tf.Tensor(0.017286709, shape=(), dtype=float32)
loss: tf.Tensor(0.03516493, shape=(), dtype=float32)
loss: tf.Tensor(0.029568048, shape=(), dtype=float32)
loss: tf.Tensor(0.03053341, shape=(), dtype=float32)
loss: tf.Tensor(0.041790023, shape=(), dtype=float32)
loss: tf.Tensor(0.025434326, shape=(), dtype=float32)
loss: tf.Tensor(0.014493226, shape=(), dtype=float32)
loss: tf.Tensor(0.051486854, shape=(), dtype=float32)
loss: tf.Tensor(0.0701712, shape=(), dtype=float32)
loss: tf.Tensor(0.02799562, shape=(), dtype=float32)
loss: tf.Tensor(0.041290626, shape=(), dtype=float32)
loss: tf.Tensor(0.08540041, shape=(), dtype=float32)
loss: tf.Tensor(0.02394236, shape=(), dtype=float32)
loss: tf.Tensor(0.032545913, shape=(), dtype=float32)
loss: tf.Tensor(0.07816315, shape=(), dtype=float32)
loss: tf.Tensor(0.022156429, shape=(), dtype=float32)
loss: tf.Tensor(0.027329467, shape=(), dtype=float32)
loss: tf.Tensor(0.07910804, shape=(), dtype=float32)
loss: tf.Tensor(0.05062383, shape=(), dtype=float32)
loss: tf.Tensor(0.016672937, shape=(), dtype=float32)
loss: tf.Tensor(0.05635277, shape=(), dtype=float32)
loss: tf.Tensor(0.12444805, shape=(), dtype=float32)
loss: tf.Tensor(0.0069654267, shape=(), dtype=float32)
loss: tf.Tensor(0.022401989, shape=(), dtype=float32)
loss: tf.Tensor(0.067090094, shape=(), dtype=float32)
loss: tf.Tensor(0.11756106, shape=(), dtype=float32)
loss: tf.Tensor(0.07604273, shape=(), dtype=float32)
loss: tf.Tensor(0.08360645, shape=(), dtype=float32)
loss: tf.Tensor(0.044259585, shape=(), dtype=float32)
loss: tf.Tensor(0.038190022, shape=(), dtype=float32)
loss: tf.Tensor(0.026323866, shape=(), dtype=float32)
loss: tf.Tensor(0.020711236, shape=(), dtype=float32)
loss: tf.Tensor(0.045212626, shape=(), dtype=float32)
loss: tf.Tensor(0.11546965, shape=(), dtype=float32)
loss: tf.Tensor(0.22034523, shape=(), dtype=float32)
loss: tf.Tensor(0.10354678, shape=(), dtype=float32)
loss: tf.Tensor(0.08541021, shape=(), dtype=float32)
loss: tf.Tensor(0.015477882, shape=(), dtype=float32)
loss: tf.Tensor(0.073130615, shape=(), dtype=float32)
loss: tf.Tensor(0.024024904, shape=(), dtype=float32)
loss: tf.Tensor(0.075008914, shape=(), dtype=float32)
loss: tf.Tensor(0.031516284, shape=(), dtype=float32)
loss: tf.Tensor(1.072883e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7014447, shape=(), dtype=float32)
F1 SCORE:
0.8249528
EPOCH  42 #################################
loss: tf.Tensor(0.020924222, shape=(), dtype=float32)
loss: tf.Tensor(0.098685265, shape=(), dtype=float32)
loss: tf.Tensor(0.059396587, shape=(), dtype=float32)
loss: tf.Tensor(0.036976732, shape=(), dtype=float32)
loss: tf.Tensor(0.019605974, shape=(), dtype=float32)
loss: tf.Tensor(0.0506143, shape=(), dtype=float32)
loss: tf.Tensor(0.02431766, shape=(), dtype=float32)
loss: tf.Tensor(0.048016347, shape=(), dtype=float32)
loss: tf.Tensor(0.030552814, shape=(), dtype=float32)
loss: tf.Tensor(0.042672493, shape=(), dtype=float32)
loss: tf.Tensor(0.040369064, shape=(), dtype=float32)
loss: tf.Tensor(0.06232667, shape=(), dtype=float32)
loss: tf.Tensor(0.084263675, shape=(), dtype=float32)
loss: tf.Tensor(0.0067075994, shape=(), dtype=float32)
loss: tf.Tensor(0.022615168, shape=(), dtype=float32)
loss: tf.Tensor(0.01691664, shape=(), dtype=float32)
loss: tf.Tensor(0.10435468, shape=(), dtype=float32)
loss: tf.Tensor(0.06583828, shape=(), dtype=float32)
loss: tf.Tensor(0.023546875, shape=(), dtype=float32)
loss: tf.Tensor(0.08459173, shape=(), dtype=float32)
loss: tf.Tensor(0.021153754, shape=(), dtype=float32)
loss: tf.Tensor(0.059802294, shape=(), dtype=float32)
loss: tf.Tensor(0.072719656, shape=(), dtype=float32)
loss: tf.Tensor(0.019903742, shape=(), dtype=float32)
loss: tf.Tensor(0.0412678, shape=(), dtype=float32)
loss: tf.Tensor(0.02285249, shape=(), dtype=float32)
loss: tf.Tensor(0.057153527, shape=(), dtype=float32)
loss: tf.Tensor(0.026419105, shape=(), dtype=float32)
loss: tf.Tensor(0.019311557, shape=(), dtype=float32)
loss: tf.Tensor(0.050732695, shape=(), dtype=float32)
loss: tf.Tensor(0.04908426, shape=(), dtype=float32)
loss: tf.Tensor(0.06405426, shape=(), dtype=float32)
loss: tf.Tensor(0.019025447, shape=(), dtype=float32)
loss: tf.Tensor(0.025567524, shape=(), dtype=float32)
loss: tf.Tensor(0.0225081, shape=(), dtype=float32)
loss: tf.Tensor(0.014416392, shape=(), dtype=float32)
loss: tf.Tensor(0.017533734, shape=(), dtype=float32)
loss: tf.Tensor(0.03073107, shape=(), dtype=float32)
loss: tf.Tensor(0.089748986, shape=(), dtype=float32)
loss: tf.Tensor(0.01112957, shape=(), dtype=float32)
loss: tf.Tensor(0.022017282, shape=(), dtype=float32)
loss: tf.Tensor(0.029678836, shape=(), dtype=float32)
loss: tf.Tensor(0.0187006, shape=(), dtype=float32)
loss: tf.Tensor(0.03462896, shape=(), dtype=float32)
loss: tf.Tensor(0.00448803, shape=(), dtype=float32)
loss: tf.Tensor(0.022584029, shape=(), dtype=float32)
loss: tf.Tensor(0.020543337, shape=(), dtype=float32)
loss: tf.Tensor(0.06126707, shape=(), dtype=float32)
loss: tf.Tensor(0.018356126, shape=(), dtype=float32)
loss: tf.Tensor(0.020354485, shape=(), dtype=float32)
loss: tf.Tensor(0.029846845, shape=(), dtype=float32)
loss: tf.Tensor(0.0038448607, shape=(), dtype=float32)
loss: tf.Tensor(0.008300335, shape=(), dtype=float32)
loss: tf.Tensor(0.08116442, shape=(), dtype=float32)
loss: tf.Tensor(0.0118149705, shape=(), dtype=float32)
loss: tf.Tensor(0.038026605, shape=(), dtype=float32)
loss: tf.Tensor(0.015547967, shape=(), dtype=float32)
loss: tf.Tensor(0.05465278, shape=(), dtype=float32)
loss: tf.Tensor(0.03842206, shape=(), dtype=float32)
loss: tf.Tensor(0.13695835, shape=(), dtype=float32)
loss: tf.Tensor(0.04918705, shape=(), dtype=float32)
loss: tf.Tensor(0.008556273, shape=(), dtype=float32)
loss: tf.Tensor(0.030012678, shape=(), dtype=float32)
loss: tf.Tensor(0.019966936, shape=(), dtype=float32)
loss: tf.Tensor(0.018316032, shape=(), dtype=float32)
loss: tf.Tensor(0.07037695, shape=(), dtype=float32)
loss: tf.Tensor(0.033542227, shape=(), dtype=float32)
loss: tf.Tensor(0.020126268, shape=(), dtype=float32)
loss: tf.Tensor(0.046930123, shape=(), dtype=float32)
loss: tf.Tensor(0.0043899775, shape=(), dtype=float32)
loss: tf.Tensor(0.063882664, shape=(), dtype=float32)
loss: tf.Tensor(0.033059187, shape=(), dtype=float32)
loss: tf.Tensor(0.011754121, shape=(), dtype=float32)
loss: tf.Tensor(0.037041243, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6998854, shape=(), dtype=float32)
F1 SCORE:
0.82512593
EPOCH  43 #################################
loss: tf.Tensor(0.015112573, shape=(), dtype=float32)
loss: tf.Tensor(0.02505507, shape=(), dtype=float32)
loss: tf.Tensor(0.034694586, shape=(), dtype=float32)
loss: tf.Tensor(0.22808248, shape=(), dtype=float32)
loss: tf.Tensor(0.063795164, shape=(), dtype=float32)
loss: tf.Tensor(0.01972079, shape=(), dtype=float32)
loss: tf.Tensor(0.05231055, shape=(), dtype=float32)
loss: tf.Tensor(0.01994682, shape=(), dtype=float32)
loss: tf.Tensor(0.008147579, shape=(), dtype=float32)
loss: tf.Tensor(0.050028, shape=(), dtype=float32)
loss: tf.Tensor(0.025148684, shape=(), dtype=float32)
loss: tf.Tensor(0.042652737, shape=(), dtype=float32)
loss: tf.Tensor(0.049478576, shape=(), dtype=float32)
loss: tf.Tensor(0.058805853, shape=(), dtype=float32)
loss: tf.Tensor(0.018839693, shape=(), dtype=float32)
loss: tf.Tensor(0.0067830016, shape=(), dtype=float32)
loss: tf.Tensor(0.07884082, shape=(), dtype=float32)
loss: tf.Tensor(0.012168986, shape=(), dtype=float32)
loss: tf.Tensor(0.014204364, shape=(), dtype=float32)
loss: tf.Tensor(0.030065222, shape=(), dtype=float32)
loss: tf.Tensor(0.0051075667, shape=(), dtype=float32)
loss: tf.Tensor(0.056543328, shape=(), dtype=float32)
loss: tf.Tensor(0.070113614, shape=(), dtype=float32)
loss: tf.Tensor(0.04189495, shape=(), dtype=float32)
loss: tf.Tensor(0.02442939, shape=(), dtype=float32)
loss: tf.Tensor(0.032897104, shape=(), dtype=float32)
loss: tf.Tensor(0.01662032, shape=(), dtype=float32)
loss: tf.Tensor(0.018123318, shape=(), dtype=float32)
loss: tf.Tensor(0.006402233, shape=(), dtype=float32)
loss: tf.Tensor(0.056107458, shape=(), dtype=float32)
loss: tf.Tensor(0.00793167, shape=(), dtype=float32)
loss: tf.Tensor(0.027179772, shape=(), dtype=float32)
loss: tf.Tensor(0.048727967, shape=(), dtype=float32)
loss: tf.Tensor(0.08119584, shape=(), dtype=float32)
loss: tf.Tensor(0.007211727, shape=(), dtype=float32)
loss: tf.Tensor(0.041319948, shape=(), dtype=float32)
loss: tf.Tensor(0.013339852, shape=(), dtype=float32)
loss: tf.Tensor(0.04841626, shape=(), dtype=float32)
loss: tf.Tensor(0.06996813, shape=(), dtype=float32)
loss: tf.Tensor(0.11008695, shape=(), dtype=float32)
loss: tf.Tensor(0.03173649, shape=(), dtype=float32)
loss: tf.Tensor(0.025202729, shape=(), dtype=float32)
loss: tf.Tensor(0.019883053, shape=(), dtype=float32)
loss: tf.Tensor(0.032737598, shape=(), dtype=float32)
loss: tf.Tensor(0.114922084, shape=(), dtype=float32)
loss: tf.Tensor(0.0484909, shape=(), dtype=float32)
loss: tf.Tensor(0.031138051, shape=(), dtype=float32)
loss: tf.Tensor(0.018014144, shape=(), dtype=float32)
loss: tf.Tensor(0.012323928, shape=(), dtype=float32)
loss: tf.Tensor(0.039753024, shape=(), dtype=float32)
loss: tf.Tensor(0.02155757, shape=(), dtype=float32)
loss: tf.Tensor(0.036415022, shape=(), dtype=float32)
loss: tf.Tensor(0.030751998, shape=(), dtype=float32)
loss: tf.Tensor(0.021039246, shape=(), dtype=float32)
loss: tf.Tensor(0.08097468, shape=(), dtype=float32)
loss: tf.Tensor(0.0339997, shape=(), dtype=float32)
loss: tf.Tensor(0.049533855, shape=(), dtype=float32)
loss: tf.Tensor(0.018473633, shape=(), dtype=float32)
loss: tf.Tensor(0.028559295, shape=(), dtype=float32)
loss: tf.Tensor(0.019691892, shape=(), dtype=float32)
loss: tf.Tensor(0.05383805, shape=(), dtype=float32)
loss: tf.Tensor(0.023374759, shape=(), dtype=float32)
loss: tf.Tensor(0.024347045, shape=(), dtype=float32)
loss: tf.Tensor(0.016653169, shape=(), dtype=float32)
loss: tf.Tensor(0.006012112, shape=(), dtype=float32)
loss: tf.Tensor(0.07631085, shape=(), dtype=float32)
loss: tf.Tensor(0.010784026, shape=(), dtype=float32)
loss: tf.Tensor(0.03143711, shape=(), dtype=float32)
loss: tf.Tensor(0.09308965, shape=(), dtype=float32)
loss: tf.Tensor(0.031315003, shape=(), dtype=float32)
loss: tf.Tensor(0.093862966, shape=(), dtype=float32)
loss: tf.Tensor(0.032455593, shape=(), dtype=float32)
loss: tf.Tensor(0.040858325, shape=(), dtype=float32)
loss: tf.Tensor(0.000669851, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70566404, shape=(), dtype=float32)
F1 SCORE:
0.82506055
EPOCH  44 #################################
loss: tf.Tensor(0.007963642, shape=(), dtype=float32)
loss: tf.Tensor(0.06113393, shape=(), dtype=float32)
loss: tf.Tensor(0.04790814, shape=(), dtype=float32)
loss: tf.Tensor(0.02306283, shape=(), dtype=float32)
loss: tf.Tensor(0.048099104, shape=(), dtype=float32)
loss: tf.Tensor(0.017278358, shape=(), dtype=float32)
loss: tf.Tensor(0.019754745, shape=(), dtype=float32)
loss: tf.Tensor(0.039458703, shape=(), dtype=float32)
loss: tf.Tensor(0.013691412, shape=(), dtype=float32)
loss: tf.Tensor(0.04559575, shape=(), dtype=float32)
loss: tf.Tensor(0.05465214, shape=(), dtype=float32)
loss: tf.Tensor(0.055558085, shape=(), dtype=float32)
loss: tf.Tensor(0.046070155, shape=(), dtype=float32)
loss: tf.Tensor(0.025020458, shape=(), dtype=float32)
loss: tf.Tensor(0.064560905, shape=(), dtype=float32)
loss: tf.Tensor(0.07395388, shape=(), dtype=float32)
loss: tf.Tensor(0.03914094, shape=(), dtype=float32)
loss: tf.Tensor(0.050557252, shape=(), dtype=float32)
loss: tf.Tensor(0.02368516, shape=(), dtype=float32)
loss: tf.Tensor(0.09313759, shape=(), dtype=float32)
loss: tf.Tensor(0.022242524, shape=(), dtype=float32)
loss: tf.Tensor(0.015145144, shape=(), dtype=float32)
loss: tf.Tensor(0.032553814, shape=(), dtype=float32)
loss: tf.Tensor(0.046363812, shape=(), dtype=float32)
loss: tf.Tensor(0.0073818187, shape=(), dtype=float32)
loss: tf.Tensor(0.026489204, shape=(), dtype=float32)
loss: tf.Tensor(0.052150358, shape=(), dtype=float32)
loss: tf.Tensor(0.062286638, shape=(), dtype=float32)
loss: tf.Tensor(0.021298947, shape=(), dtype=float32)
loss: tf.Tensor(0.02064792, shape=(), dtype=float32)
loss: tf.Tensor(0.08690813, shape=(), dtype=float32)
loss: tf.Tensor(0.05182442, shape=(), dtype=float32)
loss: tf.Tensor(0.008355161, shape=(), dtype=float32)
loss: tf.Tensor(0.04199329, shape=(), dtype=float32)
loss: tf.Tensor(0.04580271, shape=(), dtype=float32)
loss: tf.Tensor(0.017822754, shape=(), dtype=float32)
loss: tf.Tensor(0.044188004, shape=(), dtype=float32)
loss: tf.Tensor(0.043710634, shape=(), dtype=float32)
loss: tf.Tensor(0.04697856, shape=(), dtype=float32)
loss: tf.Tensor(0.0042938283, shape=(), dtype=float32)
loss: tf.Tensor(0.063996285, shape=(), dtype=float32)
loss: tf.Tensor(0.010501469, shape=(), dtype=float32)
loss: tf.Tensor(0.009900683, shape=(), dtype=float32)
loss: tf.Tensor(0.016172657, shape=(), dtype=float32)
loss: tf.Tensor(0.053989287, shape=(), dtype=float32)
loss: tf.Tensor(0.030773198, shape=(), dtype=float32)
loss: tf.Tensor(0.009452645, shape=(), dtype=float32)
loss: tf.Tensor(0.027563673, shape=(), dtype=float32)
loss: tf.Tensor(0.024980579, shape=(), dtype=float32)
loss: tf.Tensor(0.011254431, shape=(), dtype=float32)
loss: tf.Tensor(0.01949674, shape=(), dtype=float32)
loss: tf.Tensor(0.02282449, shape=(), dtype=float32)
loss: tf.Tensor(0.060492095, shape=(), dtype=float32)
loss: tf.Tensor(0.022835698, shape=(), dtype=float32)
loss: tf.Tensor(0.06933026, shape=(), dtype=float32)
loss: tf.Tensor(0.035777304, shape=(), dtype=float32)
loss: tf.Tensor(0.023850111, shape=(), dtype=float32)
loss: tf.Tensor(0.07597072, shape=(), dtype=float32)
loss: tf.Tensor(0.055857647, shape=(), dtype=float32)
loss: tf.Tensor(0.0154553605, shape=(), dtype=float32)
loss: tf.Tensor(0.014315926, shape=(), dtype=float32)
loss: tf.Tensor(0.03503308, shape=(), dtype=float32)
loss: tf.Tensor(0.02814998, shape=(), dtype=float32)
loss: tf.Tensor(0.06534085, shape=(), dtype=float32)
loss: tf.Tensor(0.007677572, shape=(), dtype=float32)
loss: tf.Tensor(0.008610912, shape=(), dtype=float32)
loss: tf.Tensor(0.047984175, shape=(), dtype=float32)
loss: tf.Tensor(0.036356777, shape=(), dtype=float32)
loss: tf.Tensor(0.0066208015, shape=(), dtype=float32)
loss: tf.Tensor(0.003979013, shape=(), dtype=float32)
loss: tf.Tensor(0.08037581, shape=(), dtype=float32)
loss: tf.Tensor(0.011325335, shape=(), dtype=float32)
loss: tf.Tensor(0.027448202, shape=(), dtype=float32)
loss: tf.Tensor(2.7418098e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6967475, shape=(), dtype=float32)
F1 SCORE:
0.82532483
EPOCH  45 #################################
loss: tf.Tensor(0.0349872, shape=(), dtype=float32)
loss: tf.Tensor(0.044774987, shape=(), dtype=float32)
loss: tf.Tensor(0.013165741, shape=(), dtype=float32)
loss: tf.Tensor(0.081727736, shape=(), dtype=float32)
loss: tf.Tensor(0.007844658, shape=(), dtype=float32)
loss: tf.Tensor(0.002463666, shape=(), dtype=float32)
loss: tf.Tensor(0.006523217, shape=(), dtype=float32)
loss: tf.Tensor(0.04822442, shape=(), dtype=float32)
loss: tf.Tensor(0.00926268, shape=(), dtype=float32)
loss: tf.Tensor(0.036271926, shape=(), dtype=float32)
loss: tf.Tensor(0.02378553, shape=(), dtype=float32)
loss: tf.Tensor(0.019316353, shape=(), dtype=float32)
loss: tf.Tensor(0.018558778, shape=(), dtype=float32)
loss: tf.Tensor(0.033837963, shape=(), dtype=float32)
loss: tf.Tensor(0.0142755415, shape=(), dtype=float32)
loss: tf.Tensor(0.05224713, shape=(), dtype=float32)
loss: tf.Tensor(0.019857718, shape=(), dtype=float32)
loss: tf.Tensor(0.035519682, shape=(), dtype=float32)
loss: tf.Tensor(0.010315734, shape=(), dtype=float32)
loss: tf.Tensor(0.033670515, shape=(), dtype=float32)
loss: tf.Tensor(0.01438902, shape=(), dtype=float32)
loss: tf.Tensor(0.0293063, shape=(), dtype=float32)
loss: tf.Tensor(0.008476288, shape=(), dtype=float32)
loss: tf.Tensor(0.02160063, shape=(), dtype=float32)
loss: tf.Tensor(0.04198856, shape=(), dtype=float32)
loss: tf.Tensor(0.044844285, shape=(), dtype=float32)
loss: tf.Tensor(0.07837691, shape=(), dtype=float32)
loss: tf.Tensor(0.0032367534, shape=(), dtype=float32)
loss: tf.Tensor(0.012472455, shape=(), dtype=float32)
loss: tf.Tensor(0.013064231, shape=(), dtype=float32)
loss: tf.Tensor(0.013035038, shape=(), dtype=float32)
loss: tf.Tensor(0.027099952, shape=(), dtype=float32)
loss: tf.Tensor(0.021158092, shape=(), dtype=float32)
loss: tf.Tensor(0.0021909457, shape=(), dtype=float32)
loss: tf.Tensor(0.0101704905, shape=(), dtype=float32)
loss: tf.Tensor(0.024980154, shape=(), dtype=float32)
loss: tf.Tensor(0.045380402, shape=(), dtype=float32)
loss: tf.Tensor(0.081872776, shape=(), dtype=float32)
loss: tf.Tensor(0.008571104, shape=(), dtype=float32)
loss: tf.Tensor(0.0050838445, shape=(), dtype=float32)
loss: tf.Tensor(0.07784799, shape=(), dtype=float32)
loss: tf.Tensor(0.020882998, shape=(), dtype=float32)
loss: tf.Tensor(0.0053271665, shape=(), dtype=float32)
loss: tf.Tensor(0.05419414, shape=(), dtype=float32)
loss: tf.Tensor(0.009338468, shape=(), dtype=float32)
loss: tf.Tensor(0.049419418, shape=(), dtype=float32)
loss: tf.Tensor(0.02880428, shape=(), dtype=float32)
loss: tf.Tensor(0.025142338, shape=(), dtype=float32)
loss: tf.Tensor(0.005034952, shape=(), dtype=float32)
loss: tf.Tensor(0.05838325, shape=(), dtype=float32)
loss: tf.Tensor(0.0037045253, shape=(), dtype=float32)
loss: tf.Tensor(0.020132907, shape=(), dtype=float32)
loss: tf.Tensor(0.024637228, shape=(), dtype=float32)
loss: tf.Tensor(0.050007626, shape=(), dtype=float32)
loss: tf.Tensor(0.0071983254, shape=(), dtype=float32)
loss: tf.Tensor(0.006220262, shape=(), dtype=float32)
loss: tf.Tensor(0.030509548, shape=(), dtype=float32)
loss: tf.Tensor(0.062306985, shape=(), dtype=float32)
loss: tf.Tensor(0.019189095, shape=(), dtype=float32)
loss: tf.Tensor(0.00664257, shape=(), dtype=float32)
loss: tf.Tensor(0.027572155, shape=(), dtype=float32)
loss: tf.Tensor(0.035678357, shape=(), dtype=float32)
loss: tf.Tensor(0.0059762774, shape=(), dtype=float32)
loss: tf.Tensor(0.0020452978, shape=(), dtype=float32)
loss: tf.Tensor(0.0043570357, shape=(), dtype=float32)
loss: tf.Tensor(0.03608513, shape=(), dtype=float32)
loss: tf.Tensor(0.034949794, shape=(), dtype=float32)
loss: tf.Tensor(0.026060546, shape=(), dtype=float32)
loss: tf.Tensor(0.053800836, shape=(), dtype=float32)
loss: tf.Tensor(0.13539876, shape=(), dtype=float32)
loss: tf.Tensor(0.0061799353, shape=(), dtype=float32)
loss: tf.Tensor(0.007688179, shape=(), dtype=float32)
loss: tf.Tensor(0.058622528, shape=(), dtype=float32)
loss: tf.Tensor(0.00094404945, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69302183, shape=(), dtype=float32)
F1 SCORE:
0.8255062
EPOCH  46 #################################
loss: tf.Tensor(0.00565427, shape=(), dtype=float32)
loss: tf.Tensor(0.0079279365, shape=(), dtype=float32)
loss: tf.Tensor(0.019487225, shape=(), dtype=float32)
loss: tf.Tensor(0.058647595, shape=(), dtype=float32)
loss: tf.Tensor(0.012687214, shape=(), dtype=float32)
loss: tf.Tensor(0.06547888, shape=(), dtype=float32)
loss: tf.Tensor(0.034059342, shape=(), dtype=float32)
loss: tf.Tensor(0.031589482, shape=(), dtype=float32)
loss: tf.Tensor(0.0028577296, shape=(), dtype=float32)
loss: tf.Tensor(0.03637744, shape=(), dtype=float32)
loss: tf.Tensor(0.034428455, shape=(), dtype=float32)
loss: tf.Tensor(0.027483478, shape=(), dtype=float32)
loss: tf.Tensor(0.030731263, shape=(), dtype=float32)
loss: tf.Tensor(0.007188902, shape=(), dtype=float32)
loss: tf.Tensor(0.06367069, shape=(), dtype=float32)
loss: tf.Tensor(0.008091478, shape=(), dtype=float32)
loss: tf.Tensor(0.011499589, shape=(), dtype=float32)
loss: tf.Tensor(0.01787671, shape=(), dtype=float32)
loss: tf.Tensor(0.019478451, shape=(), dtype=float32)
loss: tf.Tensor(0.06080222, shape=(), dtype=float32)
loss: tf.Tensor(0.070487164, shape=(), dtype=float32)
loss: tf.Tensor(0.045303866, shape=(), dtype=float32)
loss: tf.Tensor(0.013841968, shape=(), dtype=float32)
loss: tf.Tensor(0.019562865, shape=(), dtype=float32)
loss: tf.Tensor(0.027473422, shape=(), dtype=float32)
loss: tf.Tensor(0.009262015, shape=(), dtype=float32)
loss: tf.Tensor(0.006625401, shape=(), dtype=float32)
loss: tf.Tensor(0.004463424, shape=(), dtype=float32)
loss: tf.Tensor(0.018610856, shape=(), dtype=float32)
loss: tf.Tensor(0.004850897, shape=(), dtype=float32)
loss: tf.Tensor(0.037477493, shape=(), dtype=float32)
loss: tf.Tensor(0.019429091, shape=(), dtype=float32)
loss: tf.Tensor(0.013980601, shape=(), dtype=float32)
loss: tf.Tensor(0.07202208, shape=(), dtype=float32)
loss: tf.Tensor(0.118928194, shape=(), dtype=float32)
loss: tf.Tensor(0.011041758, shape=(), dtype=float32)
loss: tf.Tensor(0.03515863, shape=(), dtype=float32)
loss: tf.Tensor(0.009723968, shape=(), dtype=float32)
loss: tf.Tensor(0.022557091, shape=(), dtype=float32)
loss: tf.Tensor(0.0072513344, shape=(), dtype=float32)
loss: tf.Tensor(0.05251047, shape=(), dtype=float32)
loss: tf.Tensor(0.0015778053, shape=(), dtype=float32)
loss: tf.Tensor(0.02226182, shape=(), dtype=float32)
loss: tf.Tensor(0.07166921, shape=(), dtype=float32)
loss: tf.Tensor(0.043417796, shape=(), dtype=float32)
loss: tf.Tensor(0.012348248, shape=(), dtype=float32)
loss: tf.Tensor(0.061892137, shape=(), dtype=float32)
loss: tf.Tensor(0.028133087, shape=(), dtype=float32)
loss: tf.Tensor(0.011250214, shape=(), dtype=float32)
loss: tf.Tensor(0.08582518, shape=(), dtype=float32)
loss: tf.Tensor(0.021087013, shape=(), dtype=float32)
loss: tf.Tensor(0.13294046, shape=(), dtype=float32)
loss: tf.Tensor(0.03716976, shape=(), dtype=float32)
loss: tf.Tensor(0.011487638, shape=(), dtype=float32)
loss: tf.Tensor(0.026443888, shape=(), dtype=float32)
loss: tf.Tensor(0.029016027, shape=(), dtype=float32)
loss: tf.Tensor(0.062291283, shape=(), dtype=float32)
loss: tf.Tensor(0.0069886683, shape=(), dtype=float32)
loss: tf.Tensor(0.041902594, shape=(), dtype=float32)
loss: tf.Tensor(0.048371777, shape=(), dtype=float32)
loss: tf.Tensor(0.009610009, shape=(), dtype=float32)
loss: tf.Tensor(0.029809065, shape=(), dtype=float32)
loss: tf.Tensor(0.018941123, shape=(), dtype=float32)
loss: tf.Tensor(0.045518655, shape=(), dtype=float32)
loss: tf.Tensor(0.007427335, shape=(), dtype=float32)
loss: tf.Tensor(0.023160757, shape=(), dtype=float32)
loss: tf.Tensor(0.02033054, shape=(), dtype=float32)
loss: tf.Tensor(0.018074038, shape=(), dtype=float32)
loss: tf.Tensor(0.008662555, shape=(), dtype=float32)
loss: tf.Tensor(0.014779209, shape=(), dtype=float32)
loss: tf.Tensor(0.004121058, shape=(), dtype=float32)
loss: tf.Tensor(0.017202094, shape=(), dtype=float32)
loss: tf.Tensor(0.025261234, shape=(), dtype=float32)
loss: tf.Tensor(1.5139465e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7068231, shape=(), dtype=float32)
F1 SCORE:
0.8254245
EPOCH  47 #################################
loss: tf.Tensor(0.09176476, shape=(), dtype=float32)
loss: tf.Tensor(0.08119414, shape=(), dtype=float32)
loss: tf.Tensor(0.011244507, shape=(), dtype=float32)
loss: tf.Tensor(0.035650004, shape=(), dtype=float32)
loss: tf.Tensor(0.0101855835, shape=(), dtype=float32)
loss: tf.Tensor(0.018468745, shape=(), dtype=float32)
loss: tf.Tensor(0.013922324, shape=(), dtype=float32)
loss: tf.Tensor(0.022262108, shape=(), dtype=float32)
loss: tf.Tensor(0.0667593, shape=(), dtype=float32)
loss: tf.Tensor(0.030063376, shape=(), dtype=float32)
loss: tf.Tensor(0.0037426937, shape=(), dtype=float32)
loss: tf.Tensor(0.017179836, shape=(), dtype=float32)
loss: tf.Tensor(0.05420593, shape=(), dtype=float32)
loss: tf.Tensor(0.016378613, shape=(), dtype=float32)
loss: tf.Tensor(0.050520454, shape=(), dtype=float32)
loss: tf.Tensor(0.02612114, shape=(), dtype=float32)
loss: tf.Tensor(0.03317905, shape=(), dtype=float32)
loss: tf.Tensor(0.027852958, shape=(), dtype=float32)
loss: tf.Tensor(0.018069739, shape=(), dtype=float32)
loss: tf.Tensor(0.040959455, shape=(), dtype=float32)
loss: tf.Tensor(0.11251403, shape=(), dtype=float32)
loss: tf.Tensor(0.055744305, shape=(), dtype=float32)
loss: tf.Tensor(0.0052336417, shape=(), dtype=float32)
loss: tf.Tensor(0.077593595, shape=(), dtype=float32)
loss: tf.Tensor(0.071780056, shape=(), dtype=float32)
loss: tf.Tensor(0.023312068, shape=(), dtype=float32)
loss: tf.Tensor(0.054224964, shape=(), dtype=float32)
loss: tf.Tensor(0.0782161, shape=(), dtype=float32)
loss: tf.Tensor(0.057027258, shape=(), dtype=float32)
loss: tf.Tensor(0.080526285, shape=(), dtype=float32)
loss: tf.Tensor(0.024056701, shape=(), dtype=float32)
loss: tf.Tensor(0.06046857, shape=(), dtype=float32)
loss: tf.Tensor(0.050993606, shape=(), dtype=float32)
loss: tf.Tensor(0.013169977, shape=(), dtype=float32)
loss: tf.Tensor(0.02109739, shape=(), dtype=float32)
loss: tf.Tensor(0.009097105, shape=(), dtype=float32)
loss: tf.Tensor(0.118437186, shape=(), dtype=float32)
loss: tf.Tensor(0.009183925, shape=(), dtype=float32)
loss: tf.Tensor(0.09240553, shape=(), dtype=float32)
loss: tf.Tensor(0.025732344, shape=(), dtype=float32)
loss: tf.Tensor(0.029934831, shape=(), dtype=float32)
loss: tf.Tensor(0.13584398, shape=(), dtype=float32)
loss: tf.Tensor(0.0048296466, shape=(), dtype=float32)
loss: tf.Tensor(0.020649124, shape=(), dtype=float32)
loss: tf.Tensor(0.016081387, shape=(), dtype=float32)
loss: tf.Tensor(0.0033828104, shape=(), dtype=float32)
loss: tf.Tensor(0.067310564, shape=(), dtype=float32)
loss: tf.Tensor(0.035658203, shape=(), dtype=float32)
loss: tf.Tensor(0.039907623, shape=(), dtype=float32)
loss: tf.Tensor(0.022594377, shape=(), dtype=float32)
loss: tf.Tensor(0.05083433, shape=(), dtype=float32)
loss: tf.Tensor(0.022501312, shape=(), dtype=float32)
loss: tf.Tensor(0.036901537, shape=(), dtype=float32)
loss: tf.Tensor(0.04635406, shape=(), dtype=float32)
loss: tf.Tensor(0.026184687, shape=(), dtype=float32)
loss: tf.Tensor(0.064804986, shape=(), dtype=float32)
loss: tf.Tensor(0.041038416, shape=(), dtype=float32)
loss: tf.Tensor(0.004098167, shape=(), dtype=float32)
loss: tf.Tensor(0.06310435, shape=(), dtype=float32)
loss: tf.Tensor(0.014924155, shape=(), dtype=float32)
loss: tf.Tensor(0.006104587, shape=(), dtype=float32)
loss: tf.Tensor(0.045471765, shape=(), dtype=float32)
loss: tf.Tensor(0.022130117, shape=(), dtype=float32)
loss: tf.Tensor(0.064026184, shape=(), dtype=float32)
loss: tf.Tensor(0.04929153, shape=(), dtype=float32)
loss: tf.Tensor(0.0029917455, shape=(), dtype=float32)
loss: tf.Tensor(0.003290139, shape=(), dtype=float32)
loss: tf.Tensor(0.027133003, shape=(), dtype=float32)
loss: tf.Tensor(0.025105167, shape=(), dtype=float32)
loss: tf.Tensor(0.050976038, shape=(), dtype=float32)
loss: tf.Tensor(0.023819625, shape=(), dtype=float32)
loss: tf.Tensor(0.096579514, shape=(), dtype=float32)
loss: tf.Tensor(0.022425435, shape=(), dtype=float32)
loss: tf.Tensor(0.006202496, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69660014, shape=(), dtype=float32)
F1 SCORE:
0.8255909
EPOCH  48 #################################
loss: tf.Tensor(0.015430253, shape=(), dtype=float32)
loss: tf.Tensor(0.008971362, shape=(), dtype=float32)
loss: tf.Tensor(0.008248733, shape=(), dtype=float32)
loss: tf.Tensor(0.0437105, shape=(), dtype=float32)
loss: tf.Tensor(0.009534732, shape=(), dtype=float32)
loss: tf.Tensor(0.02560874, shape=(), dtype=float32)
loss: tf.Tensor(0.0025358952, shape=(), dtype=float32)
loss: tf.Tensor(0.013316035, shape=(), dtype=float32)
loss: tf.Tensor(0.019510202, shape=(), dtype=float32)
loss: tf.Tensor(0.02169053, shape=(), dtype=float32)
loss: tf.Tensor(0.020726211, shape=(), dtype=float32)
loss: tf.Tensor(0.024870845, shape=(), dtype=float32)
loss: tf.Tensor(0.015356343, shape=(), dtype=float32)
loss: tf.Tensor(0.043289836, shape=(), dtype=float32)
loss: tf.Tensor(0.026835226, shape=(), dtype=float32)
loss: tf.Tensor(0.008641853, shape=(), dtype=float32)
loss: tf.Tensor(0.016940624, shape=(), dtype=float32)
loss: tf.Tensor(0.05946755, shape=(), dtype=float32)
loss: tf.Tensor(0.01677314, shape=(), dtype=float32)
loss: tf.Tensor(0.0052982434, shape=(), dtype=float32)
loss: tf.Tensor(0.069694415, shape=(), dtype=float32)
loss: tf.Tensor(0.0070158816, shape=(), dtype=float32)
loss: tf.Tensor(0.023913346, shape=(), dtype=float32)
loss: tf.Tensor(0.04335422, shape=(), dtype=float32)
loss: tf.Tensor(0.0037230798, shape=(), dtype=float32)
loss: tf.Tensor(0.012737393, shape=(), dtype=float32)
loss: tf.Tensor(0.038659938, shape=(), dtype=float32)
loss: tf.Tensor(0.029362664, shape=(), dtype=float32)
loss: tf.Tensor(0.011771991, shape=(), dtype=float32)
loss: tf.Tensor(0.039237212, shape=(), dtype=float32)
loss: tf.Tensor(0.020223854, shape=(), dtype=float32)
loss: tf.Tensor(0.0056467825, shape=(), dtype=float32)
loss: tf.Tensor(0.037399575, shape=(), dtype=float32)
loss: tf.Tensor(0.029366355, shape=(), dtype=float32)
loss: tf.Tensor(0.01958099, shape=(), dtype=float32)
loss: tf.Tensor(0.022108922, shape=(), dtype=float32)
loss: tf.Tensor(0.010608163, shape=(), dtype=float32)
loss: tf.Tensor(0.054481104, shape=(), dtype=float32)
loss: tf.Tensor(0.0112251695, shape=(), dtype=float32)
loss: tf.Tensor(0.073901646, shape=(), dtype=float32)
loss: tf.Tensor(0.042330366, shape=(), dtype=float32)
loss: tf.Tensor(0.026651112, shape=(), dtype=float32)
loss: tf.Tensor(0.048652597, shape=(), dtype=float32)
loss: tf.Tensor(0.04488845, shape=(), dtype=float32)
loss: tf.Tensor(0.010651096, shape=(), dtype=float32)
loss: tf.Tensor(0.022068975, shape=(), dtype=float32)
loss: tf.Tensor(0.15768728, shape=(), dtype=float32)
loss: tf.Tensor(0.013650643, shape=(), dtype=float32)
loss: tf.Tensor(0.010018643, shape=(), dtype=float32)
loss: tf.Tensor(0.008232282, shape=(), dtype=float32)
loss: tf.Tensor(0.01040001, shape=(), dtype=float32)
loss: tf.Tensor(0.023135558, shape=(), dtype=float32)
loss: tf.Tensor(0.030359292, shape=(), dtype=float32)
loss: tf.Tensor(0.061185945, shape=(), dtype=float32)
loss: tf.Tensor(0.011094332, shape=(), dtype=float32)
loss: tf.Tensor(0.006423724, shape=(), dtype=float32)
loss: tf.Tensor(0.026435854, shape=(), dtype=float32)
loss: tf.Tensor(0.019100918, shape=(), dtype=float32)
loss: tf.Tensor(0.015185492, shape=(), dtype=float32)
loss: tf.Tensor(0.017526185, shape=(), dtype=float32)
loss: tf.Tensor(0.003917946, shape=(), dtype=float32)
loss: tf.Tensor(0.015700985, shape=(), dtype=float32)
loss: tf.Tensor(0.028303215, shape=(), dtype=float32)
loss: tf.Tensor(0.010276143, shape=(), dtype=float32)
loss: tf.Tensor(0.041034006, shape=(), dtype=float32)
loss: tf.Tensor(0.00936512, shape=(), dtype=float32)
loss: tf.Tensor(0.019193131, shape=(), dtype=float32)
loss: tf.Tensor(0.009105706, shape=(), dtype=float32)
loss: tf.Tensor(0.03674497, shape=(), dtype=float32)
loss: tf.Tensor(0.0364437, shape=(), dtype=float32)
loss: tf.Tensor(0.0244397, shape=(), dtype=float32)
loss: tf.Tensor(0.06182558, shape=(), dtype=float32)
loss: tf.Tensor(0.032071456, shape=(), dtype=float32)
loss: tf.Tensor(0.0, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70600086, shape=(), dtype=float32)
F1 SCORE:
0.82554954
EPOCH  49 #################################
loss: tf.Tensor(0.013384551, shape=(), dtype=float32)
loss: tf.Tensor(0.0049402635, shape=(), dtype=float32)
loss: tf.Tensor(0.037320215, shape=(), dtype=float32)
loss: tf.Tensor(0.04294845, shape=(), dtype=float32)
loss: tf.Tensor(0.018945828, shape=(), dtype=float32)
loss: tf.Tensor(0.028783852, shape=(), dtype=float32)
loss: tf.Tensor(0.009483547, shape=(), dtype=float32)
loss: tf.Tensor(0.019506067, shape=(), dtype=float32)
loss: tf.Tensor(0.011168568, shape=(), dtype=float32)
loss: tf.Tensor(0.012321922, shape=(), dtype=float32)
loss: tf.Tensor(0.00929756, shape=(), dtype=float32)
loss: tf.Tensor(0.020697169, shape=(), dtype=float32)
loss: tf.Tensor(0.00915787, shape=(), dtype=float32)
loss: tf.Tensor(0.03173716, shape=(), dtype=float32)
loss: tf.Tensor(0.027970424, shape=(), dtype=float32)
loss: tf.Tensor(0.0063011376, shape=(), dtype=float32)
loss: tf.Tensor(0.051447704, shape=(), dtype=float32)
loss: tf.Tensor(0.018117433, shape=(), dtype=float32)
loss: tf.Tensor(0.007858786, shape=(), dtype=float32)
loss: tf.Tensor(0.08300278, shape=(), dtype=float32)
loss: tf.Tensor(0.006167208, shape=(), dtype=float32)
loss: tf.Tensor(0.005767336, shape=(), dtype=float32)
loss: tf.Tensor(0.025026068, shape=(), dtype=float32)
loss: tf.Tensor(0.003057916, shape=(), dtype=float32)
loss: tf.Tensor(0.01653302, shape=(), dtype=float32)
loss: tf.Tensor(0.042172648, shape=(), dtype=float32)
loss: tf.Tensor(0.007772922, shape=(), dtype=float32)
loss: tf.Tensor(0.12795635, shape=(), dtype=float32)
loss: tf.Tensor(0.012776842, shape=(), dtype=float32)
loss: tf.Tensor(0.0034738064, shape=(), dtype=float32)
loss: tf.Tensor(0.05137174, shape=(), dtype=float32)
loss: tf.Tensor(0.0036907562, shape=(), dtype=float32)
loss: tf.Tensor(0.014862347, shape=(), dtype=float32)
loss: tf.Tensor(0.025336208, shape=(), dtype=float32)
loss: tf.Tensor(0.0107760085, shape=(), dtype=float32)
loss: tf.Tensor(0.007660328, shape=(), dtype=float32)
loss: tf.Tensor(0.014000382, shape=(), dtype=float32)
loss: tf.Tensor(0.013213731, shape=(), dtype=float32)
loss: tf.Tensor(0.005142769, shape=(), dtype=float32)
loss: tf.Tensor(0.025042176, shape=(), dtype=float32)
loss: tf.Tensor(0.019162793, shape=(), dtype=float32)
loss: tf.Tensor(0.031104641, shape=(), dtype=float32)
loss: tf.Tensor(0.063756324, shape=(), dtype=float32)
loss: tf.Tensor(0.003585863, shape=(), dtype=float32)
loss: tf.Tensor(0.031032981, shape=(), dtype=float32)
loss: tf.Tensor(0.03684861, shape=(), dtype=float32)
loss: tf.Tensor(0.020660475, shape=(), dtype=float32)
loss: tf.Tensor(0.011694109, shape=(), dtype=float32)
loss: tf.Tensor(0.012416065, shape=(), dtype=float32)
loss: tf.Tensor(0.0424856, shape=(), dtype=float32)
loss: tf.Tensor(0.020876067, shape=(), dtype=float32)
loss: tf.Tensor(0.019285448, shape=(), dtype=float32)
loss: tf.Tensor(0.088527024, shape=(), dtype=float32)
loss: tf.Tensor(0.012407184, shape=(), dtype=float32)
loss: tf.Tensor(0.09393855, shape=(), dtype=float32)
loss: tf.Tensor(0.003792933, shape=(), dtype=float32)
loss: tf.Tensor(0.01656649, shape=(), dtype=float32)
loss: tf.Tensor(0.061920296, shape=(), dtype=float32)
loss: tf.Tensor(0.006774512, shape=(), dtype=float32)
loss: tf.Tensor(0.0075884913, shape=(), dtype=float32)
loss: tf.Tensor(0.032109894, shape=(), dtype=float32)
loss: tf.Tensor(0.009116023, shape=(), dtype=float32)
loss: tf.Tensor(0.015230135, shape=(), dtype=float32)
loss: tf.Tensor(0.037316747, shape=(), dtype=float32)
loss: tf.Tensor(0.015334848, shape=(), dtype=float32)
loss: tf.Tensor(0.06526664, shape=(), dtype=float32)
loss: tf.Tensor(0.04654304, shape=(), dtype=float32)
loss: tf.Tensor(0.03230097, shape=(), dtype=float32)
loss: tf.Tensor(0.017183695, shape=(), dtype=float32)
loss: tf.Tensor(0.01495005, shape=(), dtype=float32)
loss: tf.Tensor(0.070800394, shape=(), dtype=float32)
loss: tf.Tensor(0.026830994, shape=(), dtype=float32)
loss: tf.Tensor(0.039918188, shape=(), dtype=float32)
loss: tf.Tensor(0.0, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f3be0ba1bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6977748, shape=(), dtype=float32)
F1 SCORE:
0.8257289
