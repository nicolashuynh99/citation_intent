2021-02-28 13:22:31.535920: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-02-28 13:22:31.535963: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
LOADING DICO FINI
1000 edges added on 111397   --------   1 % 
2000 edges added on 111397   --------   2 % 
3000 edges added on 111397   --------   3 % 
4000 edges added on 111397   --------   4 % 
5000 edges added on 111397   --------   4 % 
6000 edges added on 111397   --------   5 % 
7000 edges added on 111397   --------   6 % 
8000 edges added on 111397   --------   7 % 
9000 edges added on 111397   --------   8 % 
10000 edges added on 111397   --------   9 % 
11000 edges added on 111397   --------   10 % 
12000 edges added on 111397   --------   11 % 
13000 edges added on 111397   --------   12 % 
14000 edges added on 111397   --------   13 % 
15000 edges added on 111397   --------   13 % 
16000 edges added on 111397   --------   14 % 
17000 edges added on 111397   --------   15 % 
18000 edges added on 111397   --------   16 % 
19000 edges added on 111397   --------   17 % 
20000 edges added on 111397   --------   18 % 
21000 edges added on 111397   --------   19 % 
22000 edges added on 111397   --------   20 % 
23000 edges added on 111397   --------   21 % 
24000 edges added on 111397   --------   22 % 
25000 edges added on 111397   --------   22 % 
26000 edges added on 111397   --------   23 % 
27000 edges added on 111397   --------   24 % 
28000 edges added on 111397   --------   25 % 
29000 edges added on 111397   --------   26 % 
30000 edges added on 111397   --------   27 % 
31000 edges added on 111397   --------   28 % 
32000 edges added on 111397   --------   29 % 
33000 edges added on 111397   --------   30 % 
34000 edges added on 111397   --------   31 % 
35000 edges added on 111397   --------   31 % 
36000 edges added on 111397   --------   32 % 
37000 edges added on 111397   --------   33 % 
38000 edges added on 111397   --------   34 % 
39000 edges added on 111397   --------   35 % 
40000 edges added on 111397   --------   36 % 
41000 edges added on 111397   --------   37 % 
42000 edges added on 111397   --------   38 % 
43000 edges added on 111397   --------   39 % 
44000 edges added on 111397   --------   39 % 
45000 edges added on 111397   --------   40 % 
46000 edges added on 111397   --------   41 % 
47000 edges added on 111397   --------   42 % 
48000 edges added on 111397   --------   43 % 
49000 edges added on 111397   --------   44 % 
50000 edges added on 111397   --------   45 % 
51000 edges added on 111397   --------   46 % 
52000 edges added on 111397   --------   47 % 
53000 edges added on 111397   --------   48 % 
54000 edges added on 111397   --------   48 % 
55000 edges added on 111397   --------   49 % 
56000 edges added on 111397   --------   50 % 
57000 edges added on 111397   --------   51 % 
58000 edges added on 111397   --------   52 % 
59000 edges added on 111397   --------   53 % 
60000 edges added on 111397   --------   54 % 
61000 edges added on 111397   --------   55 % 
62000 edges added on 111397   --------   56 % 
63000 edges added on 111397   --------   57 % 
64000 edges added on 111397   --------   57 % 
65000 edges added on 111397   --------   58 % 
66000 edges added on 111397   --------   59 % 
67000 edges added on 111397   --------   60 % 
68000 edges added on 111397   --------   61 % 
69000 edges added on 111397   --------   62 % 
70000 edges added on 111397   --------   63 % 
71000 edges added on 111397   --------   64 % 
72000 edges added on 111397   --------   65 % 
73000 edges added on 111397   --------   66 % 
74000 edges added on 111397   --------   66 % 
75000 edges added on 111397   --------   67 % 
76000 edges added on 111397   --------   68 % 
77000 edges added on 111397   --------   69 % 
78000 edges added on 111397   --------   70 % 
79000 edges added on 111397   --------   71 % 
80000 edges added on 111397   --------   72 % 
81000 edges added on 111397   --------   73 % 
82000 edges added on 111397   --------   74 % 
83000 edges added on 111397   --------   75 % 
84000 edges added on 111397   --------   75 % 
85000 edges added on 111397   --------   76 % 
86000 edges added on 111397   --------   77 % 
87000 edges added on 111397   --------   78 % 
88000 edges added on 111397   --------   79 % 
89000 edges added on 111397   --------   80 % 
90000 edges added on 111397   --------   81 % 
91000 edges added on 111397   --------   82 % 
92000 edges added on 111397   --------   83 % 
93000 edges added on 111397   --------   83 % 
94000 edges added on 111397   --------   84 % 
95000 edges added on 111397   --------   85 % 
96000 edges added on 111397   --------   86 % 
97000 edges added on 111397   --------   87 % 
98000 edges added on 111397   --------   88 % 
99000 edges added on 111397   --------   89 % 
100000 edges added on 111397   --------   90 % 
101000 edges added on 111397   --------   91 % 
102000 edges added on 111397   --------   92 % 
103000 edges added on 111397   --------   92 % 
104000 edges added on 111397   --------   93 % 
105000 edges added on 111397   --------   94 % 
106000 edges added on 111397   --------   95 % 
107000 edges added on 111397   --------   96 % 
108000 edges added on 111397   --------   97 % 
109000 edges added on 111397   --------   98 % 
110000 edges added on 111397   --------   99 % 
111000 edges added on 111397   --------   100 % 
avant: 7685
apres: 7301
2021-02-28 13:23:05.317518: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-02-28 13:23:05.318429: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-02-28 13:23:05.318459: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-02-28 13:23:05.318496: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (cedar006.saclay.inria.fr): /proc/driver/nvidia/version does not exist
2021-02-28 13:23:05.322467: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
EPOCH  0 #################################
/data/projet_citations/sage/edgeMinibatch.py:119: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.train_edges[i][2])
509
loss: tf.Tensor(1.1127859, shape=(), dtype=float32)
loss: tf.Tensor(1.0612587, shape=(), dtype=float32)
loss: tf.Tensor(0.8524895, shape=(), dtype=float32)
loss: tf.Tensor(1.0198361, shape=(), dtype=float32)
loss: tf.Tensor(0.89801955, shape=(), dtype=float32)
loss: tf.Tensor(0.97135264, shape=(), dtype=float32)
loss: tf.Tensor(0.89383185, shape=(), dtype=float32)
loss: tf.Tensor(0.9000442, shape=(), dtype=float32)
loss: tf.Tensor(0.88510203, shape=(), dtype=float32)
loss: tf.Tensor(0.79163015, shape=(), dtype=float32)
loss: tf.Tensor(0.8964712, shape=(), dtype=float32)
loss: tf.Tensor(1.0262289, shape=(), dtype=float32)
loss: tf.Tensor(0.82993454, shape=(), dtype=float32)
loss: tf.Tensor(0.8402035, shape=(), dtype=float32)
loss: tf.Tensor(0.8234222, shape=(), dtype=float32)
loss: tf.Tensor(0.7305664, shape=(), dtype=float32)
loss: tf.Tensor(0.83202934, shape=(), dtype=float32)
loss: tf.Tensor(0.82200587, shape=(), dtype=float32)
loss: tf.Tensor(0.9381186, shape=(), dtype=float32)
loss: tf.Tensor(0.7542007, shape=(), dtype=float32)
loss: tf.Tensor(0.81760323, shape=(), dtype=float32)
loss: tf.Tensor(0.74268824, shape=(), dtype=float32)
loss: tf.Tensor(0.7615488, shape=(), dtype=float32)
loss: tf.Tensor(0.62969285, shape=(), dtype=float32)
loss: tf.Tensor(0.7573924, shape=(), dtype=float32)
loss: tf.Tensor(0.69088244, shape=(), dtype=float32)
loss: tf.Tensor(0.54639965, shape=(), dtype=float32)
loss: tf.Tensor(0.5838157, shape=(), dtype=float32)
loss: tf.Tensor(0.72004473, shape=(), dtype=float32)
loss: tf.Tensor(0.8006497, shape=(), dtype=float32)
loss: tf.Tensor(0.7211157, shape=(), dtype=float32)
loss: tf.Tensor(0.63398284, shape=(), dtype=float32)
loss: tf.Tensor(0.797411, shape=(), dtype=float32)
loss: tf.Tensor(0.83133096, shape=(), dtype=float32)
loss: tf.Tensor(0.7338948, shape=(), dtype=float32)
loss: tf.Tensor(0.86976504, shape=(), dtype=float32)
loss: tf.Tensor(0.70233476, shape=(), dtype=float32)
loss: tf.Tensor(0.694437, shape=(), dtype=float32)
loss: tf.Tensor(0.8626403, shape=(), dtype=float32)
loss: tf.Tensor(0.8331492, shape=(), dtype=float32)
loss: tf.Tensor(0.7088739, shape=(), dtype=float32)
loss: tf.Tensor(0.8074389, shape=(), dtype=float32)
loss: tf.Tensor(0.6572961, shape=(), dtype=float32)
loss: tf.Tensor(0.7319707, shape=(), dtype=float32)
loss: tf.Tensor(0.62128675, shape=(), dtype=float32)
loss: tf.Tensor(0.6001153, shape=(), dtype=float32)
loss: tf.Tensor(0.6196224, shape=(), dtype=float32)
loss: tf.Tensor(0.64732915, shape=(), dtype=float32)
loss: tf.Tensor(0.6739908, shape=(), dtype=float32)
loss: tf.Tensor(0.7283739, shape=(), dtype=float32)
loss: tf.Tensor(0.5556862, shape=(), dtype=float32)
loss: tf.Tensor(0.79733247, shape=(), dtype=float32)
loss: tf.Tensor(0.665514, shape=(), dtype=float32)
loss: tf.Tensor(0.6713917, shape=(), dtype=float32)
loss: tf.Tensor(0.67497176, shape=(), dtype=float32)
loss: tf.Tensor(0.7054441, shape=(), dtype=float32)
loss: tf.Tensor(0.6591915, shape=(), dtype=float32)
loss: tf.Tensor(0.5227737, shape=(), dtype=float32)
loss: tf.Tensor(0.5032549, shape=(), dtype=float32)
loss: tf.Tensor(0.7089106, shape=(), dtype=float32)
loss: tf.Tensor(0.4752819, shape=(), dtype=float32)
loss: tf.Tensor(0.5887612, shape=(), dtype=float32)
loss: tf.Tensor(0.54502887, shape=(), dtype=float32)
loss: tf.Tensor(0.39972842, shape=(), dtype=float32)
loss: tf.Tensor(0.48139057, shape=(), dtype=float32)
loss: tf.Tensor(0.5780832, shape=(), dtype=float32)
loss: tf.Tensor(0.64995694, shape=(), dtype=float32)
loss: tf.Tensor(0.5717181, shape=(), dtype=float32)
loss: tf.Tensor(0.56209993, shape=(), dtype=float32)
loss: tf.Tensor(0.70066804, shape=(), dtype=float32)
loss: tf.Tensor(0.3385166, shape=(), dtype=float32)
loss: tf.Tensor(0.5359608, shape=(), dtype=float32)
loss: tf.Tensor(0.5818542, shape=(), dtype=float32)
loss: tf.Tensor(0.30527145, shape=(), dtype=float32)
TEST LOSS: #####################################
/data/projet_citations/sage/edgeMinibatch.py:163: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.test_edges[i][2])
2021-02-28 13:44:51.344546: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-02-28 13:44:51.346875: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2399860000 Hz
tf.Tensor(0.7297914, shape=(), dtype=float32)
F1 SCORE:
0.8334003
EPOCH  1 #################################
loss: tf.Tensor(0.59028035, shape=(), dtype=float32)
loss: tf.Tensor(0.47056523, shape=(), dtype=float32)
loss: tf.Tensor(0.5137618, shape=(), dtype=float32)
loss: tf.Tensor(0.65669614, shape=(), dtype=float32)
loss: tf.Tensor(0.5985659, shape=(), dtype=float32)
loss: tf.Tensor(0.5539098, shape=(), dtype=float32)
loss: tf.Tensor(0.62279695, shape=(), dtype=float32)
loss: tf.Tensor(0.4494246, shape=(), dtype=float32)
loss: tf.Tensor(0.51101816, shape=(), dtype=float32)
loss: tf.Tensor(0.48399124, shape=(), dtype=float32)
loss: tf.Tensor(0.4934079, shape=(), dtype=float32)
loss: tf.Tensor(0.43780708, shape=(), dtype=float32)
loss: tf.Tensor(0.5742899, shape=(), dtype=float32)
loss: tf.Tensor(0.54161006, shape=(), dtype=float32)
loss: tf.Tensor(0.3471048, shape=(), dtype=float32)
loss: tf.Tensor(0.39337826, shape=(), dtype=float32)
loss: tf.Tensor(0.43522328, shape=(), dtype=float32)
loss: tf.Tensor(0.57657766, shape=(), dtype=float32)
loss: tf.Tensor(0.41947442, shape=(), dtype=float32)
loss: tf.Tensor(0.36921763, shape=(), dtype=float32)
loss: tf.Tensor(0.56659204, shape=(), dtype=float32)
loss: tf.Tensor(0.4992864, shape=(), dtype=float32)
loss: tf.Tensor(0.3059675, shape=(), dtype=float32)
loss: tf.Tensor(0.38821122, shape=(), dtype=float32)
loss: tf.Tensor(0.28275555, shape=(), dtype=float32)
loss: tf.Tensor(0.5645309, shape=(), dtype=float32)
loss: tf.Tensor(0.40940607, shape=(), dtype=float32)
loss: tf.Tensor(0.514848, shape=(), dtype=float32)
loss: tf.Tensor(0.45061788, shape=(), dtype=float32)
loss: tf.Tensor(0.47694674, shape=(), dtype=float32)
loss: tf.Tensor(0.46011013, shape=(), dtype=float32)
loss: tf.Tensor(0.48402873, shape=(), dtype=float32)
loss: tf.Tensor(0.500801, shape=(), dtype=float32)
loss: tf.Tensor(0.4887376, shape=(), dtype=float32)
loss: tf.Tensor(0.48410746, shape=(), dtype=float32)
loss: tf.Tensor(0.41404277, shape=(), dtype=float32)
loss: tf.Tensor(0.4387556, shape=(), dtype=float32)
loss: tf.Tensor(0.4297179, shape=(), dtype=float32)
loss: tf.Tensor(0.40096885, shape=(), dtype=float32)
loss: tf.Tensor(0.35665476, shape=(), dtype=float32)
loss: tf.Tensor(0.44192994, shape=(), dtype=float32)
loss: tf.Tensor(0.4553296, shape=(), dtype=float32)
loss: tf.Tensor(0.5210249, shape=(), dtype=float32)
loss: tf.Tensor(0.44999883, shape=(), dtype=float32)
loss: tf.Tensor(0.47967464, shape=(), dtype=float32)
loss: tf.Tensor(0.46577036, shape=(), dtype=float32)
loss: tf.Tensor(0.43009812, shape=(), dtype=float32)
loss: tf.Tensor(0.47724915, shape=(), dtype=float32)
loss: tf.Tensor(0.37283614, shape=(), dtype=float32)
loss: tf.Tensor(0.3651524, shape=(), dtype=float32)
loss: tf.Tensor(0.40596092, shape=(), dtype=float32)
loss: tf.Tensor(0.48945144, shape=(), dtype=float32)
loss: tf.Tensor(0.4527647, shape=(), dtype=float32)
loss: tf.Tensor(0.40511987, shape=(), dtype=float32)
loss: tf.Tensor(0.43463227, shape=(), dtype=float32)
loss: tf.Tensor(0.46973214, shape=(), dtype=float32)
loss: tf.Tensor(0.30340308, shape=(), dtype=float32)
loss: tf.Tensor(0.44411814, shape=(), dtype=float32)
loss: tf.Tensor(0.40830106, shape=(), dtype=float32)
loss: tf.Tensor(0.37404296, shape=(), dtype=float32)
loss: tf.Tensor(0.4869905, shape=(), dtype=float32)
loss: tf.Tensor(0.63368326, shape=(), dtype=float32)
loss: tf.Tensor(0.4030708, shape=(), dtype=float32)
loss: tf.Tensor(0.41563433, shape=(), dtype=float32)
loss: tf.Tensor(0.34212598, shape=(), dtype=float32)
loss: tf.Tensor(0.3153513, shape=(), dtype=float32)
loss: tf.Tensor(0.2944172, shape=(), dtype=float32)
loss: tf.Tensor(0.36001366, shape=(), dtype=float32)
loss: tf.Tensor(0.3568816, shape=(), dtype=float32)
loss: tf.Tensor(0.5307619, shape=(), dtype=float32)
loss: tf.Tensor(0.5166644, shape=(), dtype=float32)
loss: tf.Tensor(0.46885356, shape=(), dtype=float32)
loss: tf.Tensor(0.4588192, shape=(), dtype=float32)
loss: tf.Tensor(0.0026609034, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.71801656, shape=(), dtype=float32)
F1 SCORE:
0.8370466
EPOCH  2 #################################
loss: tf.Tensor(0.4857107, shape=(), dtype=float32)
loss: tf.Tensor(0.40243426, shape=(), dtype=float32)
loss: tf.Tensor(0.4519162, shape=(), dtype=float32)
loss: tf.Tensor(0.40558553, shape=(), dtype=float32)
loss: tf.Tensor(0.31419998, shape=(), dtype=float32)
loss: tf.Tensor(0.38677478, shape=(), dtype=float32)
loss: tf.Tensor(0.23855163, shape=(), dtype=float32)
loss: tf.Tensor(0.4020963, shape=(), dtype=float32)
loss: tf.Tensor(0.44773906, shape=(), dtype=float32)
loss: tf.Tensor(0.47833598, shape=(), dtype=float32)
loss: tf.Tensor(0.2799013, shape=(), dtype=float32)
loss: tf.Tensor(0.444127, shape=(), dtype=float32)
loss: tf.Tensor(0.40130085, shape=(), dtype=float32)
loss: tf.Tensor(0.3460256, shape=(), dtype=float32)
loss: tf.Tensor(0.48459473, shape=(), dtype=float32)
loss: tf.Tensor(0.4285267, shape=(), dtype=float32)
loss: tf.Tensor(0.4071246, shape=(), dtype=float32)
loss: tf.Tensor(0.5086982, shape=(), dtype=float32)
loss: tf.Tensor(0.3867242, shape=(), dtype=float32)
loss: tf.Tensor(0.3580655, shape=(), dtype=float32)
loss: tf.Tensor(0.3954803, shape=(), dtype=float32)
loss: tf.Tensor(0.48955858, shape=(), dtype=float32)
loss: tf.Tensor(0.30447686, shape=(), dtype=float32)
loss: tf.Tensor(0.4294994, shape=(), dtype=float32)
loss: tf.Tensor(0.4013944, shape=(), dtype=float32)
loss: tf.Tensor(0.3765504, shape=(), dtype=float32)
loss: tf.Tensor(0.3456896, shape=(), dtype=float32)
loss: tf.Tensor(0.48747367, shape=(), dtype=float32)
loss: tf.Tensor(0.30891436, shape=(), dtype=float32)
loss: tf.Tensor(0.31625786, shape=(), dtype=float32)
loss: tf.Tensor(0.38886952, shape=(), dtype=float32)
loss: tf.Tensor(0.30159327, shape=(), dtype=float32)
loss: tf.Tensor(0.42674458, shape=(), dtype=float32)
loss: tf.Tensor(0.60728693, shape=(), dtype=float32)
loss: tf.Tensor(0.3869228, shape=(), dtype=float32)
loss: tf.Tensor(0.4955576, shape=(), dtype=float32)
loss: tf.Tensor(0.34602794, shape=(), dtype=float32)
loss: tf.Tensor(0.5190767, shape=(), dtype=float32)
loss: tf.Tensor(0.3969814, shape=(), dtype=float32)
loss: tf.Tensor(0.46363083, shape=(), dtype=float32)
loss: tf.Tensor(0.39278153, shape=(), dtype=float32)
loss: tf.Tensor(0.45810685, shape=(), dtype=float32)
loss: tf.Tensor(0.38603112, shape=(), dtype=float32)
loss: tf.Tensor(0.4703318, shape=(), dtype=float32)
loss: tf.Tensor(0.3604766, shape=(), dtype=float32)
loss: tf.Tensor(0.45144707, shape=(), dtype=float32)
loss: tf.Tensor(0.42222026, shape=(), dtype=float32)
loss: tf.Tensor(0.593145, shape=(), dtype=float32)
loss: tf.Tensor(0.36602184, shape=(), dtype=float32)
loss: tf.Tensor(0.4735824, shape=(), dtype=float32)
loss: tf.Tensor(0.3722268, shape=(), dtype=float32)
loss: tf.Tensor(0.41526872, shape=(), dtype=float32)
loss: tf.Tensor(0.38366562, shape=(), dtype=float32)
loss: tf.Tensor(0.50162095, shape=(), dtype=float32)
loss: tf.Tensor(0.38665745, shape=(), dtype=float32)
loss: tf.Tensor(0.39765888, shape=(), dtype=float32)
loss: tf.Tensor(0.38549507, shape=(), dtype=float32)
loss: tf.Tensor(0.37624508, shape=(), dtype=float32)
loss: tf.Tensor(0.33712578, shape=(), dtype=float32)
loss: tf.Tensor(0.39519456, shape=(), dtype=float32)
loss: tf.Tensor(0.28982452, shape=(), dtype=float32)
loss: tf.Tensor(0.3378007, shape=(), dtype=float32)
loss: tf.Tensor(0.3449121, shape=(), dtype=float32)
loss: tf.Tensor(0.56071734, shape=(), dtype=float32)
loss: tf.Tensor(0.61389816, shape=(), dtype=float32)
loss: tf.Tensor(0.38000092, shape=(), dtype=float32)
loss: tf.Tensor(0.41565907, shape=(), dtype=float32)
loss: tf.Tensor(0.42961702, shape=(), dtype=float32)
loss: tf.Tensor(0.56036127, shape=(), dtype=float32)
loss: tf.Tensor(0.5227232, shape=(), dtype=float32)
loss: tf.Tensor(0.20095241, shape=(), dtype=float32)
loss: tf.Tensor(0.35035056, shape=(), dtype=float32)
loss: tf.Tensor(0.38353235, shape=(), dtype=float32)
loss: tf.Tensor(4.5666685, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.73581314, shape=(), dtype=float32)
F1 SCORE:
0.8314547
EPOCH  3 #################################
loss: tf.Tensor(0.3231773, shape=(), dtype=float32)
loss: tf.Tensor(0.38578412, shape=(), dtype=float32)
loss: tf.Tensor(0.44128308, shape=(), dtype=float32)
loss: tf.Tensor(0.48846406, shape=(), dtype=float32)
loss: tf.Tensor(0.54132986, shape=(), dtype=float32)
loss: tf.Tensor(0.5588913, shape=(), dtype=float32)
loss: tf.Tensor(0.39654455, shape=(), dtype=float32)
loss: tf.Tensor(0.52880484, shape=(), dtype=float32)
loss: tf.Tensor(0.5413715, shape=(), dtype=float32)
loss: tf.Tensor(0.39091477, shape=(), dtype=float32)
loss: tf.Tensor(0.37503144, shape=(), dtype=float32)
loss: tf.Tensor(0.38010743, shape=(), dtype=float32)
loss: tf.Tensor(0.39092284, shape=(), dtype=float32)
loss: tf.Tensor(0.40239555, shape=(), dtype=float32)
loss: tf.Tensor(0.4045368, shape=(), dtype=float32)
loss: tf.Tensor(0.5188524, shape=(), dtype=float32)
loss: tf.Tensor(0.43503064, shape=(), dtype=float32)
loss: tf.Tensor(0.38143176, shape=(), dtype=float32)
loss: tf.Tensor(0.3525735, shape=(), dtype=float32)
loss: tf.Tensor(0.33716744, shape=(), dtype=float32)
loss: tf.Tensor(0.3514362, shape=(), dtype=float32)
loss: tf.Tensor(0.30388063, shape=(), dtype=float32)
loss: tf.Tensor(0.30971584, shape=(), dtype=float32)
loss: tf.Tensor(0.4284387, shape=(), dtype=float32)
loss: tf.Tensor(0.42270118, shape=(), dtype=float32)
loss: tf.Tensor(0.42798808, shape=(), dtype=float32)
loss: tf.Tensor(0.3263006, shape=(), dtype=float32)
loss: tf.Tensor(0.516388, shape=(), dtype=float32)
loss: tf.Tensor(0.42222258, shape=(), dtype=float32)
loss: tf.Tensor(0.44846144, shape=(), dtype=float32)
loss: tf.Tensor(0.43561137, shape=(), dtype=float32)
loss: tf.Tensor(0.3811786, shape=(), dtype=float32)
loss: tf.Tensor(0.26488626, shape=(), dtype=float32)
loss: tf.Tensor(0.34331372, shape=(), dtype=float32)
loss: tf.Tensor(0.4132147, shape=(), dtype=float32)
loss: tf.Tensor(0.49858966, shape=(), dtype=float32)
loss: tf.Tensor(0.360357, shape=(), dtype=float32)
loss: tf.Tensor(0.45773557, shape=(), dtype=float32)
loss: tf.Tensor(0.33880505, shape=(), dtype=float32)
loss: tf.Tensor(0.4513982, shape=(), dtype=float32)
loss: tf.Tensor(0.48421234, shape=(), dtype=float32)
loss: tf.Tensor(0.4049316, shape=(), dtype=float32)
loss: tf.Tensor(0.3904363, shape=(), dtype=float32)
loss: tf.Tensor(0.41630286, shape=(), dtype=float32)
loss: tf.Tensor(0.28568912, shape=(), dtype=float32)
loss: tf.Tensor(0.344746, shape=(), dtype=float32)
loss: tf.Tensor(0.38001877, shape=(), dtype=float32)
loss: tf.Tensor(0.51222444, shape=(), dtype=float32)
loss: tf.Tensor(0.3649503, shape=(), dtype=float32)
loss: tf.Tensor(0.38364005, shape=(), dtype=float32)
loss: tf.Tensor(0.285347, shape=(), dtype=float32)
loss: tf.Tensor(0.37995067, shape=(), dtype=float32)
loss: tf.Tensor(0.44352654, shape=(), dtype=float32)
loss: tf.Tensor(0.28177056, shape=(), dtype=float32)
loss: tf.Tensor(0.4629084, shape=(), dtype=float32)
loss: tf.Tensor(0.47810647, shape=(), dtype=float32)
loss: tf.Tensor(0.45142457, shape=(), dtype=float32)
loss: tf.Tensor(0.5630851, shape=(), dtype=float32)
loss: tf.Tensor(0.35998553, shape=(), dtype=float32)
loss: tf.Tensor(0.42331055, shape=(), dtype=float32)
loss: tf.Tensor(0.36014643, shape=(), dtype=float32)
loss: tf.Tensor(0.48317078, shape=(), dtype=float32)
loss: tf.Tensor(0.5362953, shape=(), dtype=float32)
loss: tf.Tensor(0.52534133, shape=(), dtype=float32)
loss: tf.Tensor(0.3488658, shape=(), dtype=float32)
loss: tf.Tensor(0.5462221, shape=(), dtype=float32)
loss: tf.Tensor(0.3437574, shape=(), dtype=float32)
loss: tf.Tensor(0.38824296, shape=(), dtype=float32)
loss: tf.Tensor(0.41882038, shape=(), dtype=float32)
loss: tf.Tensor(0.4729813, shape=(), dtype=float32)
loss: tf.Tensor(0.39912602, shape=(), dtype=float32)
loss: tf.Tensor(0.33199254, shape=(), dtype=float32)
loss: tf.Tensor(0.35580394, shape=(), dtype=float32)
loss: tf.Tensor(0.27753848, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.72552747, shape=(), dtype=float32)
F1 SCORE:
0.82574624
EPOCH  4 #################################
loss: tf.Tensor(0.3514742, shape=(), dtype=float32)
loss: tf.Tensor(0.3486915, shape=(), dtype=float32)
loss: tf.Tensor(0.26408952, shape=(), dtype=float32)
loss: tf.Tensor(0.41191742, shape=(), dtype=float32)
loss: tf.Tensor(0.25408, shape=(), dtype=float32)
loss: tf.Tensor(0.363612, shape=(), dtype=float32)
loss: tf.Tensor(0.4662452, shape=(), dtype=float32)
loss: tf.Tensor(0.4186938, shape=(), dtype=float32)
loss: tf.Tensor(0.4537555, shape=(), dtype=float32)
loss: tf.Tensor(0.3616913, shape=(), dtype=float32)
loss: tf.Tensor(0.31690064, shape=(), dtype=float32)
loss: tf.Tensor(0.42355388, shape=(), dtype=float32)
loss: tf.Tensor(0.31652153, shape=(), dtype=float32)
loss: tf.Tensor(0.35130128, shape=(), dtype=float32)
loss: tf.Tensor(0.30272675, shape=(), dtype=float32)
loss: tf.Tensor(0.40703598, shape=(), dtype=float32)
loss: tf.Tensor(0.31631684, shape=(), dtype=float32)
loss: tf.Tensor(0.49929655, shape=(), dtype=float32)
loss: tf.Tensor(0.4889669, shape=(), dtype=float32)
loss: tf.Tensor(0.2957291, shape=(), dtype=float32)
loss: tf.Tensor(0.4287401, shape=(), dtype=float32)
loss: tf.Tensor(0.41729596, shape=(), dtype=float32)
loss: tf.Tensor(0.33693513, shape=(), dtype=float32)
loss: tf.Tensor(0.335548, shape=(), dtype=float32)
loss: tf.Tensor(0.44391954, shape=(), dtype=float32)
loss: tf.Tensor(0.27559802, shape=(), dtype=float32)
loss: tf.Tensor(0.34185126, shape=(), dtype=float32)
loss: tf.Tensor(0.39299923, shape=(), dtype=float32)
loss: tf.Tensor(0.3536178, shape=(), dtype=float32)
loss: tf.Tensor(0.3807192, shape=(), dtype=float32)
loss: tf.Tensor(0.26945868, shape=(), dtype=float32)
loss: tf.Tensor(0.28184897, shape=(), dtype=float32)
loss: tf.Tensor(0.34974805, shape=(), dtype=float32)
loss: tf.Tensor(0.26396987, shape=(), dtype=float32)
loss: tf.Tensor(0.56288725, shape=(), dtype=float32)
loss: tf.Tensor(0.28882086, shape=(), dtype=float32)
loss: tf.Tensor(0.36793107, shape=(), dtype=float32)
loss: tf.Tensor(0.37485132, shape=(), dtype=float32)
loss: tf.Tensor(0.3226715, shape=(), dtype=float32)
loss: tf.Tensor(0.29039156, shape=(), dtype=float32)
loss: tf.Tensor(0.5225464, shape=(), dtype=float32)
loss: tf.Tensor(0.31384057, shape=(), dtype=float32)
loss: tf.Tensor(0.39007965, shape=(), dtype=float32)
loss: tf.Tensor(0.28812015, shape=(), dtype=float32)
loss: tf.Tensor(0.26941335, shape=(), dtype=float32)
loss: tf.Tensor(0.3198336, shape=(), dtype=float32)
loss: tf.Tensor(0.34867314, shape=(), dtype=float32)
loss: tf.Tensor(0.461923, shape=(), dtype=float32)
loss: tf.Tensor(0.3936366, shape=(), dtype=float32)
loss: tf.Tensor(0.30047283, shape=(), dtype=float32)
loss: tf.Tensor(0.2590605, shape=(), dtype=float32)
loss: tf.Tensor(0.40231436, shape=(), dtype=float32)
loss: tf.Tensor(0.4106332, shape=(), dtype=float32)
loss: tf.Tensor(0.3295166, shape=(), dtype=float32)
loss: tf.Tensor(0.34085742, shape=(), dtype=float32)
loss: tf.Tensor(0.2479188, shape=(), dtype=float32)
loss: tf.Tensor(0.35952502, shape=(), dtype=float32)
loss: tf.Tensor(0.42203125, shape=(), dtype=float32)
loss: tf.Tensor(0.32046404, shape=(), dtype=float32)
loss: tf.Tensor(0.38518965, shape=(), dtype=float32)
loss: tf.Tensor(0.44958392, shape=(), dtype=float32)
loss: tf.Tensor(0.49057254, shape=(), dtype=float32)
loss: tf.Tensor(0.2223344, shape=(), dtype=float32)
loss: tf.Tensor(0.37144485, shape=(), dtype=float32)
loss: tf.Tensor(0.4528742, shape=(), dtype=float32)
loss: tf.Tensor(0.21834658, shape=(), dtype=float32)
loss: tf.Tensor(0.41425592, shape=(), dtype=float32)
loss: tf.Tensor(0.298733, shape=(), dtype=float32)
loss: tf.Tensor(0.5052657, shape=(), dtype=float32)
loss: tf.Tensor(0.4917946, shape=(), dtype=float32)
loss: tf.Tensor(0.33144504, shape=(), dtype=float32)
loss: tf.Tensor(0.32568404, shape=(), dtype=float32)
loss: tf.Tensor(0.38474342, shape=(), dtype=float32)
loss: tf.Tensor(0.30314398, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:5 out of the last 5 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7067871, shape=(), dtype=float32)
F1 SCORE:
0.8330014
EPOCH  5 #################################
loss: tf.Tensor(0.33128408, shape=(), dtype=float32)
loss: tf.Tensor(0.344645, shape=(), dtype=float32)
loss: tf.Tensor(0.29718623, shape=(), dtype=float32)
loss: tf.Tensor(0.4272126, shape=(), dtype=float32)
loss: tf.Tensor(0.30740502, shape=(), dtype=float32)
loss: tf.Tensor(0.35113725, shape=(), dtype=float32)
loss: tf.Tensor(0.37448886, shape=(), dtype=float32)
loss: tf.Tensor(0.41034713, shape=(), dtype=float32)
loss: tf.Tensor(0.5086906, shape=(), dtype=float32)
loss: tf.Tensor(0.4441038, shape=(), dtype=float32)
loss: tf.Tensor(0.4095049, shape=(), dtype=float32)
loss: tf.Tensor(0.38357925, shape=(), dtype=float32)
loss: tf.Tensor(0.28740072, shape=(), dtype=float32)
loss: tf.Tensor(0.2867398, shape=(), dtype=float32)
loss: tf.Tensor(0.23927125, shape=(), dtype=float32)
loss: tf.Tensor(0.23608656, shape=(), dtype=float32)
loss: tf.Tensor(0.37122726, shape=(), dtype=float32)
loss: tf.Tensor(0.3277489, shape=(), dtype=float32)
loss: tf.Tensor(0.24886249, shape=(), dtype=float32)
loss: tf.Tensor(0.3612517, shape=(), dtype=float32)
loss: tf.Tensor(0.3201605, shape=(), dtype=float32)
loss: tf.Tensor(0.51843536, shape=(), dtype=float32)
loss: tf.Tensor(0.3887035, shape=(), dtype=float32)
loss: tf.Tensor(0.3446083, shape=(), dtype=float32)
loss: tf.Tensor(0.3255727, shape=(), dtype=float32)
loss: tf.Tensor(0.33494803, shape=(), dtype=float32)
loss: tf.Tensor(0.40578598, shape=(), dtype=float32)
loss: tf.Tensor(0.35872006, shape=(), dtype=float32)
loss: tf.Tensor(0.5048074, shape=(), dtype=float32)
loss: tf.Tensor(0.37677175, shape=(), dtype=float32)
loss: tf.Tensor(0.2934961, shape=(), dtype=float32)
loss: tf.Tensor(0.34223348, shape=(), dtype=float32)
loss: tf.Tensor(0.2752096, shape=(), dtype=float32)
loss: tf.Tensor(0.3742958, shape=(), dtype=float32)
loss: tf.Tensor(0.40642074, shape=(), dtype=float32)
loss: tf.Tensor(0.2519209, shape=(), dtype=float32)
loss: tf.Tensor(0.3213193, shape=(), dtype=float32)
loss: tf.Tensor(0.27646527, shape=(), dtype=float32)
loss: tf.Tensor(0.38429052, shape=(), dtype=float32)
loss: tf.Tensor(0.32768968, shape=(), dtype=float32)
loss: tf.Tensor(0.47237137, shape=(), dtype=float32)
loss: tf.Tensor(0.36652434, shape=(), dtype=float32)
loss: tf.Tensor(0.34131157, shape=(), dtype=float32)
loss: tf.Tensor(0.30100015, shape=(), dtype=float32)
loss: tf.Tensor(0.42345962, shape=(), dtype=float32)
loss: tf.Tensor(0.21141568, shape=(), dtype=float32)
loss: tf.Tensor(0.38810432, shape=(), dtype=float32)
loss: tf.Tensor(0.40628538, shape=(), dtype=float32)
loss: tf.Tensor(0.40512794, shape=(), dtype=float32)
loss: tf.Tensor(0.3816753, shape=(), dtype=float32)
loss: tf.Tensor(0.25034276, shape=(), dtype=float32)
loss: tf.Tensor(0.4171991, shape=(), dtype=float32)
loss: tf.Tensor(0.2969288, shape=(), dtype=float32)
loss: tf.Tensor(0.40277785, shape=(), dtype=float32)
loss: tf.Tensor(0.35046846, shape=(), dtype=float32)
loss: tf.Tensor(0.36793053, shape=(), dtype=float32)
loss: tf.Tensor(0.31234494, shape=(), dtype=float32)
loss: tf.Tensor(0.31022468, shape=(), dtype=float32)
loss: tf.Tensor(0.24062356, shape=(), dtype=float32)
loss: tf.Tensor(0.28257236, shape=(), dtype=float32)
loss: tf.Tensor(0.32229272, shape=(), dtype=float32)
loss: tf.Tensor(0.24952513, shape=(), dtype=float32)
loss: tf.Tensor(0.31679016, shape=(), dtype=float32)
loss: tf.Tensor(0.20260915, shape=(), dtype=float32)
loss: tf.Tensor(0.33999267, shape=(), dtype=float32)
loss: tf.Tensor(0.47343487, shape=(), dtype=float32)
loss: tf.Tensor(0.3781429, shape=(), dtype=float32)
loss: tf.Tensor(0.37043262, shape=(), dtype=float32)
loss: tf.Tensor(0.35317066, shape=(), dtype=float32)
loss: tf.Tensor(0.4049887, shape=(), dtype=float32)
loss: tf.Tensor(0.32354897, shape=(), dtype=float32)
loss: tf.Tensor(0.1929142, shape=(), dtype=float32)
loss: tf.Tensor(0.24613354, shape=(), dtype=float32)
loss: tf.Tensor(0.011787407, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:6 out of the last 6 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7017449, shape=(), dtype=float32)
F1 SCORE:
0.8357477
EPOCH  6 #################################
loss: tf.Tensor(0.25906792, shape=(), dtype=float32)
loss: tf.Tensor(0.24717425, shape=(), dtype=float32)
loss: tf.Tensor(0.37772366, shape=(), dtype=float32)
loss: tf.Tensor(0.28784427, shape=(), dtype=float32)
loss: tf.Tensor(0.28192782, shape=(), dtype=float32)
loss: tf.Tensor(0.22935672, shape=(), dtype=float32)
loss: tf.Tensor(0.4345999, shape=(), dtype=float32)
loss: tf.Tensor(0.28098488, shape=(), dtype=float32)
loss: tf.Tensor(0.23183863, shape=(), dtype=float32)
loss: tf.Tensor(0.2724634, shape=(), dtype=float32)
loss: tf.Tensor(0.30414325, shape=(), dtype=float32)
loss: tf.Tensor(0.20660762, shape=(), dtype=float32)
loss: tf.Tensor(0.30583394, shape=(), dtype=float32)
loss: tf.Tensor(0.44632694, shape=(), dtype=float32)
loss: tf.Tensor(0.36130705, shape=(), dtype=float32)
loss: tf.Tensor(0.20762567, shape=(), dtype=float32)
loss: tf.Tensor(0.34562957, shape=(), dtype=float32)
loss: tf.Tensor(0.26350993, shape=(), dtype=float32)
loss: tf.Tensor(0.43163368, shape=(), dtype=float32)
loss: tf.Tensor(0.24305911, shape=(), dtype=float32)
loss: tf.Tensor(0.26453573, shape=(), dtype=float32)
loss: tf.Tensor(0.25536358, shape=(), dtype=float32)
loss: tf.Tensor(0.33325204, shape=(), dtype=float32)
loss: tf.Tensor(0.21618974, shape=(), dtype=float32)
loss: tf.Tensor(0.17015469, shape=(), dtype=float32)
loss: tf.Tensor(0.2727203, shape=(), dtype=float32)
loss: tf.Tensor(0.31110325, shape=(), dtype=float32)
loss: tf.Tensor(0.34692368, shape=(), dtype=float32)
loss: tf.Tensor(0.37911472, shape=(), dtype=float32)
loss: tf.Tensor(0.37432536, shape=(), dtype=float32)
loss: tf.Tensor(0.29690263, shape=(), dtype=float32)
loss: tf.Tensor(0.24039882, shape=(), dtype=float32)
loss: tf.Tensor(0.28552747, shape=(), dtype=float32)
loss: tf.Tensor(0.39145908, shape=(), dtype=float32)
loss: tf.Tensor(0.39336175, shape=(), dtype=float32)
loss: tf.Tensor(0.4692766, shape=(), dtype=float32)
loss: tf.Tensor(0.25099772, shape=(), dtype=float32)
loss: tf.Tensor(0.21784516, shape=(), dtype=float32)
loss: tf.Tensor(0.2112166, shape=(), dtype=float32)
loss: tf.Tensor(0.35441098, shape=(), dtype=float32)
loss: tf.Tensor(0.2786557, shape=(), dtype=float32)
loss: tf.Tensor(0.34921238, shape=(), dtype=float32)
loss: tf.Tensor(0.40769982, shape=(), dtype=float32)
loss: tf.Tensor(0.26346305, shape=(), dtype=float32)
loss: tf.Tensor(0.29684237, shape=(), dtype=float32)
loss: tf.Tensor(0.3830771, shape=(), dtype=float32)
loss: tf.Tensor(0.38378036, shape=(), dtype=float32)
loss: tf.Tensor(0.25836852, shape=(), dtype=float32)
loss: tf.Tensor(0.30422336, shape=(), dtype=float32)
loss: tf.Tensor(0.4229543, shape=(), dtype=float32)
loss: tf.Tensor(0.3308318, shape=(), dtype=float32)
loss: tf.Tensor(0.37067538, shape=(), dtype=float32)
loss: tf.Tensor(0.2795635, shape=(), dtype=float32)
loss: tf.Tensor(0.22517721, shape=(), dtype=float32)
loss: tf.Tensor(0.30165195, shape=(), dtype=float32)
loss: tf.Tensor(0.27392548, shape=(), dtype=float32)
loss: tf.Tensor(0.32420754, shape=(), dtype=float32)
loss: tf.Tensor(0.2703562, shape=(), dtype=float32)
loss: tf.Tensor(0.28169078, shape=(), dtype=float32)
loss: tf.Tensor(0.299683, shape=(), dtype=float32)
loss: tf.Tensor(0.2851966, shape=(), dtype=float32)
loss: tf.Tensor(0.3074588, shape=(), dtype=float32)
loss: tf.Tensor(0.3178904, shape=(), dtype=float32)
loss: tf.Tensor(0.32628113, shape=(), dtype=float32)
loss: tf.Tensor(0.34399894, shape=(), dtype=float32)
loss: tf.Tensor(0.25355253, shape=(), dtype=float32)
loss: tf.Tensor(0.3106864, shape=(), dtype=float32)
loss: tf.Tensor(0.50004363, shape=(), dtype=float32)
loss: tf.Tensor(0.26972732, shape=(), dtype=float32)
loss: tf.Tensor(0.2823857, shape=(), dtype=float32)
loss: tf.Tensor(0.32573396, shape=(), dtype=float32)
loss: tf.Tensor(0.23605905, shape=(), dtype=float32)
loss: tf.Tensor(0.38301057, shape=(), dtype=float32)
loss: tf.Tensor(0.022432737, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:7 out of the last 7 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70344067, shape=(), dtype=float32)
F1 SCORE:
0.8353974
EPOCH  7 #################################
loss: tf.Tensor(0.26602298, shape=(), dtype=float32)
loss: tf.Tensor(0.32492062, shape=(), dtype=float32)
loss: tf.Tensor(0.40199202, shape=(), dtype=float32)
loss: tf.Tensor(0.31918216, shape=(), dtype=float32)
loss: tf.Tensor(0.32789856, shape=(), dtype=float32)
loss: tf.Tensor(0.28897727, shape=(), dtype=float32)
loss: tf.Tensor(0.35911652, shape=(), dtype=float32)
loss: tf.Tensor(0.31327292, shape=(), dtype=float32)
loss: tf.Tensor(0.319972, shape=(), dtype=float32)
loss: tf.Tensor(0.23085737, shape=(), dtype=float32)
loss: tf.Tensor(0.3334887, shape=(), dtype=float32)
loss: tf.Tensor(0.25358284, shape=(), dtype=float32)
loss: tf.Tensor(0.30758473, shape=(), dtype=float32)
loss: tf.Tensor(0.40386018, shape=(), dtype=float32)
loss: tf.Tensor(0.3600298, shape=(), dtype=float32)
loss: tf.Tensor(0.2917317, shape=(), dtype=float32)
loss: tf.Tensor(0.30676332, shape=(), dtype=float32)
loss: tf.Tensor(0.2376281, shape=(), dtype=float32)
loss: tf.Tensor(0.29517967, shape=(), dtype=float32)
loss: tf.Tensor(0.34723458, shape=(), dtype=float32)
loss: tf.Tensor(0.19996364, shape=(), dtype=float32)
loss: tf.Tensor(0.35911614, shape=(), dtype=float32)
loss: tf.Tensor(0.3985305, shape=(), dtype=float32)
loss: tf.Tensor(0.27384123, shape=(), dtype=float32)
loss: tf.Tensor(0.31556728, shape=(), dtype=float32)
loss: tf.Tensor(0.21807636, shape=(), dtype=float32)
loss: tf.Tensor(0.2301139, shape=(), dtype=float32)
loss: tf.Tensor(0.3232798, shape=(), dtype=float32)
loss: tf.Tensor(0.32236138, shape=(), dtype=float32)
loss: tf.Tensor(0.21916932, shape=(), dtype=float32)
loss: tf.Tensor(0.20767088, shape=(), dtype=float32)
loss: tf.Tensor(0.404861, shape=(), dtype=float32)
loss: tf.Tensor(0.21419463, shape=(), dtype=float32)
loss: tf.Tensor(0.28982303, shape=(), dtype=float32)
loss: tf.Tensor(0.28493142, shape=(), dtype=float32)
loss: tf.Tensor(0.34540132, shape=(), dtype=float32)
loss: tf.Tensor(0.26007846, shape=(), dtype=float32)
loss: tf.Tensor(0.20933262, shape=(), dtype=float32)
loss: tf.Tensor(0.24279092, shape=(), dtype=float32)
loss: tf.Tensor(0.43750772, shape=(), dtype=float32)
loss: tf.Tensor(0.28592536, shape=(), dtype=float32)
loss: tf.Tensor(0.20600794, shape=(), dtype=float32)
loss: tf.Tensor(0.2602763, shape=(), dtype=float32)
loss: tf.Tensor(0.3288766, shape=(), dtype=float32)
loss: tf.Tensor(0.23707514, shape=(), dtype=float32)
loss: tf.Tensor(0.3366506, shape=(), dtype=float32)
loss: tf.Tensor(0.3492254, shape=(), dtype=float32)
loss: tf.Tensor(0.268279, shape=(), dtype=float32)
loss: tf.Tensor(0.26012558, shape=(), dtype=float32)
loss: tf.Tensor(0.3978841, shape=(), dtype=float32)
loss: tf.Tensor(0.261843, shape=(), dtype=float32)
loss: tf.Tensor(0.25148425, shape=(), dtype=float32)
loss: tf.Tensor(0.251452, shape=(), dtype=float32)
loss: tf.Tensor(0.3010517, shape=(), dtype=float32)
loss: tf.Tensor(0.2609707, shape=(), dtype=float32)
loss: tf.Tensor(0.28870776, shape=(), dtype=float32)
loss: tf.Tensor(0.22107582, shape=(), dtype=float32)
loss: tf.Tensor(0.20652394, shape=(), dtype=float32)
loss: tf.Tensor(0.20323628, shape=(), dtype=float32)
loss: tf.Tensor(0.3079902, shape=(), dtype=float32)
loss: tf.Tensor(0.17031187, shape=(), dtype=float32)
loss: tf.Tensor(0.24262242, shape=(), dtype=float32)
loss: tf.Tensor(0.26061675, shape=(), dtype=float32)
loss: tf.Tensor(0.32342124, shape=(), dtype=float32)
loss: tf.Tensor(0.38026392, shape=(), dtype=float32)
loss: tf.Tensor(0.26162198, shape=(), dtype=float32)
loss: tf.Tensor(0.34463775, shape=(), dtype=float32)
loss: tf.Tensor(0.32062703, shape=(), dtype=float32)
loss: tf.Tensor(0.33771074, shape=(), dtype=float32)
loss: tf.Tensor(0.33743152, shape=(), dtype=float32)
loss: tf.Tensor(0.34015468, shape=(), dtype=float32)
loss: tf.Tensor(0.27639312, shape=(), dtype=float32)
loss: tf.Tensor(0.3602994, shape=(), dtype=float32)
loss: tf.Tensor(0.0036207375, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:8 out of the last 8 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7136277, shape=(), dtype=float32)
F1 SCORE:
0.8328499
EPOCH  8 #################################
loss: tf.Tensor(0.26186973, shape=(), dtype=float32)
loss: tf.Tensor(0.22595058, shape=(), dtype=float32)
loss: tf.Tensor(0.23817691, shape=(), dtype=float32)
loss: tf.Tensor(0.19696261, shape=(), dtype=float32)
loss: tf.Tensor(0.3068923, shape=(), dtype=float32)
loss: tf.Tensor(0.16583022, shape=(), dtype=float32)
loss: tf.Tensor(0.28145936, shape=(), dtype=float32)
loss: tf.Tensor(0.30511916, shape=(), dtype=float32)
loss: tf.Tensor(0.19999301, shape=(), dtype=float32)
loss: tf.Tensor(0.24268122, shape=(), dtype=float32)
loss: tf.Tensor(0.18177702, shape=(), dtype=float32)
loss: tf.Tensor(0.2704407, shape=(), dtype=float32)
loss: tf.Tensor(0.2575828, shape=(), dtype=float32)
loss: tf.Tensor(0.29237863, shape=(), dtype=float32)
loss: tf.Tensor(0.27848682, shape=(), dtype=float32)
loss: tf.Tensor(0.2262393, shape=(), dtype=float32)
loss: tf.Tensor(0.18096575, shape=(), dtype=float32)
loss: tf.Tensor(0.32148457, shape=(), dtype=float32)
loss: tf.Tensor(0.32716256, shape=(), dtype=float32)
loss: tf.Tensor(0.329862, shape=(), dtype=float32)
loss: tf.Tensor(0.19800359, shape=(), dtype=float32)
loss: tf.Tensor(0.26648504, shape=(), dtype=float32)
loss: tf.Tensor(0.21778572, shape=(), dtype=float32)
loss: tf.Tensor(0.24738443, shape=(), dtype=float32)
loss: tf.Tensor(0.2607006, shape=(), dtype=float32)
loss: tf.Tensor(0.32095551, shape=(), dtype=float32)
loss: tf.Tensor(0.28045696, shape=(), dtype=float32)
loss: tf.Tensor(0.17659724, shape=(), dtype=float32)
loss: tf.Tensor(0.22761242, shape=(), dtype=float32)
loss: tf.Tensor(0.19242701, shape=(), dtype=float32)
loss: tf.Tensor(0.264158, shape=(), dtype=float32)
loss: tf.Tensor(0.21511494, shape=(), dtype=float32)
loss: tf.Tensor(0.13456476, shape=(), dtype=float32)
loss: tf.Tensor(0.26647946, shape=(), dtype=float32)
loss: tf.Tensor(0.25046366, shape=(), dtype=float32)
loss: tf.Tensor(0.40369347, shape=(), dtype=float32)
loss: tf.Tensor(0.20258316, shape=(), dtype=float32)
loss: tf.Tensor(0.2141629, shape=(), dtype=float32)
loss: tf.Tensor(0.25844285, shape=(), dtype=float32)
loss: tf.Tensor(0.29627427, shape=(), dtype=float32)
loss: tf.Tensor(0.29372284, shape=(), dtype=float32)
loss: tf.Tensor(0.22849704, shape=(), dtype=float32)
loss: tf.Tensor(0.16515344, shape=(), dtype=float32)
loss: tf.Tensor(0.2285654, shape=(), dtype=float32)
loss: tf.Tensor(0.23013891, shape=(), dtype=float32)
loss: tf.Tensor(0.23231146, shape=(), dtype=float32)
loss: tf.Tensor(0.1560667, shape=(), dtype=float32)
loss: tf.Tensor(0.16070797, shape=(), dtype=float32)
loss: tf.Tensor(0.25294667, shape=(), dtype=float32)
loss: tf.Tensor(0.21897362, shape=(), dtype=float32)
loss: tf.Tensor(0.30450827, shape=(), dtype=float32)
loss: tf.Tensor(0.22014701, shape=(), dtype=float32)
loss: tf.Tensor(0.36968383, shape=(), dtype=float32)
loss: tf.Tensor(0.25275657, shape=(), dtype=float32)
loss: tf.Tensor(0.35654572, shape=(), dtype=float32)
loss: tf.Tensor(0.22254881, shape=(), dtype=float32)
loss: tf.Tensor(0.25123987, shape=(), dtype=float32)
loss: tf.Tensor(0.20596935, shape=(), dtype=float32)
loss: tf.Tensor(0.24943785, shape=(), dtype=float32)
loss: tf.Tensor(0.28194687, shape=(), dtype=float32)
loss: tf.Tensor(0.24283455, shape=(), dtype=float32)
loss: tf.Tensor(0.3486858, shape=(), dtype=float32)
loss: tf.Tensor(0.24669595, shape=(), dtype=float32)
loss: tf.Tensor(0.2090415, shape=(), dtype=float32)
loss: tf.Tensor(0.38618234, shape=(), dtype=float32)
loss: tf.Tensor(0.2571324, shape=(), dtype=float32)
loss: tf.Tensor(0.42204884, shape=(), dtype=float32)
loss: tf.Tensor(0.34370804, shape=(), dtype=float32)
loss: tf.Tensor(0.20276147, shape=(), dtype=float32)
loss: tf.Tensor(0.30837646, shape=(), dtype=float32)
loss: tf.Tensor(0.20144199, shape=(), dtype=float32)
loss: tf.Tensor(0.29100403, shape=(), dtype=float32)
loss: tf.Tensor(0.24508008, shape=(), dtype=float32)
loss: tf.Tensor(0.36135983, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:9 out of the last 9 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7022899, shape=(), dtype=float32)
F1 SCORE:
0.83338565
EPOCH  9 #################################
loss: tf.Tensor(0.3313939, shape=(), dtype=float32)
loss: tf.Tensor(0.30124742, shape=(), dtype=float32)
loss: tf.Tensor(0.28344643, shape=(), dtype=float32)
loss: tf.Tensor(0.18685253, shape=(), dtype=float32)
loss: tf.Tensor(0.27913037, shape=(), dtype=float32)
loss: tf.Tensor(0.16230251, shape=(), dtype=float32)
loss: tf.Tensor(0.19076702, shape=(), dtype=float32)
loss: tf.Tensor(0.3191288, shape=(), dtype=float32)
loss: tf.Tensor(0.35708088, shape=(), dtype=float32)
loss: tf.Tensor(0.21234915, shape=(), dtype=float32)
loss: tf.Tensor(0.3442356, shape=(), dtype=float32)
loss: tf.Tensor(0.23937295, shape=(), dtype=float32)
loss: tf.Tensor(0.22836667, shape=(), dtype=float32)
loss: tf.Tensor(0.29933706, shape=(), dtype=float32)
loss: tf.Tensor(0.283077, shape=(), dtype=float32)
loss: tf.Tensor(0.23377526, shape=(), dtype=float32)
loss: tf.Tensor(0.25377095, shape=(), dtype=float32)
loss: tf.Tensor(0.26746592, shape=(), dtype=float32)
loss: tf.Tensor(0.2856695, shape=(), dtype=float32)
loss: tf.Tensor(0.28463334, shape=(), dtype=float32)
loss: tf.Tensor(0.32892764, shape=(), dtype=float32)
loss: tf.Tensor(0.23418179, shape=(), dtype=float32)
loss: tf.Tensor(0.36087325, shape=(), dtype=float32)
loss: tf.Tensor(0.20090126, shape=(), dtype=float32)
loss: tf.Tensor(0.27203187, shape=(), dtype=float32)
loss: tf.Tensor(0.2211351, shape=(), dtype=float32)
loss: tf.Tensor(0.2346445, shape=(), dtype=float32)
loss: tf.Tensor(0.23563725, shape=(), dtype=float32)
loss: tf.Tensor(0.26421174, shape=(), dtype=float32)
loss: tf.Tensor(0.30291334, shape=(), dtype=float32)
loss: tf.Tensor(0.30727023, shape=(), dtype=float32)
loss: tf.Tensor(0.2768131, shape=(), dtype=float32)
loss: tf.Tensor(0.2614077, shape=(), dtype=float32)
loss: tf.Tensor(0.28929093, shape=(), dtype=float32)
loss: tf.Tensor(0.24192987, shape=(), dtype=float32)
loss: tf.Tensor(0.23820455, shape=(), dtype=float32)
loss: tf.Tensor(0.45506454, shape=(), dtype=float32)
loss: tf.Tensor(0.3644569, shape=(), dtype=float32)
loss: tf.Tensor(0.33369157, shape=(), dtype=float32)
loss: tf.Tensor(0.27830613, shape=(), dtype=float32)
loss: tf.Tensor(0.23195109, shape=(), dtype=float32)
loss: tf.Tensor(0.40152144, shape=(), dtype=float32)
loss: tf.Tensor(0.2823442, shape=(), dtype=float32)
loss: tf.Tensor(0.28958514, shape=(), dtype=float32)
loss: tf.Tensor(0.28699428, shape=(), dtype=float32)
loss: tf.Tensor(0.22936003, shape=(), dtype=float32)
loss: tf.Tensor(0.22010013, shape=(), dtype=float32)
loss: tf.Tensor(0.22099862, shape=(), dtype=float32)
loss: tf.Tensor(0.28052464, shape=(), dtype=float32)
loss: tf.Tensor(0.20452543, shape=(), dtype=float32)
loss: tf.Tensor(0.19312386, shape=(), dtype=float32)
loss: tf.Tensor(0.21808317, shape=(), dtype=float32)
loss: tf.Tensor(0.23848991, shape=(), dtype=float32)
loss: tf.Tensor(0.15471256, shape=(), dtype=float32)
loss: tf.Tensor(0.1932581, shape=(), dtype=float32)
loss: tf.Tensor(0.14794326, shape=(), dtype=float32)
loss: tf.Tensor(0.15910818, shape=(), dtype=float32)
loss: tf.Tensor(0.15643279, shape=(), dtype=float32)
loss: tf.Tensor(0.2540124, shape=(), dtype=float32)
loss: tf.Tensor(0.29282096, shape=(), dtype=float32)
loss: tf.Tensor(0.3135969, shape=(), dtype=float32)
loss: tf.Tensor(0.26303893, shape=(), dtype=float32)
loss: tf.Tensor(0.173958, shape=(), dtype=float32)
loss: tf.Tensor(0.21512194, shape=(), dtype=float32)
loss: tf.Tensor(0.30582318, shape=(), dtype=float32)
loss: tf.Tensor(0.2876261, shape=(), dtype=float32)
loss: tf.Tensor(0.2947425, shape=(), dtype=float32)
loss: tf.Tensor(0.23849596, shape=(), dtype=float32)
loss: tf.Tensor(0.28339905, shape=(), dtype=float32)
loss: tf.Tensor(0.3521331, shape=(), dtype=float32)
loss: tf.Tensor(0.24851899, shape=(), dtype=float32)
loss: tf.Tensor(0.26319683, shape=(), dtype=float32)
loss: tf.Tensor(0.25748217, shape=(), dtype=float32)
loss: tf.Tensor(0.19490401, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:10 out of the last 10 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7175127, shape=(), dtype=float32)
F1 SCORE:
0.83105105
EPOCH  10 #################################
loss: tf.Tensor(0.23647174, shape=(), dtype=float32)
loss: tf.Tensor(0.27637962, shape=(), dtype=float32)
loss: tf.Tensor(0.31474698, shape=(), dtype=float32)
loss: tf.Tensor(0.27728924, shape=(), dtype=float32)
loss: tf.Tensor(0.22041252, shape=(), dtype=float32)
loss: tf.Tensor(0.12718904, shape=(), dtype=float32)
loss: tf.Tensor(0.18554264, shape=(), dtype=float32)
loss: tf.Tensor(0.23657267, shape=(), dtype=float32)
loss: tf.Tensor(0.1951715, shape=(), dtype=float32)
loss: tf.Tensor(0.2963869, shape=(), dtype=float32)
loss: tf.Tensor(0.21174093, shape=(), dtype=float32)
loss: tf.Tensor(0.14272541, shape=(), dtype=float32)
loss: tf.Tensor(0.24981825, shape=(), dtype=float32)
loss: tf.Tensor(0.38885254, shape=(), dtype=float32)
loss: tf.Tensor(0.27616563, shape=(), dtype=float32)
loss: tf.Tensor(0.23529053, shape=(), dtype=float32)
loss: tf.Tensor(0.17278802, shape=(), dtype=float32)
loss: tf.Tensor(0.27609947, shape=(), dtype=float32)
loss: tf.Tensor(0.22177757, shape=(), dtype=float32)
loss: tf.Tensor(0.16494302, shape=(), dtype=float32)
loss: tf.Tensor(0.20960023, shape=(), dtype=float32)
loss: tf.Tensor(0.21369019, shape=(), dtype=float32)
loss: tf.Tensor(0.21396561, shape=(), dtype=float32)
loss: tf.Tensor(0.24330765, shape=(), dtype=float32)
loss: tf.Tensor(0.16333306, shape=(), dtype=float32)
loss: tf.Tensor(0.296877, shape=(), dtype=float32)
loss: tf.Tensor(0.20325257, shape=(), dtype=float32)
loss: tf.Tensor(0.18595827, shape=(), dtype=float32)
loss: tf.Tensor(0.25518328, shape=(), dtype=float32)
loss: tf.Tensor(0.25610545, shape=(), dtype=float32)
loss: tf.Tensor(0.29411355, shape=(), dtype=float32)
loss: tf.Tensor(0.20281889, shape=(), dtype=float32)
loss: tf.Tensor(0.14927179, shape=(), dtype=float32)
loss: tf.Tensor(0.2019957, shape=(), dtype=float32)
loss: tf.Tensor(0.3580671, shape=(), dtype=float32)
loss: tf.Tensor(0.22146308, shape=(), dtype=float32)
loss: tf.Tensor(0.21954109, shape=(), dtype=float32)
loss: tf.Tensor(0.21000604, shape=(), dtype=float32)
loss: tf.Tensor(0.16500379, shape=(), dtype=float32)
loss: tf.Tensor(0.23021686, shape=(), dtype=float32)
loss: tf.Tensor(0.21805239, shape=(), dtype=float32)
loss: tf.Tensor(0.23062365, shape=(), dtype=float32)
loss: tf.Tensor(0.25350323, shape=(), dtype=float32)
loss: tf.Tensor(0.23338586, shape=(), dtype=float32)
loss: tf.Tensor(0.17251389, shape=(), dtype=float32)
loss: tf.Tensor(0.20531373, shape=(), dtype=float32)
loss: tf.Tensor(0.17543368, shape=(), dtype=float32)
loss: tf.Tensor(0.19125439, shape=(), dtype=float32)
loss: tf.Tensor(0.18552142, shape=(), dtype=float32)
loss: tf.Tensor(0.25113547, shape=(), dtype=float32)
loss: tf.Tensor(0.23588896, shape=(), dtype=float32)
loss: tf.Tensor(0.28596994, shape=(), dtype=float32)
loss: tf.Tensor(0.2342572, shape=(), dtype=float32)
loss: tf.Tensor(0.25733528, shape=(), dtype=float32)
loss: tf.Tensor(0.30306745, shape=(), dtype=float32)
loss: tf.Tensor(0.46357104, shape=(), dtype=float32)
loss: tf.Tensor(0.25791118, shape=(), dtype=float32)
loss: tf.Tensor(0.15790942, shape=(), dtype=float32)
loss: tf.Tensor(0.25479764, shape=(), dtype=float32)
loss: tf.Tensor(0.21383543, shape=(), dtype=float32)
loss: tf.Tensor(0.2756596, shape=(), dtype=float32)
loss: tf.Tensor(0.24793285, shape=(), dtype=float32)
loss: tf.Tensor(0.29892993, shape=(), dtype=float32)
loss: tf.Tensor(0.26804566, shape=(), dtype=float32)
loss: tf.Tensor(0.22428721, shape=(), dtype=float32)
loss: tf.Tensor(0.24446268, shape=(), dtype=float32)
loss: tf.Tensor(0.25906205, shape=(), dtype=float32)
loss: tf.Tensor(0.23298469, shape=(), dtype=float32)
loss: tf.Tensor(0.20780106, shape=(), dtype=float32)
loss: tf.Tensor(0.19848557, shape=(), dtype=float32)
loss: tf.Tensor(0.23491305, shape=(), dtype=float32)
loss: tf.Tensor(0.29330632, shape=(), dtype=float32)
loss: tf.Tensor(0.16169882, shape=(), dtype=float32)
loss: tf.Tensor(0.0010592095, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7040129, shape=(), dtype=float32)
F1 SCORE:
0.8309882
EPOCH  11 #################################
loss: tf.Tensor(0.19809368, shape=(), dtype=float32)
loss: tf.Tensor(0.12301158, shape=(), dtype=float32)
loss: tf.Tensor(0.16186571, shape=(), dtype=float32)
loss: tf.Tensor(0.13761654, shape=(), dtype=float32)
loss: tf.Tensor(0.13946855, shape=(), dtype=float32)
loss: tf.Tensor(0.12162675, shape=(), dtype=float32)
loss: tf.Tensor(0.2370391, shape=(), dtype=float32)
loss: tf.Tensor(0.20691925, shape=(), dtype=float32)
loss: tf.Tensor(0.14973482, shape=(), dtype=float32)
loss: tf.Tensor(0.23032828, shape=(), dtype=float32)
loss: tf.Tensor(0.19221453, shape=(), dtype=float32)
loss: tf.Tensor(0.16337281, shape=(), dtype=float32)
loss: tf.Tensor(0.2019585, shape=(), dtype=float32)
loss: tf.Tensor(0.16241716, shape=(), dtype=float32)
loss: tf.Tensor(0.14210266, shape=(), dtype=float32)
loss: tf.Tensor(0.22618777, shape=(), dtype=float32)
loss: tf.Tensor(0.12633505, shape=(), dtype=float32)
loss: tf.Tensor(0.26739365, shape=(), dtype=float32)
loss: tf.Tensor(0.19173603, shape=(), dtype=float32)
loss: tf.Tensor(0.2281241, shape=(), dtype=float32)
loss: tf.Tensor(0.25006953, shape=(), dtype=float32)
loss: tf.Tensor(0.22866793, shape=(), dtype=float32)
loss: tf.Tensor(0.18979909, shape=(), dtype=float32)
loss: tf.Tensor(0.25990054, shape=(), dtype=float32)
loss: tf.Tensor(0.27771747, shape=(), dtype=float32)
loss: tf.Tensor(0.37331912, shape=(), dtype=float32)
loss: tf.Tensor(0.17686339, shape=(), dtype=float32)
loss: tf.Tensor(0.18143213, shape=(), dtype=float32)
loss: tf.Tensor(0.23353693, shape=(), dtype=float32)
loss: tf.Tensor(0.25870755, shape=(), dtype=float32)
loss: tf.Tensor(0.2242831, shape=(), dtype=float32)
loss: tf.Tensor(0.21245293, shape=(), dtype=float32)
loss: tf.Tensor(0.1788021, shape=(), dtype=float32)
loss: tf.Tensor(0.24798436, shape=(), dtype=float32)
loss: tf.Tensor(0.2727376, shape=(), dtype=float32)
loss: tf.Tensor(0.18819715, shape=(), dtype=float32)
loss: tf.Tensor(0.32187694, shape=(), dtype=float32)
loss: tf.Tensor(0.1489346, shape=(), dtype=float32)
loss: tf.Tensor(0.12803604, shape=(), dtype=float32)
loss: tf.Tensor(0.20759216, shape=(), dtype=float32)
loss: tf.Tensor(0.16513707, shape=(), dtype=float32)
loss: tf.Tensor(0.1370731, shape=(), dtype=float32)
loss: tf.Tensor(0.15770258, shape=(), dtype=float32)
loss: tf.Tensor(0.102563925, shape=(), dtype=float32)
loss: tf.Tensor(0.15270239, shape=(), dtype=float32)
loss: tf.Tensor(0.122986354, shape=(), dtype=float32)
loss: tf.Tensor(0.2413719, shape=(), dtype=float32)
loss: tf.Tensor(0.18374135, shape=(), dtype=float32)
loss: tf.Tensor(0.27863058, shape=(), dtype=float32)
loss: tf.Tensor(0.12578294, shape=(), dtype=float32)
loss: tf.Tensor(0.27631778, shape=(), dtype=float32)
loss: tf.Tensor(0.17819896, shape=(), dtype=float32)
loss: tf.Tensor(0.24233599, shape=(), dtype=float32)
loss: tf.Tensor(0.19241472, shape=(), dtype=float32)
loss: tf.Tensor(0.15173851, shape=(), dtype=float32)
loss: tf.Tensor(0.24402429, shape=(), dtype=float32)
loss: tf.Tensor(0.15395544, shape=(), dtype=float32)
loss: tf.Tensor(0.17147772, shape=(), dtype=float32)
loss: tf.Tensor(0.11590549, shape=(), dtype=float32)
loss: tf.Tensor(0.19688672, shape=(), dtype=float32)
loss: tf.Tensor(0.23972026, shape=(), dtype=float32)
loss: tf.Tensor(0.15089738, shape=(), dtype=float32)
loss: tf.Tensor(0.3282371, shape=(), dtype=float32)
loss: tf.Tensor(0.16506405, shape=(), dtype=float32)
loss: tf.Tensor(0.42830014, shape=(), dtype=float32)
loss: tf.Tensor(0.1807486, shape=(), dtype=float32)
loss: tf.Tensor(0.2779271, shape=(), dtype=float32)
loss: tf.Tensor(0.1172429, shape=(), dtype=float32)
loss: tf.Tensor(0.29667276, shape=(), dtype=float32)
loss: tf.Tensor(0.16519624, shape=(), dtype=float32)
loss: tf.Tensor(0.15019281, shape=(), dtype=float32)
loss: tf.Tensor(0.24143429, shape=(), dtype=float32)
loss: tf.Tensor(0.12955996, shape=(), dtype=float32)
loss: tf.Tensor(0.028308148, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70312804, shape=(), dtype=float32)
F1 SCORE:
0.83132535
EPOCH  12 #################################
loss: tf.Tensor(0.09744032, shape=(), dtype=float32)
loss: tf.Tensor(0.15240484, shape=(), dtype=float32)
loss: tf.Tensor(0.18438965, shape=(), dtype=float32)
loss: tf.Tensor(0.2632641, shape=(), dtype=float32)
loss: tf.Tensor(0.14956617, shape=(), dtype=float32)
loss: tf.Tensor(0.14513944, shape=(), dtype=float32)
loss: tf.Tensor(0.25207576, shape=(), dtype=float32)
loss: tf.Tensor(0.33137855, shape=(), dtype=float32)
loss: tf.Tensor(0.21455173, shape=(), dtype=float32)
loss: tf.Tensor(0.2511483, shape=(), dtype=float32)
loss: tf.Tensor(0.12142356, shape=(), dtype=float32)
loss: tf.Tensor(0.23658642, shape=(), dtype=float32)
loss: tf.Tensor(0.22303201, shape=(), dtype=float32)
loss: tf.Tensor(0.11916924, shape=(), dtype=float32)
loss: tf.Tensor(0.16661093, shape=(), dtype=float32)
loss: tf.Tensor(0.18986891, shape=(), dtype=float32)
loss: tf.Tensor(0.19392651, shape=(), dtype=float32)
loss: tf.Tensor(0.20024376, shape=(), dtype=float32)
loss: tf.Tensor(0.14656849, shape=(), dtype=float32)
loss: tf.Tensor(0.2541002, shape=(), dtype=float32)
loss: tf.Tensor(0.19702518, shape=(), dtype=float32)
loss: tf.Tensor(0.1191759, shape=(), dtype=float32)
loss: tf.Tensor(0.22147445, shape=(), dtype=float32)
loss: tf.Tensor(0.19181806, shape=(), dtype=float32)
loss: tf.Tensor(0.09002164, shape=(), dtype=float32)
loss: tf.Tensor(0.13305846, shape=(), dtype=float32)
loss: tf.Tensor(0.16450548, shape=(), dtype=float32)
loss: tf.Tensor(0.15655166, shape=(), dtype=float32)
loss: tf.Tensor(0.17916624, shape=(), dtype=float32)
loss: tf.Tensor(0.21841766, shape=(), dtype=float32)
loss: tf.Tensor(0.17184688, shape=(), dtype=float32)
loss: tf.Tensor(0.24495351, shape=(), dtype=float32)
loss: tf.Tensor(0.16685663, shape=(), dtype=float32)
loss: tf.Tensor(0.21249098, shape=(), dtype=float32)
loss: tf.Tensor(0.14581038, shape=(), dtype=float32)
loss: tf.Tensor(0.21351796, shape=(), dtype=float32)
loss: tf.Tensor(0.16754462, shape=(), dtype=float32)
loss: tf.Tensor(0.1083179, shape=(), dtype=float32)
loss: tf.Tensor(0.12906039, shape=(), dtype=float32)
loss: tf.Tensor(0.15437117, shape=(), dtype=float32)
loss: tf.Tensor(0.1423958, shape=(), dtype=float32)
loss: tf.Tensor(0.17581894, shape=(), dtype=float32)
loss: tf.Tensor(0.26614493, shape=(), dtype=float32)
loss: tf.Tensor(0.18431507, shape=(), dtype=float32)
loss: tf.Tensor(0.2350577, shape=(), dtype=float32)
loss: tf.Tensor(0.16037013, shape=(), dtype=float32)
loss: tf.Tensor(0.16804151, shape=(), dtype=float32)
loss: tf.Tensor(0.18964705, shape=(), dtype=float32)
loss: tf.Tensor(0.20047647, shape=(), dtype=float32)
loss: tf.Tensor(0.14732602, shape=(), dtype=float32)
loss: tf.Tensor(0.28227672, shape=(), dtype=float32)
loss: tf.Tensor(0.17690346, shape=(), dtype=float32)
loss: tf.Tensor(0.18780357, shape=(), dtype=float32)
loss: tf.Tensor(0.15799169, shape=(), dtype=float32)
loss: tf.Tensor(0.13120864, shape=(), dtype=float32)
loss: tf.Tensor(0.43230188, shape=(), dtype=float32)
loss: tf.Tensor(0.19768073, shape=(), dtype=float32)
loss: tf.Tensor(0.20829304, shape=(), dtype=float32)
loss: tf.Tensor(0.25353613, shape=(), dtype=float32)
loss: tf.Tensor(0.14578323, shape=(), dtype=float32)
loss: tf.Tensor(0.24283203, shape=(), dtype=float32)
loss: tf.Tensor(0.16540931, shape=(), dtype=float32)
loss: tf.Tensor(0.18715224, shape=(), dtype=float32)
loss: tf.Tensor(0.1521194, shape=(), dtype=float32)
loss: tf.Tensor(0.2777874, shape=(), dtype=float32)
loss: tf.Tensor(0.30168605, shape=(), dtype=float32)
loss: tf.Tensor(0.16444656, shape=(), dtype=float32)
loss: tf.Tensor(0.124668196, shape=(), dtype=float32)
loss: tf.Tensor(0.1564511, shape=(), dtype=float32)
loss: tf.Tensor(0.13934952, shape=(), dtype=float32)
loss: tf.Tensor(0.21331125, shape=(), dtype=float32)
loss: tf.Tensor(0.18791915, shape=(), dtype=float32)
loss: tf.Tensor(0.19721366, shape=(), dtype=float32)
loss: tf.Tensor(0.0021439441, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70452857, shape=(), dtype=float32)
F1 SCORE:
0.83110857
EPOCH  13 #################################
loss: tf.Tensor(0.1451013, shape=(), dtype=float32)
loss: tf.Tensor(0.12657002, shape=(), dtype=float32)
loss: tf.Tensor(0.13605061, shape=(), dtype=float32)
loss: tf.Tensor(0.17897572, shape=(), dtype=float32)
loss: tf.Tensor(0.20132285, shape=(), dtype=float32)
loss: tf.Tensor(0.07647898, shape=(), dtype=float32)
loss: tf.Tensor(0.42560044, shape=(), dtype=float32)
loss: tf.Tensor(0.15429167, shape=(), dtype=float32)
loss: tf.Tensor(0.093400985, shape=(), dtype=float32)
loss: tf.Tensor(0.16380903, shape=(), dtype=float32)
loss: tf.Tensor(0.15186863, shape=(), dtype=float32)
loss: tf.Tensor(0.1699276, shape=(), dtype=float32)
loss: tf.Tensor(0.20514993, shape=(), dtype=float32)
loss: tf.Tensor(0.15005878, shape=(), dtype=float32)
loss: tf.Tensor(0.1156492, shape=(), dtype=float32)
loss: tf.Tensor(0.121145524, shape=(), dtype=float32)
loss: tf.Tensor(0.1592961, shape=(), dtype=float32)
loss: tf.Tensor(0.13735873, shape=(), dtype=float32)
loss: tf.Tensor(0.13756207, shape=(), dtype=float32)
loss: tf.Tensor(0.11745637, shape=(), dtype=float32)
loss: tf.Tensor(0.25086406, shape=(), dtype=float32)
loss: tf.Tensor(0.11848413, shape=(), dtype=float32)
loss: tf.Tensor(0.1689484, shape=(), dtype=float32)
loss: tf.Tensor(0.19095416, shape=(), dtype=float32)
loss: tf.Tensor(0.17069945, shape=(), dtype=float32)
loss: tf.Tensor(0.099793, shape=(), dtype=float32)
loss: tf.Tensor(0.18072286, shape=(), dtype=float32)
loss: tf.Tensor(0.17585577, shape=(), dtype=float32)
loss: tf.Tensor(0.1056248, shape=(), dtype=float32)
loss: tf.Tensor(0.16307165, shape=(), dtype=float32)
loss: tf.Tensor(0.10920453, shape=(), dtype=float32)
loss: tf.Tensor(0.16438887, shape=(), dtype=float32)
loss: tf.Tensor(0.06243745, shape=(), dtype=float32)
loss: tf.Tensor(0.09731592, shape=(), dtype=float32)
loss: tf.Tensor(0.13437933, shape=(), dtype=float32)
loss: tf.Tensor(0.15952684, shape=(), dtype=float32)
loss: tf.Tensor(0.098053955, shape=(), dtype=float32)
loss: tf.Tensor(0.19409765, shape=(), dtype=float32)
loss: tf.Tensor(0.16333696, shape=(), dtype=float32)
loss: tf.Tensor(0.14077899, shape=(), dtype=float32)
loss: tf.Tensor(0.17772561, shape=(), dtype=float32)
loss: tf.Tensor(0.110512674, shape=(), dtype=float32)
loss: tf.Tensor(0.25242808, shape=(), dtype=float32)
loss: tf.Tensor(0.08808848, shape=(), dtype=float32)
loss: tf.Tensor(0.15290177, shape=(), dtype=float32)
loss: tf.Tensor(0.22270475, shape=(), dtype=float32)
loss: tf.Tensor(0.23645209, shape=(), dtype=float32)
loss: tf.Tensor(0.14077576, shape=(), dtype=float32)
loss: tf.Tensor(0.19750124, shape=(), dtype=float32)
loss: tf.Tensor(0.20713916, shape=(), dtype=float32)
loss: tf.Tensor(0.18362884, shape=(), dtype=float32)
loss: tf.Tensor(0.2823166, shape=(), dtype=float32)
loss: tf.Tensor(0.20836641, shape=(), dtype=float32)
loss: tf.Tensor(0.06862131, shape=(), dtype=float32)
loss: tf.Tensor(0.08074674, shape=(), dtype=float32)
loss: tf.Tensor(0.12980245, shape=(), dtype=float32)
loss: tf.Tensor(0.20373346, shape=(), dtype=float32)
loss: tf.Tensor(0.22153322, shape=(), dtype=float32)
loss: tf.Tensor(0.09643606, shape=(), dtype=float32)
loss: tf.Tensor(0.118157834, shape=(), dtype=float32)
loss: tf.Tensor(0.20632194, shape=(), dtype=float32)
loss: tf.Tensor(0.17591862, shape=(), dtype=float32)
loss: tf.Tensor(0.19054155, shape=(), dtype=float32)
loss: tf.Tensor(0.15732041, shape=(), dtype=float32)
loss: tf.Tensor(0.12582958, shape=(), dtype=float32)
loss: tf.Tensor(0.20328946, shape=(), dtype=float32)
loss: tf.Tensor(0.110574305, shape=(), dtype=float32)
loss: tf.Tensor(0.12228597, shape=(), dtype=float32)
loss: tf.Tensor(0.2399365, shape=(), dtype=float32)
loss: tf.Tensor(0.062737204, shape=(), dtype=float32)
loss: tf.Tensor(0.18364811, shape=(), dtype=float32)
loss: tf.Tensor(0.09655429, shape=(), dtype=float32)
loss: tf.Tensor(0.18733408, shape=(), dtype=float32)
loss: tf.Tensor(0.00025293013, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.704468, shape=(), dtype=float32)
F1 SCORE:
0.8305607
EPOCH  14 #################################
loss: tf.Tensor(0.090225555, shape=(), dtype=float32)
loss: tf.Tensor(0.12154021, shape=(), dtype=float32)
loss: tf.Tensor(0.12361666, shape=(), dtype=float32)
loss: tf.Tensor(0.07521799, shape=(), dtype=float32)
loss: tf.Tensor(0.15192905, shape=(), dtype=float32)
loss: tf.Tensor(0.13484603, shape=(), dtype=float32)
loss: tf.Tensor(0.11291746, shape=(), dtype=float32)
loss: tf.Tensor(0.11490283, shape=(), dtype=float32)
loss: tf.Tensor(0.07417734, shape=(), dtype=float32)
loss: tf.Tensor(0.086391106, shape=(), dtype=float32)
loss: tf.Tensor(0.12326327, shape=(), dtype=float32)
loss: tf.Tensor(0.098210126, shape=(), dtype=float32)
loss: tf.Tensor(0.13951108, shape=(), dtype=float32)
loss: tf.Tensor(0.11124921, shape=(), dtype=float32)
loss: tf.Tensor(0.110108785, shape=(), dtype=float32)
loss: tf.Tensor(0.14807513, shape=(), dtype=float32)
loss: tf.Tensor(0.13241215, shape=(), dtype=float32)
loss: tf.Tensor(0.08896997, shape=(), dtype=float32)
loss: tf.Tensor(0.06610785, shape=(), dtype=float32)
loss: tf.Tensor(0.19575965, shape=(), dtype=float32)
loss: tf.Tensor(0.15785001, shape=(), dtype=float32)
loss: tf.Tensor(0.06788868, shape=(), dtype=float32)
loss: tf.Tensor(0.068612635, shape=(), dtype=float32)
loss: tf.Tensor(0.07209014, shape=(), dtype=float32)
loss: tf.Tensor(0.1836539, shape=(), dtype=float32)
loss: tf.Tensor(0.27738336, shape=(), dtype=float32)
loss: tf.Tensor(0.09790744, shape=(), dtype=float32)
loss: tf.Tensor(0.14658196, shape=(), dtype=float32)
loss: tf.Tensor(0.25121623, shape=(), dtype=float32)
loss: tf.Tensor(0.15918738, shape=(), dtype=float32)
loss: tf.Tensor(0.071342155, shape=(), dtype=float32)
loss: tf.Tensor(0.121995926, shape=(), dtype=float32)
loss: tf.Tensor(0.109531716, shape=(), dtype=float32)
loss: tf.Tensor(0.12593508, shape=(), dtype=float32)
loss: tf.Tensor(0.2071805, shape=(), dtype=float32)
loss: tf.Tensor(0.18586844, shape=(), dtype=float32)
loss: tf.Tensor(0.10910617, shape=(), dtype=float32)
loss: tf.Tensor(0.089806005, shape=(), dtype=float32)
loss: tf.Tensor(0.07949842, shape=(), dtype=float32)
loss: tf.Tensor(0.23785535, shape=(), dtype=float32)
loss: tf.Tensor(0.10802234, shape=(), dtype=float32)
loss: tf.Tensor(0.11789647, shape=(), dtype=float32)
loss: tf.Tensor(0.10955084, shape=(), dtype=float32)
loss: tf.Tensor(0.17334408, shape=(), dtype=float32)
loss: tf.Tensor(0.100924835, shape=(), dtype=float32)
loss: tf.Tensor(0.14646332, shape=(), dtype=float32)
loss: tf.Tensor(0.20503843, shape=(), dtype=float32)
loss: tf.Tensor(0.14398026, shape=(), dtype=float32)
loss: tf.Tensor(0.10769902, shape=(), dtype=float32)
loss: tf.Tensor(0.10828519, shape=(), dtype=float32)
loss: tf.Tensor(0.2435379, shape=(), dtype=float32)
loss: tf.Tensor(0.17501606, shape=(), dtype=float32)
loss: tf.Tensor(0.14336643, shape=(), dtype=float32)
loss: tf.Tensor(0.29127643, shape=(), dtype=float32)
loss: tf.Tensor(0.18726504, shape=(), dtype=float32)
loss: tf.Tensor(0.102837086, shape=(), dtype=float32)
loss: tf.Tensor(0.13185523, shape=(), dtype=float32)
loss: tf.Tensor(0.26794913, shape=(), dtype=float32)
loss: tf.Tensor(0.099842876, shape=(), dtype=float32)
loss: tf.Tensor(0.12843713, shape=(), dtype=float32)
loss: tf.Tensor(0.15313505, shape=(), dtype=float32)
loss: tf.Tensor(0.13956457, shape=(), dtype=float32)
loss: tf.Tensor(0.21286821, shape=(), dtype=float32)
loss: tf.Tensor(0.12107393, shape=(), dtype=float32)
loss: tf.Tensor(0.203134, shape=(), dtype=float32)
loss: tf.Tensor(0.10413148, shape=(), dtype=float32)
loss: tf.Tensor(0.22613326, shape=(), dtype=float32)
loss: tf.Tensor(0.075252764, shape=(), dtype=float32)
loss: tf.Tensor(0.11858661, shape=(), dtype=float32)
loss: tf.Tensor(0.12234852, shape=(), dtype=float32)
loss: tf.Tensor(0.10311124, shape=(), dtype=float32)
loss: tf.Tensor(0.100838244, shape=(), dtype=float32)
loss: tf.Tensor(0.09778092, shape=(), dtype=float32)
loss: tf.Tensor(0.07194393, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7068121, shape=(), dtype=float32)
F1 SCORE:
0.82966924
EPOCH  15 #################################
loss: tf.Tensor(0.13845031, shape=(), dtype=float32)
loss: tf.Tensor(0.15558405, shape=(), dtype=float32)
loss: tf.Tensor(0.10669801, shape=(), dtype=float32)
loss: tf.Tensor(0.11797742, shape=(), dtype=float32)
loss: tf.Tensor(0.13941056, shape=(), dtype=float32)
loss: tf.Tensor(0.28351617, shape=(), dtype=float32)
loss: tf.Tensor(0.1391622, shape=(), dtype=float32)
loss: tf.Tensor(0.11806789, shape=(), dtype=float32)
loss: tf.Tensor(0.24743372, shape=(), dtype=float32)
loss: tf.Tensor(0.18376714, shape=(), dtype=float32)
loss: tf.Tensor(0.104779184, shape=(), dtype=float32)
loss: tf.Tensor(0.18259199, shape=(), dtype=float32)
loss: tf.Tensor(0.14358577, shape=(), dtype=float32)
loss: tf.Tensor(0.079053864, shape=(), dtype=float32)
loss: tf.Tensor(0.19907087, shape=(), dtype=float32)
loss: tf.Tensor(0.14611883, shape=(), dtype=float32)
loss: tf.Tensor(0.16125004, shape=(), dtype=float32)
loss: tf.Tensor(0.16078873, shape=(), dtype=float32)
loss: tf.Tensor(0.14580357, shape=(), dtype=float32)
loss: tf.Tensor(0.11788705, shape=(), dtype=float32)
loss: tf.Tensor(0.20142351, shape=(), dtype=float32)
loss: tf.Tensor(0.21497974, shape=(), dtype=float32)
loss: tf.Tensor(0.13606033, shape=(), dtype=float32)
loss: tf.Tensor(0.12020203, shape=(), dtype=float32)
loss: tf.Tensor(0.08112257, shape=(), dtype=float32)
loss: tf.Tensor(0.20081328, shape=(), dtype=float32)
loss: tf.Tensor(0.11967009, shape=(), dtype=float32)
loss: tf.Tensor(0.23119615, shape=(), dtype=float32)
loss: tf.Tensor(0.16780663, shape=(), dtype=float32)
loss: tf.Tensor(0.12938392, shape=(), dtype=float32)
loss: tf.Tensor(0.09596733, shape=(), dtype=float32)
loss: tf.Tensor(0.22734553, shape=(), dtype=float32)
loss: tf.Tensor(0.14879268, shape=(), dtype=float32)
loss: tf.Tensor(0.1876561, shape=(), dtype=float32)
loss: tf.Tensor(0.1906651, shape=(), dtype=float32)
loss: tf.Tensor(0.13417646, shape=(), dtype=float32)
loss: tf.Tensor(0.12657233, shape=(), dtype=float32)
loss: tf.Tensor(0.17210674, shape=(), dtype=float32)
loss: tf.Tensor(0.10708574, shape=(), dtype=float32)
loss: tf.Tensor(0.106855914, shape=(), dtype=float32)
loss: tf.Tensor(0.08749678, shape=(), dtype=float32)
loss: tf.Tensor(0.13532364, shape=(), dtype=float32)
loss: tf.Tensor(0.12547365, shape=(), dtype=float32)
loss: tf.Tensor(0.15064535, shape=(), dtype=float32)
loss: tf.Tensor(0.07553713, shape=(), dtype=float32)
loss: tf.Tensor(0.09135702, shape=(), dtype=float32)
loss: tf.Tensor(0.12699579, shape=(), dtype=float32)
loss: tf.Tensor(0.13444108, shape=(), dtype=float32)
loss: tf.Tensor(0.12736574, shape=(), dtype=float32)
loss: tf.Tensor(0.14372586, shape=(), dtype=float32)
loss: tf.Tensor(0.113835156, shape=(), dtype=float32)
loss: tf.Tensor(0.107588194, shape=(), dtype=float32)
loss: tf.Tensor(0.14162089, shape=(), dtype=float32)
loss: tf.Tensor(0.12373957, shape=(), dtype=float32)
loss: tf.Tensor(0.20302683, shape=(), dtype=float32)
loss: tf.Tensor(0.079414874, shape=(), dtype=float32)
loss: tf.Tensor(0.113551274, shape=(), dtype=float32)
loss: tf.Tensor(0.20087278, shape=(), dtype=float32)
loss: tf.Tensor(0.08685731, shape=(), dtype=float32)
loss: tf.Tensor(0.06153654, shape=(), dtype=float32)
loss: tf.Tensor(0.12003232, shape=(), dtype=float32)
loss: tf.Tensor(0.21131864, shape=(), dtype=float32)
loss: tf.Tensor(0.120711744, shape=(), dtype=float32)
loss: tf.Tensor(0.15989795, shape=(), dtype=float32)
loss: tf.Tensor(0.09660877, shape=(), dtype=float32)
loss: tf.Tensor(0.17304197, shape=(), dtype=float32)
loss: tf.Tensor(0.16499454, shape=(), dtype=float32)
loss: tf.Tensor(0.061597977, shape=(), dtype=float32)
loss: tf.Tensor(0.20377514, shape=(), dtype=float32)
loss: tf.Tensor(0.08479509, shape=(), dtype=float32)
loss: tf.Tensor(0.082188755, shape=(), dtype=float32)
loss: tf.Tensor(0.073456556, shape=(), dtype=float32)
loss: tf.Tensor(0.13923039, shape=(), dtype=float32)
loss: tf.Tensor(0.013811612, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70340556, shape=(), dtype=float32)
F1 SCORE:
0.8295482
EPOCH  16 #################################
loss: tf.Tensor(0.16412558, shape=(), dtype=float32)
loss: tf.Tensor(0.08013188, shape=(), dtype=float32)
loss: tf.Tensor(0.060078584, shape=(), dtype=float32)
loss: tf.Tensor(0.1027461, shape=(), dtype=float32)
loss: tf.Tensor(0.075064704, shape=(), dtype=float32)
loss: tf.Tensor(0.05147747, shape=(), dtype=float32)
loss: tf.Tensor(0.052167162, shape=(), dtype=float32)
loss: tf.Tensor(0.16495782, shape=(), dtype=float32)
loss: tf.Tensor(0.27910882, shape=(), dtype=float32)
loss: tf.Tensor(0.10573376, shape=(), dtype=float32)
loss: tf.Tensor(0.042243518, shape=(), dtype=float32)
loss: tf.Tensor(0.09440671, shape=(), dtype=float32)
loss: tf.Tensor(0.10007386, shape=(), dtype=float32)
loss: tf.Tensor(0.10318116, shape=(), dtype=float32)
loss: tf.Tensor(0.08009053, shape=(), dtype=float32)
loss: tf.Tensor(0.10491984, shape=(), dtype=float32)
loss: tf.Tensor(0.106405474, shape=(), dtype=float32)
loss: tf.Tensor(0.07124277, shape=(), dtype=float32)
loss: tf.Tensor(0.12968113, shape=(), dtype=float32)
loss: tf.Tensor(0.15716715, shape=(), dtype=float32)
loss: tf.Tensor(0.14868936, shape=(), dtype=float32)
loss: tf.Tensor(0.10865918, shape=(), dtype=float32)
loss: tf.Tensor(0.15618531, shape=(), dtype=float32)
loss: tf.Tensor(0.12164419, shape=(), dtype=float32)
loss: tf.Tensor(0.1123883, shape=(), dtype=float32)
loss: tf.Tensor(0.094100535, shape=(), dtype=float32)
loss: tf.Tensor(0.10051197, shape=(), dtype=float32)
loss: tf.Tensor(0.10149163, shape=(), dtype=float32)
loss: tf.Tensor(0.08474214, shape=(), dtype=float32)
loss: tf.Tensor(0.12865728, shape=(), dtype=float32)
loss: tf.Tensor(0.04174508, shape=(), dtype=float32)
loss: tf.Tensor(0.10168222, shape=(), dtype=float32)
loss: tf.Tensor(0.13239999, shape=(), dtype=float32)
loss: tf.Tensor(0.15667519, shape=(), dtype=float32)
loss: tf.Tensor(0.06725523, shape=(), dtype=float32)
loss: tf.Tensor(0.14818738, shape=(), dtype=float32)
loss: tf.Tensor(0.12178238, shape=(), dtype=float32)
loss: tf.Tensor(0.08404953, shape=(), dtype=float32)
loss: tf.Tensor(0.11537003, shape=(), dtype=float32)
loss: tf.Tensor(0.1280235, shape=(), dtype=float32)
loss: tf.Tensor(0.16375406, shape=(), dtype=float32)
loss: tf.Tensor(0.11000785, shape=(), dtype=float32)
loss: tf.Tensor(0.1377511, shape=(), dtype=float32)
loss: tf.Tensor(0.10760119, shape=(), dtype=float32)
loss: tf.Tensor(0.14117207, shape=(), dtype=float32)
loss: tf.Tensor(0.13293417, shape=(), dtype=float32)
loss: tf.Tensor(0.15442508, shape=(), dtype=float32)
loss: tf.Tensor(0.07717239, shape=(), dtype=float32)
loss: tf.Tensor(0.0993367, shape=(), dtype=float32)
loss: tf.Tensor(0.044953942, shape=(), dtype=float32)
loss: tf.Tensor(0.062485814, shape=(), dtype=float32)
loss: tf.Tensor(0.12916535, shape=(), dtype=float32)
loss: tf.Tensor(0.077347815, shape=(), dtype=float32)
loss: tf.Tensor(0.08063129, shape=(), dtype=float32)
loss: tf.Tensor(0.15503629, shape=(), dtype=float32)
loss: tf.Tensor(0.09989706, shape=(), dtype=float32)
loss: tf.Tensor(0.070664, shape=(), dtype=float32)
loss: tf.Tensor(0.086375944, shape=(), dtype=float32)
loss: tf.Tensor(0.0493917, shape=(), dtype=float32)
loss: tf.Tensor(0.055341125, shape=(), dtype=float32)
loss: tf.Tensor(0.101298064, shape=(), dtype=float32)
loss: tf.Tensor(0.09309912, shape=(), dtype=float32)
loss: tf.Tensor(0.123318255, shape=(), dtype=float32)
loss: tf.Tensor(0.06642899, shape=(), dtype=float32)
loss: tf.Tensor(0.16255933, shape=(), dtype=float32)
loss: tf.Tensor(0.08478944, shape=(), dtype=float32)
loss: tf.Tensor(0.17534305, shape=(), dtype=float32)
loss: tf.Tensor(0.082609214, shape=(), dtype=float32)
loss: tf.Tensor(0.08136997, shape=(), dtype=float32)
loss: tf.Tensor(0.051322475, shape=(), dtype=float32)
loss: tf.Tensor(0.050648775, shape=(), dtype=float32)
loss: tf.Tensor(0.09637774, shape=(), dtype=float32)
loss: tf.Tensor(0.12578358, shape=(), dtype=float32)
loss: tf.Tensor(0.0015936305, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71090883, shape=(), dtype=float32)
F1 SCORE:
0.8287296
EPOCH  17 #################################
loss: tf.Tensor(0.0728431, shape=(), dtype=float32)
loss: tf.Tensor(0.0852977, shape=(), dtype=float32)
loss: tf.Tensor(0.12807612, shape=(), dtype=float32)
loss: tf.Tensor(0.11880721, shape=(), dtype=float32)
loss: tf.Tensor(0.015279655, shape=(), dtype=float32)
loss: tf.Tensor(0.03743382, shape=(), dtype=float32)
loss: tf.Tensor(0.08765589, shape=(), dtype=float32)
loss: tf.Tensor(0.10606088, shape=(), dtype=float32)
loss: tf.Tensor(0.084090635, shape=(), dtype=float32)
loss: tf.Tensor(0.16325168, shape=(), dtype=float32)
loss: tf.Tensor(0.123661965, shape=(), dtype=float32)
loss: tf.Tensor(0.1407398, shape=(), dtype=float32)
loss: tf.Tensor(0.109058335, shape=(), dtype=float32)
loss: tf.Tensor(0.07543938, shape=(), dtype=float32)
loss: tf.Tensor(0.1538655, shape=(), dtype=float32)
loss: tf.Tensor(0.14291719, shape=(), dtype=float32)
loss: tf.Tensor(0.04947741, shape=(), dtype=float32)
loss: tf.Tensor(0.11323395, shape=(), dtype=float32)
loss: tf.Tensor(0.17335957, shape=(), dtype=float32)
loss: tf.Tensor(0.20566647, shape=(), dtype=float32)
loss: tf.Tensor(0.035925128, shape=(), dtype=float32)
loss: tf.Tensor(0.12520808, shape=(), dtype=float32)
loss: tf.Tensor(0.07976513, shape=(), dtype=float32)
loss: tf.Tensor(0.12055791, shape=(), dtype=float32)
loss: tf.Tensor(0.09163635, shape=(), dtype=float32)
loss: tf.Tensor(0.118996985, shape=(), dtype=float32)
loss: tf.Tensor(0.09101381, shape=(), dtype=float32)
loss: tf.Tensor(0.049362116, shape=(), dtype=float32)
loss: tf.Tensor(0.06870728, shape=(), dtype=float32)
loss: tf.Tensor(0.1753647, shape=(), dtype=float32)
loss: tf.Tensor(0.036060132, shape=(), dtype=float32)
loss: tf.Tensor(0.14857465, shape=(), dtype=float32)
loss: tf.Tensor(0.046479415, shape=(), dtype=float32)
loss: tf.Tensor(0.06846545, shape=(), dtype=float32)
loss: tf.Tensor(0.092583805, shape=(), dtype=float32)
loss: tf.Tensor(0.08625689, shape=(), dtype=float32)
loss: tf.Tensor(0.044880085, shape=(), dtype=float32)
loss: tf.Tensor(0.111622915, shape=(), dtype=float32)
loss: tf.Tensor(0.069383994, shape=(), dtype=float32)
loss: tf.Tensor(0.07772281, shape=(), dtype=float32)
loss: tf.Tensor(0.16246597, shape=(), dtype=float32)
loss: tf.Tensor(0.05694086, shape=(), dtype=float32)
loss: tf.Tensor(0.070984334, shape=(), dtype=float32)
loss: tf.Tensor(0.1142998, shape=(), dtype=float32)
loss: tf.Tensor(0.14697346, shape=(), dtype=float32)
loss: tf.Tensor(0.07973332, shape=(), dtype=float32)
loss: tf.Tensor(0.07628415, shape=(), dtype=float32)
loss: tf.Tensor(0.114703216, shape=(), dtype=float32)
loss: tf.Tensor(0.11902187, shape=(), dtype=float32)
loss: tf.Tensor(0.08126875, shape=(), dtype=float32)
loss: tf.Tensor(0.037070524, shape=(), dtype=float32)
loss: tf.Tensor(0.05288127, shape=(), dtype=float32)
loss: tf.Tensor(0.120783865, shape=(), dtype=float32)
loss: tf.Tensor(0.23885614, shape=(), dtype=float32)
loss: tf.Tensor(0.13914566, shape=(), dtype=float32)
loss: tf.Tensor(0.15677568, shape=(), dtype=float32)
loss: tf.Tensor(0.10042024, shape=(), dtype=float32)
loss: tf.Tensor(0.08111879, shape=(), dtype=float32)
loss: tf.Tensor(0.12598057, shape=(), dtype=float32)
loss: tf.Tensor(0.0674452, shape=(), dtype=float32)
loss: tf.Tensor(0.14308839, shape=(), dtype=float32)
loss: tf.Tensor(0.096618034, shape=(), dtype=float32)
loss: tf.Tensor(0.12910706, shape=(), dtype=float32)
loss: tf.Tensor(0.14736792, shape=(), dtype=float32)
loss: tf.Tensor(0.08614189, shape=(), dtype=float32)
loss: tf.Tensor(0.12938835, shape=(), dtype=float32)
loss: tf.Tensor(0.072884366, shape=(), dtype=float32)
loss: tf.Tensor(0.1893335, shape=(), dtype=float32)
loss: tf.Tensor(0.09300006, shape=(), dtype=float32)
loss: tf.Tensor(0.10558982, shape=(), dtype=float32)
loss: tf.Tensor(0.10176806, shape=(), dtype=float32)
loss: tf.Tensor(0.07493235, shape=(), dtype=float32)
loss: tf.Tensor(0.12541232, shape=(), dtype=float32)
loss: tf.Tensor(0.037644036, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7174392, shape=(), dtype=float32)
F1 SCORE:
0.8278845
EPOCH  18 #################################
loss: tf.Tensor(0.08491769, shape=(), dtype=float32)
loss: tf.Tensor(0.08468194, shape=(), dtype=float32)
loss: tf.Tensor(0.13814801, shape=(), dtype=float32)
loss: tf.Tensor(0.077182345, shape=(), dtype=float32)
loss: tf.Tensor(0.08304337, shape=(), dtype=float32)
loss: tf.Tensor(0.12212506, shape=(), dtype=float32)
loss: tf.Tensor(0.13709384, shape=(), dtype=float32)
loss: tf.Tensor(0.082091436, shape=(), dtype=float32)
loss: tf.Tensor(0.077707894, shape=(), dtype=float32)
loss: tf.Tensor(0.043598328, shape=(), dtype=float32)
loss: tf.Tensor(0.11840106, shape=(), dtype=float32)
loss: tf.Tensor(0.040603302, shape=(), dtype=float32)
loss: tf.Tensor(0.111137316, shape=(), dtype=float32)
loss: tf.Tensor(0.08510932, shape=(), dtype=float32)
loss: tf.Tensor(0.09742513, shape=(), dtype=float32)
loss: tf.Tensor(0.09928047, shape=(), dtype=float32)
loss: tf.Tensor(0.09308315, shape=(), dtype=float32)
loss: tf.Tensor(0.19375557, shape=(), dtype=float32)
loss: tf.Tensor(0.071463235, shape=(), dtype=float32)
loss: tf.Tensor(0.07996585, shape=(), dtype=float32)
loss: tf.Tensor(0.08420685, shape=(), dtype=float32)
loss: tf.Tensor(0.05189978, shape=(), dtype=float32)
loss: tf.Tensor(0.040188197, shape=(), dtype=float32)
loss: tf.Tensor(0.08707162, shape=(), dtype=float32)
loss: tf.Tensor(0.071846, shape=(), dtype=float32)
loss: tf.Tensor(0.073934935, shape=(), dtype=float32)
loss: tf.Tensor(0.096384615, shape=(), dtype=float32)
loss: tf.Tensor(0.110983275, shape=(), dtype=float32)
loss: tf.Tensor(0.06744631, shape=(), dtype=float32)
loss: tf.Tensor(0.09634529, shape=(), dtype=float32)
loss: tf.Tensor(0.108940355, shape=(), dtype=float32)
loss: tf.Tensor(0.06428008, shape=(), dtype=float32)
loss: tf.Tensor(0.09803596, shape=(), dtype=float32)
loss: tf.Tensor(0.08379753, shape=(), dtype=float32)
loss: tf.Tensor(0.0829463, shape=(), dtype=float32)
loss: tf.Tensor(0.03583215, shape=(), dtype=float32)
loss: tf.Tensor(0.086689256, shape=(), dtype=float32)
loss: tf.Tensor(0.10584842, shape=(), dtype=float32)
loss: tf.Tensor(0.06430914, shape=(), dtype=float32)
loss: tf.Tensor(0.111079276, shape=(), dtype=float32)
loss: tf.Tensor(0.15066232, shape=(), dtype=float32)
loss: tf.Tensor(0.1292578, shape=(), dtype=float32)
loss: tf.Tensor(0.088953696, shape=(), dtype=float32)
loss: tf.Tensor(0.07425798, shape=(), dtype=float32)
loss: tf.Tensor(0.03674253, shape=(), dtype=float32)
loss: tf.Tensor(0.09548122, shape=(), dtype=float32)
loss: tf.Tensor(0.060273647, shape=(), dtype=float32)
loss: tf.Tensor(0.071258366, shape=(), dtype=float32)
loss: tf.Tensor(0.06812033, shape=(), dtype=float32)
loss: tf.Tensor(0.09427336, shape=(), dtype=float32)
loss: tf.Tensor(0.12082656, shape=(), dtype=float32)
loss: tf.Tensor(0.07758143, shape=(), dtype=float32)
loss: tf.Tensor(0.13906606, shape=(), dtype=float32)
loss: tf.Tensor(0.047175746, shape=(), dtype=float32)
loss: tf.Tensor(0.14145797, shape=(), dtype=float32)
loss: tf.Tensor(0.09988659, shape=(), dtype=float32)
loss: tf.Tensor(0.060183473, shape=(), dtype=float32)
loss: tf.Tensor(0.04540788, shape=(), dtype=float32)
loss: tf.Tensor(0.14476536, shape=(), dtype=float32)
loss: tf.Tensor(0.1287727, shape=(), dtype=float32)
loss: tf.Tensor(0.054401666, shape=(), dtype=float32)
loss: tf.Tensor(0.12126704, shape=(), dtype=float32)
loss: tf.Tensor(0.035184994, shape=(), dtype=float32)
loss: tf.Tensor(0.08604193, shape=(), dtype=float32)
loss: tf.Tensor(0.051101457, shape=(), dtype=float32)
loss: tf.Tensor(0.11693975, shape=(), dtype=float32)
loss: tf.Tensor(0.06983945, shape=(), dtype=float32)
loss: tf.Tensor(0.08767826, shape=(), dtype=float32)
loss: tf.Tensor(0.1110111, shape=(), dtype=float32)
loss: tf.Tensor(0.035054147, shape=(), dtype=float32)
loss: tf.Tensor(0.10206339, shape=(), dtype=float32)
loss: tf.Tensor(0.09933505, shape=(), dtype=float32)
loss: tf.Tensor(0.09635942, shape=(), dtype=float32)
loss: tf.Tensor(0.00373939, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7064259, shape=(), dtype=float32)
F1 SCORE:
0.8278201
EPOCH  19 #################################
loss: tf.Tensor(0.04848976, shape=(), dtype=float32)
loss: tf.Tensor(0.10053976, shape=(), dtype=float32)
loss: tf.Tensor(0.068818174, shape=(), dtype=float32)
loss: tf.Tensor(0.08502953, shape=(), dtype=float32)
loss: tf.Tensor(0.041625377, shape=(), dtype=float32)
loss: tf.Tensor(0.077055894, shape=(), dtype=float32)
loss: tf.Tensor(0.041010447, shape=(), dtype=float32)
loss: tf.Tensor(0.18641895, shape=(), dtype=float32)
loss: tf.Tensor(0.08871246, shape=(), dtype=float32)
loss: tf.Tensor(0.060506143, shape=(), dtype=float32)
loss: tf.Tensor(0.05407161, shape=(), dtype=float32)
loss: tf.Tensor(0.1016677, shape=(), dtype=float32)
loss: tf.Tensor(0.14651644, shape=(), dtype=float32)
loss: tf.Tensor(0.19719367, shape=(), dtype=float32)
loss: tf.Tensor(0.09832528, shape=(), dtype=float32)
loss: tf.Tensor(0.08010719, shape=(), dtype=float32)
loss: tf.Tensor(0.043035865, shape=(), dtype=float32)
loss: tf.Tensor(0.062057476, shape=(), dtype=float32)
loss: tf.Tensor(0.07931317, shape=(), dtype=float32)
loss: tf.Tensor(0.082804196, shape=(), dtype=float32)
loss: tf.Tensor(0.1677012, shape=(), dtype=float32)
loss: tf.Tensor(0.043812543, shape=(), dtype=float32)
loss: tf.Tensor(0.06982452, shape=(), dtype=float32)
loss: tf.Tensor(0.10613673, shape=(), dtype=float32)
loss: tf.Tensor(0.05410009, shape=(), dtype=float32)
loss: tf.Tensor(0.10286089, shape=(), dtype=float32)
loss: tf.Tensor(0.15414342, shape=(), dtype=float32)
loss: tf.Tensor(0.039237306, shape=(), dtype=float32)
loss: tf.Tensor(0.07899992, shape=(), dtype=float32)
loss: tf.Tensor(0.08899627, shape=(), dtype=float32)
loss: tf.Tensor(0.049870577, shape=(), dtype=float32)
loss: tf.Tensor(0.02282209, shape=(), dtype=float32)
loss: tf.Tensor(0.10421998, shape=(), dtype=float32)
loss: tf.Tensor(0.14208592, shape=(), dtype=float32)
loss: tf.Tensor(0.05059666, shape=(), dtype=float32)
loss: tf.Tensor(0.04408691, shape=(), dtype=float32)
loss: tf.Tensor(0.10458036, shape=(), dtype=float32)
loss: tf.Tensor(0.14505434, shape=(), dtype=float32)
loss: tf.Tensor(0.072122395, shape=(), dtype=float32)
loss: tf.Tensor(0.10606474, shape=(), dtype=float32)
loss: tf.Tensor(0.021609414, shape=(), dtype=float32)
loss: tf.Tensor(0.047943, shape=(), dtype=float32)
loss: tf.Tensor(0.06539392, shape=(), dtype=float32)
loss: tf.Tensor(0.11396266, shape=(), dtype=float32)
loss: tf.Tensor(0.022810971, shape=(), dtype=float32)
loss: tf.Tensor(0.09784755, shape=(), dtype=float32)
loss: tf.Tensor(0.06179898, shape=(), dtype=float32)
loss: tf.Tensor(0.12867568, shape=(), dtype=float32)
loss: tf.Tensor(0.110935815, shape=(), dtype=float32)
loss: tf.Tensor(0.026615852, shape=(), dtype=float32)
loss: tf.Tensor(0.093514845, shape=(), dtype=float32)
loss: tf.Tensor(0.0993946, shape=(), dtype=float32)
loss: tf.Tensor(0.26677668, shape=(), dtype=float32)
loss: tf.Tensor(0.03959361, shape=(), dtype=float32)
loss: tf.Tensor(0.038421977, shape=(), dtype=float32)
loss: tf.Tensor(0.1107927, shape=(), dtype=float32)
loss: tf.Tensor(0.07712624, shape=(), dtype=float32)
loss: tf.Tensor(0.067902625, shape=(), dtype=float32)
loss: tf.Tensor(0.10708222, shape=(), dtype=float32)
loss: tf.Tensor(0.100006744, shape=(), dtype=float32)
loss: tf.Tensor(0.030434147, shape=(), dtype=float32)
loss: tf.Tensor(0.12680498, shape=(), dtype=float32)
loss: tf.Tensor(0.026278164, shape=(), dtype=float32)
loss: tf.Tensor(0.019718023, shape=(), dtype=float32)
loss: tf.Tensor(0.19108586, shape=(), dtype=float32)
loss: tf.Tensor(0.062508434, shape=(), dtype=float32)
loss: tf.Tensor(0.07338185, shape=(), dtype=float32)
loss: tf.Tensor(0.11380929, shape=(), dtype=float32)
loss: tf.Tensor(0.17202416, shape=(), dtype=float32)
loss: tf.Tensor(0.0938608, shape=(), dtype=float32)
loss: tf.Tensor(0.0793442, shape=(), dtype=float32)
loss: tf.Tensor(0.08502462, shape=(), dtype=float32)
loss: tf.Tensor(0.13495767, shape=(), dtype=float32)
loss: tf.Tensor(1.1920922e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71099144, shape=(), dtype=float32)
F1 SCORE:
0.82717615
EPOCH  20 #################################
loss: tf.Tensor(0.07602315, shape=(), dtype=float32)
loss: tf.Tensor(0.08538499, shape=(), dtype=float32)
loss: tf.Tensor(0.048385363, shape=(), dtype=float32)
loss: tf.Tensor(0.1014891, shape=(), dtype=float32)
loss: tf.Tensor(0.043961197, shape=(), dtype=float32)
loss: tf.Tensor(0.07085884, shape=(), dtype=float32)
loss: tf.Tensor(0.15781789, shape=(), dtype=float32)
loss: tf.Tensor(0.08387819, shape=(), dtype=float32)
loss: tf.Tensor(0.045900345, shape=(), dtype=float32)
loss: tf.Tensor(0.049743228, shape=(), dtype=float32)
loss: tf.Tensor(0.06352008, shape=(), dtype=float32)
loss: tf.Tensor(0.118237875, shape=(), dtype=float32)
loss: tf.Tensor(0.051753234, shape=(), dtype=float32)
loss: tf.Tensor(0.054617222, shape=(), dtype=float32)
loss: tf.Tensor(0.08063978, shape=(), dtype=float32)
loss: tf.Tensor(0.03622062, shape=(), dtype=float32)
loss: tf.Tensor(0.052032676, shape=(), dtype=float32)
loss: tf.Tensor(0.16731897, shape=(), dtype=float32)
loss: tf.Tensor(0.033214748, shape=(), dtype=float32)
loss: tf.Tensor(0.13976753, shape=(), dtype=float32)
loss: tf.Tensor(0.105118684, shape=(), dtype=float32)
loss: tf.Tensor(0.04305066, shape=(), dtype=float32)
loss: tf.Tensor(0.1069587, shape=(), dtype=float32)
loss: tf.Tensor(0.038641937, shape=(), dtype=float32)
loss: tf.Tensor(0.047957886, shape=(), dtype=float32)
loss: tf.Tensor(0.07124352, shape=(), dtype=float32)
loss: tf.Tensor(0.030658057, shape=(), dtype=float32)
loss: tf.Tensor(0.08028491, shape=(), dtype=float32)
loss: tf.Tensor(0.065349035, shape=(), dtype=float32)
loss: tf.Tensor(0.03159298, shape=(), dtype=float32)
loss: tf.Tensor(0.044349093, shape=(), dtype=float32)
loss: tf.Tensor(0.057946086, shape=(), dtype=float32)
loss: tf.Tensor(0.16815166, shape=(), dtype=float32)
loss: tf.Tensor(0.045775823, shape=(), dtype=float32)
loss: tf.Tensor(0.06510478, shape=(), dtype=float32)
loss: tf.Tensor(0.0493843, shape=(), dtype=float32)
loss: tf.Tensor(0.030498592, shape=(), dtype=float32)
loss: tf.Tensor(0.02303968, shape=(), dtype=float32)
loss: tf.Tensor(0.17132963, shape=(), dtype=float32)
loss: tf.Tensor(0.06944661, shape=(), dtype=float32)
loss: tf.Tensor(0.1062893, shape=(), dtype=float32)
loss: tf.Tensor(0.073862135, shape=(), dtype=float32)
loss: tf.Tensor(0.025660815, shape=(), dtype=float32)
loss: tf.Tensor(0.059555348, shape=(), dtype=float32)
loss: tf.Tensor(0.05384951, shape=(), dtype=float32)
loss: tf.Tensor(0.061284598, shape=(), dtype=float32)
loss: tf.Tensor(0.03304336, shape=(), dtype=float32)
loss: tf.Tensor(0.0827136, shape=(), dtype=float32)
loss: tf.Tensor(0.11710847, shape=(), dtype=float32)
loss: tf.Tensor(0.08984996, shape=(), dtype=float32)
loss: tf.Tensor(0.056013867, shape=(), dtype=float32)
loss: tf.Tensor(0.09375617, shape=(), dtype=float32)
loss: tf.Tensor(0.030462824, shape=(), dtype=float32)
loss: tf.Tensor(0.03516495, shape=(), dtype=float32)
loss: tf.Tensor(0.11401625, shape=(), dtype=float32)
loss: tf.Tensor(0.05377701, shape=(), dtype=float32)
loss: tf.Tensor(0.08493523, shape=(), dtype=float32)
loss: tf.Tensor(0.06886975, shape=(), dtype=float32)
loss: tf.Tensor(0.028761886, shape=(), dtype=float32)
loss: tf.Tensor(0.07282582, shape=(), dtype=float32)
loss: tf.Tensor(0.04132206, shape=(), dtype=float32)
loss: tf.Tensor(0.07470803, shape=(), dtype=float32)
loss: tf.Tensor(0.10905561, shape=(), dtype=float32)
loss: tf.Tensor(0.09987085, shape=(), dtype=float32)
loss: tf.Tensor(0.024786549, shape=(), dtype=float32)
loss: tf.Tensor(0.04030817, shape=(), dtype=float32)
loss: tf.Tensor(0.086027324, shape=(), dtype=float32)
loss: tf.Tensor(0.03174126, shape=(), dtype=float32)
loss: tf.Tensor(0.036501244, shape=(), dtype=float32)
loss: tf.Tensor(0.07546327, shape=(), dtype=float32)
loss: tf.Tensor(0.047501836, shape=(), dtype=float32)
loss: tf.Tensor(0.011559161, shape=(), dtype=float32)
loss: tf.Tensor(0.018874738, shape=(), dtype=float32)
loss: tf.Tensor(2.3841855e-07, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70042336, shape=(), dtype=float32)
F1 SCORE:
0.82729405
EPOCH  21 #################################
loss: tf.Tensor(0.026713012, shape=(), dtype=float32)
loss: tf.Tensor(0.14974798, shape=(), dtype=float32)
loss: tf.Tensor(0.11452899, shape=(), dtype=float32)
loss: tf.Tensor(0.09035973, shape=(), dtype=float32)
loss: tf.Tensor(0.042715125, shape=(), dtype=float32)
loss: tf.Tensor(0.122907944, shape=(), dtype=float32)
loss: tf.Tensor(0.15135306, shape=(), dtype=float32)
loss: tf.Tensor(0.105680905, shape=(), dtype=float32)
loss: tf.Tensor(0.13452274, shape=(), dtype=float32)
loss: tf.Tensor(0.04887767, shape=(), dtype=float32)
loss: tf.Tensor(0.21031938, shape=(), dtype=float32)
loss: tf.Tensor(0.07466458, shape=(), dtype=float32)
loss: tf.Tensor(0.017995693, shape=(), dtype=float32)
loss: tf.Tensor(0.057449114, shape=(), dtype=float32)
loss: tf.Tensor(0.043866646, shape=(), dtype=float32)
loss: tf.Tensor(0.032166, shape=(), dtype=float32)
loss: tf.Tensor(0.12334259, shape=(), dtype=float32)
loss: tf.Tensor(0.058911648, shape=(), dtype=float32)
loss: tf.Tensor(0.09634079, shape=(), dtype=float32)
loss: tf.Tensor(0.039951205, shape=(), dtype=float32)
loss: tf.Tensor(0.047938105, shape=(), dtype=float32)
loss: tf.Tensor(0.041202568, shape=(), dtype=float32)
loss: tf.Tensor(0.05705234, shape=(), dtype=float32)
loss: tf.Tensor(0.08773839, shape=(), dtype=float32)
loss: tf.Tensor(0.0681321, shape=(), dtype=float32)
loss: tf.Tensor(0.041081928, shape=(), dtype=float32)
loss: tf.Tensor(0.13353069, shape=(), dtype=float32)
loss: tf.Tensor(0.09022683, shape=(), dtype=float32)
loss: tf.Tensor(0.046125922, shape=(), dtype=float32)
loss: tf.Tensor(0.038737208, shape=(), dtype=float32)
loss: tf.Tensor(0.069350034, shape=(), dtype=float32)
loss: tf.Tensor(0.10469244, shape=(), dtype=float32)
loss: tf.Tensor(0.059593864, shape=(), dtype=float32)
loss: tf.Tensor(0.12563263, shape=(), dtype=float32)
loss: tf.Tensor(0.042846326, shape=(), dtype=float32)
loss: tf.Tensor(0.04210695, shape=(), dtype=float32)
loss: tf.Tensor(0.04820467, shape=(), dtype=float32)
loss: tf.Tensor(0.10380033, shape=(), dtype=float32)
loss: tf.Tensor(0.0689665, shape=(), dtype=float32)
loss: tf.Tensor(0.05360134, shape=(), dtype=float32)
loss: tf.Tensor(0.043147966, shape=(), dtype=float32)
loss: tf.Tensor(0.08810297, shape=(), dtype=float32)
loss: tf.Tensor(0.050334774, shape=(), dtype=float32)
loss: tf.Tensor(0.0728105, shape=(), dtype=float32)
loss: tf.Tensor(0.16666251, shape=(), dtype=float32)
loss: tf.Tensor(0.014217416, shape=(), dtype=float32)
loss: tf.Tensor(0.045756463, shape=(), dtype=float32)
loss: tf.Tensor(0.05985452, shape=(), dtype=float32)
loss: tf.Tensor(0.1445639, shape=(), dtype=float32)
loss: tf.Tensor(0.10013833, shape=(), dtype=float32)
loss: tf.Tensor(0.08069846, shape=(), dtype=float32)
loss: tf.Tensor(0.040735368, shape=(), dtype=float32)
loss: tf.Tensor(0.069428355, shape=(), dtype=float32)
loss: tf.Tensor(0.104243726, shape=(), dtype=float32)
loss: tf.Tensor(0.021766337, shape=(), dtype=float32)
loss: tf.Tensor(0.064888075, shape=(), dtype=float32)
loss: tf.Tensor(0.056005158, shape=(), dtype=float32)
loss: tf.Tensor(0.025212817, shape=(), dtype=float32)
loss: tf.Tensor(0.043150745, shape=(), dtype=float32)
loss: tf.Tensor(0.038645234, shape=(), dtype=float32)
loss: tf.Tensor(0.09342174, shape=(), dtype=float32)
loss: tf.Tensor(0.033977296, shape=(), dtype=float32)
loss: tf.Tensor(0.0967665, shape=(), dtype=float32)
loss: tf.Tensor(0.07183533, shape=(), dtype=float32)
loss: tf.Tensor(0.11082686, shape=(), dtype=float32)
loss: tf.Tensor(0.095868215, shape=(), dtype=float32)
loss: tf.Tensor(0.10467902, shape=(), dtype=float32)
loss: tf.Tensor(0.06215598, shape=(), dtype=float32)
loss: tf.Tensor(0.06011437, shape=(), dtype=float32)
loss: tf.Tensor(0.1616796, shape=(), dtype=float32)
loss: tf.Tensor(0.06564736, shape=(), dtype=float32)
loss: tf.Tensor(0.019273415, shape=(), dtype=float32)
loss: tf.Tensor(0.08040797, shape=(), dtype=float32)
loss: tf.Tensor(2.622601e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7042294, shape=(), dtype=float32)
F1 SCORE:
0.826978
EPOCH  22 #################################
loss: tf.Tensor(0.056826234, shape=(), dtype=float32)
loss: tf.Tensor(0.06742479, shape=(), dtype=float32)
loss: tf.Tensor(0.06203443, shape=(), dtype=float32)
loss: tf.Tensor(0.009840417, shape=(), dtype=float32)
loss: tf.Tensor(0.021196442, shape=(), dtype=float32)
loss: tf.Tensor(0.07668607, shape=(), dtype=float32)
loss: tf.Tensor(0.026386846, shape=(), dtype=float32)
loss: tf.Tensor(0.09063018, shape=(), dtype=float32)
loss: tf.Tensor(0.12132914, shape=(), dtype=float32)
loss: tf.Tensor(0.053750917, shape=(), dtype=float32)
loss: tf.Tensor(0.120459296, shape=(), dtype=float32)
loss: tf.Tensor(0.0672938, shape=(), dtype=float32)
loss: tf.Tensor(0.030438012, shape=(), dtype=float32)
loss: tf.Tensor(0.028766269, shape=(), dtype=float32)
loss: tf.Tensor(0.04464175, shape=(), dtype=float32)
loss: tf.Tensor(0.05616982, shape=(), dtype=float32)
loss: tf.Tensor(0.03948421, shape=(), dtype=float32)
loss: tf.Tensor(0.068610445, shape=(), dtype=float32)
loss: tf.Tensor(0.030862136, shape=(), dtype=float32)
loss: tf.Tensor(0.0824934, shape=(), dtype=float32)
loss: tf.Tensor(0.027273916, shape=(), dtype=float32)
loss: tf.Tensor(0.017263569, shape=(), dtype=float32)
loss: tf.Tensor(0.055792823, shape=(), dtype=float32)
loss: tf.Tensor(0.03528353, shape=(), dtype=float32)
loss: tf.Tensor(0.012753867, shape=(), dtype=float32)
loss: tf.Tensor(0.02533637, shape=(), dtype=float32)
loss: tf.Tensor(0.026887527, shape=(), dtype=float32)
loss: tf.Tensor(0.055425152, shape=(), dtype=float32)
loss: tf.Tensor(0.10970772, shape=(), dtype=float32)
loss: tf.Tensor(0.05154324, shape=(), dtype=float32)
loss: tf.Tensor(0.04332364, shape=(), dtype=float32)
loss: tf.Tensor(0.024959736, shape=(), dtype=float32)
loss: tf.Tensor(0.083150655, shape=(), dtype=float32)
loss: tf.Tensor(0.08902045, shape=(), dtype=float32)
loss: tf.Tensor(0.09890181, shape=(), dtype=float32)
loss: tf.Tensor(0.07946681, shape=(), dtype=float32)
loss: tf.Tensor(0.089767955, shape=(), dtype=float32)
loss: tf.Tensor(0.04086257, shape=(), dtype=float32)
loss: tf.Tensor(0.08792667, shape=(), dtype=float32)
loss: tf.Tensor(0.027435394, shape=(), dtype=float32)
loss: tf.Tensor(0.012171525, shape=(), dtype=float32)
loss: tf.Tensor(0.070048414, shape=(), dtype=float32)
loss: tf.Tensor(0.08910112, shape=(), dtype=float32)
loss: tf.Tensor(0.04085067, shape=(), dtype=float32)
loss: tf.Tensor(0.06599936, shape=(), dtype=float32)
loss: tf.Tensor(0.033533793, shape=(), dtype=float32)
loss: tf.Tensor(0.056170102, shape=(), dtype=float32)
loss: tf.Tensor(0.08434861, shape=(), dtype=float32)
loss: tf.Tensor(0.043760385, shape=(), dtype=float32)
loss: tf.Tensor(0.09667813, shape=(), dtype=float32)
loss: tf.Tensor(0.11076705, shape=(), dtype=float32)
loss: tf.Tensor(0.06542357, shape=(), dtype=float32)
loss: tf.Tensor(0.08111277, shape=(), dtype=float32)
loss: tf.Tensor(0.05133491, shape=(), dtype=float32)
loss: tf.Tensor(0.046617076, shape=(), dtype=float32)
loss: tf.Tensor(0.039861098, shape=(), dtype=float32)
loss: tf.Tensor(0.048028607, shape=(), dtype=float32)
loss: tf.Tensor(0.04226638, shape=(), dtype=float32)
loss: tf.Tensor(0.035565935, shape=(), dtype=float32)
loss: tf.Tensor(0.04562884, shape=(), dtype=float32)
loss: tf.Tensor(0.03323973, shape=(), dtype=float32)
loss: tf.Tensor(0.06378699, shape=(), dtype=float32)
loss: tf.Tensor(0.043562938, shape=(), dtype=float32)
loss: tf.Tensor(0.07621085, shape=(), dtype=float32)
loss: tf.Tensor(0.052020364, shape=(), dtype=float32)
loss: tf.Tensor(0.09294668, shape=(), dtype=float32)
loss: tf.Tensor(0.04312256, shape=(), dtype=float32)
loss: tf.Tensor(0.027473433, shape=(), dtype=float32)
loss: tf.Tensor(0.08032505, shape=(), dtype=float32)
loss: tf.Tensor(0.09117592, shape=(), dtype=float32)
loss: tf.Tensor(0.17782034, shape=(), dtype=float32)
loss: tf.Tensor(0.031720746, shape=(), dtype=float32)
loss: tf.Tensor(0.03867475, shape=(), dtype=float32)
loss: tf.Tensor(0.00068176386, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69734913, shape=(), dtype=float32)
F1 SCORE:
0.82738763
EPOCH  23 #################################
loss: tf.Tensor(0.03594775, shape=(), dtype=float32)
loss: tf.Tensor(0.12782232, shape=(), dtype=float32)
loss: tf.Tensor(0.037382666, shape=(), dtype=float32)
loss: tf.Tensor(0.096994705, shape=(), dtype=float32)
loss: tf.Tensor(0.08467598, shape=(), dtype=float32)
loss: tf.Tensor(0.06050074, shape=(), dtype=float32)
loss: tf.Tensor(0.06898952, shape=(), dtype=float32)
loss: tf.Tensor(0.04825367, shape=(), dtype=float32)
loss: tf.Tensor(0.011181321, shape=(), dtype=float32)
loss: tf.Tensor(0.026313484, shape=(), dtype=float32)
loss: tf.Tensor(0.088580735, shape=(), dtype=float32)
loss: tf.Tensor(0.03945933, shape=(), dtype=float32)
loss: tf.Tensor(0.043680374, shape=(), dtype=float32)
loss: tf.Tensor(0.119465455, shape=(), dtype=float32)
loss: tf.Tensor(0.02700642, shape=(), dtype=float32)
loss: tf.Tensor(0.07751718, shape=(), dtype=float32)
loss: tf.Tensor(0.079618506, shape=(), dtype=float32)
loss: tf.Tensor(0.04309153, shape=(), dtype=float32)
loss: tf.Tensor(0.023416853, shape=(), dtype=float32)
loss: tf.Tensor(0.027591135, shape=(), dtype=float32)
loss: tf.Tensor(0.07589402, shape=(), dtype=float32)
loss: tf.Tensor(0.026451435, shape=(), dtype=float32)
loss: tf.Tensor(0.08227352, shape=(), dtype=float32)
loss: tf.Tensor(0.09315699, shape=(), dtype=float32)
loss: tf.Tensor(0.026366405, shape=(), dtype=float32)
loss: tf.Tensor(0.07029902, shape=(), dtype=float32)
loss: tf.Tensor(0.06430612, shape=(), dtype=float32)
loss: tf.Tensor(0.020653008, shape=(), dtype=float32)
loss: tf.Tensor(0.048537742, shape=(), dtype=float32)
loss: tf.Tensor(0.044174835, shape=(), dtype=float32)
loss: tf.Tensor(0.111476906, shape=(), dtype=float32)
loss: tf.Tensor(0.054505635, shape=(), dtype=float32)
loss: tf.Tensor(0.009578469, shape=(), dtype=float32)
loss: tf.Tensor(0.043826327, shape=(), dtype=float32)
loss: tf.Tensor(0.10493593, shape=(), dtype=float32)
loss: tf.Tensor(0.021534871, shape=(), dtype=float32)
loss: tf.Tensor(0.026507664, shape=(), dtype=float32)
loss: tf.Tensor(0.034070708, shape=(), dtype=float32)
loss: tf.Tensor(0.065547496, shape=(), dtype=float32)
loss: tf.Tensor(0.055060767, shape=(), dtype=float32)
loss: tf.Tensor(0.028645985, shape=(), dtype=float32)
loss: tf.Tensor(0.06891152, shape=(), dtype=float32)
loss: tf.Tensor(0.0712651, shape=(), dtype=float32)
loss: tf.Tensor(0.025070198, shape=(), dtype=float32)
loss: tf.Tensor(0.10519753, shape=(), dtype=float32)
loss: tf.Tensor(0.1034174, shape=(), dtype=float32)
loss: tf.Tensor(0.2083569, shape=(), dtype=float32)
loss: tf.Tensor(0.024322884, shape=(), dtype=float32)
loss: tf.Tensor(0.047303103, shape=(), dtype=float32)
loss: tf.Tensor(0.078488894, shape=(), dtype=float32)
loss: tf.Tensor(0.054124966, shape=(), dtype=float32)
loss: tf.Tensor(0.049679194, shape=(), dtype=float32)
loss: tf.Tensor(0.028600512, shape=(), dtype=float32)
loss: tf.Tensor(0.03888026, shape=(), dtype=float32)
loss: tf.Tensor(0.09049752, shape=(), dtype=float32)
loss: tf.Tensor(0.043094657, shape=(), dtype=float32)
loss: tf.Tensor(0.06460936, shape=(), dtype=float32)
loss: tf.Tensor(0.07684601, shape=(), dtype=float32)
loss: tf.Tensor(0.09738493, shape=(), dtype=float32)
loss: tf.Tensor(0.051584426, shape=(), dtype=float32)
loss: tf.Tensor(0.027227452, shape=(), dtype=float32)
loss: tf.Tensor(0.032242645, shape=(), dtype=float32)
loss: tf.Tensor(0.04175593, shape=(), dtype=float32)
loss: tf.Tensor(0.055270847, shape=(), dtype=float32)
loss: tf.Tensor(0.007163487, shape=(), dtype=float32)
loss: tf.Tensor(0.061576083, shape=(), dtype=float32)
loss: tf.Tensor(0.03450079, shape=(), dtype=float32)
loss: tf.Tensor(0.07194693, shape=(), dtype=float32)
loss: tf.Tensor(0.03350635, shape=(), dtype=float32)
loss: tf.Tensor(0.021404661, shape=(), dtype=float32)
loss: tf.Tensor(0.023090428, shape=(), dtype=float32)
loss: tf.Tensor(0.09927949, shape=(), dtype=float32)
loss: tf.Tensor(0.12844187, shape=(), dtype=float32)
loss: tf.Tensor(0.0002454218, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7048836, shape=(), dtype=float32)
F1 SCORE:
0.82722884
EPOCH  24 #################################
loss: tf.Tensor(0.04531147, shape=(), dtype=float32)
loss: tf.Tensor(0.027758658, shape=(), dtype=float32)
loss: tf.Tensor(0.07048129, shape=(), dtype=float32)
loss: tf.Tensor(0.05270932, shape=(), dtype=float32)
loss: tf.Tensor(0.051211454, shape=(), dtype=float32)
loss: tf.Tensor(0.034461703, shape=(), dtype=float32)
loss: tf.Tensor(0.012927439, shape=(), dtype=float32)
loss: tf.Tensor(0.019954588, shape=(), dtype=float32)
loss: tf.Tensor(0.027812473, shape=(), dtype=float32)
loss: tf.Tensor(0.03386272, shape=(), dtype=float32)
loss: tf.Tensor(0.017382754, shape=(), dtype=float32)
loss: tf.Tensor(0.020813396, shape=(), dtype=float32)
loss: tf.Tensor(0.066785455, shape=(), dtype=float32)
loss: tf.Tensor(0.039754104, shape=(), dtype=float32)
loss: tf.Tensor(0.17430536, shape=(), dtype=float32)
loss: tf.Tensor(0.020310836, shape=(), dtype=float32)
loss: tf.Tensor(0.035636675, shape=(), dtype=float32)
loss: tf.Tensor(0.013329893, shape=(), dtype=float32)
loss: tf.Tensor(0.04181416, shape=(), dtype=float32)
loss: tf.Tensor(0.04069693, shape=(), dtype=float32)
loss: tf.Tensor(0.050258454, shape=(), dtype=float32)
loss: tf.Tensor(0.035662312, shape=(), dtype=float32)
loss: tf.Tensor(0.01767831, shape=(), dtype=float32)
loss: tf.Tensor(0.03236862, shape=(), dtype=float32)
loss: tf.Tensor(0.052208953, shape=(), dtype=float32)
loss: tf.Tensor(0.06250663, shape=(), dtype=float32)
loss: tf.Tensor(0.018127494, shape=(), dtype=float32)
loss: tf.Tensor(0.018109186, shape=(), dtype=float32)
loss: tf.Tensor(0.04477046, shape=(), dtype=float32)
loss: tf.Tensor(0.07719953, shape=(), dtype=float32)
loss: tf.Tensor(0.076811045, shape=(), dtype=float32)
loss: tf.Tensor(0.06596438, shape=(), dtype=float32)
loss: tf.Tensor(0.041703634, shape=(), dtype=float32)
loss: tf.Tensor(0.010915734, shape=(), dtype=float32)
loss: tf.Tensor(0.1758169, shape=(), dtype=float32)
loss: tf.Tensor(0.024172988, shape=(), dtype=float32)
loss: tf.Tensor(0.035849888, shape=(), dtype=float32)
loss: tf.Tensor(0.119645745, shape=(), dtype=float32)
loss: tf.Tensor(0.032779817, shape=(), dtype=float32)
loss: tf.Tensor(0.03939802, shape=(), dtype=float32)
loss: tf.Tensor(0.100797154, shape=(), dtype=float32)
loss: tf.Tensor(0.041600432, shape=(), dtype=float32)
loss: tf.Tensor(0.16444378, shape=(), dtype=float32)
loss: tf.Tensor(0.06489105, shape=(), dtype=float32)
loss: tf.Tensor(0.016447257, shape=(), dtype=float32)
loss: tf.Tensor(0.040647577, shape=(), dtype=float32)
loss: tf.Tensor(0.05381445, shape=(), dtype=float32)
loss: tf.Tensor(0.044654544, shape=(), dtype=float32)
loss: tf.Tensor(0.1055176, shape=(), dtype=float32)
loss: tf.Tensor(0.122084185, shape=(), dtype=float32)
loss: tf.Tensor(0.072416246, shape=(), dtype=float32)
loss: tf.Tensor(0.035024475, shape=(), dtype=float32)
loss: tf.Tensor(0.024150161, shape=(), dtype=float32)
loss: tf.Tensor(0.06628606, shape=(), dtype=float32)
loss: tf.Tensor(0.049747888, shape=(), dtype=float32)
loss: tf.Tensor(0.06356138, shape=(), dtype=float32)
loss: tf.Tensor(0.06693319, shape=(), dtype=float32)
loss: tf.Tensor(0.12370163, shape=(), dtype=float32)
loss: tf.Tensor(0.05236783, shape=(), dtype=float32)
loss: tf.Tensor(0.0638838, shape=(), dtype=float32)
loss: tf.Tensor(0.10450754, shape=(), dtype=float32)
loss: tf.Tensor(0.040871345, shape=(), dtype=float32)
loss: tf.Tensor(0.060739376, shape=(), dtype=float32)
loss: tf.Tensor(0.08493538, shape=(), dtype=float32)
loss: tf.Tensor(0.008557461, shape=(), dtype=float32)
loss: tf.Tensor(0.06233958, shape=(), dtype=float32)
loss: tf.Tensor(0.037677325, shape=(), dtype=float32)
loss: tf.Tensor(0.02481235, shape=(), dtype=float32)
loss: tf.Tensor(0.08681363, shape=(), dtype=float32)
loss: tf.Tensor(0.09970178, shape=(), dtype=float32)
loss: tf.Tensor(0.019359272, shape=(), dtype=float32)
loss: tf.Tensor(0.038849402, shape=(), dtype=float32)
loss: tf.Tensor(0.044092417, shape=(), dtype=float32)
loss: tf.Tensor(0.00068212126, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7004602, shape=(), dtype=float32)
F1 SCORE:
0.8273228
EPOCH  25 #################################
loss: tf.Tensor(0.021257395, shape=(), dtype=float32)
loss: tf.Tensor(0.01184658, shape=(), dtype=float32)
loss: tf.Tensor(0.018083695, shape=(), dtype=float32)
loss: tf.Tensor(0.036404938, shape=(), dtype=float32)
loss: tf.Tensor(0.07533299, shape=(), dtype=float32)
loss: tf.Tensor(0.090374105, shape=(), dtype=float32)
loss: tf.Tensor(0.1093447, shape=(), dtype=float32)
loss: tf.Tensor(0.07632202, shape=(), dtype=float32)
loss: tf.Tensor(0.02127415, shape=(), dtype=float32)
loss: tf.Tensor(0.008613953, shape=(), dtype=float32)
loss: tf.Tensor(0.032197285, shape=(), dtype=float32)
loss: tf.Tensor(0.091695175, shape=(), dtype=float32)
loss: tf.Tensor(0.07929478, shape=(), dtype=float32)
loss: tf.Tensor(0.035116818, shape=(), dtype=float32)
loss: tf.Tensor(0.0055685914, shape=(), dtype=float32)
loss: tf.Tensor(0.019270802, shape=(), dtype=float32)
loss: tf.Tensor(0.076929405, shape=(), dtype=float32)
loss: tf.Tensor(0.06799527, shape=(), dtype=float32)
loss: tf.Tensor(0.056247354, shape=(), dtype=float32)
loss: tf.Tensor(0.052857794, shape=(), dtype=float32)
loss: tf.Tensor(0.044009373, shape=(), dtype=float32)
loss: tf.Tensor(0.024953377, shape=(), dtype=float32)
loss: tf.Tensor(0.037387427, shape=(), dtype=float32)
loss: tf.Tensor(0.011237218, shape=(), dtype=float32)
loss: tf.Tensor(0.014608056, shape=(), dtype=float32)
loss: tf.Tensor(0.13933916, shape=(), dtype=float32)
loss: tf.Tensor(0.009515821, shape=(), dtype=float32)
loss: tf.Tensor(0.027451584, shape=(), dtype=float32)
loss: tf.Tensor(0.11393523, shape=(), dtype=float32)
loss: tf.Tensor(0.04079538, shape=(), dtype=float32)
loss: tf.Tensor(0.11537632, shape=(), dtype=float32)
loss: tf.Tensor(0.042670984, shape=(), dtype=float32)
loss: tf.Tensor(0.070699714, shape=(), dtype=float32)
loss: tf.Tensor(0.016387053, shape=(), dtype=float32)
loss: tf.Tensor(0.036044937, shape=(), dtype=float32)
loss: tf.Tensor(0.015068071, shape=(), dtype=float32)
loss: tf.Tensor(0.02804826, shape=(), dtype=float32)
loss: tf.Tensor(0.07382408, shape=(), dtype=float32)
loss: tf.Tensor(0.029145947, shape=(), dtype=float32)
loss: tf.Tensor(0.041409373, shape=(), dtype=float32)
loss: tf.Tensor(0.0112446975, shape=(), dtype=float32)
loss: tf.Tensor(0.046910897, shape=(), dtype=float32)
loss: tf.Tensor(0.06144275, shape=(), dtype=float32)
loss: tf.Tensor(0.035309266, shape=(), dtype=float32)
loss: tf.Tensor(0.055331927, shape=(), dtype=float32)
loss: tf.Tensor(0.18534689, shape=(), dtype=float32)
loss: tf.Tensor(0.045624524, shape=(), dtype=float32)
loss: tf.Tensor(0.07895596, shape=(), dtype=float32)
loss: tf.Tensor(0.0506565, shape=(), dtype=float32)
loss: tf.Tensor(0.073870584, shape=(), dtype=float32)
loss: tf.Tensor(0.055616304, shape=(), dtype=float32)
loss: tf.Tensor(0.031237775, shape=(), dtype=float32)
loss: tf.Tensor(0.049868263, shape=(), dtype=float32)
loss: tf.Tensor(0.03900857, shape=(), dtype=float32)
loss: tf.Tensor(0.06391224, shape=(), dtype=float32)
loss: tf.Tensor(0.08258752, shape=(), dtype=float32)
loss: tf.Tensor(0.01584336, shape=(), dtype=float32)
loss: tf.Tensor(0.07616058, shape=(), dtype=float32)
loss: tf.Tensor(0.083981656, shape=(), dtype=float32)
loss: tf.Tensor(0.09741617, shape=(), dtype=float32)
loss: tf.Tensor(0.03855752, shape=(), dtype=float32)
loss: tf.Tensor(0.06989908, shape=(), dtype=float32)
loss: tf.Tensor(0.0077599837, shape=(), dtype=float32)
loss: tf.Tensor(0.025143147, shape=(), dtype=float32)
loss: tf.Tensor(0.065699294, shape=(), dtype=float32)
loss: tf.Tensor(0.059931733, shape=(), dtype=float32)
loss: tf.Tensor(0.01699579, shape=(), dtype=float32)
loss: tf.Tensor(0.0652576, shape=(), dtype=float32)
loss: tf.Tensor(0.09104496, shape=(), dtype=float32)
loss: tf.Tensor(0.060887307, shape=(), dtype=float32)
loss: tf.Tensor(0.045237664, shape=(), dtype=float32)
loss: tf.Tensor(0.0721454, shape=(), dtype=float32)
loss: tf.Tensor(0.023753032, shape=(), dtype=float32)
loss: tf.Tensor(0.004850644, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69067043, shape=(), dtype=float32)
F1 SCORE:
0.8281229
EPOCH  26 #################################
loss: tf.Tensor(0.078328535, shape=(), dtype=float32)
loss: tf.Tensor(0.06933924, shape=(), dtype=float32)
loss: tf.Tensor(0.017088853, shape=(), dtype=float32)
loss: tf.Tensor(0.052884787, shape=(), dtype=float32)
loss: tf.Tensor(0.05491357, shape=(), dtype=float32)
loss: tf.Tensor(0.06453374, shape=(), dtype=float32)
loss: tf.Tensor(0.079527125, shape=(), dtype=float32)
loss: tf.Tensor(0.049883347, shape=(), dtype=float32)
loss: tf.Tensor(0.01677409, shape=(), dtype=float32)
loss: tf.Tensor(0.023495335, shape=(), dtype=float32)
loss: tf.Tensor(0.10462947, shape=(), dtype=float32)
loss: tf.Tensor(0.058007136, shape=(), dtype=float32)
loss: tf.Tensor(0.057381544, shape=(), dtype=float32)
loss: tf.Tensor(0.030375652, shape=(), dtype=float32)
loss: tf.Tensor(0.019890498, shape=(), dtype=float32)
loss: tf.Tensor(0.07386956, shape=(), dtype=float32)
loss: tf.Tensor(0.02312631, shape=(), dtype=float32)
loss: tf.Tensor(0.045914993, shape=(), dtype=float32)
loss: tf.Tensor(0.038845323, shape=(), dtype=float32)
loss: tf.Tensor(0.042737283, shape=(), dtype=float32)
loss: tf.Tensor(0.013295484, shape=(), dtype=float32)
loss: tf.Tensor(0.02241798, shape=(), dtype=float32)
loss: tf.Tensor(0.016290875, shape=(), dtype=float32)
loss: tf.Tensor(0.030040095, shape=(), dtype=float32)
loss: tf.Tensor(0.0680265, shape=(), dtype=float32)
loss: tf.Tensor(0.015486511, shape=(), dtype=float32)
loss: tf.Tensor(0.06806698, shape=(), dtype=float32)
loss: tf.Tensor(0.035905458, shape=(), dtype=float32)
loss: tf.Tensor(0.07033175, shape=(), dtype=float32)
loss: tf.Tensor(0.044192735, shape=(), dtype=float32)
loss: tf.Tensor(0.04178114, shape=(), dtype=float32)
loss: tf.Tensor(0.051336482, shape=(), dtype=float32)
loss: tf.Tensor(0.017756652, shape=(), dtype=float32)
loss: tf.Tensor(0.111664526, shape=(), dtype=float32)
loss: tf.Tensor(0.034291033, shape=(), dtype=float32)
loss: tf.Tensor(0.058497604, shape=(), dtype=float32)
loss: tf.Tensor(0.032863807, shape=(), dtype=float32)
loss: tf.Tensor(0.1038909, shape=(), dtype=float32)
loss: tf.Tensor(0.07133685, shape=(), dtype=float32)
loss: tf.Tensor(0.02347622, shape=(), dtype=float32)
loss: tf.Tensor(0.04986966, shape=(), dtype=float32)
loss: tf.Tensor(0.044634867, shape=(), dtype=float32)
loss: tf.Tensor(0.06552198, shape=(), dtype=float32)
loss: tf.Tensor(0.03756127, shape=(), dtype=float32)
loss: tf.Tensor(0.043697175, shape=(), dtype=float32)
loss: tf.Tensor(0.040755868, shape=(), dtype=float32)
loss: tf.Tensor(0.026579825, shape=(), dtype=float32)
loss: tf.Tensor(0.049443234, shape=(), dtype=float32)
loss: tf.Tensor(0.037772097, shape=(), dtype=float32)
loss: tf.Tensor(0.047553692, shape=(), dtype=float32)
loss: tf.Tensor(0.04644489, shape=(), dtype=float32)
loss: tf.Tensor(0.09213399, shape=(), dtype=float32)
loss: tf.Tensor(0.01741532, shape=(), dtype=float32)
loss: tf.Tensor(0.048921417, shape=(), dtype=float32)
loss: tf.Tensor(0.06440368, shape=(), dtype=float32)
loss: tf.Tensor(0.10664357, shape=(), dtype=float32)
loss: tf.Tensor(0.09047398, shape=(), dtype=float32)
loss: tf.Tensor(0.0071319705, shape=(), dtype=float32)
loss: tf.Tensor(0.06419404, shape=(), dtype=float32)
loss: tf.Tensor(0.0466812, shape=(), dtype=float32)
loss: tf.Tensor(0.03141563, shape=(), dtype=float32)
loss: tf.Tensor(0.052163396, shape=(), dtype=float32)
loss: tf.Tensor(0.01229533, shape=(), dtype=float32)
loss: tf.Tensor(0.114924595, shape=(), dtype=float32)
loss: tf.Tensor(0.033821683, shape=(), dtype=float32)
loss: tf.Tensor(0.12305117, shape=(), dtype=float32)
loss: tf.Tensor(0.09476918, shape=(), dtype=float32)
loss: tf.Tensor(0.05263591, shape=(), dtype=float32)
loss: tf.Tensor(0.03878568, shape=(), dtype=float32)
loss: tf.Tensor(0.044364505, shape=(), dtype=float32)
loss: tf.Tensor(0.062238235, shape=(), dtype=float32)
loss: tf.Tensor(0.0655859, shape=(), dtype=float32)
loss: tf.Tensor(0.06869101, shape=(), dtype=float32)
loss: tf.Tensor(4.112636e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.72114676, shape=(), dtype=float32)
F1 SCORE:
0.8273085
EPOCH  27 #################################
loss: tf.Tensor(0.06874358, shape=(), dtype=float32)
loss: tf.Tensor(0.03691747, shape=(), dtype=float32)
loss: tf.Tensor(0.06691034, shape=(), dtype=float32)
loss: tf.Tensor(0.02113498, shape=(), dtype=float32)
loss: tf.Tensor(0.033182383, shape=(), dtype=float32)
loss: tf.Tensor(0.040779434, shape=(), dtype=float32)
loss: tf.Tensor(0.020391833, shape=(), dtype=float32)
loss: tf.Tensor(0.021029152, shape=(), dtype=float32)
loss: tf.Tensor(0.021670854, shape=(), dtype=float32)
loss: tf.Tensor(0.017540667, shape=(), dtype=float32)
loss: tf.Tensor(0.022127945, shape=(), dtype=float32)
loss: tf.Tensor(0.015543355, shape=(), dtype=float32)
loss: tf.Tensor(0.057598937, shape=(), dtype=float32)
loss: tf.Tensor(0.0314247, shape=(), dtype=float32)
loss: tf.Tensor(0.02337703, shape=(), dtype=float32)
loss: tf.Tensor(0.06836267, shape=(), dtype=float32)
loss: tf.Tensor(0.013319292, shape=(), dtype=float32)
loss: tf.Tensor(0.020055126, shape=(), dtype=float32)
loss: tf.Tensor(0.015592768, shape=(), dtype=float32)
loss: tf.Tensor(0.023076328, shape=(), dtype=float32)
loss: tf.Tensor(0.014574885, shape=(), dtype=float32)
loss: tf.Tensor(0.029694276, shape=(), dtype=float32)
loss: tf.Tensor(0.08513429, shape=(), dtype=float32)
loss: tf.Tensor(0.006675831, shape=(), dtype=float32)
loss: tf.Tensor(0.031818096, shape=(), dtype=float32)
loss: tf.Tensor(0.11170036, shape=(), dtype=float32)
loss: tf.Tensor(0.019121084, shape=(), dtype=float32)
loss: tf.Tensor(0.061719894, shape=(), dtype=float32)
loss: tf.Tensor(0.01418887, shape=(), dtype=float32)
loss: tf.Tensor(0.010587662, shape=(), dtype=float32)
loss: tf.Tensor(0.013572054, shape=(), dtype=float32)
loss: tf.Tensor(0.01431736, shape=(), dtype=float32)
loss: tf.Tensor(0.022061016, shape=(), dtype=float32)
loss: tf.Tensor(0.03733053, shape=(), dtype=float32)
loss: tf.Tensor(0.028668664, shape=(), dtype=float32)
loss: tf.Tensor(0.028868431, shape=(), dtype=float32)
loss: tf.Tensor(0.042090274, shape=(), dtype=float32)
loss: tf.Tensor(0.036536783, shape=(), dtype=float32)
loss: tf.Tensor(0.007593839, shape=(), dtype=float32)
loss: tf.Tensor(0.028311886, shape=(), dtype=float32)
loss: tf.Tensor(0.030922107, shape=(), dtype=float32)
loss: tf.Tensor(0.2031509, shape=(), dtype=float32)
loss: tf.Tensor(0.019460605, shape=(), dtype=float32)
loss: tf.Tensor(0.11210242, shape=(), dtype=float32)
loss: tf.Tensor(0.08959962, shape=(), dtype=float32)
loss: tf.Tensor(0.0071366443, shape=(), dtype=float32)
loss: tf.Tensor(0.030529037, shape=(), dtype=float32)
loss: tf.Tensor(0.032243513, shape=(), dtype=float32)
loss: tf.Tensor(0.068330094, shape=(), dtype=float32)
loss: tf.Tensor(0.16734388, shape=(), dtype=float32)
loss: tf.Tensor(0.11048633, shape=(), dtype=float32)
loss: tf.Tensor(0.08285563, shape=(), dtype=float32)
loss: tf.Tensor(0.008339905, shape=(), dtype=float32)
loss: tf.Tensor(0.042584997, shape=(), dtype=float32)
loss: tf.Tensor(0.083842896, shape=(), dtype=float32)
loss: tf.Tensor(0.06554531, shape=(), dtype=float32)
loss: tf.Tensor(0.029096916, shape=(), dtype=float32)
loss: tf.Tensor(0.12216607, shape=(), dtype=float32)
loss: tf.Tensor(0.10774557, shape=(), dtype=float32)
loss: tf.Tensor(0.06929114, shape=(), dtype=float32)
loss: tf.Tensor(0.056392126, shape=(), dtype=float32)
loss: tf.Tensor(0.060886826, shape=(), dtype=float32)
loss: tf.Tensor(0.03133312, shape=(), dtype=float32)
loss: tf.Tensor(0.016279245, shape=(), dtype=float32)
loss: tf.Tensor(0.06393188, shape=(), dtype=float32)
loss: tf.Tensor(0.12368815, shape=(), dtype=float32)
loss: tf.Tensor(0.045708127, shape=(), dtype=float32)
loss: tf.Tensor(0.026002485, shape=(), dtype=float32)
loss: tf.Tensor(0.029464662, shape=(), dtype=float32)
loss: tf.Tensor(0.114492156, shape=(), dtype=float32)
loss: tf.Tensor(0.013258061, shape=(), dtype=float32)
loss: tf.Tensor(0.07722213, shape=(), dtype=float32)
loss: tf.Tensor(0.06194627, shape=(), dtype=float32)
loss: tf.Tensor(0.011177896, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7189525, shape=(), dtype=float32)
F1 SCORE:
0.82653266
EPOCH  28 #################################
loss: tf.Tensor(0.05916466, shape=(), dtype=float32)
loss: tf.Tensor(0.013988024, shape=(), dtype=float32)
loss: tf.Tensor(0.022049932, shape=(), dtype=float32)
loss: tf.Tensor(0.07377157, shape=(), dtype=float32)
loss: tf.Tensor(0.02184929, shape=(), dtype=float32)
loss: tf.Tensor(0.11087038, shape=(), dtype=float32)
loss: tf.Tensor(0.069041416, shape=(), dtype=float32)
loss: tf.Tensor(0.055451702, shape=(), dtype=float32)
loss: tf.Tensor(0.06086148, shape=(), dtype=float32)
loss: tf.Tensor(0.043933105, shape=(), dtype=float32)
loss: tf.Tensor(0.011853968, shape=(), dtype=float32)
loss: tf.Tensor(0.0653442, shape=(), dtype=float32)
loss: tf.Tensor(0.038429428, shape=(), dtype=float32)
loss: tf.Tensor(0.027081687, shape=(), dtype=float32)
loss: tf.Tensor(0.040356692, shape=(), dtype=float32)
loss: tf.Tensor(0.054701433, shape=(), dtype=float32)
loss: tf.Tensor(0.027500989, shape=(), dtype=float32)
loss: tf.Tensor(0.025359148, shape=(), dtype=float32)
loss: tf.Tensor(0.026842738, shape=(), dtype=float32)
loss: tf.Tensor(0.010526355, shape=(), dtype=float32)
loss: tf.Tensor(0.012674439, shape=(), dtype=float32)
loss: tf.Tensor(0.13373433, shape=(), dtype=float32)
loss: tf.Tensor(0.05530657, shape=(), dtype=float32)
loss: tf.Tensor(0.031556565, shape=(), dtype=float32)
loss: tf.Tensor(0.027949547, shape=(), dtype=float32)
loss: tf.Tensor(0.014674989, shape=(), dtype=float32)
loss: tf.Tensor(0.05139364, shape=(), dtype=float32)
loss: tf.Tensor(0.04109996, shape=(), dtype=float32)
loss: tf.Tensor(0.010950003, shape=(), dtype=float32)
loss: tf.Tensor(0.03678042, shape=(), dtype=float32)
loss: tf.Tensor(0.052737292, shape=(), dtype=float32)
loss: tf.Tensor(0.033789817, shape=(), dtype=float32)
loss: tf.Tensor(0.032162853, shape=(), dtype=float32)
loss: tf.Tensor(0.04033031, shape=(), dtype=float32)
loss: tf.Tensor(0.03329276, shape=(), dtype=float32)
loss: tf.Tensor(0.016631046, shape=(), dtype=float32)
loss: tf.Tensor(0.0071589844, shape=(), dtype=float32)
loss: tf.Tensor(0.007853868, shape=(), dtype=float32)
loss: tf.Tensor(0.021864783, shape=(), dtype=float32)
loss: tf.Tensor(0.09501186, shape=(), dtype=float32)
loss: tf.Tensor(0.048399024, shape=(), dtype=float32)
loss: tf.Tensor(0.06598576, shape=(), dtype=float32)
loss: tf.Tensor(0.098994195, shape=(), dtype=float32)
loss: tf.Tensor(0.032208856, shape=(), dtype=float32)
loss: tf.Tensor(0.015058236, shape=(), dtype=float32)
loss: tf.Tensor(0.02406049, shape=(), dtype=float32)
loss: tf.Tensor(0.14921942, shape=(), dtype=float32)
loss: tf.Tensor(0.16756028, shape=(), dtype=float32)
loss: tf.Tensor(0.06998957, shape=(), dtype=float32)
loss: tf.Tensor(0.11332801, shape=(), dtype=float32)
loss: tf.Tensor(0.070610195, shape=(), dtype=float32)
loss: tf.Tensor(0.018076966, shape=(), dtype=float32)
loss: tf.Tensor(0.046373703, shape=(), dtype=float32)
loss: tf.Tensor(0.05107215, shape=(), dtype=float32)
loss: tf.Tensor(0.088819236, shape=(), dtype=float32)
loss: tf.Tensor(0.07502119, shape=(), dtype=float32)
loss: tf.Tensor(0.034094818, shape=(), dtype=float32)
loss: tf.Tensor(0.067731135, shape=(), dtype=float32)
loss: tf.Tensor(0.032453004, shape=(), dtype=float32)
loss: tf.Tensor(0.061944913, shape=(), dtype=float32)
loss: tf.Tensor(0.030916862, shape=(), dtype=float32)
loss: tf.Tensor(0.12297693, shape=(), dtype=float32)
loss: tf.Tensor(0.05361356, shape=(), dtype=float32)
loss: tf.Tensor(0.030061474, shape=(), dtype=float32)
loss: tf.Tensor(0.08395416, shape=(), dtype=float32)
loss: tf.Tensor(0.02159403, shape=(), dtype=float32)
loss: tf.Tensor(0.046920754, shape=(), dtype=float32)
loss: tf.Tensor(0.04224273, shape=(), dtype=float32)
loss: tf.Tensor(0.07465967, shape=(), dtype=float32)
loss: tf.Tensor(0.028374813, shape=(), dtype=float32)
loss: tf.Tensor(0.052487575, shape=(), dtype=float32)
loss: tf.Tensor(0.020565968, shape=(), dtype=float32)
loss: tf.Tensor(0.021030571, shape=(), dtype=float32)
loss: tf.Tensor(0.0016546857, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6935441, shape=(), dtype=float32)
F1 SCORE:
0.82690364
EPOCH  29 #################################
loss: tf.Tensor(0.03852619, shape=(), dtype=float32)
loss: tf.Tensor(0.06643397, shape=(), dtype=float32)
loss: tf.Tensor(0.04033945, shape=(), dtype=float32)
loss: tf.Tensor(0.015501363, shape=(), dtype=float32)
loss: tf.Tensor(0.031064842, shape=(), dtype=float32)
loss: tf.Tensor(0.058695212, shape=(), dtype=float32)
loss: tf.Tensor(0.023889735, shape=(), dtype=float32)
loss: tf.Tensor(0.08094127, shape=(), dtype=float32)
loss: tf.Tensor(0.026691163, shape=(), dtype=float32)
loss: tf.Tensor(0.019096645, shape=(), dtype=float32)
loss: tf.Tensor(0.010469338, shape=(), dtype=float32)
loss: tf.Tensor(0.0064453734, shape=(), dtype=float32)
loss: tf.Tensor(0.14449787, shape=(), dtype=float32)
loss: tf.Tensor(0.029857473, shape=(), dtype=float32)
loss: tf.Tensor(0.0113379285, shape=(), dtype=float32)
loss: tf.Tensor(0.02224344, shape=(), dtype=float32)
loss: tf.Tensor(0.011466098, shape=(), dtype=float32)
loss: tf.Tensor(0.009313142, shape=(), dtype=float32)
loss: tf.Tensor(0.02952757, shape=(), dtype=float32)
loss: tf.Tensor(0.043013528, shape=(), dtype=float32)
loss: tf.Tensor(0.027959125, shape=(), dtype=float32)
loss: tf.Tensor(0.014401287, shape=(), dtype=float32)
loss: tf.Tensor(0.05823197, shape=(), dtype=float32)
loss: tf.Tensor(0.023228819, shape=(), dtype=float32)
loss: tf.Tensor(0.024028089, shape=(), dtype=float32)
loss: tf.Tensor(0.01633293, shape=(), dtype=float32)
loss: tf.Tensor(0.08660121, shape=(), dtype=float32)
loss: tf.Tensor(0.011147886, shape=(), dtype=float32)
loss: tf.Tensor(0.015396348, shape=(), dtype=float32)
loss: tf.Tensor(0.0348825, shape=(), dtype=float32)
loss: tf.Tensor(0.03355299, shape=(), dtype=float32)
loss: tf.Tensor(0.02716165, shape=(), dtype=float32)
loss: tf.Tensor(0.0509838, shape=(), dtype=float32)
loss: tf.Tensor(0.08542102, shape=(), dtype=float32)
loss: tf.Tensor(0.019156223, shape=(), dtype=float32)
loss: tf.Tensor(0.05054099, shape=(), dtype=float32)
loss: tf.Tensor(0.05539913, shape=(), dtype=float32)
loss: tf.Tensor(0.014764723, shape=(), dtype=float32)
loss: tf.Tensor(0.0755523, shape=(), dtype=float32)
loss: tf.Tensor(0.024854181, shape=(), dtype=float32)
loss: tf.Tensor(0.04117875, shape=(), dtype=float32)
loss: tf.Tensor(0.04756625, shape=(), dtype=float32)
loss: tf.Tensor(0.03362432, shape=(), dtype=float32)
loss: tf.Tensor(0.04505811, shape=(), dtype=float32)
loss: tf.Tensor(0.010640467, shape=(), dtype=float32)
loss: tf.Tensor(0.024148796, shape=(), dtype=float32)
loss: tf.Tensor(0.031858437, shape=(), dtype=float32)
loss: tf.Tensor(0.018630765, shape=(), dtype=float32)
loss: tf.Tensor(0.068023324, shape=(), dtype=float32)
loss: tf.Tensor(0.07034582, shape=(), dtype=float32)
loss: tf.Tensor(0.03227344, shape=(), dtype=float32)
loss: tf.Tensor(0.03469064, shape=(), dtype=float32)
loss: tf.Tensor(0.007743975, shape=(), dtype=float32)
loss: tf.Tensor(0.06758488, shape=(), dtype=float32)
loss: tf.Tensor(0.0072542243, shape=(), dtype=float32)
loss: tf.Tensor(0.04545334, shape=(), dtype=float32)
loss: tf.Tensor(0.016773403, shape=(), dtype=float32)
loss: tf.Tensor(0.10152775, shape=(), dtype=float32)
loss: tf.Tensor(0.028185895, shape=(), dtype=float32)
loss: tf.Tensor(0.008765053, shape=(), dtype=float32)
loss: tf.Tensor(0.05458414, shape=(), dtype=float32)
loss: tf.Tensor(0.0066128303, shape=(), dtype=float32)
loss: tf.Tensor(0.107654974, shape=(), dtype=float32)
loss: tf.Tensor(0.039591834, shape=(), dtype=float32)
loss: tf.Tensor(0.09593297, shape=(), dtype=float32)
loss: tf.Tensor(0.030772667, shape=(), dtype=float32)
loss: tf.Tensor(0.023262745, shape=(), dtype=float32)
loss: tf.Tensor(0.021166725, shape=(), dtype=float32)
loss: tf.Tensor(0.05872567, shape=(), dtype=float32)
loss: tf.Tensor(0.032155346, shape=(), dtype=float32)
loss: tf.Tensor(0.027571294, shape=(), dtype=float32)
loss: tf.Tensor(0.030171478, shape=(), dtype=float32)
loss: tf.Tensor(0.079361886, shape=(), dtype=float32)
loss: tf.Tensor(3.0994368e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70642865, shape=(), dtype=float32)
F1 SCORE:
0.8266943
EPOCH  30 #################################
loss: tf.Tensor(0.029250735, shape=(), dtype=float32)
loss: tf.Tensor(0.012300547, shape=(), dtype=float32)
loss: tf.Tensor(0.018814465, shape=(), dtype=float32)
loss: tf.Tensor(0.041326076, shape=(), dtype=float32)
loss: tf.Tensor(0.03947676, shape=(), dtype=float32)
loss: tf.Tensor(0.03436841, shape=(), dtype=float32)
loss: tf.Tensor(0.0639418, shape=(), dtype=float32)
loss: tf.Tensor(0.107708, shape=(), dtype=float32)
loss: tf.Tensor(0.026029944, shape=(), dtype=float32)
loss: tf.Tensor(0.059944764, shape=(), dtype=float32)
loss: tf.Tensor(0.03575582, shape=(), dtype=float32)
loss: tf.Tensor(0.051421035, shape=(), dtype=float32)
loss: tf.Tensor(0.098431036, shape=(), dtype=float32)
loss: tf.Tensor(0.015914025, shape=(), dtype=float32)
loss: tf.Tensor(0.019373767, shape=(), dtype=float32)
loss: tf.Tensor(0.030251538, shape=(), dtype=float32)
loss: tf.Tensor(0.0055818856, shape=(), dtype=float32)
loss: tf.Tensor(0.080348596, shape=(), dtype=float32)
loss: tf.Tensor(0.014742954, shape=(), dtype=float32)
loss: tf.Tensor(0.03964387, shape=(), dtype=float32)
loss: tf.Tensor(0.047138214, shape=(), dtype=float32)
loss: tf.Tensor(0.009179099, shape=(), dtype=float32)
loss: tf.Tensor(0.011227149, shape=(), dtype=float32)
loss: tf.Tensor(0.05873111, shape=(), dtype=float32)
loss: tf.Tensor(0.031110499, shape=(), dtype=float32)
loss: tf.Tensor(0.029277375, shape=(), dtype=float32)
loss: tf.Tensor(0.053232327, shape=(), dtype=float32)
loss: tf.Tensor(0.045148257, shape=(), dtype=float32)
loss: tf.Tensor(0.1767982, shape=(), dtype=float32)
loss: tf.Tensor(0.020838685, shape=(), dtype=float32)
loss: tf.Tensor(0.04332641, shape=(), dtype=float32)
loss: tf.Tensor(0.046509333, shape=(), dtype=float32)
loss: tf.Tensor(0.06438304, shape=(), dtype=float32)
loss: tf.Tensor(0.04943108, shape=(), dtype=float32)
loss: tf.Tensor(0.026095133, shape=(), dtype=float32)
loss: tf.Tensor(0.018807257, shape=(), dtype=float32)
loss: tf.Tensor(0.048876673, shape=(), dtype=float32)
loss: tf.Tensor(0.029365594, shape=(), dtype=float32)
loss: tf.Tensor(0.042439032, shape=(), dtype=float32)
loss: tf.Tensor(0.044494785, shape=(), dtype=float32)
loss: tf.Tensor(0.07173335, shape=(), dtype=float32)
loss: tf.Tensor(0.05645635, shape=(), dtype=float32)
loss: tf.Tensor(0.047156475, shape=(), dtype=float32)
loss: tf.Tensor(0.015057169, shape=(), dtype=float32)
loss: tf.Tensor(0.0625582, shape=(), dtype=float32)
loss: tf.Tensor(0.02267062, shape=(), dtype=float32)
loss: tf.Tensor(0.022792151, shape=(), dtype=float32)
loss: tf.Tensor(0.047574557, shape=(), dtype=float32)
loss: tf.Tensor(0.055919938, shape=(), dtype=float32)
loss: tf.Tensor(0.021275913, shape=(), dtype=float32)
loss: tf.Tensor(0.01176937, shape=(), dtype=float32)
loss: tf.Tensor(0.036067948, shape=(), dtype=float32)
loss: tf.Tensor(0.04847568, shape=(), dtype=float32)
loss: tf.Tensor(0.07854226, shape=(), dtype=float32)
loss: tf.Tensor(0.037461333, shape=(), dtype=float32)
loss: tf.Tensor(0.0056515015, shape=(), dtype=float32)
loss: tf.Tensor(0.028642273, shape=(), dtype=float32)
loss: tf.Tensor(0.04232856, shape=(), dtype=float32)
loss: tf.Tensor(0.017745849, shape=(), dtype=float32)
loss: tf.Tensor(0.028291108, shape=(), dtype=float32)
loss: tf.Tensor(0.017216425, shape=(), dtype=float32)
loss: tf.Tensor(0.05984327, shape=(), dtype=float32)
loss: tf.Tensor(0.016930494, shape=(), dtype=float32)
loss: tf.Tensor(0.023774972, shape=(), dtype=float32)
loss: tf.Tensor(0.02645013, shape=(), dtype=float32)
loss: tf.Tensor(0.030414188, shape=(), dtype=float32)
loss: tf.Tensor(0.040100627, shape=(), dtype=float32)
loss: tf.Tensor(0.0109488275, shape=(), dtype=float32)
loss: tf.Tensor(0.028234275, shape=(), dtype=float32)
loss: tf.Tensor(0.07003443, shape=(), dtype=float32)
loss: tf.Tensor(0.006194447, shape=(), dtype=float32)
loss: tf.Tensor(0.053420737, shape=(), dtype=float32)
loss: tf.Tensor(0.013521806, shape=(), dtype=float32)
loss: tf.Tensor(0.00060373195, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.697969, shape=(), dtype=float32)
F1 SCORE:
0.8267
EPOCH  31 #################################
loss: tf.Tensor(0.013956151, shape=(), dtype=float32)
loss: tf.Tensor(0.0070798886, shape=(), dtype=float32)
loss: tf.Tensor(0.017885087, shape=(), dtype=float32)
loss: tf.Tensor(0.024581663, shape=(), dtype=float32)
loss: tf.Tensor(0.0052872794, shape=(), dtype=float32)
loss: tf.Tensor(0.022625413, shape=(), dtype=float32)
loss: tf.Tensor(0.10130599, shape=(), dtype=float32)
loss: tf.Tensor(0.025409222, shape=(), dtype=float32)
loss: tf.Tensor(0.03144554, shape=(), dtype=float32)
loss: tf.Tensor(0.029931746, shape=(), dtype=float32)
loss: tf.Tensor(0.026985921, shape=(), dtype=float32)
loss: tf.Tensor(0.014107061, shape=(), dtype=float32)
loss: tf.Tensor(0.010477016, shape=(), dtype=float32)
loss: tf.Tensor(0.009681284, shape=(), dtype=float32)
loss: tf.Tensor(0.013668885, shape=(), dtype=float32)
loss: tf.Tensor(0.024728084, shape=(), dtype=float32)
loss: tf.Tensor(0.034625642, shape=(), dtype=float32)
loss: tf.Tensor(0.0072456645, shape=(), dtype=float32)
loss: tf.Tensor(0.14108966, shape=(), dtype=float32)
loss: tf.Tensor(0.041668415, shape=(), dtype=float32)
loss: tf.Tensor(0.01808965, shape=(), dtype=float32)
loss: tf.Tensor(0.03372333, shape=(), dtype=float32)
loss: tf.Tensor(0.005944393, shape=(), dtype=float32)
loss: tf.Tensor(0.011510371, shape=(), dtype=float32)
loss: tf.Tensor(0.028366549, shape=(), dtype=float32)
loss: tf.Tensor(0.014665275, shape=(), dtype=float32)
loss: tf.Tensor(0.040185202, shape=(), dtype=float32)
loss: tf.Tensor(0.021594508, shape=(), dtype=float32)
loss: tf.Tensor(0.010838695, shape=(), dtype=float32)
loss: tf.Tensor(0.007366824, shape=(), dtype=float32)
loss: tf.Tensor(0.031932473, shape=(), dtype=float32)
loss: tf.Tensor(0.0030571832, shape=(), dtype=float32)
loss: tf.Tensor(0.024165612, shape=(), dtype=float32)
loss: tf.Tensor(0.00943456, shape=(), dtype=float32)
loss: tf.Tensor(0.111150235, shape=(), dtype=float32)
loss: tf.Tensor(0.008310839, shape=(), dtype=float32)
loss: tf.Tensor(0.02484182, shape=(), dtype=float32)
loss: tf.Tensor(0.012122257, shape=(), dtype=float32)
loss: tf.Tensor(0.026698334, shape=(), dtype=float32)
loss: tf.Tensor(0.012282091, shape=(), dtype=float32)
loss: tf.Tensor(0.036474615, shape=(), dtype=float32)
loss: tf.Tensor(0.024295637, shape=(), dtype=float32)
loss: tf.Tensor(0.022908352, shape=(), dtype=float32)
loss: tf.Tensor(0.021181634, shape=(), dtype=float32)
loss: tf.Tensor(0.05177539, shape=(), dtype=float32)
loss: tf.Tensor(0.21002845, shape=(), dtype=float32)
loss: tf.Tensor(0.03929012, shape=(), dtype=float32)
loss: tf.Tensor(0.040046107, shape=(), dtype=float32)
loss: tf.Tensor(0.062125493, shape=(), dtype=float32)
loss: tf.Tensor(0.038418595, shape=(), dtype=float32)
loss: tf.Tensor(0.020537768, shape=(), dtype=float32)
loss: tf.Tensor(0.13686785, shape=(), dtype=float32)
loss: tf.Tensor(0.0972408, shape=(), dtype=float32)
loss: tf.Tensor(0.028814398, shape=(), dtype=float32)
loss: tf.Tensor(0.043603256, shape=(), dtype=float32)
loss: tf.Tensor(0.0062336205, shape=(), dtype=float32)
loss: tf.Tensor(0.0756319, shape=(), dtype=float32)
loss: tf.Tensor(0.0501693, shape=(), dtype=float32)
loss: tf.Tensor(0.10335557, shape=(), dtype=float32)
loss: tf.Tensor(0.04411461, shape=(), dtype=float32)
loss: tf.Tensor(0.036118686, shape=(), dtype=float32)
loss: tf.Tensor(0.023727672, shape=(), dtype=float32)
loss: tf.Tensor(0.00689247, shape=(), dtype=float32)
loss: tf.Tensor(0.06846548, shape=(), dtype=float32)
loss: tf.Tensor(0.060116414, shape=(), dtype=float32)
loss: tf.Tensor(0.011970766, shape=(), dtype=float32)
loss: tf.Tensor(0.04250223, shape=(), dtype=float32)
loss: tf.Tensor(0.026330085, shape=(), dtype=float32)
loss: tf.Tensor(0.08094882, shape=(), dtype=float32)
loss: tf.Tensor(0.040157728, shape=(), dtype=float32)
loss: tf.Tensor(0.065703176, shape=(), dtype=float32)
loss: tf.Tensor(0.0044377856, shape=(), dtype=float32)
loss: tf.Tensor(0.073089845, shape=(), dtype=float32)
loss: tf.Tensor(2.4437606e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71140707, shape=(), dtype=float32)
F1 SCORE:
0.8261921
EPOCH  32 #################################
loss: tf.Tensor(0.073434025, shape=(), dtype=float32)
loss: tf.Tensor(0.050043587, shape=(), dtype=float32)
loss: tf.Tensor(0.016480189, shape=(), dtype=float32)
loss: tf.Tensor(0.0420676, shape=(), dtype=float32)
loss: tf.Tensor(0.04662636, shape=(), dtype=float32)
loss: tf.Tensor(0.03418237, shape=(), dtype=float32)
loss: tf.Tensor(0.019324243, shape=(), dtype=float32)
loss: tf.Tensor(0.05993622, shape=(), dtype=float32)
loss: tf.Tensor(0.044880867, shape=(), dtype=float32)
loss: tf.Tensor(0.046712063, shape=(), dtype=float32)
loss: tf.Tensor(0.039214578, shape=(), dtype=float32)
loss: tf.Tensor(0.008090706, shape=(), dtype=float32)
loss: tf.Tensor(0.0170198, shape=(), dtype=float32)
loss: tf.Tensor(0.030015318, shape=(), dtype=float32)
loss: tf.Tensor(0.08721117, shape=(), dtype=float32)
loss: tf.Tensor(0.10939237, shape=(), dtype=float32)
loss: tf.Tensor(0.09408886, shape=(), dtype=float32)
loss: tf.Tensor(0.06635917, shape=(), dtype=float32)
loss: tf.Tensor(0.057648733, shape=(), dtype=float32)
loss: tf.Tensor(0.01322317, shape=(), dtype=float32)
loss: tf.Tensor(0.018334324, shape=(), dtype=float32)
loss: tf.Tensor(0.022472646, shape=(), dtype=float32)
loss: tf.Tensor(0.057925824, shape=(), dtype=float32)
loss: tf.Tensor(0.084277496, shape=(), dtype=float32)
loss: tf.Tensor(0.032118477, shape=(), dtype=float32)
loss: tf.Tensor(0.09486767, shape=(), dtype=float32)
loss: tf.Tensor(0.03247289, shape=(), dtype=float32)
loss: tf.Tensor(0.018516269, shape=(), dtype=float32)
loss: tf.Tensor(0.025046356, shape=(), dtype=float32)
loss: tf.Tensor(0.014923883, shape=(), dtype=float32)
loss: tf.Tensor(0.03572866, shape=(), dtype=float32)
loss: tf.Tensor(0.008436585, shape=(), dtype=float32)
loss: tf.Tensor(0.030194001, shape=(), dtype=float32)
loss: tf.Tensor(0.010791291, shape=(), dtype=float32)
loss: tf.Tensor(0.011743355, shape=(), dtype=float32)
loss: tf.Tensor(0.06274721, shape=(), dtype=float32)
loss: tf.Tensor(0.032188777, shape=(), dtype=float32)
loss: tf.Tensor(0.0572687, shape=(), dtype=float32)
loss: tf.Tensor(0.044197064, shape=(), dtype=float32)
loss: tf.Tensor(0.021707987, shape=(), dtype=float32)
loss: tf.Tensor(0.016662277, shape=(), dtype=float32)
loss: tf.Tensor(0.057691827, shape=(), dtype=float32)
loss: tf.Tensor(0.08800231, shape=(), dtype=float32)
loss: tf.Tensor(0.037946075, shape=(), dtype=float32)
loss: tf.Tensor(0.04437756, shape=(), dtype=float32)
loss: tf.Tensor(0.044400617, shape=(), dtype=float32)
loss: tf.Tensor(0.018624159, shape=(), dtype=float32)
loss: tf.Tensor(0.12028878, shape=(), dtype=float32)
loss: tf.Tensor(0.062414132, shape=(), dtype=float32)
loss: tf.Tensor(0.051648486, shape=(), dtype=float32)
loss: tf.Tensor(0.0702746, shape=(), dtype=float32)
loss: tf.Tensor(0.17858219, shape=(), dtype=float32)
loss: tf.Tensor(0.03496371, shape=(), dtype=float32)
loss: tf.Tensor(0.0750961, shape=(), dtype=float32)
loss: tf.Tensor(0.092188664, shape=(), dtype=float32)
loss: tf.Tensor(0.04695485, shape=(), dtype=float32)
loss: tf.Tensor(0.011317848, shape=(), dtype=float32)
loss: tf.Tensor(0.04984518, shape=(), dtype=float32)
loss: tf.Tensor(0.017715469, shape=(), dtype=float32)
loss: tf.Tensor(0.046472672, shape=(), dtype=float32)
loss: tf.Tensor(0.043320537, shape=(), dtype=float32)
loss: tf.Tensor(0.0692341, shape=(), dtype=float32)
loss: tf.Tensor(0.067723624, shape=(), dtype=float32)
loss: tf.Tensor(0.052692614, shape=(), dtype=float32)
loss: tf.Tensor(0.067882545, shape=(), dtype=float32)
loss: tf.Tensor(0.01711218, shape=(), dtype=float32)
loss: tf.Tensor(0.04579885, shape=(), dtype=float32)
loss: tf.Tensor(0.033846736, shape=(), dtype=float32)
loss: tf.Tensor(0.016903736, shape=(), dtype=float32)
loss: tf.Tensor(0.07051433, shape=(), dtype=float32)
loss: tf.Tensor(0.047915004, shape=(), dtype=float32)
loss: tf.Tensor(0.05123048, shape=(), dtype=float32)
loss: tf.Tensor(0.046120457, shape=(), dtype=float32)
loss: tf.Tensor(0.08386743, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7076951, shape=(), dtype=float32)
F1 SCORE:
0.82591563
EPOCH  33 #################################
loss: tf.Tensor(0.03312625, shape=(), dtype=float32)
loss: tf.Tensor(0.10375124, shape=(), dtype=float32)
loss: tf.Tensor(0.034197785, shape=(), dtype=float32)
loss: tf.Tensor(0.10550762, shape=(), dtype=float32)
loss: tf.Tensor(0.14602773, shape=(), dtype=float32)
loss: tf.Tensor(0.01774414, shape=(), dtype=float32)
loss: tf.Tensor(0.097025946, shape=(), dtype=float32)
loss: tf.Tensor(0.10204044, shape=(), dtype=float32)
loss: tf.Tensor(0.2649845, shape=(), dtype=float32)
loss: tf.Tensor(0.05310608, shape=(), dtype=float32)
loss: tf.Tensor(0.027868528, shape=(), dtype=float32)
loss: tf.Tensor(0.007851281, shape=(), dtype=float32)
loss: tf.Tensor(0.025954662, shape=(), dtype=float32)
loss: tf.Tensor(0.069328725, shape=(), dtype=float32)
loss: tf.Tensor(0.086136535, shape=(), dtype=float32)
loss: tf.Tensor(0.01561257, shape=(), dtype=float32)
loss: tf.Tensor(0.050511837, shape=(), dtype=float32)
loss: tf.Tensor(0.04995872, shape=(), dtype=float32)
loss: tf.Tensor(0.0319851, shape=(), dtype=float32)
loss: tf.Tensor(0.07130887, shape=(), dtype=float32)
loss: tf.Tensor(0.04671947, shape=(), dtype=float32)
loss: tf.Tensor(0.06680566, shape=(), dtype=float32)
loss: tf.Tensor(0.038330324, shape=(), dtype=float32)
loss: tf.Tensor(0.075620085, shape=(), dtype=float32)
loss: tf.Tensor(0.05777757, shape=(), dtype=float32)
loss: tf.Tensor(0.073469475, shape=(), dtype=float32)
loss: tf.Tensor(0.05760213, shape=(), dtype=float32)
loss: tf.Tensor(0.020231573, shape=(), dtype=float32)
loss: tf.Tensor(0.029224625, shape=(), dtype=float32)
loss: tf.Tensor(0.070877865, shape=(), dtype=float32)
loss: tf.Tensor(0.026281852, shape=(), dtype=float32)
loss: tf.Tensor(0.10182943, shape=(), dtype=float32)
loss: tf.Tensor(0.017760135, shape=(), dtype=float32)
loss: tf.Tensor(0.018798918, shape=(), dtype=float32)
loss: tf.Tensor(0.042736217, shape=(), dtype=float32)
loss: tf.Tensor(0.080106996, shape=(), dtype=float32)
loss: tf.Tensor(0.029477121, shape=(), dtype=float32)
loss: tf.Tensor(0.017584875, shape=(), dtype=float32)
loss: tf.Tensor(0.04526525, shape=(), dtype=float32)
loss: tf.Tensor(0.041827254, shape=(), dtype=float32)
loss: tf.Tensor(0.015662137, shape=(), dtype=float32)
loss: tf.Tensor(0.02467979, shape=(), dtype=float32)
loss: tf.Tensor(0.007203834, shape=(), dtype=float32)
loss: tf.Tensor(0.05693035, shape=(), dtype=float32)
loss: tf.Tensor(0.05285077, shape=(), dtype=float32)
loss: tf.Tensor(0.09830161, shape=(), dtype=float32)
loss: tf.Tensor(0.042931885, shape=(), dtype=float32)
loss: tf.Tensor(0.019227998, shape=(), dtype=float32)
loss: tf.Tensor(0.050457392, shape=(), dtype=float32)
loss: tf.Tensor(0.02228685, shape=(), dtype=float32)
loss: tf.Tensor(0.04587199, shape=(), dtype=float32)
loss: tf.Tensor(0.0927367, shape=(), dtype=float32)
loss: tf.Tensor(0.03578522, shape=(), dtype=float32)
loss: tf.Tensor(0.03756495, shape=(), dtype=float32)
loss: tf.Tensor(0.0495886, shape=(), dtype=float32)
loss: tf.Tensor(0.059807256, shape=(), dtype=float32)
loss: tf.Tensor(0.07492902, shape=(), dtype=float32)
loss: tf.Tensor(0.020110462, shape=(), dtype=float32)
loss: tf.Tensor(0.025252461, shape=(), dtype=float32)
loss: tf.Tensor(0.02693283, shape=(), dtype=float32)
loss: tf.Tensor(0.079779744, shape=(), dtype=float32)
loss: tf.Tensor(0.02427929, shape=(), dtype=float32)
loss: tf.Tensor(0.04378178, shape=(), dtype=float32)
loss: tf.Tensor(0.19667904, shape=(), dtype=float32)
loss: tf.Tensor(0.03874202, shape=(), dtype=float32)
loss: tf.Tensor(0.047967207, shape=(), dtype=float32)
loss: tf.Tensor(0.025497274, shape=(), dtype=float32)
loss: tf.Tensor(0.044621862, shape=(), dtype=float32)
loss: tf.Tensor(0.036418952, shape=(), dtype=float32)
loss: tf.Tensor(0.0656233, shape=(), dtype=float32)
loss: tf.Tensor(0.032088086, shape=(), dtype=float32)
loss: tf.Tensor(0.04632968, shape=(), dtype=float32)
loss: tf.Tensor(0.029127324, shape=(), dtype=float32)
loss: tf.Tensor(2.0265559e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7006061, shape=(), dtype=float32)
F1 SCORE:
0.82601327
EPOCH  34 #################################
loss: tf.Tensor(0.03962773, shape=(), dtype=float32)
loss: tf.Tensor(0.04716963, shape=(), dtype=float32)
loss: tf.Tensor(0.013231597, shape=(), dtype=float32)
loss: tf.Tensor(0.017546115, shape=(), dtype=float32)
loss: tf.Tensor(0.02977873, shape=(), dtype=float32)
loss: tf.Tensor(0.019849462, shape=(), dtype=float32)
loss: tf.Tensor(0.052875474, shape=(), dtype=float32)
loss: tf.Tensor(0.008906841, shape=(), dtype=float32)
loss: tf.Tensor(0.0307441, shape=(), dtype=float32)
loss: tf.Tensor(0.023818841, shape=(), dtype=float32)
loss: tf.Tensor(0.060568828, shape=(), dtype=float32)
loss: tf.Tensor(0.08801597, shape=(), dtype=float32)
loss: tf.Tensor(0.005194543, shape=(), dtype=float32)
loss: tf.Tensor(0.11350636, shape=(), dtype=float32)
loss: tf.Tensor(0.06423996, shape=(), dtype=float32)
loss: tf.Tensor(0.04782757, shape=(), dtype=float32)
loss: tf.Tensor(0.0064293016, shape=(), dtype=float32)
loss: tf.Tensor(0.026669577, shape=(), dtype=float32)
loss: tf.Tensor(0.00773333, shape=(), dtype=float32)
loss: tf.Tensor(0.03736998, shape=(), dtype=float32)
loss: tf.Tensor(0.037263293, shape=(), dtype=float32)
loss: tf.Tensor(0.07364598, shape=(), dtype=float32)
loss: tf.Tensor(0.04431983, shape=(), dtype=float32)
loss: tf.Tensor(0.0519815, shape=(), dtype=float32)
loss: tf.Tensor(0.005080807, shape=(), dtype=float32)
loss: tf.Tensor(0.045123685, shape=(), dtype=float32)
loss: tf.Tensor(0.02700836, shape=(), dtype=float32)
loss: tf.Tensor(0.023032429, shape=(), dtype=float32)
loss: tf.Tensor(0.07405457, shape=(), dtype=float32)
loss: tf.Tensor(0.01553943, shape=(), dtype=float32)
loss: tf.Tensor(0.03652648, shape=(), dtype=float32)
loss: tf.Tensor(0.012659862, shape=(), dtype=float32)
loss: tf.Tensor(0.0173973, shape=(), dtype=float32)
loss: tf.Tensor(0.024939938, shape=(), dtype=float32)
loss: tf.Tensor(0.0510682, shape=(), dtype=float32)
loss: tf.Tensor(0.03454373, shape=(), dtype=float32)
loss: tf.Tensor(0.04986907, shape=(), dtype=float32)
loss: tf.Tensor(0.06124334, shape=(), dtype=float32)
loss: tf.Tensor(0.024689365, shape=(), dtype=float32)
loss: tf.Tensor(0.08173248, shape=(), dtype=float32)
loss: tf.Tensor(0.01730992, shape=(), dtype=float32)
loss: tf.Tensor(0.027223554, shape=(), dtype=float32)
loss: tf.Tensor(0.037081316, shape=(), dtype=float32)
loss: tf.Tensor(0.040322796, shape=(), dtype=float32)
loss: tf.Tensor(0.039087728, shape=(), dtype=float32)
loss: tf.Tensor(0.027109621, shape=(), dtype=float32)
loss: tf.Tensor(0.016351497, shape=(), dtype=float32)
loss: tf.Tensor(0.07430339, shape=(), dtype=float32)
loss: tf.Tensor(0.030451559, shape=(), dtype=float32)
loss: tf.Tensor(0.017249625, shape=(), dtype=float32)
loss: tf.Tensor(0.11666366, shape=(), dtype=float32)
loss: tf.Tensor(0.036140792, shape=(), dtype=float32)
loss: tf.Tensor(0.039413795, shape=(), dtype=float32)
loss: tf.Tensor(0.052514352, shape=(), dtype=float32)
loss: tf.Tensor(0.050264522, shape=(), dtype=float32)
loss: tf.Tensor(0.0449538, shape=(), dtype=float32)
loss: tf.Tensor(0.10005455, shape=(), dtype=float32)
loss: tf.Tensor(0.03505834, shape=(), dtype=float32)
loss: tf.Tensor(0.09537633, shape=(), dtype=float32)
loss: tf.Tensor(0.04169208, shape=(), dtype=float32)
loss: tf.Tensor(0.042985592, shape=(), dtype=float32)
loss: tf.Tensor(0.052209735, shape=(), dtype=float32)
loss: tf.Tensor(0.054461274, shape=(), dtype=float32)
loss: tf.Tensor(0.04518785, shape=(), dtype=float32)
loss: tf.Tensor(0.015903337, shape=(), dtype=float32)
loss: tf.Tensor(0.04704844, shape=(), dtype=float32)
loss: tf.Tensor(0.048326265, shape=(), dtype=float32)
loss: tf.Tensor(0.011389252, shape=(), dtype=float32)
loss: tf.Tensor(0.019209078, shape=(), dtype=float32)
loss: tf.Tensor(0.10616983, shape=(), dtype=float32)
loss: tf.Tensor(0.010914718, shape=(), dtype=float32)
loss: tf.Tensor(0.02217508, shape=(), dtype=float32)
loss: tf.Tensor(0.014732833, shape=(), dtype=float32)
loss: tf.Tensor(6.4372807e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7108451, shape=(), dtype=float32)
F1 SCORE:
0.82570106
EPOCH  35 #################################
loss: tf.Tensor(0.01643387, shape=(), dtype=float32)
loss: tf.Tensor(0.008210895, shape=(), dtype=float32)
loss: tf.Tensor(0.023993202, shape=(), dtype=float32)
loss: tf.Tensor(0.024669327, shape=(), dtype=float32)
loss: tf.Tensor(0.0562465, shape=(), dtype=float32)
loss: tf.Tensor(0.046804033, shape=(), dtype=float32)
loss: tf.Tensor(0.0141405305, shape=(), dtype=float32)
loss: tf.Tensor(0.0051605934, shape=(), dtype=float32)
loss: tf.Tensor(0.035154786, shape=(), dtype=float32)
loss: tf.Tensor(0.014744842, shape=(), dtype=float32)
loss: tf.Tensor(0.008851047, shape=(), dtype=float32)
loss: tf.Tensor(0.031166082, shape=(), dtype=float32)
loss: tf.Tensor(0.018827222, shape=(), dtype=float32)
loss: tf.Tensor(0.015173012, shape=(), dtype=float32)
loss: tf.Tensor(0.012518339, shape=(), dtype=float32)
loss: tf.Tensor(0.0062014167, shape=(), dtype=float32)
loss: tf.Tensor(0.020701244, shape=(), dtype=float32)
loss: tf.Tensor(0.053344075, shape=(), dtype=float32)
loss: tf.Tensor(0.04267293, shape=(), dtype=float32)
loss: tf.Tensor(0.008552558, shape=(), dtype=float32)
loss: tf.Tensor(0.033332456, shape=(), dtype=float32)
loss: tf.Tensor(0.026033886, shape=(), dtype=float32)
loss: tf.Tensor(0.09047385, shape=(), dtype=float32)
loss: tf.Tensor(0.04756759, shape=(), dtype=float32)
loss: tf.Tensor(0.025559237, shape=(), dtype=float32)
loss: tf.Tensor(0.06733449, shape=(), dtype=float32)
loss: tf.Tensor(0.038523268, shape=(), dtype=float32)
loss: tf.Tensor(0.04132405, shape=(), dtype=float32)
loss: tf.Tensor(0.011460533, shape=(), dtype=float32)
loss: tf.Tensor(0.024694845, shape=(), dtype=float32)
loss: tf.Tensor(0.017768716, shape=(), dtype=float32)
loss: tf.Tensor(0.059865955, shape=(), dtype=float32)
loss: tf.Tensor(0.060977973, shape=(), dtype=float32)
loss: tf.Tensor(0.0046885307, shape=(), dtype=float32)
loss: tf.Tensor(0.016942479, shape=(), dtype=float32)
loss: tf.Tensor(0.027363788, shape=(), dtype=float32)
loss: tf.Tensor(0.0050929086, shape=(), dtype=float32)
loss: tf.Tensor(0.033633262, shape=(), dtype=float32)
loss: tf.Tensor(0.044692453, shape=(), dtype=float32)
loss: tf.Tensor(0.09179886, shape=(), dtype=float32)
loss: tf.Tensor(0.09198679, shape=(), dtype=float32)
loss: tf.Tensor(0.030719751, shape=(), dtype=float32)
loss: tf.Tensor(0.014008573, shape=(), dtype=float32)
loss: tf.Tensor(0.04615543, shape=(), dtype=float32)
loss: tf.Tensor(0.0035205788, shape=(), dtype=float32)
loss: tf.Tensor(0.021819163, shape=(), dtype=float32)
loss: tf.Tensor(0.097652845, shape=(), dtype=float32)
loss: tf.Tensor(0.039574917, shape=(), dtype=float32)
loss: tf.Tensor(0.02659056, shape=(), dtype=float32)
loss: tf.Tensor(0.02349666, shape=(), dtype=float32)
loss: tf.Tensor(0.016322946, shape=(), dtype=float32)
loss: tf.Tensor(0.03132808, shape=(), dtype=float32)
loss: tf.Tensor(0.06498159, shape=(), dtype=float32)
loss: tf.Tensor(0.03258569, shape=(), dtype=float32)
loss: tf.Tensor(0.011499371, shape=(), dtype=float32)
loss: tf.Tensor(0.03093611, shape=(), dtype=float32)
loss: tf.Tensor(0.024326561, shape=(), dtype=float32)
loss: tf.Tensor(0.010381815, shape=(), dtype=float32)
loss: tf.Tensor(0.017018383, shape=(), dtype=float32)
loss: tf.Tensor(0.013696003, shape=(), dtype=float32)
loss: tf.Tensor(0.015431375, shape=(), dtype=float32)
loss: tf.Tensor(0.010817918, shape=(), dtype=float32)
loss: tf.Tensor(0.0020910925, shape=(), dtype=float32)
loss: tf.Tensor(0.008314815, shape=(), dtype=float32)
loss: tf.Tensor(0.0775045, shape=(), dtype=float32)
loss: tf.Tensor(0.015735067, shape=(), dtype=float32)
loss: tf.Tensor(0.01596153, shape=(), dtype=float32)
loss: tf.Tensor(0.0005930315, shape=(), dtype=float32)
loss: tf.Tensor(0.034172412, shape=(), dtype=float32)
loss: tf.Tensor(0.00833759, shape=(), dtype=float32)
loss: tf.Tensor(0.021916784, shape=(), dtype=float32)
loss: tf.Tensor(0.06999511, shape=(), dtype=float32)
loss: tf.Tensor(0.0103789745, shape=(), dtype=float32)
loss: tf.Tensor(0.0, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7104998, shape=(), dtype=float32)
F1 SCORE:
0.82543725
EPOCH  36 #################################
loss: tf.Tensor(0.033584703, shape=(), dtype=float32)
loss: tf.Tensor(0.045111038, shape=(), dtype=float32)
loss: tf.Tensor(0.020427847, shape=(), dtype=float32)
loss: tf.Tensor(0.0023307954, shape=(), dtype=float32)
loss: tf.Tensor(0.019892247, shape=(), dtype=float32)
loss: tf.Tensor(0.011370744, shape=(), dtype=float32)
loss: tf.Tensor(0.0029293997, shape=(), dtype=float32)
loss: tf.Tensor(0.044038653, shape=(), dtype=float32)
loss: tf.Tensor(0.0067366366, shape=(), dtype=float32)
loss: tf.Tensor(0.016989661, shape=(), dtype=float32)
loss: tf.Tensor(0.0070763337, shape=(), dtype=float32)
loss: tf.Tensor(0.013908321, shape=(), dtype=float32)
loss: tf.Tensor(0.014534073, shape=(), dtype=float32)
loss: tf.Tensor(0.014518845, shape=(), dtype=float32)
loss: tf.Tensor(0.009305333, shape=(), dtype=float32)
loss: tf.Tensor(0.012306853, shape=(), dtype=float32)
loss: tf.Tensor(0.0026478851, shape=(), dtype=float32)
loss: tf.Tensor(0.056632627, shape=(), dtype=float32)
loss: tf.Tensor(0.01618322, shape=(), dtype=float32)
loss: tf.Tensor(0.047592483, shape=(), dtype=float32)
loss: tf.Tensor(0.017582607, shape=(), dtype=float32)
loss: tf.Tensor(0.0045108683, shape=(), dtype=float32)
loss: tf.Tensor(0.003636604, shape=(), dtype=float32)
loss: tf.Tensor(0.0073612947, shape=(), dtype=float32)
loss: tf.Tensor(0.08927143, shape=(), dtype=float32)
loss: tf.Tensor(0.007414353, shape=(), dtype=float32)
loss: tf.Tensor(0.0084108235, shape=(), dtype=float32)
loss: tf.Tensor(0.012902179, shape=(), dtype=float32)
loss: tf.Tensor(0.0364809, shape=(), dtype=float32)
loss: tf.Tensor(0.01763464, shape=(), dtype=float32)
loss: tf.Tensor(0.010982268, shape=(), dtype=float32)
loss: tf.Tensor(0.019297209, shape=(), dtype=float32)
loss: tf.Tensor(0.01771805, shape=(), dtype=float32)
loss: tf.Tensor(0.012011434, shape=(), dtype=float32)
loss: tf.Tensor(0.01233366, shape=(), dtype=float32)
loss: tf.Tensor(0.016552102, shape=(), dtype=float32)
loss: tf.Tensor(0.00862107, shape=(), dtype=float32)
loss: tf.Tensor(0.04731659, shape=(), dtype=float32)
loss: tf.Tensor(0.039103698, shape=(), dtype=float32)
loss: tf.Tensor(0.13741505, shape=(), dtype=float32)
loss: tf.Tensor(0.038006794, shape=(), dtype=float32)
loss: tf.Tensor(0.009147239, shape=(), dtype=float32)
loss: tf.Tensor(0.03682802, shape=(), dtype=float32)
loss: tf.Tensor(0.013876216, shape=(), dtype=float32)
loss: tf.Tensor(0.076932885, shape=(), dtype=float32)
loss: tf.Tensor(0.012190896, shape=(), dtype=float32)
loss: tf.Tensor(0.025792608, shape=(), dtype=float32)
loss: tf.Tensor(0.019819409, shape=(), dtype=float32)
loss: tf.Tensor(0.11409592, shape=(), dtype=float32)
loss: tf.Tensor(0.007338722, shape=(), dtype=float32)
loss: tf.Tensor(0.018406676, shape=(), dtype=float32)
loss: tf.Tensor(0.026067812, shape=(), dtype=float32)
loss: tf.Tensor(0.005712486, shape=(), dtype=float32)
loss: tf.Tensor(0.06632494, shape=(), dtype=float32)
loss: tf.Tensor(0.016424475, shape=(), dtype=float32)
loss: tf.Tensor(0.04461361, shape=(), dtype=float32)
loss: tf.Tensor(0.06285508, shape=(), dtype=float32)
loss: tf.Tensor(0.034951445, shape=(), dtype=float32)
loss: tf.Tensor(0.026393056, shape=(), dtype=float32)
loss: tf.Tensor(0.014523742, shape=(), dtype=float32)
loss: tf.Tensor(0.008535299, shape=(), dtype=float32)
loss: tf.Tensor(0.16325669, shape=(), dtype=float32)
loss: tf.Tensor(0.043146696, shape=(), dtype=float32)
loss: tf.Tensor(0.023739252, shape=(), dtype=float32)
loss: tf.Tensor(0.01672427, shape=(), dtype=float32)
loss: tf.Tensor(0.03767601, shape=(), dtype=float32)
loss: tf.Tensor(0.042052828, shape=(), dtype=float32)
loss: tf.Tensor(0.0045029293, shape=(), dtype=float32)
loss: tf.Tensor(0.02035501, shape=(), dtype=float32)
loss: tf.Tensor(0.07576183, shape=(), dtype=float32)
loss: tf.Tensor(0.015925713, shape=(), dtype=float32)
loss: tf.Tensor(0.04840498, shape=(), dtype=float32)
loss: tf.Tensor(0.026100082, shape=(), dtype=float32)
loss: tf.Tensor(0.0003113262, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7020446, shape=(), dtype=float32)
F1 SCORE:
0.82552814
EPOCH  37 #################################
loss: tf.Tensor(0.014462428, shape=(), dtype=float32)
loss: tf.Tensor(0.025540648, shape=(), dtype=float32)
loss: tf.Tensor(0.0076437686, shape=(), dtype=float32)
loss: tf.Tensor(0.032626376, shape=(), dtype=float32)
loss: tf.Tensor(0.047557715, shape=(), dtype=float32)
loss: tf.Tensor(0.031364694, shape=(), dtype=float32)
loss: tf.Tensor(0.027312536, shape=(), dtype=float32)
loss: tf.Tensor(0.006522876, shape=(), dtype=float32)
loss: tf.Tensor(0.034436245, shape=(), dtype=float32)
loss: tf.Tensor(0.022465877, shape=(), dtype=float32)
loss: tf.Tensor(0.006782082, shape=(), dtype=float32)
loss: tf.Tensor(0.0091312695, shape=(), dtype=float32)
loss: tf.Tensor(0.09773144, shape=(), dtype=float32)
loss: tf.Tensor(0.043491587, shape=(), dtype=float32)
loss: tf.Tensor(0.009394599, shape=(), dtype=float32)
loss: tf.Tensor(0.007146523, shape=(), dtype=float32)
loss: tf.Tensor(0.04787818, shape=(), dtype=float32)
loss: tf.Tensor(0.041940298, shape=(), dtype=float32)
loss: tf.Tensor(0.023638178, shape=(), dtype=float32)
loss: tf.Tensor(0.004156765, shape=(), dtype=float32)
loss: tf.Tensor(0.03868038, shape=(), dtype=float32)
loss: tf.Tensor(0.011197917, shape=(), dtype=float32)
loss: tf.Tensor(0.056381866, shape=(), dtype=float32)
loss: tf.Tensor(0.009343056, shape=(), dtype=float32)
loss: tf.Tensor(0.035583448, shape=(), dtype=float32)
loss: tf.Tensor(0.03444073, shape=(), dtype=float32)
loss: tf.Tensor(0.055256583, shape=(), dtype=float32)
loss: tf.Tensor(0.00833778, shape=(), dtype=float32)
loss: tf.Tensor(0.054089002, shape=(), dtype=float32)
loss: tf.Tensor(0.035867885, shape=(), dtype=float32)
loss: tf.Tensor(0.023335425, shape=(), dtype=float32)
loss: tf.Tensor(0.019628787, shape=(), dtype=float32)
loss: tf.Tensor(0.015060055, shape=(), dtype=float32)
loss: tf.Tensor(0.013888107, shape=(), dtype=float32)
loss: tf.Tensor(0.03839315, shape=(), dtype=float32)
loss: tf.Tensor(0.031575453, shape=(), dtype=float32)
loss: tf.Tensor(0.017933466, shape=(), dtype=float32)
loss: tf.Tensor(0.029950703, shape=(), dtype=float32)
loss: tf.Tensor(0.081477225, shape=(), dtype=float32)
loss: tf.Tensor(0.06816247, shape=(), dtype=float32)
loss: tf.Tensor(0.014957815, shape=(), dtype=float32)
loss: tf.Tensor(0.025728466, shape=(), dtype=float32)
loss: tf.Tensor(0.087458774, shape=(), dtype=float32)
loss: tf.Tensor(0.04083717, shape=(), dtype=float32)
loss: tf.Tensor(0.10200982, shape=(), dtype=float32)
loss: tf.Tensor(0.014217865, shape=(), dtype=float32)
loss: tf.Tensor(0.049158886, shape=(), dtype=float32)
loss: tf.Tensor(0.02703218, shape=(), dtype=float32)
loss: tf.Tensor(0.005993694, shape=(), dtype=float32)
loss: tf.Tensor(0.0065796124, shape=(), dtype=float32)
loss: tf.Tensor(0.020748371, shape=(), dtype=float32)
loss: tf.Tensor(0.044807054, shape=(), dtype=float32)
loss: tf.Tensor(0.055129427, shape=(), dtype=float32)
loss: tf.Tensor(0.030069804, shape=(), dtype=float32)
loss: tf.Tensor(0.042297818, shape=(), dtype=float32)
loss: tf.Tensor(0.006960617, shape=(), dtype=float32)
loss: tf.Tensor(0.023265662, shape=(), dtype=float32)
loss: tf.Tensor(0.040127903, shape=(), dtype=float32)
loss: tf.Tensor(0.025814485, shape=(), dtype=float32)
loss: tf.Tensor(0.025810428, shape=(), dtype=float32)
loss: tf.Tensor(0.022628747, shape=(), dtype=float32)
loss: tf.Tensor(0.05885598, shape=(), dtype=float32)
loss: tf.Tensor(0.066618256, shape=(), dtype=float32)
loss: tf.Tensor(0.01354493, shape=(), dtype=float32)
loss: tf.Tensor(0.021144677, shape=(), dtype=float32)
loss: tf.Tensor(0.069894135, shape=(), dtype=float32)
loss: tf.Tensor(0.030129392, shape=(), dtype=float32)
loss: tf.Tensor(0.01636869, shape=(), dtype=float32)
loss: tf.Tensor(0.13063575, shape=(), dtype=float32)
loss: tf.Tensor(0.05942418, shape=(), dtype=float32)
loss: tf.Tensor(0.051656503, shape=(), dtype=float32)
loss: tf.Tensor(0.052735906, shape=(), dtype=float32)
loss: tf.Tensor(0.033954803, shape=(), dtype=float32)
loss: tf.Tensor(0.0041667316, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7075223, shape=(), dtype=float32)
F1 SCORE:
0.82533926
EPOCH  38 #################################
loss: tf.Tensor(0.08128337, shape=(), dtype=float32)
loss: tf.Tensor(0.0056363656, shape=(), dtype=float32)
loss: tf.Tensor(0.004813211, shape=(), dtype=float32)
loss: tf.Tensor(0.07354501, shape=(), dtype=float32)
loss: tf.Tensor(0.076213434, shape=(), dtype=float32)
loss: tf.Tensor(0.104033634, shape=(), dtype=float32)
loss: tf.Tensor(0.014862236, shape=(), dtype=float32)
loss: tf.Tensor(0.019646443, shape=(), dtype=float32)
loss: tf.Tensor(0.0690298, shape=(), dtype=float32)
loss: tf.Tensor(0.022787755, shape=(), dtype=float32)
loss: tf.Tensor(0.04745028, shape=(), dtype=float32)
loss: tf.Tensor(0.05929559, shape=(), dtype=float32)
loss: tf.Tensor(0.13443273, shape=(), dtype=float32)
loss: tf.Tensor(0.008071382, shape=(), dtype=float32)
loss: tf.Tensor(0.033338085, shape=(), dtype=float32)
loss: tf.Tensor(0.012546964, shape=(), dtype=float32)
loss: tf.Tensor(0.019289093, shape=(), dtype=float32)
loss: tf.Tensor(0.0020680935, shape=(), dtype=float32)
loss: tf.Tensor(0.02200917, shape=(), dtype=float32)
loss: tf.Tensor(0.030872386, shape=(), dtype=float32)
loss: tf.Tensor(0.059855938, shape=(), dtype=float32)
loss: tf.Tensor(0.073623955, shape=(), dtype=float32)
loss: tf.Tensor(0.071435004, shape=(), dtype=float32)
loss: tf.Tensor(0.0038593465, shape=(), dtype=float32)
loss: tf.Tensor(0.030362282, shape=(), dtype=float32)
loss: tf.Tensor(0.06865819, shape=(), dtype=float32)
loss: tf.Tensor(0.021703871, shape=(), dtype=float32)
loss: tf.Tensor(0.069640286, shape=(), dtype=float32)
loss: tf.Tensor(0.03511838, shape=(), dtype=float32)
loss: tf.Tensor(0.04602157, shape=(), dtype=float32)
loss: tf.Tensor(0.014898263, shape=(), dtype=float32)
loss: tf.Tensor(0.051691093, shape=(), dtype=float32)
loss: tf.Tensor(0.04288236, shape=(), dtype=float32)
loss: tf.Tensor(0.014942194, shape=(), dtype=float32)
loss: tf.Tensor(0.009897463, shape=(), dtype=float32)
loss: tf.Tensor(0.025531294, shape=(), dtype=float32)
loss: tf.Tensor(0.01607746, shape=(), dtype=float32)
loss: tf.Tensor(0.011514196, shape=(), dtype=float32)
loss: tf.Tensor(0.01419088, shape=(), dtype=float32)
loss: tf.Tensor(0.025832254, shape=(), dtype=float32)
loss: tf.Tensor(0.10965875, shape=(), dtype=float32)
loss: tf.Tensor(0.10658289, shape=(), dtype=float32)
loss: tf.Tensor(0.059438825, shape=(), dtype=float32)
loss: tf.Tensor(0.016282927, shape=(), dtype=float32)
loss: tf.Tensor(0.047214307, shape=(), dtype=float32)
loss: tf.Tensor(0.036562905, shape=(), dtype=float32)
loss: tf.Tensor(0.027356505, shape=(), dtype=float32)
loss: tf.Tensor(0.019788112, shape=(), dtype=float32)
loss: tf.Tensor(0.047168147, shape=(), dtype=float32)
loss: tf.Tensor(0.10623994, shape=(), dtype=float32)
loss: tf.Tensor(0.08232274, shape=(), dtype=float32)
loss: tf.Tensor(0.02367341, shape=(), dtype=float32)
loss: tf.Tensor(0.015001706, shape=(), dtype=float32)
loss: tf.Tensor(0.028361054, shape=(), dtype=float32)
loss: tf.Tensor(0.017233193, shape=(), dtype=float32)
loss: tf.Tensor(0.016509032, shape=(), dtype=float32)
loss: tf.Tensor(0.0053435145, shape=(), dtype=float32)
loss: tf.Tensor(0.04749804, shape=(), dtype=float32)
loss: tf.Tensor(0.047806963, shape=(), dtype=float32)
loss: tf.Tensor(0.025170662, shape=(), dtype=float32)
loss: tf.Tensor(0.046513896, shape=(), dtype=float32)
loss: tf.Tensor(0.066607416, shape=(), dtype=float32)
loss: tf.Tensor(0.033368904, shape=(), dtype=float32)
loss: tf.Tensor(0.004530618, shape=(), dtype=float32)
loss: tf.Tensor(0.032779172, shape=(), dtype=float32)
loss: tf.Tensor(0.032202076, shape=(), dtype=float32)
loss: tf.Tensor(0.050417442, shape=(), dtype=float32)
loss: tf.Tensor(0.052287508, shape=(), dtype=float32)
loss: tf.Tensor(0.0382856, shape=(), dtype=float32)
loss: tf.Tensor(0.026865667, shape=(), dtype=float32)
loss: tf.Tensor(0.091122754, shape=(), dtype=float32)
loss: tf.Tensor(0.012760864, shape=(), dtype=float32)
loss: tf.Tensor(0.02974065, shape=(), dtype=float32)
loss: tf.Tensor(0.00018761781, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7051894, shape=(), dtype=float32)
F1 SCORE:
0.8251644
EPOCH  39 #################################
loss: tf.Tensor(0.014931424, shape=(), dtype=float32)
loss: tf.Tensor(0.0786196, shape=(), dtype=float32)
loss: tf.Tensor(0.047086205, shape=(), dtype=float32)
loss: tf.Tensor(0.029936707, shape=(), dtype=float32)
loss: tf.Tensor(0.045142196, shape=(), dtype=float32)
loss: tf.Tensor(0.026006555, shape=(), dtype=float32)
loss: tf.Tensor(0.008556382, shape=(), dtype=float32)
loss: tf.Tensor(0.04692233, shape=(), dtype=float32)
loss: tf.Tensor(0.035585474, shape=(), dtype=float32)
loss: tf.Tensor(0.02246842, shape=(), dtype=float32)
loss: tf.Tensor(0.0600895, shape=(), dtype=float32)
loss: tf.Tensor(0.03198849, shape=(), dtype=float32)
loss: tf.Tensor(0.01954904, shape=(), dtype=float32)
loss: tf.Tensor(0.006905707, shape=(), dtype=float32)
loss: tf.Tensor(0.017168688, shape=(), dtype=float32)
loss: tf.Tensor(0.035208866, shape=(), dtype=float32)
loss: tf.Tensor(0.02391839, shape=(), dtype=float32)
loss: tf.Tensor(0.026766367, shape=(), dtype=float32)
loss: tf.Tensor(0.030306183, shape=(), dtype=float32)
loss: tf.Tensor(0.009061778, shape=(), dtype=float32)
loss: tf.Tensor(0.005633056, shape=(), dtype=float32)
loss: tf.Tensor(0.029704297, shape=(), dtype=float32)
loss: tf.Tensor(0.051037565, shape=(), dtype=float32)
loss: tf.Tensor(0.09192176, shape=(), dtype=float32)
loss: tf.Tensor(0.0065315515, shape=(), dtype=float32)
loss: tf.Tensor(0.01789572, shape=(), dtype=float32)
loss: tf.Tensor(0.032181803, shape=(), dtype=float32)
loss: tf.Tensor(0.010424557, shape=(), dtype=float32)
loss: tf.Tensor(0.06842537, shape=(), dtype=float32)
loss: tf.Tensor(0.024578102, shape=(), dtype=float32)
loss: tf.Tensor(0.028019315, shape=(), dtype=float32)
loss: tf.Tensor(0.03518701, shape=(), dtype=float32)
loss: tf.Tensor(0.019227766, shape=(), dtype=float32)
loss: tf.Tensor(0.09367397, shape=(), dtype=float32)
loss: tf.Tensor(0.027909853, shape=(), dtype=float32)
loss: tf.Tensor(0.014293208, shape=(), dtype=float32)
loss: tf.Tensor(0.039471205, shape=(), dtype=float32)
loss: tf.Tensor(0.017002683, shape=(), dtype=float32)
loss: tf.Tensor(0.010555301, shape=(), dtype=float32)
loss: tf.Tensor(0.0204107, shape=(), dtype=float32)
loss: tf.Tensor(0.020472366, shape=(), dtype=float32)
loss: tf.Tensor(0.09161975, shape=(), dtype=float32)
loss: tf.Tensor(0.019735318, shape=(), dtype=float32)
loss: tf.Tensor(0.019937092, shape=(), dtype=float32)
loss: tf.Tensor(0.028037364, shape=(), dtype=float32)
loss: tf.Tensor(0.09290167, shape=(), dtype=float32)
loss: tf.Tensor(0.065238096, shape=(), dtype=float32)
loss: tf.Tensor(0.033051174, shape=(), dtype=float32)
loss: tf.Tensor(0.07974157, shape=(), dtype=float32)
loss: tf.Tensor(0.02153656, shape=(), dtype=float32)
loss: tf.Tensor(0.011210568, shape=(), dtype=float32)
loss: tf.Tensor(0.017902208, shape=(), dtype=float32)
loss: tf.Tensor(0.021978794, shape=(), dtype=float32)
loss: tf.Tensor(0.07153844, shape=(), dtype=float32)
loss: tf.Tensor(0.094306, shape=(), dtype=float32)
loss: tf.Tensor(0.0024412803, shape=(), dtype=float32)
loss: tf.Tensor(0.055944636, shape=(), dtype=float32)
loss: tf.Tensor(0.020444464, shape=(), dtype=float32)
loss: tf.Tensor(0.031672224, shape=(), dtype=float32)
loss: tf.Tensor(0.052626118, shape=(), dtype=float32)
loss: tf.Tensor(0.087739475, shape=(), dtype=float32)
loss: tf.Tensor(0.017463598, shape=(), dtype=float32)
loss: tf.Tensor(0.07428253, shape=(), dtype=float32)
loss: tf.Tensor(0.011736047, shape=(), dtype=float32)
loss: tf.Tensor(0.023387194, shape=(), dtype=float32)
loss: tf.Tensor(0.044592425, shape=(), dtype=float32)
loss: tf.Tensor(0.014916949, shape=(), dtype=float32)
loss: tf.Tensor(0.05104167, shape=(), dtype=float32)
loss: tf.Tensor(0.02389462, shape=(), dtype=float32)
loss: tf.Tensor(0.031999223, shape=(), dtype=float32)
loss: tf.Tensor(0.013097933, shape=(), dtype=float32)
loss: tf.Tensor(0.017692726, shape=(), dtype=float32)
loss: tf.Tensor(0.011789244, shape=(), dtype=float32)
loss: tf.Tensor(9.750845e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7102135, shape=(), dtype=float32)
F1 SCORE:
0.8249669
EPOCH  40 #################################
loss: tf.Tensor(0.048490535, shape=(), dtype=float32)
loss: tf.Tensor(0.036567565, shape=(), dtype=float32)
loss: tf.Tensor(0.014704929, shape=(), dtype=float32)
loss: tf.Tensor(0.02752584, shape=(), dtype=float32)
loss: tf.Tensor(0.04107657, shape=(), dtype=float32)
loss: tf.Tensor(0.02187371, shape=(), dtype=float32)
loss: tf.Tensor(0.035957087, shape=(), dtype=float32)
loss: tf.Tensor(0.012139546, shape=(), dtype=float32)
loss: tf.Tensor(0.018784858, shape=(), dtype=float32)
loss: tf.Tensor(0.01025492, shape=(), dtype=float32)
loss: tf.Tensor(0.023642482, shape=(), dtype=float32)
loss: tf.Tensor(0.026743235, shape=(), dtype=float32)
loss: tf.Tensor(0.004379825, shape=(), dtype=float32)
loss: tf.Tensor(0.08757982, shape=(), dtype=float32)
loss: tf.Tensor(0.07114587, shape=(), dtype=float32)
loss: tf.Tensor(0.03135393, shape=(), dtype=float32)
loss: tf.Tensor(0.038061514, shape=(), dtype=float32)
loss: tf.Tensor(0.028257107, shape=(), dtype=float32)
loss: tf.Tensor(0.015134195, shape=(), dtype=float32)
loss: tf.Tensor(0.010393351, shape=(), dtype=float32)
loss: tf.Tensor(0.034375627, shape=(), dtype=float32)
loss: tf.Tensor(0.041997503, shape=(), dtype=float32)
loss: tf.Tensor(0.033966597, shape=(), dtype=float32)
loss: tf.Tensor(0.003045577, shape=(), dtype=float32)
loss: tf.Tensor(0.055257794, shape=(), dtype=float32)
loss: tf.Tensor(0.011755334, shape=(), dtype=float32)
loss: tf.Tensor(0.048546508, shape=(), dtype=float32)
loss: tf.Tensor(0.050942264, shape=(), dtype=float32)
loss: tf.Tensor(0.027904425, shape=(), dtype=float32)
loss: tf.Tensor(0.040657267, shape=(), dtype=float32)
loss: tf.Tensor(0.0077006244, shape=(), dtype=float32)
loss: tf.Tensor(0.041412033, shape=(), dtype=float32)
loss: tf.Tensor(0.06324821, shape=(), dtype=float32)
loss: tf.Tensor(0.043746486, shape=(), dtype=float32)
loss: tf.Tensor(0.031418532, shape=(), dtype=float32)
loss: tf.Tensor(0.013217871, shape=(), dtype=float32)
loss: tf.Tensor(0.035983864, shape=(), dtype=float32)
loss: tf.Tensor(0.0030720662, shape=(), dtype=float32)
loss: tf.Tensor(0.03705916, shape=(), dtype=float32)
loss: tf.Tensor(0.041229293, shape=(), dtype=float32)
loss: tf.Tensor(0.005659522, shape=(), dtype=float32)
loss: tf.Tensor(0.02194875, shape=(), dtype=float32)
loss: tf.Tensor(0.05652636, shape=(), dtype=float32)
loss: tf.Tensor(0.0081440145, shape=(), dtype=float32)
loss: tf.Tensor(0.071643345, shape=(), dtype=float32)
loss: tf.Tensor(0.04011922, shape=(), dtype=float32)
loss: tf.Tensor(0.056563634, shape=(), dtype=float32)
loss: tf.Tensor(0.023325, shape=(), dtype=float32)
loss: tf.Tensor(0.026861316, shape=(), dtype=float32)
loss: tf.Tensor(0.034938645, shape=(), dtype=float32)
loss: tf.Tensor(0.10805699, shape=(), dtype=float32)
loss: tf.Tensor(0.06893026, shape=(), dtype=float32)
loss: tf.Tensor(0.022500807, shape=(), dtype=float32)
loss: tf.Tensor(0.043780908, shape=(), dtype=float32)
loss: tf.Tensor(0.02825629, shape=(), dtype=float32)
loss: tf.Tensor(0.0069379015, shape=(), dtype=float32)
loss: tf.Tensor(0.0245062, shape=(), dtype=float32)
loss: tf.Tensor(0.03121662, shape=(), dtype=float32)
loss: tf.Tensor(0.022144182, shape=(), dtype=float32)
loss: tf.Tensor(0.004108187, shape=(), dtype=float32)
loss: tf.Tensor(0.023724547, shape=(), dtype=float32)
loss: tf.Tensor(0.013975847, shape=(), dtype=float32)
loss: tf.Tensor(0.03470915, shape=(), dtype=float32)
loss: tf.Tensor(0.0022838789, shape=(), dtype=float32)
loss: tf.Tensor(0.038706545, shape=(), dtype=float32)
loss: tf.Tensor(0.0060727214, shape=(), dtype=float32)
loss: tf.Tensor(0.018337285, shape=(), dtype=float32)
loss: tf.Tensor(0.021506047, shape=(), dtype=float32)
loss: tf.Tensor(0.0562571, shape=(), dtype=float32)
loss: tf.Tensor(0.010394294, shape=(), dtype=float32)
loss: tf.Tensor(0.0082770325, shape=(), dtype=float32)
loss: tf.Tensor(0.0154537475, shape=(), dtype=float32)
loss: tf.Tensor(0.009966002, shape=(), dtype=float32)
loss: tf.Tensor(0.040921744, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70817804, shape=(), dtype=float32)
F1 SCORE:
0.82467055
EPOCH  41 #################################
loss: tf.Tensor(0.0044723856, shape=(), dtype=float32)
loss: tf.Tensor(0.0024791192, shape=(), dtype=float32)
loss: tf.Tensor(0.050544314, shape=(), dtype=float32)
loss: tf.Tensor(0.040441018, shape=(), dtype=float32)
loss: tf.Tensor(0.076394156, shape=(), dtype=float32)
loss: tf.Tensor(0.012383339, shape=(), dtype=float32)
loss: tf.Tensor(0.0024571444, shape=(), dtype=float32)
loss: tf.Tensor(0.040991668, shape=(), dtype=float32)
loss: tf.Tensor(0.023023285, shape=(), dtype=float32)
loss: tf.Tensor(0.033041686, shape=(), dtype=float32)
loss: tf.Tensor(0.0065783923, shape=(), dtype=float32)
loss: tf.Tensor(0.05264292, shape=(), dtype=float32)
loss: tf.Tensor(0.047614627, shape=(), dtype=float32)
loss: tf.Tensor(0.04676235, shape=(), dtype=float32)
loss: tf.Tensor(0.010393513, shape=(), dtype=float32)
loss: tf.Tensor(0.027710548, shape=(), dtype=float32)
loss: tf.Tensor(0.029162815, shape=(), dtype=float32)
loss: tf.Tensor(0.05999241, shape=(), dtype=float32)
loss: tf.Tensor(0.023830447, shape=(), dtype=float32)
loss: tf.Tensor(0.119661495, shape=(), dtype=float32)
loss: tf.Tensor(0.021789493, shape=(), dtype=float32)
loss: tf.Tensor(0.0076104943, shape=(), dtype=float32)
loss: tf.Tensor(0.07565668, shape=(), dtype=float32)
loss: tf.Tensor(0.026318459, shape=(), dtype=float32)
loss: tf.Tensor(0.041566197, shape=(), dtype=float32)
loss: tf.Tensor(0.020940332, shape=(), dtype=float32)
loss: tf.Tensor(0.013280239, shape=(), dtype=float32)
loss: tf.Tensor(0.07731483, shape=(), dtype=float32)
loss: tf.Tensor(0.0023155122, shape=(), dtype=float32)
loss: tf.Tensor(0.009285205, shape=(), dtype=float32)
loss: tf.Tensor(0.011522207, shape=(), dtype=float32)
loss: tf.Tensor(0.016539304, shape=(), dtype=float32)
loss: tf.Tensor(0.03794377, shape=(), dtype=float32)
loss: tf.Tensor(0.04267528, shape=(), dtype=float32)
loss: tf.Tensor(0.0049797, shape=(), dtype=float32)
loss: tf.Tensor(0.029715337, shape=(), dtype=float32)
loss: tf.Tensor(0.011084417, shape=(), dtype=float32)
loss: tf.Tensor(0.045494113, shape=(), dtype=float32)
loss: tf.Tensor(0.0078111156, shape=(), dtype=float32)
loss: tf.Tensor(0.061997425, shape=(), dtype=float32)
loss: tf.Tensor(0.08711576, shape=(), dtype=float32)
loss: tf.Tensor(0.014113299, shape=(), dtype=float32)
loss: tf.Tensor(0.013183338, shape=(), dtype=float32)
loss: tf.Tensor(0.05414448, shape=(), dtype=float32)
loss: tf.Tensor(0.12065762, shape=(), dtype=float32)
loss: tf.Tensor(0.056351453, shape=(), dtype=float32)
loss: tf.Tensor(0.03008554, shape=(), dtype=float32)
loss: tf.Tensor(0.038716976, shape=(), dtype=float32)
loss: tf.Tensor(0.051205803, shape=(), dtype=float32)
loss: tf.Tensor(0.034545608, shape=(), dtype=float32)
loss: tf.Tensor(0.018312542, shape=(), dtype=float32)
loss: tf.Tensor(0.026979556, shape=(), dtype=float32)
loss: tf.Tensor(0.007833546, shape=(), dtype=float32)
loss: tf.Tensor(0.0623521, shape=(), dtype=float32)
loss: tf.Tensor(0.03222729, shape=(), dtype=float32)
loss: tf.Tensor(0.059081815, shape=(), dtype=float32)
loss: tf.Tensor(0.0077869557, shape=(), dtype=float32)
loss: tf.Tensor(0.037226204, shape=(), dtype=float32)
loss: tf.Tensor(0.03493627, shape=(), dtype=float32)
loss: tf.Tensor(0.033411745, shape=(), dtype=float32)
loss: tf.Tensor(0.01928668, shape=(), dtype=float32)
loss: tf.Tensor(0.024461703, shape=(), dtype=float32)
loss: tf.Tensor(0.06620616, shape=(), dtype=float32)
loss: tf.Tensor(0.013108433, shape=(), dtype=float32)
loss: tf.Tensor(0.0121574905, shape=(), dtype=float32)
loss: tf.Tensor(0.02485434, shape=(), dtype=float32)
loss: tf.Tensor(0.07157257, shape=(), dtype=float32)
loss: tf.Tensor(0.026771443, shape=(), dtype=float32)
loss: tf.Tensor(0.027645716, shape=(), dtype=float32)
loss: tf.Tensor(0.055201694, shape=(), dtype=float32)
loss: tf.Tensor(0.033656184, shape=(), dtype=float32)
loss: tf.Tensor(0.0049855695, shape=(), dtype=float32)
loss: tf.Tensor(0.023355924, shape=(), dtype=float32)
loss: tf.Tensor(0.002626543, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6972663, shape=(), dtype=float32)
F1 SCORE:
0.82478017
EPOCH  42 #################################
loss: tf.Tensor(0.0027605137, shape=(), dtype=float32)
loss: tf.Tensor(0.013454382, shape=(), dtype=float32)
loss: tf.Tensor(0.028518312, shape=(), dtype=float32)
loss: tf.Tensor(0.018961713, shape=(), dtype=float32)
loss: tf.Tensor(0.011430468, shape=(), dtype=float32)
loss: tf.Tensor(0.04920372, shape=(), dtype=float32)
loss: tf.Tensor(0.020382704, shape=(), dtype=float32)
loss: tf.Tensor(0.019925967, shape=(), dtype=float32)
loss: tf.Tensor(0.0033704997, shape=(), dtype=float32)
loss: tf.Tensor(0.025919463, shape=(), dtype=float32)
loss: tf.Tensor(0.04738151, shape=(), dtype=float32)
loss: tf.Tensor(0.025403867, shape=(), dtype=float32)
loss: tf.Tensor(0.0056912885, shape=(), dtype=float32)
loss: tf.Tensor(0.029046876, shape=(), dtype=float32)
loss: tf.Tensor(0.010233529, shape=(), dtype=float32)
loss: tf.Tensor(0.030117607, shape=(), dtype=float32)
loss: tf.Tensor(0.025047166, shape=(), dtype=float32)
loss: tf.Tensor(0.10974315, shape=(), dtype=float32)
loss: tf.Tensor(0.01656769, shape=(), dtype=float32)
loss: tf.Tensor(0.039369192, shape=(), dtype=float32)
loss: tf.Tensor(0.047189668, shape=(), dtype=float32)
loss: tf.Tensor(0.08108196, shape=(), dtype=float32)
loss: tf.Tensor(0.06865979, shape=(), dtype=float32)
loss: tf.Tensor(0.0056186495, shape=(), dtype=float32)
loss: tf.Tensor(0.031574473, shape=(), dtype=float32)
loss: tf.Tensor(0.15065107, shape=(), dtype=float32)
loss: tf.Tensor(0.021595662, shape=(), dtype=float32)
loss: tf.Tensor(0.0698451, shape=(), dtype=float32)
loss: tf.Tensor(0.015432327, shape=(), dtype=float32)
loss: tf.Tensor(0.018941678, shape=(), dtype=float32)
loss: tf.Tensor(0.08256326, shape=(), dtype=float32)
loss: tf.Tensor(0.026998896, shape=(), dtype=float32)
loss: tf.Tensor(0.020384902, shape=(), dtype=float32)
loss: tf.Tensor(0.049058672, shape=(), dtype=float32)
loss: tf.Tensor(0.033962656, shape=(), dtype=float32)
loss: tf.Tensor(0.04605222, shape=(), dtype=float32)
loss: tf.Tensor(0.03313805, shape=(), dtype=float32)
loss: tf.Tensor(0.013758578, shape=(), dtype=float32)
loss: tf.Tensor(0.07384142, shape=(), dtype=float32)
loss: tf.Tensor(0.018826263, shape=(), dtype=float32)
loss: tf.Tensor(0.036837947, shape=(), dtype=float32)
loss: tf.Tensor(0.011236402, shape=(), dtype=float32)
loss: tf.Tensor(0.0138376355, shape=(), dtype=float32)
loss: tf.Tensor(0.028233994, shape=(), dtype=float32)
loss: tf.Tensor(0.00903576, shape=(), dtype=float32)
loss: tf.Tensor(0.029956913, shape=(), dtype=float32)
loss: tf.Tensor(0.008660939, shape=(), dtype=float32)
loss: tf.Tensor(0.020992545, shape=(), dtype=float32)
loss: tf.Tensor(0.016325045, shape=(), dtype=float32)
loss: tf.Tensor(0.069417104, shape=(), dtype=float32)
loss: tf.Tensor(0.028481858, shape=(), dtype=float32)
loss: tf.Tensor(0.022375345, shape=(), dtype=float32)
loss: tf.Tensor(0.018498862, shape=(), dtype=float32)
loss: tf.Tensor(0.040740684, shape=(), dtype=float32)
loss: tf.Tensor(0.007840007, shape=(), dtype=float32)
loss: tf.Tensor(0.0071127648, shape=(), dtype=float32)
loss: tf.Tensor(0.038419183, shape=(), dtype=float32)
loss: tf.Tensor(0.04176633, shape=(), dtype=float32)
loss: tf.Tensor(0.016946837, shape=(), dtype=float32)
loss: tf.Tensor(0.027790692, shape=(), dtype=float32)
loss: tf.Tensor(0.031279624, shape=(), dtype=float32)
loss: tf.Tensor(0.010696497, shape=(), dtype=float32)
loss: tf.Tensor(0.011652856, shape=(), dtype=float32)
loss: tf.Tensor(0.030896306, shape=(), dtype=float32)
loss: tf.Tensor(0.024559753, shape=(), dtype=float32)
loss: tf.Tensor(0.048272446, shape=(), dtype=float32)
loss: tf.Tensor(0.012297516, shape=(), dtype=float32)
loss: tf.Tensor(0.010624646, shape=(), dtype=float32)
loss: tf.Tensor(0.019679211, shape=(), dtype=float32)
loss: tf.Tensor(0.011843001, shape=(), dtype=float32)
loss: tf.Tensor(0.004841391, shape=(), dtype=float32)
loss: tf.Tensor(0.03563225, shape=(), dtype=float32)
loss: tf.Tensor(0.09169816, shape=(), dtype=float32)
loss: tf.Tensor(3.4689303e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7103259, shape=(), dtype=float32)
F1 SCORE:
0.824599
EPOCH  43 #################################
loss: tf.Tensor(0.031706404, shape=(), dtype=float32)
loss: tf.Tensor(0.005032244, shape=(), dtype=float32)
loss: tf.Tensor(0.0051286113, shape=(), dtype=float32)
loss: tf.Tensor(0.019021463, shape=(), dtype=float32)
loss: tf.Tensor(0.014514285, shape=(), dtype=float32)
loss: tf.Tensor(0.032727774, shape=(), dtype=float32)
loss: tf.Tensor(0.030821213, shape=(), dtype=float32)
loss: tf.Tensor(0.0034540305, shape=(), dtype=float32)
loss: tf.Tensor(0.029308982, shape=(), dtype=float32)
loss: tf.Tensor(0.08146794, shape=(), dtype=float32)
loss: tf.Tensor(0.09529123, shape=(), dtype=float32)
loss: tf.Tensor(0.023981381, shape=(), dtype=float32)
loss: tf.Tensor(0.01406228, shape=(), dtype=float32)
loss: tf.Tensor(0.034409214, shape=(), dtype=float32)
loss: tf.Tensor(0.02846963, shape=(), dtype=float32)
loss: tf.Tensor(0.05754231, shape=(), dtype=float32)
loss: tf.Tensor(0.015724424, shape=(), dtype=float32)
loss: tf.Tensor(0.010693475, shape=(), dtype=float32)
loss: tf.Tensor(0.016314749, shape=(), dtype=float32)
loss: tf.Tensor(0.0142477425, shape=(), dtype=float32)
loss: tf.Tensor(0.008692668, shape=(), dtype=float32)
loss: tf.Tensor(0.01774583, shape=(), dtype=float32)
loss: tf.Tensor(0.028959898, shape=(), dtype=float32)
loss: tf.Tensor(0.007772794, shape=(), dtype=float32)
loss: tf.Tensor(0.004520451, shape=(), dtype=float32)
loss: tf.Tensor(0.06266638, shape=(), dtype=float32)
loss: tf.Tensor(0.010318442, shape=(), dtype=float32)
loss: tf.Tensor(0.020718943, shape=(), dtype=float32)
loss: tf.Tensor(0.010684205, shape=(), dtype=float32)
loss: tf.Tensor(0.008130279, shape=(), dtype=float32)
loss: tf.Tensor(0.010365902, shape=(), dtype=float32)
loss: tf.Tensor(0.009456279, shape=(), dtype=float32)
loss: tf.Tensor(0.056684736, shape=(), dtype=float32)
loss: tf.Tensor(0.05916796, shape=(), dtype=float32)
loss: tf.Tensor(0.004717531, shape=(), dtype=float32)
loss: tf.Tensor(0.006849095, shape=(), dtype=float32)
loss: tf.Tensor(0.031231128, shape=(), dtype=float32)
loss: tf.Tensor(0.013903249, shape=(), dtype=float32)
loss: tf.Tensor(0.016849842, shape=(), dtype=float32)
loss: tf.Tensor(0.019904858, shape=(), dtype=float32)
loss: tf.Tensor(0.024558311, shape=(), dtype=float32)
loss: tf.Tensor(0.035332955, shape=(), dtype=float32)
loss: tf.Tensor(0.012446858, shape=(), dtype=float32)
loss: tf.Tensor(0.03365316, shape=(), dtype=float32)
loss: tf.Tensor(0.035468165, shape=(), dtype=float32)
loss: tf.Tensor(0.039948754, shape=(), dtype=float32)
loss: tf.Tensor(0.13889065, shape=(), dtype=float32)
loss: tf.Tensor(0.028291177, shape=(), dtype=float32)
loss: tf.Tensor(0.016925072, shape=(), dtype=float32)
loss: tf.Tensor(0.049568895, shape=(), dtype=float32)
loss: tf.Tensor(0.02253913, shape=(), dtype=float32)
loss: tf.Tensor(0.020208187, shape=(), dtype=float32)
loss: tf.Tensor(0.025564296, shape=(), dtype=float32)
loss: tf.Tensor(0.03419666, shape=(), dtype=float32)
loss: tf.Tensor(0.06747314, shape=(), dtype=float32)
loss: tf.Tensor(0.038472086, shape=(), dtype=float32)
loss: tf.Tensor(0.048777398, shape=(), dtype=float32)
loss: tf.Tensor(0.0136144385, shape=(), dtype=float32)
loss: tf.Tensor(0.017906403, shape=(), dtype=float32)
loss: tf.Tensor(0.06423888, shape=(), dtype=float32)
loss: tf.Tensor(0.030089593, shape=(), dtype=float32)
loss: tf.Tensor(0.018574199, shape=(), dtype=float32)
loss: tf.Tensor(0.010556778, shape=(), dtype=float32)
loss: tf.Tensor(0.09128861, shape=(), dtype=float32)
loss: tf.Tensor(0.009001689, shape=(), dtype=float32)
loss: tf.Tensor(0.08716588, shape=(), dtype=float32)
loss: tf.Tensor(0.099498294, shape=(), dtype=float32)
loss: tf.Tensor(0.07372615, shape=(), dtype=float32)
loss: tf.Tensor(0.022268744, shape=(), dtype=float32)
loss: tf.Tensor(0.015189767, shape=(), dtype=float32)
loss: tf.Tensor(0.078801386, shape=(), dtype=float32)
loss: tf.Tensor(0.01366103, shape=(), dtype=float32)
loss: tf.Tensor(0.042886984, shape=(), dtype=float32)
loss: tf.Tensor(3.2186456e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.706734, shape=(), dtype=float32)
F1 SCORE:
0.82452124
EPOCH  44 #################################
loss: tf.Tensor(0.028072689, shape=(), dtype=float32)
loss: tf.Tensor(0.007432787, shape=(), dtype=float32)
loss: tf.Tensor(0.014070492, shape=(), dtype=float32)
loss: tf.Tensor(0.011929479, shape=(), dtype=float32)
loss: tf.Tensor(0.005122362, shape=(), dtype=float32)
loss: tf.Tensor(0.04741456, shape=(), dtype=float32)
loss: tf.Tensor(0.055373203, shape=(), dtype=float32)
loss: tf.Tensor(0.025463488, shape=(), dtype=float32)
loss: tf.Tensor(0.007918397, shape=(), dtype=float32)
loss: tf.Tensor(0.009111264, shape=(), dtype=float32)
loss: tf.Tensor(0.07516464, shape=(), dtype=float32)
loss: tf.Tensor(0.025060399, shape=(), dtype=float32)
loss: tf.Tensor(0.027949762, shape=(), dtype=float32)
loss: tf.Tensor(0.025591485, shape=(), dtype=float32)
loss: tf.Tensor(0.041718725, shape=(), dtype=float32)
loss: tf.Tensor(0.04983519, shape=(), dtype=float32)
loss: tf.Tensor(0.008852551, shape=(), dtype=float32)
loss: tf.Tensor(0.030052707, shape=(), dtype=float32)
loss: tf.Tensor(0.021527126, shape=(), dtype=float32)
loss: tf.Tensor(0.015494768, shape=(), dtype=float32)
loss: tf.Tensor(0.0070159715, shape=(), dtype=float32)
loss: tf.Tensor(0.012210556, shape=(), dtype=float32)
loss: tf.Tensor(0.028603492, shape=(), dtype=float32)
loss: tf.Tensor(0.019632513, shape=(), dtype=float32)
loss: tf.Tensor(0.075265564, shape=(), dtype=float32)
loss: tf.Tensor(0.032541215, shape=(), dtype=float32)
loss: tf.Tensor(0.10726925, shape=(), dtype=float32)
loss: tf.Tensor(0.022977853, shape=(), dtype=float32)
loss: tf.Tensor(0.027221901, shape=(), dtype=float32)
loss: tf.Tensor(0.016165398, shape=(), dtype=float32)
loss: tf.Tensor(0.010563176, shape=(), dtype=float32)
loss: tf.Tensor(0.013064967, shape=(), dtype=float32)
loss: tf.Tensor(0.019251905, shape=(), dtype=float32)
loss: tf.Tensor(0.023398586, shape=(), dtype=float32)
loss: tf.Tensor(0.008012554, shape=(), dtype=float32)
loss: tf.Tensor(0.019205773, shape=(), dtype=float32)
loss: tf.Tensor(0.033045642, shape=(), dtype=float32)
loss: tf.Tensor(0.020820796, shape=(), dtype=float32)
loss: tf.Tensor(0.03408968, shape=(), dtype=float32)
loss: tf.Tensor(0.013495659, shape=(), dtype=float32)
loss: tf.Tensor(0.0076067043, shape=(), dtype=float32)
loss: tf.Tensor(0.014429815, shape=(), dtype=float32)
loss: tf.Tensor(0.010015016, shape=(), dtype=float32)
loss: tf.Tensor(0.02199667, shape=(), dtype=float32)
loss: tf.Tensor(0.018562775, shape=(), dtype=float32)
loss: tf.Tensor(0.011024373, shape=(), dtype=float32)
loss: tf.Tensor(0.02557891, shape=(), dtype=float32)
loss: tf.Tensor(0.011318082, shape=(), dtype=float32)
loss: tf.Tensor(0.004598379, shape=(), dtype=float32)
loss: tf.Tensor(0.0033266898, shape=(), dtype=float32)
loss: tf.Tensor(0.03606262, shape=(), dtype=float32)
loss: tf.Tensor(0.0028394873, shape=(), dtype=float32)
loss: tf.Tensor(0.014839569, shape=(), dtype=float32)
loss: tf.Tensor(0.014616627, shape=(), dtype=float32)
loss: tf.Tensor(0.0032317722, shape=(), dtype=float32)
loss: tf.Tensor(0.06211442, shape=(), dtype=float32)
loss: tf.Tensor(0.036932375, shape=(), dtype=float32)
loss: tf.Tensor(0.023210458, shape=(), dtype=float32)
loss: tf.Tensor(0.002768397, shape=(), dtype=float32)
loss: tf.Tensor(0.011130232, shape=(), dtype=float32)
loss: tf.Tensor(0.030560449, shape=(), dtype=float32)
loss: tf.Tensor(0.006983448, shape=(), dtype=float32)
loss: tf.Tensor(0.052717105, shape=(), dtype=float32)
loss: tf.Tensor(0.022243831, shape=(), dtype=float32)
loss: tf.Tensor(0.011933281, shape=(), dtype=float32)
loss: tf.Tensor(0.044221994, shape=(), dtype=float32)
loss: tf.Tensor(0.004779389, shape=(), dtype=float32)
loss: tf.Tensor(0.054344937, shape=(), dtype=float32)
loss: tf.Tensor(0.00916217, shape=(), dtype=float32)
loss: tf.Tensor(0.01750821, shape=(), dtype=float32)
loss: tf.Tensor(0.007490371, shape=(), dtype=float32)
loss: tf.Tensor(0.0014625182, shape=(), dtype=float32)
loss: tf.Tensor(0.05814941, shape=(), dtype=float32)
loss: tf.Tensor(0.00070797175, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6947497, shape=(), dtype=float32)
F1 SCORE:
0.8245875
EPOCH  45 #################################
loss: tf.Tensor(0.01760996, shape=(), dtype=float32)
loss: tf.Tensor(0.008848953, shape=(), dtype=float32)
loss: tf.Tensor(0.009937176, shape=(), dtype=float32)
loss: tf.Tensor(0.004428642, shape=(), dtype=float32)
loss: tf.Tensor(0.012593592, shape=(), dtype=float32)
loss: tf.Tensor(0.0711237, shape=(), dtype=float32)
loss: tf.Tensor(0.009265049, shape=(), dtype=float32)
loss: tf.Tensor(0.03736556, shape=(), dtype=float32)
loss: tf.Tensor(0.021170627, shape=(), dtype=float32)
loss: tf.Tensor(0.011889121, shape=(), dtype=float32)
loss: tf.Tensor(0.04958676, shape=(), dtype=float32)
loss: tf.Tensor(0.023440659, shape=(), dtype=float32)
loss: tf.Tensor(0.030186601, shape=(), dtype=float32)
loss: tf.Tensor(0.006512793, shape=(), dtype=float32)
loss: tf.Tensor(0.019159183, shape=(), dtype=float32)
loss: tf.Tensor(0.016897246, shape=(), dtype=float32)
loss: tf.Tensor(0.05962728, shape=(), dtype=float32)
loss: tf.Tensor(0.048469402, shape=(), dtype=float32)
loss: tf.Tensor(0.00768028, shape=(), dtype=float32)
loss: tf.Tensor(0.01518559, shape=(), dtype=float32)
loss: tf.Tensor(0.026348572, shape=(), dtype=float32)
loss: tf.Tensor(0.016535074, shape=(), dtype=float32)
loss: tf.Tensor(0.04708402, shape=(), dtype=float32)
loss: tf.Tensor(0.014249128, shape=(), dtype=float32)
loss: tf.Tensor(0.07732532, shape=(), dtype=float32)
loss: tf.Tensor(0.0028558415, shape=(), dtype=float32)
loss: tf.Tensor(0.034635063, shape=(), dtype=float32)
loss: tf.Tensor(0.0054987683, shape=(), dtype=float32)
loss: tf.Tensor(0.009030865, shape=(), dtype=float32)
loss: tf.Tensor(0.04863144, shape=(), dtype=float32)
loss: tf.Tensor(0.008147901, shape=(), dtype=float32)
loss: tf.Tensor(0.023034746, shape=(), dtype=float32)
loss: tf.Tensor(0.017345844, shape=(), dtype=float32)
loss: tf.Tensor(0.04602598, shape=(), dtype=float32)
loss: tf.Tensor(0.015493895, shape=(), dtype=float32)
loss: tf.Tensor(0.037549745, shape=(), dtype=float32)
loss: tf.Tensor(0.027728265, shape=(), dtype=float32)
loss: tf.Tensor(0.0021412983, shape=(), dtype=float32)
loss: tf.Tensor(0.0048054825, shape=(), dtype=float32)
loss: tf.Tensor(0.007042153, shape=(), dtype=float32)
loss: tf.Tensor(0.025428925, shape=(), dtype=float32)
loss: tf.Tensor(0.014010881, shape=(), dtype=float32)
loss: tf.Tensor(0.011583388, shape=(), dtype=float32)
loss: tf.Tensor(0.013133748, shape=(), dtype=float32)
loss: tf.Tensor(0.026279, shape=(), dtype=float32)
loss: tf.Tensor(0.02057303, shape=(), dtype=float32)
loss: tf.Tensor(0.05918064, shape=(), dtype=float32)
loss: tf.Tensor(0.013090633, shape=(), dtype=float32)
loss: tf.Tensor(0.026075408, shape=(), dtype=float32)
loss: tf.Tensor(0.006724106, shape=(), dtype=float32)
loss: tf.Tensor(0.0034204368, shape=(), dtype=float32)
loss: tf.Tensor(0.02849413, shape=(), dtype=float32)
loss: tf.Tensor(0.040597558, shape=(), dtype=float32)
loss: tf.Tensor(0.027870255, shape=(), dtype=float32)
loss: tf.Tensor(0.0076199267, shape=(), dtype=float32)
loss: tf.Tensor(0.008724745, shape=(), dtype=float32)
loss: tf.Tensor(0.088522285, shape=(), dtype=float32)
loss: tf.Tensor(0.072180375, shape=(), dtype=float32)
loss: tf.Tensor(0.055582885, shape=(), dtype=float32)
loss: tf.Tensor(0.04241681, shape=(), dtype=float32)
loss: tf.Tensor(0.01696823, shape=(), dtype=float32)
loss: tf.Tensor(0.0018874843, shape=(), dtype=float32)
loss: tf.Tensor(0.0038410767, shape=(), dtype=float32)
loss: tf.Tensor(0.0072452314, shape=(), dtype=float32)
loss: tf.Tensor(0.019059097, shape=(), dtype=float32)
loss: tf.Tensor(0.009094327, shape=(), dtype=float32)
loss: tf.Tensor(0.097926214, shape=(), dtype=float32)
loss: tf.Tensor(0.0028395304, shape=(), dtype=float32)
loss: tf.Tensor(0.03595532, shape=(), dtype=float32)
loss: tf.Tensor(0.04330106, shape=(), dtype=float32)
loss: tf.Tensor(0.02416907, shape=(), dtype=float32)
loss: tf.Tensor(0.01608604, shape=(), dtype=float32)
loss: tf.Tensor(0.014770489, shape=(), dtype=float32)
loss: tf.Tensor(0.00055726734, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6989668, shape=(), dtype=float32)
F1 SCORE:
0.82473546
EPOCH  46 #################################
loss: tf.Tensor(0.03456128, shape=(), dtype=float32)
loss: tf.Tensor(0.057160262, shape=(), dtype=float32)
loss: tf.Tensor(0.068062276, shape=(), dtype=float32)
loss: tf.Tensor(0.00082816527, shape=(), dtype=float32)
loss: tf.Tensor(0.029289072, shape=(), dtype=float32)
loss: tf.Tensor(0.012739051, shape=(), dtype=float32)
loss: tf.Tensor(0.0052777845, shape=(), dtype=float32)
loss: tf.Tensor(0.010322154, shape=(), dtype=float32)
loss: tf.Tensor(0.0087193465, shape=(), dtype=float32)
loss: tf.Tensor(0.049204286, shape=(), dtype=float32)
loss: tf.Tensor(0.0243245, shape=(), dtype=float32)
loss: tf.Tensor(0.029994197, shape=(), dtype=float32)
loss: tf.Tensor(0.0036997613, shape=(), dtype=float32)
loss: tf.Tensor(0.0030554489, shape=(), dtype=float32)
loss: tf.Tensor(0.042246528, shape=(), dtype=float32)
loss: tf.Tensor(0.0071977433, shape=(), dtype=float32)
loss: tf.Tensor(0.0022331378, shape=(), dtype=float32)
loss: tf.Tensor(0.011521721, shape=(), dtype=float32)
loss: tf.Tensor(0.03993081, shape=(), dtype=float32)
loss: tf.Tensor(0.020292783, shape=(), dtype=float32)
loss: tf.Tensor(0.010519883, shape=(), dtype=float32)
loss: tf.Tensor(0.014352102, shape=(), dtype=float32)
loss: tf.Tensor(0.022926638, shape=(), dtype=float32)
loss: tf.Tensor(0.08080878, shape=(), dtype=float32)
loss: tf.Tensor(0.122657955, shape=(), dtype=float32)
loss: tf.Tensor(0.011495389, shape=(), dtype=float32)
loss: tf.Tensor(0.014197677, shape=(), dtype=float32)
loss: tf.Tensor(0.011512209, shape=(), dtype=float32)
loss: tf.Tensor(0.020866385, shape=(), dtype=float32)
loss: tf.Tensor(0.008997948, shape=(), dtype=float32)
loss: tf.Tensor(0.009046179, shape=(), dtype=float32)
loss: tf.Tensor(0.16993171, shape=(), dtype=float32)
loss: tf.Tensor(0.05341589, shape=(), dtype=float32)
loss: tf.Tensor(0.013763121, shape=(), dtype=float32)
loss: tf.Tensor(0.006674918, shape=(), dtype=float32)
loss: tf.Tensor(0.018386701, shape=(), dtype=float32)
loss: tf.Tensor(0.0060178232, shape=(), dtype=float32)
loss: tf.Tensor(0.075854756, shape=(), dtype=float32)
loss: tf.Tensor(0.050566703, shape=(), dtype=float32)
loss: tf.Tensor(0.02126283, shape=(), dtype=float32)
loss: tf.Tensor(0.06297909, shape=(), dtype=float32)
loss: tf.Tensor(0.0716661, shape=(), dtype=float32)
loss: tf.Tensor(0.05867648, shape=(), dtype=float32)
loss: tf.Tensor(0.010925965, shape=(), dtype=float32)
loss: tf.Tensor(0.05334643, shape=(), dtype=float32)
loss: tf.Tensor(0.013889045, shape=(), dtype=float32)
loss: tf.Tensor(0.0031363585, shape=(), dtype=float32)
loss: tf.Tensor(0.06356916, shape=(), dtype=float32)
loss: tf.Tensor(0.037243344, shape=(), dtype=float32)
loss: tf.Tensor(0.042572517, shape=(), dtype=float32)
loss: tf.Tensor(0.019427948, shape=(), dtype=float32)
loss: tf.Tensor(0.057421457, shape=(), dtype=float32)
loss: tf.Tensor(0.020382453, shape=(), dtype=float32)
loss: tf.Tensor(0.024455162, shape=(), dtype=float32)
loss: tf.Tensor(0.0038916513, shape=(), dtype=float32)
loss: tf.Tensor(0.032503124, shape=(), dtype=float32)
loss: tf.Tensor(0.02412801, shape=(), dtype=float32)
loss: tf.Tensor(0.03573735, shape=(), dtype=float32)
loss: tf.Tensor(0.020638373, shape=(), dtype=float32)
loss: tf.Tensor(0.032025248, shape=(), dtype=float32)
loss: tf.Tensor(0.008027639, shape=(), dtype=float32)
loss: tf.Tensor(0.026318386, shape=(), dtype=float32)
loss: tf.Tensor(0.032596074, shape=(), dtype=float32)
loss: tf.Tensor(0.009890381, shape=(), dtype=float32)
loss: tf.Tensor(0.037531927, shape=(), dtype=float32)
loss: tf.Tensor(0.012847733, shape=(), dtype=float32)
loss: tf.Tensor(0.004681227, shape=(), dtype=float32)
loss: tf.Tensor(0.008852115, shape=(), dtype=float32)
loss: tf.Tensor(0.044088174, shape=(), dtype=float32)
loss: tf.Tensor(0.06238541, shape=(), dtype=float32)
loss: tf.Tensor(0.057989813, shape=(), dtype=float32)
loss: tf.Tensor(0.04194354, shape=(), dtype=float32)
loss: tf.Tensor(0.0060201115, shape=(), dtype=float32)
loss: tf.Tensor(1.1920928e-07, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7021821, shape=(), dtype=float32)
F1 SCORE:
0.82469535
EPOCH  47 #################################
loss: tf.Tensor(0.00454127, shape=(), dtype=float32)
loss: tf.Tensor(0.012826914, shape=(), dtype=float32)
loss: tf.Tensor(0.03979601, shape=(), dtype=float32)
loss: tf.Tensor(0.0053433045, shape=(), dtype=float32)
loss: tf.Tensor(0.020483254, shape=(), dtype=float32)
loss: tf.Tensor(0.060242385, shape=(), dtype=float32)
loss: tf.Tensor(0.008831717, shape=(), dtype=float32)
loss: tf.Tensor(0.005408804, shape=(), dtype=float32)
loss: tf.Tensor(0.04393155, shape=(), dtype=float32)
loss: tf.Tensor(0.07962136, shape=(), dtype=float32)
loss: tf.Tensor(0.033263624, shape=(), dtype=float32)
loss: tf.Tensor(0.0051683807, shape=(), dtype=float32)
loss: tf.Tensor(0.063545994, shape=(), dtype=float32)
loss: tf.Tensor(0.024011282, shape=(), dtype=float32)
loss: tf.Tensor(0.014318025, shape=(), dtype=float32)
loss: tf.Tensor(0.011362873, shape=(), dtype=float32)
loss: tf.Tensor(0.0011911785, shape=(), dtype=float32)
loss: tf.Tensor(0.035422057, shape=(), dtype=float32)
loss: tf.Tensor(0.014737248, shape=(), dtype=float32)
loss: tf.Tensor(0.0044445805, shape=(), dtype=float32)
loss: tf.Tensor(0.03668121, shape=(), dtype=float32)
loss: tf.Tensor(0.017959917, shape=(), dtype=float32)
loss: tf.Tensor(0.01569543, shape=(), dtype=float32)
loss: tf.Tensor(0.0042077135, shape=(), dtype=float32)
loss: tf.Tensor(0.038368143, shape=(), dtype=float32)
loss: tf.Tensor(0.004482038, shape=(), dtype=float32)
loss: tf.Tensor(0.01101341, shape=(), dtype=float32)
loss: tf.Tensor(0.0034479597, shape=(), dtype=float32)
loss: tf.Tensor(0.013339822, shape=(), dtype=float32)
loss: tf.Tensor(0.024639962, shape=(), dtype=float32)
loss: tf.Tensor(0.0047340887, shape=(), dtype=float32)
loss: tf.Tensor(0.0014152416, shape=(), dtype=float32)
loss: tf.Tensor(0.08997705, shape=(), dtype=float32)
loss: tf.Tensor(0.033745393, shape=(), dtype=float32)
loss: tf.Tensor(0.00920819, shape=(), dtype=float32)
loss: tf.Tensor(0.011725891, shape=(), dtype=float32)
loss: tf.Tensor(0.029972313, shape=(), dtype=float32)
loss: tf.Tensor(0.03835589, shape=(), dtype=float32)
loss: tf.Tensor(0.01060381, shape=(), dtype=float32)
loss: tf.Tensor(0.013549365, shape=(), dtype=float32)
loss: tf.Tensor(0.028890446, shape=(), dtype=float32)
loss: tf.Tensor(0.018585876, shape=(), dtype=float32)
loss: tf.Tensor(0.05468728, shape=(), dtype=float32)
loss: tf.Tensor(0.022584807, shape=(), dtype=float32)
loss: tf.Tensor(0.0072174356, shape=(), dtype=float32)
loss: tf.Tensor(0.072011255, shape=(), dtype=float32)
loss: tf.Tensor(0.0461386, shape=(), dtype=float32)
loss: tf.Tensor(0.002285394, shape=(), dtype=float32)
loss: tf.Tensor(0.0048873946, shape=(), dtype=float32)
loss: tf.Tensor(0.026459267, shape=(), dtype=float32)
loss: tf.Tensor(0.038606174, shape=(), dtype=float32)
loss: tf.Tensor(0.019147731, shape=(), dtype=float32)
loss: tf.Tensor(0.0052450015, shape=(), dtype=float32)
loss: tf.Tensor(0.031499736, shape=(), dtype=float32)
loss: tf.Tensor(0.0018879303, shape=(), dtype=float32)
loss: tf.Tensor(0.0015642843, shape=(), dtype=float32)
loss: tf.Tensor(0.027821984, shape=(), dtype=float32)
loss: tf.Tensor(0.020362504, shape=(), dtype=float32)
loss: tf.Tensor(0.01685127, shape=(), dtype=float32)
loss: tf.Tensor(0.006758465, shape=(), dtype=float32)
loss: tf.Tensor(0.0048072315, shape=(), dtype=float32)
loss: tf.Tensor(0.023633204, shape=(), dtype=float32)
loss: tf.Tensor(0.036140945, shape=(), dtype=float32)
loss: tf.Tensor(0.0015176238, shape=(), dtype=float32)
loss: tf.Tensor(0.004171032, shape=(), dtype=float32)
loss: tf.Tensor(0.013429913, shape=(), dtype=float32)
loss: tf.Tensor(0.025560586, shape=(), dtype=float32)
loss: tf.Tensor(0.018681554, shape=(), dtype=float32)
loss: tf.Tensor(0.15003122, shape=(), dtype=float32)
loss: tf.Tensor(0.051471382, shape=(), dtype=float32)
loss: tf.Tensor(0.030518848, shape=(), dtype=float32)
loss: tf.Tensor(0.0024594124, shape=(), dtype=float32)
loss: tf.Tensor(0.010676913, shape=(), dtype=float32)
loss: tf.Tensor(0.008630004, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69727266, shape=(), dtype=float32)
F1 SCORE:
0.8248296
EPOCH  48 #################################
loss: tf.Tensor(0.013922416, shape=(), dtype=float32)
loss: tf.Tensor(0.011978622, shape=(), dtype=float32)
loss: tf.Tensor(0.013314405, shape=(), dtype=float32)
loss: tf.Tensor(0.014509281, shape=(), dtype=float32)
loss: tf.Tensor(0.0044583348, shape=(), dtype=float32)
loss: tf.Tensor(0.042669784, shape=(), dtype=float32)
loss: tf.Tensor(0.0029581815, shape=(), dtype=float32)
loss: tf.Tensor(0.005303232, shape=(), dtype=float32)
loss: tf.Tensor(0.015576023, shape=(), dtype=float32)
loss: tf.Tensor(0.024699483, shape=(), dtype=float32)
loss: tf.Tensor(0.085607365, shape=(), dtype=float32)
loss: tf.Tensor(0.015228718, shape=(), dtype=float32)
loss: tf.Tensor(0.047181364, shape=(), dtype=float32)
loss: tf.Tensor(0.0075446605, shape=(), dtype=float32)
loss: tf.Tensor(0.0073864395, shape=(), dtype=float32)
loss: tf.Tensor(0.005705318, shape=(), dtype=float32)
loss: tf.Tensor(0.021277072, shape=(), dtype=float32)
loss: tf.Tensor(0.019240934, shape=(), dtype=float32)
loss: tf.Tensor(0.013151714, shape=(), dtype=float32)
loss: tf.Tensor(0.019215045, shape=(), dtype=float32)
loss: tf.Tensor(0.004995399, shape=(), dtype=float32)
loss: tf.Tensor(0.030454528, shape=(), dtype=float32)
loss: tf.Tensor(0.046641372, shape=(), dtype=float32)
loss: tf.Tensor(0.006437564, shape=(), dtype=float32)
loss: tf.Tensor(0.013307679, shape=(), dtype=float32)
loss: tf.Tensor(0.03808441, shape=(), dtype=float32)
loss: tf.Tensor(0.013483916, shape=(), dtype=float32)
loss: tf.Tensor(0.036643382, shape=(), dtype=float32)
loss: tf.Tensor(0.03382182, shape=(), dtype=float32)
loss: tf.Tensor(0.019836947, shape=(), dtype=float32)
loss: tf.Tensor(0.062178887, shape=(), dtype=float32)
loss: tf.Tensor(0.007648671, shape=(), dtype=float32)
loss: tf.Tensor(0.014468615, shape=(), dtype=float32)
loss: tf.Tensor(0.017747339, shape=(), dtype=float32)
loss: tf.Tensor(0.013625567, shape=(), dtype=float32)
loss: tf.Tensor(0.0013166231, shape=(), dtype=float32)
loss: tf.Tensor(0.003327239, shape=(), dtype=float32)
loss: tf.Tensor(0.03043753, shape=(), dtype=float32)
loss: tf.Tensor(0.049186416, shape=(), dtype=float32)
loss: tf.Tensor(0.017740708, shape=(), dtype=float32)
loss: tf.Tensor(0.011849468, shape=(), dtype=float32)
loss: tf.Tensor(0.009184177, shape=(), dtype=float32)
loss: tf.Tensor(0.008219362, shape=(), dtype=float32)
loss: tf.Tensor(0.061193734, shape=(), dtype=float32)
loss: tf.Tensor(0.10473154, shape=(), dtype=float32)
loss: tf.Tensor(0.013861222, shape=(), dtype=float32)
loss: tf.Tensor(0.015988525, shape=(), dtype=float32)
loss: tf.Tensor(0.003818146, shape=(), dtype=float32)
loss: tf.Tensor(0.0054438557, shape=(), dtype=float32)
loss: tf.Tensor(0.007405502, shape=(), dtype=float32)
loss: tf.Tensor(0.017884273, shape=(), dtype=float32)
loss: tf.Tensor(0.13381404, shape=(), dtype=float32)
loss: tf.Tensor(0.017229473, shape=(), dtype=float32)
loss: tf.Tensor(0.019313509, shape=(), dtype=float32)
loss: tf.Tensor(0.029897071, shape=(), dtype=float32)
loss: tf.Tensor(0.03520222, shape=(), dtype=float32)
loss: tf.Tensor(0.015788468, shape=(), dtype=float32)
loss: tf.Tensor(0.007600865, shape=(), dtype=float32)
loss: tf.Tensor(0.0091467975, shape=(), dtype=float32)
loss: tf.Tensor(0.017041925, shape=(), dtype=float32)
loss: tf.Tensor(0.047541462, shape=(), dtype=float32)
loss: tf.Tensor(0.015790062, shape=(), dtype=float32)
loss: tf.Tensor(0.035784706, shape=(), dtype=float32)
loss: tf.Tensor(0.039543778, shape=(), dtype=float32)
loss: tf.Tensor(0.043898094, shape=(), dtype=float32)
loss: tf.Tensor(0.0066399854, shape=(), dtype=float32)
loss: tf.Tensor(0.005701024, shape=(), dtype=float32)
loss: tf.Tensor(0.017318932, shape=(), dtype=float32)
loss: tf.Tensor(0.027764456, shape=(), dtype=float32)
loss: tf.Tensor(0.03620592, shape=(), dtype=float32)
loss: tf.Tensor(0.032646127, shape=(), dtype=float32)
loss: tf.Tensor(0.0034815294, shape=(), dtype=float32)
loss: tf.Tensor(0.0022680177, shape=(), dtype=float32)
loss: tf.Tensor(7.8079036e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6966947, shape=(), dtype=float32)
F1 SCORE:
0.82497054
EPOCH  49 #################################
loss: tf.Tensor(0.016619205, shape=(), dtype=float32)
loss: tf.Tensor(0.009923628, shape=(), dtype=float32)
loss: tf.Tensor(0.012023857, shape=(), dtype=float32)
loss: tf.Tensor(0.009839499, shape=(), dtype=float32)
loss: tf.Tensor(0.0065288646, shape=(), dtype=float32)
loss: tf.Tensor(0.01621194, shape=(), dtype=float32)
loss: tf.Tensor(0.018995304, shape=(), dtype=float32)
loss: tf.Tensor(0.012628268, shape=(), dtype=float32)
loss: tf.Tensor(0.042828336, shape=(), dtype=float32)
loss: tf.Tensor(0.022486867, shape=(), dtype=float32)
loss: tf.Tensor(0.008519661, shape=(), dtype=float32)
loss: tf.Tensor(0.02759592, shape=(), dtype=float32)
loss: tf.Tensor(0.013456541, shape=(), dtype=float32)
loss: tf.Tensor(0.015487281, shape=(), dtype=float32)
loss: tf.Tensor(0.00094073004, shape=(), dtype=float32)
loss: tf.Tensor(0.02710798, shape=(), dtype=float32)
loss: tf.Tensor(0.069378905, shape=(), dtype=float32)
loss: tf.Tensor(0.024967987, shape=(), dtype=float32)
loss: tf.Tensor(0.021044398, shape=(), dtype=float32)
loss: tf.Tensor(0.008803688, shape=(), dtype=float32)
loss: tf.Tensor(0.02506555, shape=(), dtype=float32)
loss: tf.Tensor(0.019769339, shape=(), dtype=float32)
loss: tf.Tensor(0.0066933986, shape=(), dtype=float32)
loss: tf.Tensor(0.025003018, shape=(), dtype=float32)
loss: tf.Tensor(0.029085582, shape=(), dtype=float32)
loss: tf.Tensor(0.010639182, shape=(), dtype=float32)
loss: tf.Tensor(0.032200053, shape=(), dtype=float32)
loss: tf.Tensor(0.022710733, shape=(), dtype=float32)
loss: tf.Tensor(0.021479823, shape=(), dtype=float32)
loss: tf.Tensor(0.045269027, shape=(), dtype=float32)
loss: tf.Tensor(0.0011229378, shape=(), dtype=float32)
loss: tf.Tensor(0.014619979, shape=(), dtype=float32)
loss: tf.Tensor(0.005390151, shape=(), dtype=float32)
loss: tf.Tensor(0.012302583, shape=(), dtype=float32)
loss: tf.Tensor(0.02684889, shape=(), dtype=float32)
loss: tf.Tensor(0.024363237, shape=(), dtype=float32)
loss: tf.Tensor(0.031026358, shape=(), dtype=float32)
loss: tf.Tensor(0.014505411, shape=(), dtype=float32)
loss: tf.Tensor(0.011765483, shape=(), dtype=float32)
loss: tf.Tensor(0.022132406, shape=(), dtype=float32)
loss: tf.Tensor(0.01933527, shape=(), dtype=float32)
loss: tf.Tensor(0.0012029547, shape=(), dtype=float32)
loss: tf.Tensor(0.022074662, shape=(), dtype=float32)
loss: tf.Tensor(0.008889265, shape=(), dtype=float32)
loss: tf.Tensor(0.03381814, shape=(), dtype=float32)
loss: tf.Tensor(0.007837162, shape=(), dtype=float32)
loss: tf.Tensor(0.043592777, shape=(), dtype=float32)
loss: tf.Tensor(0.0035619484, shape=(), dtype=float32)
loss: tf.Tensor(0.0035092472, shape=(), dtype=float32)
loss: tf.Tensor(0.008555531, shape=(), dtype=float32)
loss: tf.Tensor(0.07475628, shape=(), dtype=float32)
loss: tf.Tensor(0.02860279, shape=(), dtype=float32)
loss: tf.Tensor(0.032283362, shape=(), dtype=float32)
loss: tf.Tensor(0.016874256, shape=(), dtype=float32)
loss: tf.Tensor(0.022597894, shape=(), dtype=float32)
loss: tf.Tensor(0.042603455, shape=(), dtype=float32)
loss: tf.Tensor(0.0019907798, shape=(), dtype=float32)
loss: tf.Tensor(0.0021060156, shape=(), dtype=float32)
loss: tf.Tensor(0.003225532, shape=(), dtype=float32)
loss: tf.Tensor(0.0032800294, shape=(), dtype=float32)
loss: tf.Tensor(0.025332794, shape=(), dtype=float32)
loss: tf.Tensor(0.027337298, shape=(), dtype=float32)
loss: tf.Tensor(0.057605505, shape=(), dtype=float32)
loss: tf.Tensor(0.018024025, shape=(), dtype=float32)
loss: tf.Tensor(0.05722575, shape=(), dtype=float32)
loss: tf.Tensor(0.0187781, shape=(), dtype=float32)
loss: tf.Tensor(0.08302546, shape=(), dtype=float32)
loss: tf.Tensor(0.008199814, shape=(), dtype=float32)
loss: tf.Tensor(0.13812381, shape=(), dtype=float32)
loss: tf.Tensor(0.066093266, shape=(), dtype=float32)
loss: tf.Tensor(0.01608866, shape=(), dtype=float32)
loss: tf.Tensor(0.07495448, shape=(), dtype=float32)
loss: tf.Tensor(0.054580957, shape=(), dtype=float32)
loss: tf.Tensor(0.00022027451, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f23397efbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6940088, shape=(), dtype=float32)
F1 SCORE:
0.82523674
