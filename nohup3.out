2021-02-24 08:40:11.481672: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-02-24 08:40:11.481716: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
LOADING DICO FINI
1000 edges added on 111397   --------   1 % 
2000 edges added on 111397   --------   2 % 
3000 edges added on 111397   --------   3 % 
4000 edges added on 111397   --------   4 % 
5000 edges added on 111397   --------   4 % 
6000 edges added on 111397   --------   5 % 
7000 edges added on 111397   --------   6 % 
8000 edges added on 111397   --------   7 % 
9000 edges added on 111397   --------   8 % 
10000 edges added on 111397   --------   9 % 
11000 edges added on 111397   --------   10 % 
12000 edges added on 111397   --------   11 % 
13000 edges added on 111397   --------   12 % 
14000 edges added on 111397   --------   13 % 
15000 edges added on 111397   --------   13 % 
16000 edges added on 111397   --------   14 % 
17000 edges added on 111397   --------   15 % 
18000 edges added on 111397   --------   16 % 
19000 edges added on 111397   --------   17 % 
20000 edges added on 111397   --------   18 % 
21000 edges added on 111397   --------   19 % 
22000 edges added on 111397   --------   20 % 
23000 edges added on 111397   --------   21 % 
24000 edges added on 111397   --------   22 % 
25000 edges added on 111397   --------   22 % 
26000 edges added on 111397   --------   23 % 
27000 edges added on 111397   --------   24 % 
28000 edges added on 111397   --------   25 % 
29000 edges added on 111397   --------   26 % 
30000 edges added on 111397   --------   27 % 
31000 edges added on 111397   --------   28 % 
32000 edges added on 111397   --------   29 % 
33000 edges added on 111397   --------   30 % 
34000 edges added on 111397   --------   31 % 
35000 edges added on 111397   --------   31 % 
36000 edges added on 111397   --------   32 % 
37000 edges added on 111397   --------   33 % 
38000 edges added on 111397   --------   34 % 
39000 edges added on 111397   --------   35 % 
40000 edges added on 111397   --------   36 % 
41000 edges added on 111397   --------   37 % 
42000 edges added on 111397   --------   38 % 
43000 edges added on 111397   --------   39 % 
44000 edges added on 111397   --------   39 % 
45000 edges added on 111397   --------   40 % 
46000 edges added on 111397   --------   41 % 
47000 edges added on 111397   --------   42 % 
48000 edges added on 111397   --------   43 % 
49000 edges added on 111397   --------   44 % 
50000 edges added on 111397   --------   45 % 
51000 edges added on 111397   --------   46 % 
52000 edges added on 111397   --------   47 % 
53000 edges added on 111397   --------   48 % 
54000 edges added on 111397   --------   48 % 
55000 edges added on 111397   --------   49 % 
56000 edges added on 111397   --------   50 % 
57000 edges added on 111397   --------   51 % 
58000 edges added on 111397   --------   52 % 
59000 edges added on 111397   --------   53 % 
60000 edges added on 111397   --------   54 % 
61000 edges added on 111397   --------   55 % 
62000 edges added on 111397   --------   56 % 
63000 edges added on 111397   --------   57 % 
64000 edges added on 111397   --------   57 % 
65000 edges added on 111397   --------   58 % 
66000 edges added on 111397   --------   59 % 
67000 edges added on 111397   --------   60 % 
68000 edges added on 111397   --------   61 % 
69000 edges added on 111397   --------   62 % 
70000 edges added on 111397   --------   63 % 
71000 edges added on 111397   --------   64 % 
72000 edges added on 111397   --------   65 % 
73000 edges added on 111397   --------   66 % 
74000 edges added on 111397   --------   66 % 
75000 edges added on 111397   --------   67 % 
76000 edges added on 111397   --------   68 % 
77000 edges added on 111397   --------   69 % 
78000 edges added on 111397   --------   70 % 
79000 edges added on 111397   --------   71 % 
80000 edges added on 111397   --------   72 % 
81000 edges added on 111397   --------   73 % 
82000 edges added on 111397   --------   74 % 
83000 edges added on 111397   --------   75 % 
84000 edges added on 111397   --------   75 % 
85000 edges added on 111397   --------   76 % 
86000 edges added on 111397   --------   77 % 
87000 edges added on 111397   --------   78 % 
88000 edges added on 111397   --------   79 % 
89000 edges added on 111397   --------   80 % 
90000 edges added on 111397   --------   81 % 
91000 edges added on 111397   --------   82 % 
92000 edges added on 111397   --------   83 % 
93000 edges added on 111397   --------   83 % 
94000 edges added on 111397   --------   84 % 
95000 edges added on 111397   --------   85 % 
96000 edges added on 111397   --------   86 % 
97000 edges added on 111397   --------   87 % 
98000 edges added on 111397   --------   88 % 
99000 edges added on 111397   --------   89 % 
100000 edges added on 111397   --------   90 % 
101000 edges added on 111397   --------   91 % 
102000 edges added on 111397   --------   92 % 
103000 edges added on 111397   --------   92 % 
104000 edges added on 111397   --------   93 % 
105000 edges added on 111397   --------   94 % 
106000 edges added on 111397   --------   95 % 
107000 edges added on 111397   --------   96 % 
108000 edges added on 111397   --------   97 % 
109000 edges added on 111397   --------   98 % 
110000 edges added on 111397   --------   99 % 
111000 edges added on 111397   --------   100 % 
avant: 7685
apres: 7301
2021-02-24 08:40:44.195446: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-02-24 08:40:44.196202: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-02-24 08:40:44.196227: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-02-24 08:40:44.196263: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (cedar006.saclay.inria.fr): /proc/driver/nvidia/version does not exist
2021-02-24 08:40:44.201625: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
EPOCH  0 #################################
/data/projet_citations/sage/edgeMinibatch.py:119: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.train_edges[i][2])
509
loss: tf.Tensor(1.0737133, shape=(), dtype=float32)
loss: tf.Tensor(0.99062747, shape=(), dtype=float32)
loss: tf.Tensor(0.8160577, shape=(), dtype=float32)
loss: tf.Tensor(0.9320287, shape=(), dtype=float32)
loss: tf.Tensor(0.8482893, shape=(), dtype=float32)
loss: tf.Tensor(0.9852725, shape=(), dtype=float32)
loss: tf.Tensor(0.9133126, shape=(), dtype=float32)
loss: tf.Tensor(0.78503066, shape=(), dtype=float32)
loss: tf.Tensor(0.8638003, shape=(), dtype=float32)
loss: tf.Tensor(0.7833912, shape=(), dtype=float32)
loss: tf.Tensor(0.7673612, shape=(), dtype=float32)
loss: tf.Tensor(0.754397, shape=(), dtype=float32)
loss: tf.Tensor(0.6740025, shape=(), dtype=float32)
loss: tf.Tensor(0.6143365, shape=(), dtype=float32)
loss: tf.Tensor(0.68008894, shape=(), dtype=float32)
loss: tf.Tensor(0.45218578, shape=(), dtype=float32)
loss: tf.Tensor(0.6430174, shape=(), dtype=float32)
loss: tf.Tensor(0.46291316, shape=(), dtype=float32)
loss: tf.Tensor(0.59253836, shape=(), dtype=float32)
loss: tf.Tensor(0.4889107, shape=(), dtype=float32)
loss: tf.Tensor(0.53471714, shape=(), dtype=float32)
loss: tf.Tensor(0.45416555, shape=(), dtype=float32)
loss: tf.Tensor(0.45026305, shape=(), dtype=float32)
loss: tf.Tensor(0.42195928, shape=(), dtype=float32)
loss: tf.Tensor(0.45467636, shape=(), dtype=float32)
loss: tf.Tensor(0.3840085, shape=(), dtype=float32)
loss: tf.Tensor(0.4106745, shape=(), dtype=float32)
loss: tf.Tensor(0.3536095, shape=(), dtype=float32)
loss: tf.Tensor(0.43280196, shape=(), dtype=float32)
loss: tf.Tensor(0.64004296, shape=(), dtype=float32)
loss: tf.Tensor(0.5595026, shape=(), dtype=float32)
loss: tf.Tensor(0.37674126, shape=(), dtype=float32)
loss: tf.Tensor(0.6566398, shape=(), dtype=float32)
loss: tf.Tensor(0.5383861, shape=(), dtype=float32)
loss: tf.Tensor(0.60717165, shape=(), dtype=float32)
loss: tf.Tensor(0.46857634, shape=(), dtype=float32)
loss: tf.Tensor(0.43611562, shape=(), dtype=float32)
loss: tf.Tensor(0.45094922, shape=(), dtype=float32)
loss: tf.Tensor(0.6041715, shape=(), dtype=float32)
loss: tf.Tensor(0.59303844, shape=(), dtype=float32)
loss: tf.Tensor(0.47038105, shape=(), dtype=float32)
loss: tf.Tensor(0.5783479, shape=(), dtype=float32)
loss: tf.Tensor(0.3913615, shape=(), dtype=float32)
loss: tf.Tensor(0.51789606, shape=(), dtype=float32)
loss: tf.Tensor(0.48974115, shape=(), dtype=float32)
loss: tf.Tensor(0.46035942, shape=(), dtype=float32)
loss: tf.Tensor(0.45426968, shape=(), dtype=float32)
loss: tf.Tensor(0.47312874, shape=(), dtype=float32)
loss: tf.Tensor(0.4452523, shape=(), dtype=float32)
loss: tf.Tensor(0.4058925, shape=(), dtype=float32)
loss: tf.Tensor(0.32445338, shape=(), dtype=float32)
loss: tf.Tensor(0.5629892, shape=(), dtype=float32)
loss: tf.Tensor(0.400524, shape=(), dtype=float32)
loss: tf.Tensor(0.5577553, shape=(), dtype=float32)
loss: tf.Tensor(0.6586454, shape=(), dtype=float32)
loss: tf.Tensor(0.5206734, shape=(), dtype=float32)
loss: tf.Tensor(0.41614956, shape=(), dtype=float32)
loss: tf.Tensor(0.38404652, shape=(), dtype=float32)
loss: tf.Tensor(0.33603942, shape=(), dtype=float32)
loss: tf.Tensor(0.5549696, shape=(), dtype=float32)
loss: tf.Tensor(0.4908802, shape=(), dtype=float32)
loss: tf.Tensor(0.4648888, shape=(), dtype=float32)
loss: tf.Tensor(0.447069, shape=(), dtype=float32)
loss: tf.Tensor(0.36023033, shape=(), dtype=float32)
loss: tf.Tensor(0.35550252, shape=(), dtype=float32)
loss: tf.Tensor(0.5290248, shape=(), dtype=float32)
loss: tf.Tensor(0.5798256, shape=(), dtype=float32)
loss: tf.Tensor(0.39527893, shape=(), dtype=float32)
loss: tf.Tensor(0.36884537, shape=(), dtype=float32)
loss: tf.Tensor(0.58395785, shape=(), dtype=float32)
loss: tf.Tensor(0.3276497, shape=(), dtype=float32)
loss: tf.Tensor(0.50913453, shape=(), dtype=float32)
loss: tf.Tensor(0.44729856, shape=(), dtype=float32)
loss: tf.Tensor(0.49080616, shape=(), dtype=float32)
TEST LOSS: #####################################
/data/projet_citations/sage/edgeMinibatch.py:163: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.test_edges[i][2])
2021-02-24 08:59:14.133720: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-02-24 08:59:14.135683: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2399860000 Hz
tf.Tensor(0.72458506, shape=(), dtype=float32)
F1 SCORE:
0.8356545
EPOCH  1 #################################
loss: tf.Tensor(0.41623455, shape=(), dtype=float32)
loss: tf.Tensor(0.47492385, shape=(), dtype=float32)
loss: tf.Tensor(0.48496285, shape=(), dtype=float32)
loss: tf.Tensor(0.43697444, shape=(), dtype=float32)
loss: tf.Tensor(0.47264794, shape=(), dtype=float32)
loss: tf.Tensor(0.50099593, shape=(), dtype=float32)
loss: tf.Tensor(0.48449722, shape=(), dtype=float32)
loss: tf.Tensor(0.289641, shape=(), dtype=float32)
loss: tf.Tensor(0.43437046, shape=(), dtype=float32)
loss: tf.Tensor(0.35116187, shape=(), dtype=float32)
loss: tf.Tensor(0.42584646, shape=(), dtype=float32)
loss: tf.Tensor(0.44803298, shape=(), dtype=float32)
loss: tf.Tensor(0.57508314, shape=(), dtype=float32)
loss: tf.Tensor(0.42545438, shape=(), dtype=float32)
loss: tf.Tensor(0.30940613, shape=(), dtype=float32)
loss: tf.Tensor(0.3197737, shape=(), dtype=float32)
loss: tf.Tensor(0.38711166, shape=(), dtype=float32)
loss: tf.Tensor(0.2912063, shape=(), dtype=float32)
loss: tf.Tensor(0.3325092, shape=(), dtype=float32)
loss: tf.Tensor(0.27754703, shape=(), dtype=float32)
loss: tf.Tensor(0.5343781, shape=(), dtype=float32)
loss: tf.Tensor(0.36082363, shape=(), dtype=float32)
loss: tf.Tensor(0.26282918, shape=(), dtype=float32)
loss: tf.Tensor(0.2988486, shape=(), dtype=float32)
loss: tf.Tensor(0.2733773, shape=(), dtype=float32)
loss: tf.Tensor(0.5189996, shape=(), dtype=float32)
loss: tf.Tensor(0.3611552, shape=(), dtype=float32)
loss: tf.Tensor(0.46093568, shape=(), dtype=float32)
loss: tf.Tensor(0.39581662, shape=(), dtype=float32)
loss: tf.Tensor(0.38619542, shape=(), dtype=float32)
loss: tf.Tensor(0.40937692, shape=(), dtype=float32)
loss: tf.Tensor(0.38803655, shape=(), dtype=float32)
loss: tf.Tensor(0.4916381, shape=(), dtype=float32)
loss: tf.Tensor(0.45723087, shape=(), dtype=float32)
loss: tf.Tensor(0.3207998, shape=(), dtype=float32)
loss: tf.Tensor(0.4241315, shape=(), dtype=float32)
loss: tf.Tensor(0.38720834, shape=(), dtype=float32)
loss: tf.Tensor(0.40580997, shape=(), dtype=float32)
loss: tf.Tensor(0.3156517, shape=(), dtype=float32)
loss: tf.Tensor(0.3100997, shape=(), dtype=float32)
loss: tf.Tensor(0.42500186, shape=(), dtype=float32)
loss: tf.Tensor(0.41719535, shape=(), dtype=float32)
loss: tf.Tensor(0.48455092, shape=(), dtype=float32)
loss: tf.Tensor(0.4336402, shape=(), dtype=float32)
loss: tf.Tensor(0.4725854, shape=(), dtype=float32)
loss: tf.Tensor(0.38582772, shape=(), dtype=float32)
loss: tf.Tensor(0.41085833, shape=(), dtype=float32)
loss: tf.Tensor(0.42609286, shape=(), dtype=float32)
loss: tf.Tensor(0.23105907, shape=(), dtype=float32)
loss: tf.Tensor(0.42819417, shape=(), dtype=float32)
loss: tf.Tensor(0.32604903, shape=(), dtype=float32)
loss: tf.Tensor(0.45158768, shape=(), dtype=float32)
loss: tf.Tensor(0.43900383, shape=(), dtype=float32)
loss: tf.Tensor(0.407839, shape=(), dtype=float32)
loss: tf.Tensor(0.42689463, shape=(), dtype=float32)
loss: tf.Tensor(0.38485077, shape=(), dtype=float32)
loss: tf.Tensor(0.31175572, shape=(), dtype=float32)
loss: tf.Tensor(0.40276375, shape=(), dtype=float32)
loss: tf.Tensor(0.3563802, shape=(), dtype=float32)
loss: tf.Tensor(0.40671173, shape=(), dtype=float32)
loss: tf.Tensor(0.35170174, shape=(), dtype=float32)
loss: tf.Tensor(0.628825, shape=(), dtype=float32)
loss: tf.Tensor(0.41843402, shape=(), dtype=float32)
loss: tf.Tensor(0.3796999, shape=(), dtype=float32)
loss: tf.Tensor(0.3625667, shape=(), dtype=float32)
loss: tf.Tensor(0.31722438, shape=(), dtype=float32)
loss: tf.Tensor(0.4182968, shape=(), dtype=float32)
loss: tf.Tensor(0.28243172, shape=(), dtype=float32)
loss: tf.Tensor(0.36595878, shape=(), dtype=float32)
loss: tf.Tensor(0.39370823, shape=(), dtype=float32)
loss: tf.Tensor(0.36859477, shape=(), dtype=float32)
loss: tf.Tensor(0.38922623, shape=(), dtype=float32)
loss: tf.Tensor(0.44453004, shape=(), dtype=float32)
loss: tf.Tensor(0.020805918, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.71421343, shape=(), dtype=float32)
F1 SCORE:
0.84121484
EPOCH  2 #################################
loss: tf.Tensor(0.44642434, shape=(), dtype=float32)
loss: tf.Tensor(0.43910939, shape=(), dtype=float32)
loss: tf.Tensor(0.36665022, shape=(), dtype=float32)
loss: tf.Tensor(0.4364289, shape=(), dtype=float32)
loss: tf.Tensor(0.31132618, shape=(), dtype=float32)
loss: tf.Tensor(0.37565577, shape=(), dtype=float32)
loss: tf.Tensor(0.24965444, shape=(), dtype=float32)
loss: tf.Tensor(0.36233217, shape=(), dtype=float32)
loss: tf.Tensor(0.4226297, shape=(), dtype=float32)
loss: tf.Tensor(0.43187034, shape=(), dtype=float32)
loss: tf.Tensor(0.27794048, shape=(), dtype=float32)
loss: tf.Tensor(0.37823662, shape=(), dtype=float32)
loss: tf.Tensor(0.34963477, shape=(), dtype=float32)
loss: tf.Tensor(0.33145955, shape=(), dtype=float32)
loss: tf.Tensor(0.47236574, shape=(), dtype=float32)
loss: tf.Tensor(0.41207469, shape=(), dtype=float32)
loss: tf.Tensor(0.43528008, shape=(), dtype=float32)
loss: tf.Tensor(0.5073779, shape=(), dtype=float32)
loss: tf.Tensor(0.30996543, shape=(), dtype=float32)
loss: tf.Tensor(0.3651577, shape=(), dtype=float32)
loss: tf.Tensor(0.43307346, shape=(), dtype=float32)
loss: tf.Tensor(0.49879935, shape=(), dtype=float32)
loss: tf.Tensor(0.29913858, shape=(), dtype=float32)
loss: tf.Tensor(0.39832798, shape=(), dtype=float32)
loss: tf.Tensor(0.3661124, shape=(), dtype=float32)
loss: tf.Tensor(0.34920335, shape=(), dtype=float32)
loss: tf.Tensor(0.31392318, shape=(), dtype=float32)
loss: tf.Tensor(0.40855616, shape=(), dtype=float32)
loss: tf.Tensor(0.31270137, shape=(), dtype=float32)
loss: tf.Tensor(0.3497018, shape=(), dtype=float32)
loss: tf.Tensor(0.31567863, shape=(), dtype=float32)
loss: tf.Tensor(0.29265672, shape=(), dtype=float32)
loss: tf.Tensor(0.3952237, shape=(), dtype=float32)
loss: tf.Tensor(0.5642066, shape=(), dtype=float32)
loss: tf.Tensor(0.4165824, shape=(), dtype=float32)
loss: tf.Tensor(0.42125222, shape=(), dtype=float32)
loss: tf.Tensor(0.29834583, shape=(), dtype=float32)
loss: tf.Tensor(0.40800557, shape=(), dtype=float32)
loss: tf.Tensor(0.32561123, shape=(), dtype=float32)
loss: tf.Tensor(0.3801475, shape=(), dtype=float32)
loss: tf.Tensor(0.41830632, shape=(), dtype=float32)
loss: tf.Tensor(0.46059024, shape=(), dtype=float32)
loss: tf.Tensor(0.37353405, shape=(), dtype=float32)
loss: tf.Tensor(0.3622327, shape=(), dtype=float32)
loss: tf.Tensor(0.3276603, shape=(), dtype=float32)
loss: tf.Tensor(0.29150388, shape=(), dtype=float32)
loss: tf.Tensor(0.3354534, shape=(), dtype=float32)
loss: tf.Tensor(0.57901365, shape=(), dtype=float32)
loss: tf.Tensor(0.3095001, shape=(), dtype=float32)
loss: tf.Tensor(0.46074802, shape=(), dtype=float32)
loss: tf.Tensor(0.35819268, shape=(), dtype=float32)
loss: tf.Tensor(0.31363752, shape=(), dtype=float32)
loss: tf.Tensor(0.32709473, shape=(), dtype=float32)
loss: tf.Tensor(0.41559178, shape=(), dtype=float32)
loss: tf.Tensor(0.31755581, shape=(), dtype=float32)
loss: tf.Tensor(0.31059015, shape=(), dtype=float32)
loss: tf.Tensor(0.31848496, shape=(), dtype=float32)
loss: tf.Tensor(0.3663353, shape=(), dtype=float32)
loss: tf.Tensor(0.35286403, shape=(), dtype=float32)
loss: tf.Tensor(0.34928176, shape=(), dtype=float32)
loss: tf.Tensor(0.25778383, shape=(), dtype=float32)
loss: tf.Tensor(0.2750203, shape=(), dtype=float32)
loss: tf.Tensor(0.29760945, shape=(), dtype=float32)
loss: tf.Tensor(0.48801342, shape=(), dtype=float32)
loss: tf.Tensor(0.6101658, shape=(), dtype=float32)
loss: tf.Tensor(0.28829682, shape=(), dtype=float32)
loss: tf.Tensor(0.43272153, shape=(), dtype=float32)
loss: tf.Tensor(0.3772792, shape=(), dtype=float32)
loss: tf.Tensor(0.41908705, shape=(), dtype=float32)
loss: tf.Tensor(0.42553252, shape=(), dtype=float32)
loss: tf.Tensor(0.18378784, shape=(), dtype=float32)
loss: tf.Tensor(0.28654483, shape=(), dtype=float32)
loss: tf.Tensor(0.37171483, shape=(), dtype=float32)
loss: tf.Tensor(3.5239782, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.72963065, shape=(), dtype=float32)
F1 SCORE:
0.8378327
EPOCH  3 #################################
loss: tf.Tensor(0.33483982, shape=(), dtype=float32)
loss: tf.Tensor(0.40284216, shape=(), dtype=float32)
loss: tf.Tensor(0.3789415, shape=(), dtype=float32)
loss: tf.Tensor(0.43435618, shape=(), dtype=float32)
loss: tf.Tensor(0.4387952, shape=(), dtype=float32)
loss: tf.Tensor(0.43873805, shape=(), dtype=float32)
loss: tf.Tensor(0.35255122, shape=(), dtype=float32)
loss: tf.Tensor(0.45327607, shape=(), dtype=float32)
loss: tf.Tensor(0.58334047, shape=(), dtype=float32)
loss: tf.Tensor(0.3715802, shape=(), dtype=float32)
loss: tf.Tensor(0.36756733, shape=(), dtype=float32)
loss: tf.Tensor(0.3362463, shape=(), dtype=float32)
loss: tf.Tensor(0.31381303, shape=(), dtype=float32)
loss: tf.Tensor(0.33815393, shape=(), dtype=float32)
loss: tf.Tensor(0.40466064, shape=(), dtype=float32)
loss: tf.Tensor(0.39074486, shape=(), dtype=float32)
loss: tf.Tensor(0.42099738, shape=(), dtype=float32)
loss: tf.Tensor(0.36520636, shape=(), dtype=float32)
loss: tf.Tensor(0.39968732, shape=(), dtype=float32)
loss: tf.Tensor(0.37586856, shape=(), dtype=float32)
loss: tf.Tensor(0.29210973, shape=(), dtype=float32)
loss: tf.Tensor(0.23997581, shape=(), dtype=float32)
loss: tf.Tensor(0.34127104, shape=(), dtype=float32)
loss: tf.Tensor(0.38482827, shape=(), dtype=float32)
loss: tf.Tensor(0.3799283, shape=(), dtype=float32)
loss: tf.Tensor(0.4358374, shape=(), dtype=float32)
loss: tf.Tensor(0.29947454, shape=(), dtype=float32)
loss: tf.Tensor(0.4387568, shape=(), dtype=float32)
loss: tf.Tensor(0.3196367, shape=(), dtype=float32)
loss: tf.Tensor(0.34815308, shape=(), dtype=float32)
loss: tf.Tensor(0.39591885, shape=(), dtype=float32)
loss: tf.Tensor(0.35116577, shape=(), dtype=float32)
loss: tf.Tensor(0.30675605, shape=(), dtype=float32)
loss: tf.Tensor(0.3260461, shape=(), dtype=float32)
loss: tf.Tensor(0.31257975, shape=(), dtype=float32)
loss: tf.Tensor(0.46852076, shape=(), dtype=float32)
loss: tf.Tensor(0.2721422, shape=(), dtype=float32)
loss: tf.Tensor(0.44985476, shape=(), dtype=float32)
loss: tf.Tensor(0.27392206, shape=(), dtype=float32)
loss: tf.Tensor(0.46404567, shape=(), dtype=float32)
loss: tf.Tensor(0.4140369, shape=(), dtype=float32)
loss: tf.Tensor(0.31294402, shape=(), dtype=float32)
loss: tf.Tensor(0.45954797, shape=(), dtype=float32)
loss: tf.Tensor(0.34216622, shape=(), dtype=float32)
loss: tf.Tensor(0.2955816, shape=(), dtype=float32)
loss: tf.Tensor(0.32730693, shape=(), dtype=float32)
loss: tf.Tensor(0.40852392, shape=(), dtype=float32)
loss: tf.Tensor(0.3571982, shape=(), dtype=float32)
loss: tf.Tensor(0.4675318, shape=(), dtype=float32)
loss: tf.Tensor(0.36560613, shape=(), dtype=float32)
loss: tf.Tensor(0.31072426, shape=(), dtype=float32)
loss: tf.Tensor(0.4319046, shape=(), dtype=float32)
loss: tf.Tensor(0.36307824, shape=(), dtype=float32)
loss: tf.Tensor(0.21560185, shape=(), dtype=float32)
loss: tf.Tensor(0.4740892, shape=(), dtype=float32)
loss: tf.Tensor(0.51752764, shape=(), dtype=float32)
loss: tf.Tensor(0.3241698, shape=(), dtype=float32)
loss: tf.Tensor(0.42776844, shape=(), dtype=float32)
loss: tf.Tensor(0.4051826, shape=(), dtype=float32)
loss: tf.Tensor(0.40287465, shape=(), dtype=float32)
loss: tf.Tensor(0.32357156, shape=(), dtype=float32)
loss: tf.Tensor(0.47349694, shape=(), dtype=float32)
loss: tf.Tensor(0.404208, shape=(), dtype=float32)
loss: tf.Tensor(0.44506603, shape=(), dtype=float32)
loss: tf.Tensor(0.24314398, shape=(), dtype=float32)
loss: tf.Tensor(0.47250977, shape=(), dtype=float32)
loss: tf.Tensor(0.24821924, shape=(), dtype=float32)
loss: tf.Tensor(0.3118334, shape=(), dtype=float32)
loss: tf.Tensor(0.33620852, shape=(), dtype=float32)
loss: tf.Tensor(0.47287208, shape=(), dtype=float32)
loss: tf.Tensor(0.33408555, shape=(), dtype=float32)
loss: tf.Tensor(0.2945067, shape=(), dtype=float32)
loss: tf.Tensor(0.22491385, shape=(), dtype=float32)
loss: tf.Tensor(0.031978108, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.7098873, shape=(), dtype=float32)
F1 SCORE:
0.83826476
EPOCH  4 #################################
loss: tf.Tensor(0.3627675, shape=(), dtype=float32)
loss: tf.Tensor(0.3079198, shape=(), dtype=float32)
loss: tf.Tensor(0.20152903, shape=(), dtype=float32)
loss: tf.Tensor(0.2454253, shape=(), dtype=float32)
loss: tf.Tensor(0.26732388, shape=(), dtype=float32)
loss: tf.Tensor(0.34641448, shape=(), dtype=float32)
loss: tf.Tensor(0.38114995, shape=(), dtype=float32)
loss: tf.Tensor(0.3578727, shape=(), dtype=float32)
loss: tf.Tensor(0.30924064, shape=(), dtype=float32)
loss: tf.Tensor(0.34743637, shape=(), dtype=float32)
loss: tf.Tensor(0.33745992, shape=(), dtype=float32)
loss: tf.Tensor(0.4074913, shape=(), dtype=float32)
loss: tf.Tensor(0.43854046, shape=(), dtype=float32)
loss: tf.Tensor(0.3486436, shape=(), dtype=float32)
loss: tf.Tensor(0.30007032, shape=(), dtype=float32)
loss: tf.Tensor(0.3446703, shape=(), dtype=float32)
loss: tf.Tensor(0.22771013, shape=(), dtype=float32)
loss: tf.Tensor(0.3849226, shape=(), dtype=float32)
loss: tf.Tensor(0.4461745, shape=(), dtype=float32)
loss: tf.Tensor(0.24353474, shape=(), dtype=float32)
loss: tf.Tensor(0.40202737, shape=(), dtype=float32)
loss: tf.Tensor(0.4082595, shape=(), dtype=float32)
loss: tf.Tensor(0.33101153, shape=(), dtype=float32)
loss: tf.Tensor(0.27191156, shape=(), dtype=float32)
loss: tf.Tensor(0.38130677, shape=(), dtype=float32)
loss: tf.Tensor(0.19715498, shape=(), dtype=float32)
loss: tf.Tensor(0.371803, shape=(), dtype=float32)
loss: tf.Tensor(0.35702705, shape=(), dtype=float32)
loss: tf.Tensor(0.29458016, shape=(), dtype=float32)
loss: tf.Tensor(0.40398812, shape=(), dtype=float32)
loss: tf.Tensor(0.29224733, shape=(), dtype=float32)
loss: tf.Tensor(0.31376916, shape=(), dtype=float32)
loss: tf.Tensor(0.31382564, shape=(), dtype=float32)
loss: tf.Tensor(0.33055833, shape=(), dtype=float32)
loss: tf.Tensor(0.49186254, shape=(), dtype=float32)
loss: tf.Tensor(0.28396118, shape=(), dtype=float32)
loss: tf.Tensor(0.3322016, shape=(), dtype=float32)
loss: tf.Tensor(0.41109398, shape=(), dtype=float32)
loss: tf.Tensor(0.27165872, shape=(), dtype=float32)
loss: tf.Tensor(0.25675476, shape=(), dtype=float32)
loss: tf.Tensor(0.38898918, shape=(), dtype=float32)
loss: tf.Tensor(0.30088794, shape=(), dtype=float32)
loss: tf.Tensor(0.38116607, shape=(), dtype=float32)
loss: tf.Tensor(0.23082829, shape=(), dtype=float32)
loss: tf.Tensor(0.22999932, shape=(), dtype=float32)
loss: tf.Tensor(0.22495957, shape=(), dtype=float32)
loss: tf.Tensor(0.36257195, shape=(), dtype=float32)
loss: tf.Tensor(0.3738007, shape=(), dtype=float32)
loss: tf.Tensor(0.35010284, shape=(), dtype=float32)
loss: tf.Tensor(0.3330774, shape=(), dtype=float32)
loss: tf.Tensor(0.23990665, shape=(), dtype=float32)
loss: tf.Tensor(0.3579555, shape=(), dtype=float32)
loss: tf.Tensor(0.36902317, shape=(), dtype=float32)
loss: tf.Tensor(0.3032395, shape=(), dtype=float32)
loss: tf.Tensor(0.33589423, shape=(), dtype=float32)
loss: tf.Tensor(0.2607529, shape=(), dtype=float32)
loss: tf.Tensor(0.29257542, shape=(), dtype=float32)
loss: tf.Tensor(0.43615407, shape=(), dtype=float32)
loss: tf.Tensor(0.31463408, shape=(), dtype=float32)
loss: tf.Tensor(0.26039353, shape=(), dtype=float32)
loss: tf.Tensor(0.31862915, shape=(), dtype=float32)
loss: tf.Tensor(0.46191433, shape=(), dtype=float32)
loss: tf.Tensor(0.2335139, shape=(), dtype=float32)
loss: tf.Tensor(0.36306003, shape=(), dtype=float32)
loss: tf.Tensor(0.42543653, shape=(), dtype=float32)
loss: tf.Tensor(0.1410972, shape=(), dtype=float32)
loss: tf.Tensor(0.30697715, shape=(), dtype=float32)
loss: tf.Tensor(0.2984782, shape=(), dtype=float32)
loss: tf.Tensor(0.41945598, shape=(), dtype=float32)
loss: tf.Tensor(0.40734804, shape=(), dtype=float32)
loss: tf.Tensor(0.36737153, shape=(), dtype=float32)
loss: tf.Tensor(0.28895918, shape=(), dtype=float32)
loss: tf.Tensor(0.35096127, shape=(), dtype=float32)
loss: tf.Tensor(0.4103876, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:5 out of the last 5 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69859546, shape=(), dtype=float32)
F1 SCORE:
0.8418145
EPOCH  5 #################################
loss: tf.Tensor(0.28106058, shape=(), dtype=float32)
loss: tf.Tensor(0.2766559, shape=(), dtype=float32)
loss: tf.Tensor(0.30846083, shape=(), dtype=float32)
loss: tf.Tensor(0.47803965, shape=(), dtype=float32)
loss: tf.Tensor(0.4185901, shape=(), dtype=float32)
loss: tf.Tensor(0.3286439, shape=(), dtype=float32)
loss: tf.Tensor(0.3728936, shape=(), dtype=float32)
loss: tf.Tensor(0.40274167, shape=(), dtype=float32)
loss: tf.Tensor(0.45457554, shape=(), dtype=float32)
loss: tf.Tensor(0.4152028, shape=(), dtype=float32)
loss: tf.Tensor(0.4325758, shape=(), dtype=float32)
loss: tf.Tensor(0.40780067, shape=(), dtype=float32)
loss: tf.Tensor(0.25026038, shape=(), dtype=float32)
loss: tf.Tensor(0.33619672, shape=(), dtype=float32)
loss: tf.Tensor(0.34021068, shape=(), dtype=float32)
loss: tf.Tensor(0.2767657, shape=(), dtype=float32)
loss: tf.Tensor(0.29818404, shape=(), dtype=float32)
loss: tf.Tensor(0.28424355, shape=(), dtype=float32)
loss: tf.Tensor(0.28641453, shape=(), dtype=float32)
loss: tf.Tensor(0.2792685, shape=(), dtype=float32)
loss: tf.Tensor(0.34365094, shape=(), dtype=float32)
loss: tf.Tensor(0.45831245, shape=(), dtype=float32)
loss: tf.Tensor(0.29318893, shape=(), dtype=float32)
loss: tf.Tensor(0.27661237, shape=(), dtype=float32)
loss: tf.Tensor(0.27903286, shape=(), dtype=float32)
loss: tf.Tensor(0.3048305, shape=(), dtype=float32)
loss: tf.Tensor(0.37327737, shape=(), dtype=float32)
loss: tf.Tensor(0.3237857, shape=(), dtype=float32)
loss: tf.Tensor(0.47922873, shape=(), dtype=float32)
loss: tf.Tensor(0.39068902, shape=(), dtype=float32)
loss: tf.Tensor(0.26372117, shape=(), dtype=float32)
loss: tf.Tensor(0.31750274, shape=(), dtype=float32)
loss: tf.Tensor(0.2539624, shape=(), dtype=float32)
loss: tf.Tensor(0.36895195, shape=(), dtype=float32)
loss: tf.Tensor(0.3774681, shape=(), dtype=float32)
loss: tf.Tensor(0.20807593, shape=(), dtype=float32)
loss: tf.Tensor(0.2681792, shape=(), dtype=float32)
loss: tf.Tensor(0.24103378, shape=(), dtype=float32)
loss: tf.Tensor(0.39689106, shape=(), dtype=float32)
loss: tf.Tensor(0.25153723, shape=(), dtype=float32)
loss: tf.Tensor(0.49559098, shape=(), dtype=float32)
loss: tf.Tensor(0.3109987, shape=(), dtype=float32)
loss: tf.Tensor(0.30554828, shape=(), dtype=float32)
loss: tf.Tensor(0.33299568, shape=(), dtype=float32)
loss: tf.Tensor(0.42500347, shape=(), dtype=float32)
loss: tf.Tensor(0.20547129, shape=(), dtype=float32)
loss: tf.Tensor(0.39759964, shape=(), dtype=float32)
loss: tf.Tensor(0.3729472, shape=(), dtype=float32)
loss: tf.Tensor(0.32262343, shape=(), dtype=float32)
loss: tf.Tensor(0.27780095, shape=(), dtype=float32)
loss: tf.Tensor(0.26843557, shape=(), dtype=float32)
loss: tf.Tensor(0.44908172, shape=(), dtype=float32)
loss: tf.Tensor(0.24631518, shape=(), dtype=float32)
loss: tf.Tensor(0.3500092, shape=(), dtype=float32)
loss: tf.Tensor(0.34689903, shape=(), dtype=float32)
loss: tf.Tensor(0.3286174, shape=(), dtype=float32)
loss: tf.Tensor(0.32002032, shape=(), dtype=float32)
loss: tf.Tensor(0.3346446, shape=(), dtype=float32)
loss: tf.Tensor(0.25149137, shape=(), dtype=float32)
loss: tf.Tensor(0.2139189, shape=(), dtype=float32)
loss: tf.Tensor(0.3023679, shape=(), dtype=float32)
loss: tf.Tensor(0.20627894, shape=(), dtype=float32)
loss: tf.Tensor(0.32874343, shape=(), dtype=float32)
loss: tf.Tensor(0.20355311, shape=(), dtype=float32)
loss: tf.Tensor(0.31461287, shape=(), dtype=float32)
loss: tf.Tensor(0.45159328, shape=(), dtype=float32)
loss: tf.Tensor(0.33079267, shape=(), dtype=float32)
loss: tf.Tensor(0.34523422, shape=(), dtype=float32)
loss: tf.Tensor(0.32693058, shape=(), dtype=float32)
loss: tf.Tensor(0.36025113, shape=(), dtype=float32)
loss: tf.Tensor(0.35343182, shape=(), dtype=float32)
loss: tf.Tensor(0.18723296, shape=(), dtype=float32)
loss: tf.Tensor(0.29294717, shape=(), dtype=float32)
loss: tf.Tensor(0.030159963, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:6 out of the last 6 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7018581, shape=(), dtype=float32)
F1 SCORE:
0.842854
EPOCH  6 #################################
loss: tf.Tensor(0.29894096, shape=(), dtype=float32)
loss: tf.Tensor(0.31121087, shape=(), dtype=float32)
loss: tf.Tensor(0.3074739, shape=(), dtype=float32)
loss: tf.Tensor(0.30719623, shape=(), dtype=float32)
loss: tf.Tensor(0.27048892, shape=(), dtype=float32)
loss: tf.Tensor(0.25450715, shape=(), dtype=float32)
loss: tf.Tensor(0.43492657, shape=(), dtype=float32)
loss: tf.Tensor(0.28871828, shape=(), dtype=float32)
loss: tf.Tensor(0.27106696, shape=(), dtype=float32)
loss: tf.Tensor(0.26289728, shape=(), dtype=float32)
loss: tf.Tensor(0.23832616, shape=(), dtype=float32)
loss: tf.Tensor(0.30644235, shape=(), dtype=float32)
loss: tf.Tensor(0.42019424, shape=(), dtype=float32)
loss: tf.Tensor(0.36753714, shape=(), dtype=float32)
loss: tf.Tensor(0.33452815, shape=(), dtype=float32)
loss: tf.Tensor(0.23899996, shape=(), dtype=float32)
loss: tf.Tensor(0.30547902, shape=(), dtype=float32)
loss: tf.Tensor(0.2798627, shape=(), dtype=float32)
loss: tf.Tensor(0.42648685, shape=(), dtype=float32)
loss: tf.Tensor(0.26365528, shape=(), dtype=float32)
loss: tf.Tensor(0.2719666, shape=(), dtype=float32)
loss: tf.Tensor(0.23855855, shape=(), dtype=float32)
loss: tf.Tensor(0.40545836, shape=(), dtype=float32)
loss: tf.Tensor(0.20494704, shape=(), dtype=float32)
loss: tf.Tensor(0.15603144, shape=(), dtype=float32)
loss: tf.Tensor(0.28821486, shape=(), dtype=float32)
loss: tf.Tensor(0.26413056, shape=(), dtype=float32)
loss: tf.Tensor(0.32073623, shape=(), dtype=float32)
loss: tf.Tensor(0.3858707, shape=(), dtype=float32)
loss: tf.Tensor(0.37540653, shape=(), dtype=float32)
loss: tf.Tensor(0.2842016, shape=(), dtype=float32)
loss: tf.Tensor(0.24624081, shape=(), dtype=float32)
loss: tf.Tensor(0.32012522, shape=(), dtype=float32)
loss: tf.Tensor(0.31794515, shape=(), dtype=float32)
loss: tf.Tensor(0.34904844, shape=(), dtype=float32)
loss: tf.Tensor(0.4417655, shape=(), dtype=float32)
loss: tf.Tensor(0.20487434, shape=(), dtype=float32)
loss: tf.Tensor(0.20002623, shape=(), dtype=float32)
loss: tf.Tensor(0.3117016, shape=(), dtype=float32)
loss: tf.Tensor(0.3752256, shape=(), dtype=float32)
loss: tf.Tensor(0.24599686, shape=(), dtype=float32)
loss: tf.Tensor(0.38600734, shape=(), dtype=float32)
loss: tf.Tensor(0.34437534, shape=(), dtype=float32)
loss: tf.Tensor(0.21510766, shape=(), dtype=float32)
loss: tf.Tensor(0.28940395, shape=(), dtype=float32)
loss: tf.Tensor(0.33820483, shape=(), dtype=float32)
loss: tf.Tensor(0.31862554, shape=(), dtype=float32)
loss: tf.Tensor(0.22185305, shape=(), dtype=float32)
loss: tf.Tensor(0.31497225, shape=(), dtype=float32)
loss: tf.Tensor(0.33846375, shape=(), dtype=float32)
loss: tf.Tensor(0.28254637, shape=(), dtype=float32)
loss: tf.Tensor(0.30275333, shape=(), dtype=float32)
loss: tf.Tensor(0.23379812, shape=(), dtype=float32)
loss: tf.Tensor(0.21991469, shape=(), dtype=float32)
loss: tf.Tensor(0.31632712, shape=(), dtype=float32)
loss: tf.Tensor(0.25763577, shape=(), dtype=float32)
loss: tf.Tensor(0.29825848, shape=(), dtype=float32)
loss: tf.Tensor(0.21795619, shape=(), dtype=float32)
loss: tf.Tensor(0.24200386, shape=(), dtype=float32)
loss: tf.Tensor(0.27348918, shape=(), dtype=float32)
loss: tf.Tensor(0.23968191, shape=(), dtype=float32)
loss: tf.Tensor(0.23230861, shape=(), dtype=float32)
loss: tf.Tensor(0.27082148, shape=(), dtype=float32)
loss: tf.Tensor(0.304019, shape=(), dtype=float32)
loss: tf.Tensor(0.32566747, shape=(), dtype=float32)
loss: tf.Tensor(0.20912738, shape=(), dtype=float32)
loss: tf.Tensor(0.37737808, shape=(), dtype=float32)
loss: tf.Tensor(0.41358307, shape=(), dtype=float32)
loss: tf.Tensor(0.3185041, shape=(), dtype=float32)
loss: tf.Tensor(0.35189244, shape=(), dtype=float32)
loss: tf.Tensor(0.43716687, shape=(), dtype=float32)
loss: tf.Tensor(0.2596861, shape=(), dtype=float32)
loss: tf.Tensor(0.31666344, shape=(), dtype=float32)
loss: tf.Tensor(0.01477737, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:7 out of the last 7 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6961063, shape=(), dtype=float32)
F1 SCORE:
0.84409887
EPOCH  7 #################################
loss: tf.Tensor(0.25917542, shape=(), dtype=float32)
loss: tf.Tensor(0.32438043, shape=(), dtype=float32)
loss: tf.Tensor(0.33554518, shape=(), dtype=float32)
loss: tf.Tensor(0.28507712, shape=(), dtype=float32)
loss: tf.Tensor(0.39047372, shape=(), dtype=float32)
loss: tf.Tensor(0.29013938, shape=(), dtype=float32)
loss: tf.Tensor(0.29412067, shape=(), dtype=float32)
loss: tf.Tensor(0.28267297, shape=(), dtype=float32)
loss: tf.Tensor(0.27986202, shape=(), dtype=float32)
loss: tf.Tensor(0.23359948, shape=(), dtype=float32)
loss: tf.Tensor(0.36973, shape=(), dtype=float32)
loss: tf.Tensor(0.26443225, shape=(), dtype=float32)
loss: tf.Tensor(0.3112168, shape=(), dtype=float32)
loss: tf.Tensor(0.29808602, shape=(), dtype=float32)
loss: tf.Tensor(0.35850298, shape=(), dtype=float32)
loss: tf.Tensor(0.27164465, shape=(), dtype=float32)
loss: tf.Tensor(0.27844703, shape=(), dtype=float32)
loss: tf.Tensor(0.18716705, shape=(), dtype=float32)
loss: tf.Tensor(0.21243675, shape=(), dtype=float32)
loss: tf.Tensor(0.31088185, shape=(), dtype=float32)
loss: tf.Tensor(0.1801283, shape=(), dtype=float32)
loss: tf.Tensor(0.37491825, shape=(), dtype=float32)
loss: tf.Tensor(0.3912189, shape=(), dtype=float32)
loss: tf.Tensor(0.2856567, shape=(), dtype=float32)
loss: tf.Tensor(0.3692091, shape=(), dtype=float32)
loss: tf.Tensor(0.26492175, shape=(), dtype=float32)
loss: tf.Tensor(0.28664067, shape=(), dtype=float32)
loss: tf.Tensor(0.32298505, shape=(), dtype=float32)
loss: tf.Tensor(0.25864667, shape=(), dtype=float32)
loss: tf.Tensor(0.22177787, shape=(), dtype=float32)
loss: tf.Tensor(0.16690786, shape=(), dtype=float32)
loss: tf.Tensor(0.33470702, shape=(), dtype=float32)
loss: tf.Tensor(0.3872487, shape=(), dtype=float32)
loss: tf.Tensor(0.39090833, shape=(), dtype=float32)
loss: tf.Tensor(0.27133512, shape=(), dtype=float32)
loss: tf.Tensor(0.3340617, shape=(), dtype=float32)
loss: tf.Tensor(0.23438458, shape=(), dtype=float32)
loss: tf.Tensor(0.20444871, shape=(), dtype=float32)
loss: tf.Tensor(0.24843855, shape=(), dtype=float32)
loss: tf.Tensor(0.3333838, shape=(), dtype=float32)
loss: tf.Tensor(0.25582862, shape=(), dtype=float32)
loss: tf.Tensor(0.2181142, shape=(), dtype=float32)
loss: tf.Tensor(0.16509038, shape=(), dtype=float32)
loss: tf.Tensor(0.29548195, shape=(), dtype=float32)
loss: tf.Tensor(0.27671954, shape=(), dtype=float32)
loss: tf.Tensor(0.376521, shape=(), dtype=float32)
loss: tf.Tensor(0.32918182, shape=(), dtype=float32)
loss: tf.Tensor(0.3185857, shape=(), dtype=float32)
loss: tf.Tensor(0.22135511, shape=(), dtype=float32)
loss: tf.Tensor(0.27825046, shape=(), dtype=float32)
loss: tf.Tensor(0.29768774, shape=(), dtype=float32)
loss: tf.Tensor(0.22010379, shape=(), dtype=float32)
loss: tf.Tensor(0.31931898, shape=(), dtype=float32)
loss: tf.Tensor(0.37255165, shape=(), dtype=float32)
loss: tf.Tensor(0.20130688, shape=(), dtype=float32)
loss: tf.Tensor(0.31259525, shape=(), dtype=float32)
loss: tf.Tensor(0.21855114, shape=(), dtype=float32)
loss: tf.Tensor(0.1930757, shape=(), dtype=float32)
loss: tf.Tensor(0.17598337, shape=(), dtype=float32)
loss: tf.Tensor(0.3136242, shape=(), dtype=float32)
loss: tf.Tensor(0.15641807, shape=(), dtype=float32)
loss: tf.Tensor(0.22716695, shape=(), dtype=float32)
loss: tf.Tensor(0.28059068, shape=(), dtype=float32)
loss: tf.Tensor(0.3064593, shape=(), dtype=float32)
loss: tf.Tensor(0.4164204, shape=(), dtype=float32)
loss: tf.Tensor(0.26036513, shape=(), dtype=float32)
loss: tf.Tensor(0.26877782, shape=(), dtype=float32)
loss: tf.Tensor(0.26652092, shape=(), dtype=float32)
loss: tf.Tensor(0.31796056, shape=(), dtype=float32)
loss: tf.Tensor(0.32475376, shape=(), dtype=float32)
loss: tf.Tensor(0.26004943, shape=(), dtype=float32)
loss: tf.Tensor(0.3326397, shape=(), dtype=float32)
loss: tf.Tensor(0.4072802, shape=(), dtype=float32)
loss: tf.Tensor(0.0010417041, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:8 out of the last 8 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6985501, shape=(), dtype=float32)
F1 SCORE:
0.84561414
EPOCH  8 #################################
loss: tf.Tensor(0.22769873, shape=(), dtype=float32)
loss: tf.Tensor(0.37086552, shape=(), dtype=float32)
loss: tf.Tensor(0.25876755, shape=(), dtype=float32)
loss: tf.Tensor(0.19717674, shape=(), dtype=float32)
loss: tf.Tensor(0.27252525, shape=(), dtype=float32)
loss: tf.Tensor(0.21670385, shape=(), dtype=float32)
loss: tf.Tensor(0.23493132, shape=(), dtype=float32)
loss: tf.Tensor(0.29857385, shape=(), dtype=float32)
loss: tf.Tensor(0.26201585, shape=(), dtype=float32)
loss: tf.Tensor(0.24975441, shape=(), dtype=float32)
loss: tf.Tensor(0.2114832, shape=(), dtype=float32)
loss: tf.Tensor(0.3100318, shape=(), dtype=float32)
loss: tf.Tensor(0.25700408, shape=(), dtype=float32)
loss: tf.Tensor(0.2589041, shape=(), dtype=float32)
loss: tf.Tensor(0.23822834, shape=(), dtype=float32)
loss: tf.Tensor(0.2116781, shape=(), dtype=float32)
loss: tf.Tensor(0.20941319, shape=(), dtype=float32)
loss: tf.Tensor(0.3011305, shape=(), dtype=float32)
loss: tf.Tensor(0.2992376, shape=(), dtype=float32)
loss: tf.Tensor(0.3088858, shape=(), dtype=float32)
loss: tf.Tensor(0.19903891, shape=(), dtype=float32)
loss: tf.Tensor(0.29224652, shape=(), dtype=float32)
loss: tf.Tensor(0.16477154, shape=(), dtype=float32)
loss: tf.Tensor(0.34561703, shape=(), dtype=float32)
loss: tf.Tensor(0.2500672, shape=(), dtype=float32)
loss: tf.Tensor(0.22140586, shape=(), dtype=float32)
loss: tf.Tensor(0.3041208, shape=(), dtype=float32)
loss: tf.Tensor(0.18914028, shape=(), dtype=float32)
loss: tf.Tensor(0.21739537, shape=(), dtype=float32)
loss: tf.Tensor(0.18427233, shape=(), dtype=float32)
loss: tf.Tensor(0.27294806, shape=(), dtype=float32)
loss: tf.Tensor(0.20454289, shape=(), dtype=float32)
loss: tf.Tensor(0.17597504, shape=(), dtype=float32)
loss: tf.Tensor(0.3203922, shape=(), dtype=float32)
loss: tf.Tensor(0.1667464, shape=(), dtype=float32)
loss: tf.Tensor(0.39555395, shape=(), dtype=float32)
loss: tf.Tensor(0.1723162, shape=(), dtype=float32)
loss: tf.Tensor(0.18931714, shape=(), dtype=float32)
loss: tf.Tensor(0.2967176, shape=(), dtype=float32)
loss: tf.Tensor(0.23361504, shape=(), dtype=float32)
loss: tf.Tensor(0.27272505, shape=(), dtype=float32)
loss: tf.Tensor(0.26221967, shape=(), dtype=float32)
loss: tf.Tensor(0.24124685, shape=(), dtype=float32)
loss: tf.Tensor(0.1837191, shape=(), dtype=float32)
loss: tf.Tensor(0.3052943, shape=(), dtype=float32)
loss: tf.Tensor(0.28615314, shape=(), dtype=float32)
loss: tf.Tensor(0.16790336, shape=(), dtype=float32)
loss: tf.Tensor(0.21697132, shape=(), dtype=float32)
loss: tf.Tensor(0.2745841, shape=(), dtype=float32)
loss: tf.Tensor(0.17256884, shape=(), dtype=float32)
loss: tf.Tensor(0.28809375, shape=(), dtype=float32)
loss: tf.Tensor(0.21911463, shape=(), dtype=float32)
loss: tf.Tensor(0.30297458, shape=(), dtype=float32)
loss: tf.Tensor(0.25259152, shape=(), dtype=float32)
loss: tf.Tensor(0.37554607, shape=(), dtype=float32)
loss: tf.Tensor(0.2208089, shape=(), dtype=float32)
loss: tf.Tensor(0.2631198, shape=(), dtype=float32)
loss: tf.Tensor(0.18177891, shape=(), dtype=float32)
loss: tf.Tensor(0.26172906, shape=(), dtype=float32)
loss: tf.Tensor(0.23155299, shape=(), dtype=float32)
loss: tf.Tensor(0.22754422, shape=(), dtype=float32)
loss: tf.Tensor(0.4347963, shape=(), dtype=float32)
loss: tf.Tensor(0.20503718, shape=(), dtype=float32)
loss: tf.Tensor(0.1883553, shape=(), dtype=float32)
loss: tf.Tensor(0.34191513, shape=(), dtype=float32)
loss: tf.Tensor(0.24368888, shape=(), dtype=float32)
loss: tf.Tensor(0.25458023, shape=(), dtype=float32)
loss: tf.Tensor(0.3042688, shape=(), dtype=float32)
loss: tf.Tensor(0.21947879, shape=(), dtype=float32)
loss: tf.Tensor(0.27116308, shape=(), dtype=float32)
loss: tf.Tensor(0.28367567, shape=(), dtype=float32)
loss: tf.Tensor(0.35337102, shape=(), dtype=float32)
loss: tf.Tensor(0.26509297, shape=(), dtype=float32)
loss: tf.Tensor(0.28306314, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:9 out of the last 9 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6991134, shape=(), dtype=float32)
F1 SCORE:
0.84521943
EPOCH  9 #################################
loss: tf.Tensor(0.34532627, shape=(), dtype=float32)
loss: tf.Tensor(0.3627525, shape=(), dtype=float32)
loss: tf.Tensor(0.33877507, shape=(), dtype=float32)
loss: tf.Tensor(0.2058106, shape=(), dtype=float32)
loss: tf.Tensor(0.24935389, shape=(), dtype=float32)
loss: tf.Tensor(0.21031392, shape=(), dtype=float32)
loss: tf.Tensor(0.2374448, shape=(), dtype=float32)
loss: tf.Tensor(0.38601694, shape=(), dtype=float32)
loss: tf.Tensor(0.3520632, shape=(), dtype=float32)
loss: tf.Tensor(0.19791976, shape=(), dtype=float32)
loss: tf.Tensor(0.30871493, shape=(), dtype=float32)
loss: tf.Tensor(0.21714899, shape=(), dtype=float32)
loss: tf.Tensor(0.25625718, shape=(), dtype=float32)
loss: tf.Tensor(0.4189501, shape=(), dtype=float32)
loss: tf.Tensor(0.27844888, shape=(), dtype=float32)
loss: tf.Tensor(0.23693682, shape=(), dtype=float32)
loss: tf.Tensor(0.22079203, shape=(), dtype=float32)
loss: tf.Tensor(0.24791546, shape=(), dtype=float32)
loss: tf.Tensor(0.3120555, shape=(), dtype=float32)
loss: tf.Tensor(0.2846917, shape=(), dtype=float32)
loss: tf.Tensor(0.2959646, shape=(), dtype=float32)
loss: tf.Tensor(0.19583775, shape=(), dtype=float32)
loss: tf.Tensor(0.31484163, shape=(), dtype=float32)
loss: tf.Tensor(0.2727515, shape=(), dtype=float32)
loss: tf.Tensor(0.30493635, shape=(), dtype=float32)
loss: tf.Tensor(0.27016085, shape=(), dtype=float32)
loss: tf.Tensor(0.20864561, shape=(), dtype=float32)
loss: tf.Tensor(0.21508875, shape=(), dtype=float32)
loss: tf.Tensor(0.27976948, shape=(), dtype=float32)
loss: tf.Tensor(0.3199149, shape=(), dtype=float32)
loss: tf.Tensor(0.2756605, shape=(), dtype=float32)
loss: tf.Tensor(0.22241692, shape=(), dtype=float32)
loss: tf.Tensor(0.25943983, shape=(), dtype=float32)
loss: tf.Tensor(0.29431966, shape=(), dtype=float32)
loss: tf.Tensor(0.27295402, shape=(), dtype=float32)
loss: tf.Tensor(0.24185528, shape=(), dtype=float32)
loss: tf.Tensor(0.3576642, shape=(), dtype=float32)
loss: tf.Tensor(0.23431075, shape=(), dtype=float32)
loss: tf.Tensor(0.33830428, shape=(), dtype=float32)
loss: tf.Tensor(0.2606875, shape=(), dtype=float32)
loss: tf.Tensor(0.21897095, shape=(), dtype=float32)
loss: tf.Tensor(0.36459586, shape=(), dtype=float32)
loss: tf.Tensor(0.25569764, shape=(), dtype=float32)
loss: tf.Tensor(0.27192107, shape=(), dtype=float32)
loss: tf.Tensor(0.3581787, shape=(), dtype=float32)
loss: tf.Tensor(0.2908275, shape=(), dtype=float32)
loss: tf.Tensor(0.27251196, shape=(), dtype=float32)
loss: tf.Tensor(0.23028004, shape=(), dtype=float32)
loss: tf.Tensor(0.31644204, shape=(), dtype=float32)
loss: tf.Tensor(0.22684045, shape=(), dtype=float32)
loss: tf.Tensor(0.19104208, shape=(), dtype=float32)
loss: tf.Tensor(0.20448108, shape=(), dtype=float32)
loss: tf.Tensor(0.3115469, shape=(), dtype=float32)
loss: tf.Tensor(0.24890962, shape=(), dtype=float32)
loss: tf.Tensor(0.22516198, shape=(), dtype=float32)
loss: tf.Tensor(0.17901905, shape=(), dtype=float32)
loss: tf.Tensor(0.1690276, shape=(), dtype=float32)
loss: tf.Tensor(0.21415266, shape=(), dtype=float32)
loss: tf.Tensor(0.23557338, shape=(), dtype=float32)
loss: tf.Tensor(0.27011636, shape=(), dtype=float32)
loss: tf.Tensor(0.3144295, shape=(), dtype=float32)
loss: tf.Tensor(0.27945808, shape=(), dtype=float32)
loss: tf.Tensor(0.17218837, shape=(), dtype=float32)
loss: tf.Tensor(0.2098681, shape=(), dtype=float32)
loss: tf.Tensor(0.38758022, shape=(), dtype=float32)
loss: tf.Tensor(0.23762634, shape=(), dtype=float32)
loss: tf.Tensor(0.30593514, shape=(), dtype=float32)
loss: tf.Tensor(0.23547684, shape=(), dtype=float32)
loss: tf.Tensor(0.28155747, shape=(), dtype=float32)
loss: tf.Tensor(0.2800306, shape=(), dtype=float32)
loss: tf.Tensor(0.36499026, shape=(), dtype=float32)
loss: tf.Tensor(0.2863075, shape=(), dtype=float32)
loss: tf.Tensor(0.28753468, shape=(), dtype=float32)
loss: tf.Tensor(0.20352468, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:10 out of the last 10 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70000196, shape=(), dtype=float32)
F1 SCORE:
0.8442672
EPOCH  10 #################################
loss: tf.Tensor(0.18420409, shape=(), dtype=float32)
loss: tf.Tensor(0.28030604, shape=(), dtype=float32)
loss: tf.Tensor(0.25265333, shape=(), dtype=float32)
loss: tf.Tensor(0.19927807, shape=(), dtype=float32)
loss: tf.Tensor(0.22829378, shape=(), dtype=float32)
loss: tf.Tensor(0.096636064, shape=(), dtype=float32)
loss: tf.Tensor(0.20410465, shape=(), dtype=float32)
loss: tf.Tensor(0.20046358, shape=(), dtype=float32)
loss: tf.Tensor(0.19245543, shape=(), dtype=float32)
loss: tf.Tensor(0.24391569, shape=(), dtype=float32)
loss: tf.Tensor(0.17306322, shape=(), dtype=float32)
loss: tf.Tensor(0.2477308, shape=(), dtype=float32)
loss: tf.Tensor(0.24152821, shape=(), dtype=float32)
loss: tf.Tensor(0.2728567, shape=(), dtype=float32)
loss: tf.Tensor(0.3845993, shape=(), dtype=float32)
loss: tf.Tensor(0.19877052, shape=(), dtype=float32)
loss: tf.Tensor(0.20412117, shape=(), dtype=float32)
loss: tf.Tensor(0.17487808, shape=(), dtype=float32)
loss: tf.Tensor(0.23012777, shape=(), dtype=float32)
loss: tf.Tensor(0.17113604, shape=(), dtype=float32)
loss: tf.Tensor(0.2861795, shape=(), dtype=float32)
loss: tf.Tensor(0.21368645, shape=(), dtype=float32)
loss: tf.Tensor(0.24300498, shape=(), dtype=float32)
loss: tf.Tensor(0.24571235, shape=(), dtype=float32)
loss: tf.Tensor(0.25272366, shape=(), dtype=float32)
loss: tf.Tensor(0.22892198, shape=(), dtype=float32)
loss: tf.Tensor(0.25406978, shape=(), dtype=float32)
loss: tf.Tensor(0.23469335, shape=(), dtype=float32)
loss: tf.Tensor(0.24062401, shape=(), dtype=float32)
loss: tf.Tensor(0.28598857, shape=(), dtype=float32)
loss: tf.Tensor(0.2063468, shape=(), dtype=float32)
loss: tf.Tensor(0.19102916, shape=(), dtype=float32)
loss: tf.Tensor(0.1439659, shape=(), dtype=float32)
loss: tf.Tensor(0.22557403, shape=(), dtype=float32)
loss: tf.Tensor(0.35887784, shape=(), dtype=float32)
loss: tf.Tensor(0.20356199, shape=(), dtype=float32)
loss: tf.Tensor(0.15676047, shape=(), dtype=float32)
loss: tf.Tensor(0.2657678, shape=(), dtype=float32)
loss: tf.Tensor(0.1428737, shape=(), dtype=float32)
loss: tf.Tensor(0.205018, shape=(), dtype=float32)
loss: tf.Tensor(0.19764996, shape=(), dtype=float32)
loss: tf.Tensor(0.2465658, shape=(), dtype=float32)
loss: tf.Tensor(0.3340788, shape=(), dtype=float32)
loss: tf.Tensor(0.32080528, shape=(), dtype=float32)
loss: tf.Tensor(0.16825013, shape=(), dtype=float32)
loss: tf.Tensor(0.17495446, shape=(), dtype=float32)
loss: tf.Tensor(0.18386775, shape=(), dtype=float32)
loss: tf.Tensor(0.19692849, shape=(), dtype=float32)
loss: tf.Tensor(0.23805521, shape=(), dtype=float32)
loss: tf.Tensor(0.19446157, shape=(), dtype=float32)
loss: tf.Tensor(0.26243013, shape=(), dtype=float32)
loss: tf.Tensor(0.3196903, shape=(), dtype=float32)
loss: tf.Tensor(0.20848174, shape=(), dtype=float32)
loss: tf.Tensor(0.31541148, shape=(), dtype=float32)
loss: tf.Tensor(0.32821655, shape=(), dtype=float32)
loss: tf.Tensor(0.242913, shape=(), dtype=float32)
loss: tf.Tensor(0.25989318, shape=(), dtype=float32)
loss: tf.Tensor(0.17136565, shape=(), dtype=float32)
loss: tf.Tensor(0.21399343, shape=(), dtype=float32)
loss: tf.Tensor(0.21156651, shape=(), dtype=float32)
loss: tf.Tensor(0.26494664, shape=(), dtype=float32)
loss: tf.Tensor(0.22169359, shape=(), dtype=float32)
loss: tf.Tensor(0.32971245, shape=(), dtype=float32)
loss: tf.Tensor(0.22509052, shape=(), dtype=float32)
loss: tf.Tensor(0.23804383, shape=(), dtype=float32)
loss: tf.Tensor(0.18221062, shape=(), dtype=float32)
loss: tf.Tensor(0.3042617, shape=(), dtype=float32)
loss: tf.Tensor(0.21645714, shape=(), dtype=float32)
loss: tf.Tensor(0.23486885, shape=(), dtype=float32)
loss: tf.Tensor(0.24785873, shape=(), dtype=float32)
loss: tf.Tensor(0.24178961, shape=(), dtype=float32)
loss: tf.Tensor(0.24123484, shape=(), dtype=float32)
loss: tf.Tensor(0.2069906, shape=(), dtype=float32)
loss: tf.Tensor(0.07078666, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6977009, shape=(), dtype=float32)
F1 SCORE:
0.8441461
EPOCH  11 #################################
loss: tf.Tensor(0.23457116, shape=(), dtype=float32)
loss: tf.Tensor(0.11558634, shape=(), dtype=float32)
loss: tf.Tensor(0.17008719, shape=(), dtype=float32)
loss: tf.Tensor(0.19306093, shape=(), dtype=float32)
loss: tf.Tensor(0.13104099, shape=(), dtype=float32)
loss: tf.Tensor(0.2468426, shape=(), dtype=float32)
loss: tf.Tensor(0.17020103, shape=(), dtype=float32)
loss: tf.Tensor(0.2600644, shape=(), dtype=float32)
loss: tf.Tensor(0.104186505, shape=(), dtype=float32)
loss: tf.Tensor(0.24564128, shape=(), dtype=float32)
loss: tf.Tensor(0.25468913, shape=(), dtype=float32)
loss: tf.Tensor(0.21244127, shape=(), dtype=float32)
loss: tf.Tensor(0.31928843, shape=(), dtype=float32)
loss: tf.Tensor(0.18358223, shape=(), dtype=float32)
loss: tf.Tensor(0.14569834, shape=(), dtype=float32)
loss: tf.Tensor(0.17577887, shape=(), dtype=float32)
loss: tf.Tensor(0.14047404, shape=(), dtype=float32)
loss: tf.Tensor(0.20709492, shape=(), dtype=float32)
loss: tf.Tensor(0.19792241, shape=(), dtype=float32)
loss: tf.Tensor(0.29239073, shape=(), dtype=float32)
loss: tf.Tensor(0.20352863, shape=(), dtype=float32)
loss: tf.Tensor(0.21460582, shape=(), dtype=float32)
loss: tf.Tensor(0.20514752, shape=(), dtype=float32)
loss: tf.Tensor(0.32501128, shape=(), dtype=float32)
loss: tf.Tensor(0.24286142, shape=(), dtype=float32)
loss: tf.Tensor(0.29340386, shape=(), dtype=float32)
loss: tf.Tensor(0.10440006, shape=(), dtype=float32)
loss: tf.Tensor(0.20428404, shape=(), dtype=float32)
loss: tf.Tensor(0.29991344, shape=(), dtype=float32)
loss: tf.Tensor(0.2559899, shape=(), dtype=float32)
loss: tf.Tensor(0.3259963, shape=(), dtype=float32)
loss: tf.Tensor(0.2355312, shape=(), dtype=float32)
loss: tf.Tensor(0.1409837, shape=(), dtype=float32)
loss: tf.Tensor(0.22847664, shape=(), dtype=float32)
loss: tf.Tensor(0.21855713, shape=(), dtype=float32)
loss: tf.Tensor(0.2173818, shape=(), dtype=float32)
loss: tf.Tensor(0.34091663, shape=(), dtype=float32)
loss: tf.Tensor(0.22112888, shape=(), dtype=float32)
loss: tf.Tensor(0.12832393, shape=(), dtype=float32)
loss: tf.Tensor(0.13756385, shape=(), dtype=float32)
loss: tf.Tensor(0.19380261, shape=(), dtype=float32)
loss: tf.Tensor(0.2417561, shape=(), dtype=float32)
loss: tf.Tensor(0.12386462, shape=(), dtype=float32)
loss: tf.Tensor(0.16311501, shape=(), dtype=float32)
loss: tf.Tensor(0.223458, shape=(), dtype=float32)
loss: tf.Tensor(0.19807205, shape=(), dtype=float32)
loss: tf.Tensor(0.2106926, shape=(), dtype=float32)
loss: tf.Tensor(0.18797174, shape=(), dtype=float32)
loss: tf.Tensor(0.2292518, shape=(), dtype=float32)
loss: tf.Tensor(0.13056813, shape=(), dtype=float32)
loss: tf.Tensor(0.16064297, shape=(), dtype=float32)
loss: tf.Tensor(0.22418037, shape=(), dtype=float32)
loss: tf.Tensor(0.20982914, shape=(), dtype=float32)
loss: tf.Tensor(0.15113898, shape=(), dtype=float32)
loss: tf.Tensor(0.17544255, shape=(), dtype=float32)
loss: tf.Tensor(0.21416788, shape=(), dtype=float32)
loss: tf.Tensor(0.17741355, shape=(), dtype=float32)
loss: tf.Tensor(0.23371866, shape=(), dtype=float32)
loss: tf.Tensor(0.14611784, shape=(), dtype=float32)
loss: tf.Tensor(0.26360187, shape=(), dtype=float32)
loss: tf.Tensor(0.352645, shape=(), dtype=float32)
loss: tf.Tensor(0.12826052, shape=(), dtype=float32)
loss: tf.Tensor(0.2865881, shape=(), dtype=float32)
loss: tf.Tensor(0.20056358, shape=(), dtype=float32)
loss: tf.Tensor(0.36982307, shape=(), dtype=float32)
loss: tf.Tensor(0.170699, shape=(), dtype=float32)
loss: tf.Tensor(0.16749744, shape=(), dtype=float32)
loss: tf.Tensor(0.11709991, shape=(), dtype=float32)
loss: tf.Tensor(0.25070027, shape=(), dtype=float32)
loss: tf.Tensor(0.2423978, shape=(), dtype=float32)
loss: tf.Tensor(0.20309079, shape=(), dtype=float32)
loss: tf.Tensor(0.28775093, shape=(), dtype=float32)
loss: tf.Tensor(0.12924582, shape=(), dtype=float32)
loss: tf.Tensor(0.50589776, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71245843, shape=(), dtype=float32)
F1 SCORE:
0.8417849
EPOCH  12 #################################
loss: tf.Tensor(0.12193761, shape=(), dtype=float32)
loss: tf.Tensor(0.2825728, shape=(), dtype=float32)
loss: tf.Tensor(0.25712913, shape=(), dtype=float32)
loss: tf.Tensor(0.58085454, shape=(), dtype=float32)
loss: tf.Tensor(0.3997002, shape=(), dtype=float32)
loss: tf.Tensor(0.22436076, shape=(), dtype=float32)
loss: tf.Tensor(0.37165397, shape=(), dtype=float32)
loss: tf.Tensor(0.40517914, shape=(), dtype=float32)
loss: tf.Tensor(0.34134528, shape=(), dtype=float32)
loss: tf.Tensor(0.45136154, shape=(), dtype=float32)
loss: tf.Tensor(0.19918936, shape=(), dtype=float32)
loss: tf.Tensor(0.21573834, shape=(), dtype=float32)
loss: tf.Tensor(0.33714527, shape=(), dtype=float32)
loss: tf.Tensor(0.21125668, shape=(), dtype=float32)
loss: tf.Tensor(0.4032549, shape=(), dtype=float32)
loss: tf.Tensor(0.28760123, shape=(), dtype=float32)
loss: tf.Tensor(0.12867518, shape=(), dtype=float32)
loss: tf.Tensor(0.27803838, shape=(), dtype=float32)
loss: tf.Tensor(0.16012718, shape=(), dtype=float32)
loss: tf.Tensor(0.24707417, shape=(), dtype=float32)
loss: tf.Tensor(0.26291966, shape=(), dtype=float32)
loss: tf.Tensor(0.20635216, shape=(), dtype=float32)
loss: tf.Tensor(0.22862014, shape=(), dtype=float32)
loss: tf.Tensor(0.29990608, shape=(), dtype=float32)
loss: tf.Tensor(0.17420274, shape=(), dtype=float32)
loss: tf.Tensor(0.19508587, shape=(), dtype=float32)
loss: tf.Tensor(0.20092787, shape=(), dtype=float32)
loss: tf.Tensor(0.18449299, shape=(), dtype=float32)
loss: tf.Tensor(0.21503392, shape=(), dtype=float32)
loss: tf.Tensor(0.19327211, shape=(), dtype=float32)
loss: tf.Tensor(0.14843354, shape=(), dtype=float32)
loss: tf.Tensor(0.19070509, shape=(), dtype=float32)
loss: tf.Tensor(0.21627475, shape=(), dtype=float32)
loss: tf.Tensor(0.22749853, shape=(), dtype=float32)
loss: tf.Tensor(0.21032046, shape=(), dtype=float32)
loss: tf.Tensor(0.15391731, shape=(), dtype=float32)
loss: tf.Tensor(0.2505849, shape=(), dtype=float32)
loss: tf.Tensor(0.1517455, shape=(), dtype=float32)
loss: tf.Tensor(0.21666698, shape=(), dtype=float32)
loss: tf.Tensor(0.16961154, shape=(), dtype=float32)
loss: tf.Tensor(0.20768295, shape=(), dtype=float32)
loss: tf.Tensor(0.18325256, shape=(), dtype=float32)
loss: tf.Tensor(0.2589302, shape=(), dtype=float32)
loss: tf.Tensor(0.20243949, shape=(), dtype=float32)
loss: tf.Tensor(0.173839, shape=(), dtype=float32)
loss: tf.Tensor(0.11698777, shape=(), dtype=float32)
loss: tf.Tensor(0.30183288, shape=(), dtype=float32)
loss: tf.Tensor(0.15679638, shape=(), dtype=float32)
loss: tf.Tensor(0.16623907, shape=(), dtype=float32)
loss: tf.Tensor(0.24174382, shape=(), dtype=float32)
loss: tf.Tensor(0.266179, shape=(), dtype=float32)
loss: tf.Tensor(0.10159703, shape=(), dtype=float32)
loss: tf.Tensor(0.1667935, shape=(), dtype=float32)
loss: tf.Tensor(0.15224533, shape=(), dtype=float32)
loss: tf.Tensor(0.17427567, shape=(), dtype=float32)
loss: tf.Tensor(0.4431171, shape=(), dtype=float32)
loss: tf.Tensor(0.30889323, shape=(), dtype=float32)
loss: tf.Tensor(0.25227112, shape=(), dtype=float32)
loss: tf.Tensor(0.243614, shape=(), dtype=float32)
loss: tf.Tensor(0.16276209, shape=(), dtype=float32)
loss: tf.Tensor(0.23296854, shape=(), dtype=float32)
loss: tf.Tensor(0.16485578, shape=(), dtype=float32)
loss: tf.Tensor(0.21436843, shape=(), dtype=float32)
loss: tf.Tensor(0.14975949, shape=(), dtype=float32)
loss: tf.Tensor(0.36667168, shape=(), dtype=float32)
loss: tf.Tensor(0.22908016, shape=(), dtype=float32)
loss: tf.Tensor(0.15173829, shape=(), dtype=float32)
loss: tf.Tensor(0.12602213, shape=(), dtype=float32)
loss: tf.Tensor(0.16970791, shape=(), dtype=float32)
loss: tf.Tensor(0.20739077, shape=(), dtype=float32)
loss: tf.Tensor(0.18652713, shape=(), dtype=float32)
loss: tf.Tensor(0.1625145, shape=(), dtype=float32)
loss: tf.Tensor(0.14668834, shape=(), dtype=float32)
loss: tf.Tensor(0.0012703214, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69514596, shape=(), dtype=float32)
F1 SCORE:
0.8415246
EPOCH  13 #################################
loss: tf.Tensor(0.15043391, shape=(), dtype=float32)
loss: tf.Tensor(0.16330406, shape=(), dtype=float32)
loss: tf.Tensor(0.08143528, shape=(), dtype=float32)
loss: tf.Tensor(0.15978743, shape=(), dtype=float32)
loss: tf.Tensor(0.23454693, shape=(), dtype=float32)
loss: tf.Tensor(0.14258012, shape=(), dtype=float32)
loss: tf.Tensor(0.30396566, shape=(), dtype=float32)
loss: tf.Tensor(0.21203561, shape=(), dtype=float32)
loss: tf.Tensor(0.12967469, shape=(), dtype=float32)
loss: tf.Tensor(0.18542826, shape=(), dtype=float32)
loss: tf.Tensor(0.17931116, shape=(), dtype=float32)
loss: tf.Tensor(0.14327075, shape=(), dtype=float32)
loss: tf.Tensor(0.18370505, shape=(), dtype=float32)
loss: tf.Tensor(0.1334814, shape=(), dtype=float32)
loss: tf.Tensor(0.19894028, shape=(), dtype=float32)
loss: tf.Tensor(0.21030739, shape=(), dtype=float32)
loss: tf.Tensor(0.23132733, shape=(), dtype=float32)
loss: tf.Tensor(0.08671682, shape=(), dtype=float32)
loss: tf.Tensor(0.21946612, shape=(), dtype=float32)
loss: tf.Tensor(0.0932149, shape=(), dtype=float32)
loss: tf.Tensor(0.29456148, shape=(), dtype=float32)
loss: tf.Tensor(0.0964754, shape=(), dtype=float32)
loss: tf.Tensor(0.14054814, shape=(), dtype=float32)
loss: tf.Tensor(0.24979644, shape=(), dtype=float32)
loss: tf.Tensor(0.23597133, shape=(), dtype=float32)
loss: tf.Tensor(0.14610413, shape=(), dtype=float32)
loss: tf.Tensor(0.31871775, shape=(), dtype=float32)
loss: tf.Tensor(0.2075379, shape=(), dtype=float32)
loss: tf.Tensor(0.14269291, shape=(), dtype=float32)
loss: tf.Tensor(0.17692314, shape=(), dtype=float32)
loss: tf.Tensor(0.108485624, shape=(), dtype=float32)
loss: tf.Tensor(0.30833486, shape=(), dtype=float32)
loss: tf.Tensor(0.14241941, shape=(), dtype=float32)
loss: tf.Tensor(0.0937544, shape=(), dtype=float32)
loss: tf.Tensor(0.17236193, shape=(), dtype=float32)
loss: tf.Tensor(0.13258752, shape=(), dtype=float32)
loss: tf.Tensor(0.12474206, shape=(), dtype=float32)
loss: tf.Tensor(0.19800423, shape=(), dtype=float32)
loss: tf.Tensor(0.18733577, shape=(), dtype=float32)
loss: tf.Tensor(0.16234566, shape=(), dtype=float32)
loss: tf.Tensor(0.2335347, shape=(), dtype=float32)
loss: tf.Tensor(0.104325406, shape=(), dtype=float32)
loss: tf.Tensor(0.19232327, shape=(), dtype=float32)
loss: tf.Tensor(0.108155936, shape=(), dtype=float32)
loss: tf.Tensor(0.2007021, shape=(), dtype=float32)
loss: tf.Tensor(0.18478298, shape=(), dtype=float32)
loss: tf.Tensor(0.14752008, shape=(), dtype=float32)
loss: tf.Tensor(0.06763, shape=(), dtype=float32)
loss: tf.Tensor(0.1958004, shape=(), dtype=float32)
loss: tf.Tensor(0.22471571, shape=(), dtype=float32)
loss: tf.Tensor(0.14376503, shape=(), dtype=float32)
loss: tf.Tensor(0.19796754, shape=(), dtype=float32)
loss: tf.Tensor(0.18905553, shape=(), dtype=float32)
loss: tf.Tensor(0.08223075, shape=(), dtype=float32)
loss: tf.Tensor(0.18405975, shape=(), dtype=float32)
loss: tf.Tensor(0.18586683, shape=(), dtype=float32)
loss: tf.Tensor(0.21790548, shape=(), dtype=float32)
loss: tf.Tensor(0.2048906, shape=(), dtype=float32)
loss: tf.Tensor(0.111686856, shape=(), dtype=float32)
loss: tf.Tensor(0.16043112, shape=(), dtype=float32)
loss: tf.Tensor(0.14637667, shape=(), dtype=float32)
loss: tf.Tensor(0.2160068, shape=(), dtype=float32)
loss: tf.Tensor(0.30822986, shape=(), dtype=float32)
loss: tf.Tensor(0.16796584, shape=(), dtype=float32)
loss: tf.Tensor(0.1766161, shape=(), dtype=float32)
loss: tf.Tensor(0.20994811, shape=(), dtype=float32)
loss: tf.Tensor(0.14961521, shape=(), dtype=float32)
loss: tf.Tensor(0.17723824, shape=(), dtype=float32)
loss: tf.Tensor(0.214115, shape=(), dtype=float32)
loss: tf.Tensor(0.11740186, shape=(), dtype=float32)
loss: tf.Tensor(0.19456463, shape=(), dtype=float32)
loss: tf.Tensor(0.115813464, shape=(), dtype=float32)
loss: tf.Tensor(0.14759603, shape=(), dtype=float32)
loss: tf.Tensor(0.38912624, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7050208, shape=(), dtype=float32)
F1 SCORE:
0.8411462
EPOCH  14 #################################
loss: tf.Tensor(0.13636027, shape=(), dtype=float32)
loss: tf.Tensor(0.23812817, shape=(), dtype=float32)
loss: tf.Tensor(0.23026226, shape=(), dtype=float32)
loss: tf.Tensor(0.24455021, shape=(), dtype=float32)
loss: tf.Tensor(0.27751127, shape=(), dtype=float32)
loss: tf.Tensor(0.2524861, shape=(), dtype=float32)
loss: tf.Tensor(0.16574232, shape=(), dtype=float32)
loss: tf.Tensor(0.14328955, shape=(), dtype=float32)
loss: tf.Tensor(0.23711482, shape=(), dtype=float32)
loss: tf.Tensor(0.28205562, shape=(), dtype=float32)
loss: tf.Tensor(0.13227105, shape=(), dtype=float32)
loss: tf.Tensor(0.28535515, shape=(), dtype=float32)
loss: tf.Tensor(0.20159002, shape=(), dtype=float32)
loss: tf.Tensor(0.22921284, shape=(), dtype=float32)
loss: tf.Tensor(0.16560315, shape=(), dtype=float32)
loss: tf.Tensor(0.28006685, shape=(), dtype=float32)
loss: tf.Tensor(0.24840581, shape=(), dtype=float32)
loss: tf.Tensor(0.13604923, shape=(), dtype=float32)
loss: tf.Tensor(0.1613018, shape=(), dtype=float32)
loss: tf.Tensor(0.17914718, shape=(), dtype=float32)
loss: tf.Tensor(0.22124122, shape=(), dtype=float32)
loss: tf.Tensor(0.16067573, shape=(), dtype=float32)
loss: tf.Tensor(0.21128444, shape=(), dtype=float32)
loss: tf.Tensor(0.21767159, shape=(), dtype=float32)
loss: tf.Tensor(0.23646343, shape=(), dtype=float32)
loss: tf.Tensor(0.3163197, shape=(), dtype=float32)
loss: tf.Tensor(0.24004169, shape=(), dtype=float32)
loss: tf.Tensor(0.198253, shape=(), dtype=float32)
loss: tf.Tensor(0.27872184, shape=(), dtype=float32)
loss: tf.Tensor(0.26096317, shape=(), dtype=float32)
loss: tf.Tensor(0.2190755, shape=(), dtype=float32)
loss: tf.Tensor(0.2602099, shape=(), dtype=float32)
loss: tf.Tensor(0.15173948, shape=(), dtype=float32)
loss: tf.Tensor(0.18268304, shape=(), dtype=float32)
loss: tf.Tensor(0.17999963, shape=(), dtype=float32)
loss: tf.Tensor(0.26587325, shape=(), dtype=float32)
loss: tf.Tensor(0.24279799, shape=(), dtype=float32)
loss: tf.Tensor(0.30234653, shape=(), dtype=float32)
loss: tf.Tensor(0.18772177, shape=(), dtype=float32)
loss: tf.Tensor(0.17959806, shape=(), dtype=float32)
loss: tf.Tensor(0.14733006, shape=(), dtype=float32)
loss: tf.Tensor(0.21831416, shape=(), dtype=float32)
loss: tf.Tensor(0.16675085, shape=(), dtype=float32)
loss: tf.Tensor(0.20112267, shape=(), dtype=float32)
loss: tf.Tensor(0.1572745, shape=(), dtype=float32)
loss: tf.Tensor(0.22603251, shape=(), dtype=float32)
loss: tf.Tensor(0.22186865, shape=(), dtype=float32)
loss: tf.Tensor(0.20337519, shape=(), dtype=float32)
loss: tf.Tensor(0.14154229, shape=(), dtype=float32)
loss: tf.Tensor(0.245421, shape=(), dtype=float32)
loss: tf.Tensor(0.29414535, shape=(), dtype=float32)
loss: tf.Tensor(0.3270861, shape=(), dtype=float32)
loss: tf.Tensor(0.17338426, shape=(), dtype=float32)
loss: tf.Tensor(0.23927158, shape=(), dtype=float32)
loss: tf.Tensor(0.13714248, shape=(), dtype=float32)
loss: tf.Tensor(0.12724262, shape=(), dtype=float32)
loss: tf.Tensor(0.12664627, shape=(), dtype=float32)
loss: tf.Tensor(0.19863488, shape=(), dtype=float32)
loss: tf.Tensor(0.15703602, shape=(), dtype=float32)
loss: tf.Tensor(0.12167368, shape=(), dtype=float32)
loss: tf.Tensor(0.15079698, shape=(), dtype=float32)
loss: tf.Tensor(0.24307805, shape=(), dtype=float32)
loss: tf.Tensor(0.2232275, shape=(), dtype=float32)
loss: tf.Tensor(0.20096083, shape=(), dtype=float32)
loss: tf.Tensor(0.22354966, shape=(), dtype=float32)
loss: tf.Tensor(0.120937645, shape=(), dtype=float32)
loss: tf.Tensor(0.20943685, shape=(), dtype=float32)
loss: tf.Tensor(0.16509558, shape=(), dtype=float32)
loss: tf.Tensor(0.12515227, shape=(), dtype=float32)
loss: tf.Tensor(0.1005328, shape=(), dtype=float32)
loss: tf.Tensor(0.21951996, shape=(), dtype=float32)
loss: tf.Tensor(0.17275865, shape=(), dtype=float32)
loss: tf.Tensor(0.11454739, shape=(), dtype=float32)
loss: tf.Tensor(0.0005122303, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f57c6e0bbf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70733064, shape=(), dtype=float32)
F1 SCORE:
0.8395485
EPOCH  15 #################################
loss: tf.Tensor(0.18983698, shape=(), dtype=float32)
loss: tf.Tensor(0.22551566, shape=(), dtype=float32)
