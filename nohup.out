2021-02-20 16:31:27.890403: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-02-20 16:31:27.890444: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
LOADING DICO FINI
1000 edges added on 111397   --------   1 % 
2000 edges added on 111397   --------   2 % 
3000 edges added on 111397   --------   3 % 
4000 edges added on 111397   --------   4 % 
5000 edges added on 111397   --------   4 % 
6000 edges added on 111397   --------   5 % 
7000 edges added on 111397   --------   6 % 
8000 edges added on 111397   --------   7 % 
9000 edges added on 111397   --------   8 % 
10000 edges added on 111397   --------   9 % 
11000 edges added on 111397   --------   10 % 
12000 edges added on 111397   --------   11 % 
13000 edges added on 111397   --------   12 % 
14000 edges added on 111397   --------   13 % 
15000 edges added on 111397   --------   13 % 
16000 edges added on 111397   --------   14 % 
17000 edges added on 111397   --------   15 % 
18000 edges added on 111397   --------   16 % 
19000 edges added on 111397   --------   17 % 
20000 edges added on 111397   --------   18 % 
21000 edges added on 111397   --------   19 % 
22000 edges added on 111397   --------   20 % 
23000 edges added on 111397   --------   21 % 
24000 edges added on 111397   --------   22 % 
25000 edges added on 111397   --------   22 % 
26000 edges added on 111397   --------   23 % 
27000 edges added on 111397   --------   24 % 
28000 edges added on 111397   --------   25 % 
29000 edges added on 111397   --------   26 % 
30000 edges added on 111397   --------   27 % 
31000 edges added on 111397   --------   28 % 
32000 edges added on 111397   --------   29 % 
33000 edges added on 111397   --------   30 % 
34000 edges added on 111397   --------   31 % 
35000 edges added on 111397   --------   31 % 
36000 edges added on 111397   --------   32 % 
37000 edges added on 111397   --------   33 % 
38000 edges added on 111397   --------   34 % 
39000 edges added on 111397   --------   35 % 
40000 edges added on 111397   --------   36 % 
41000 edges added on 111397   --------   37 % 
42000 edges added on 111397   --------   38 % 
43000 edges added on 111397   --------   39 % 
44000 edges added on 111397   --------   39 % 
45000 edges added on 111397   --------   40 % 
46000 edges added on 111397   --------   41 % 
47000 edges added on 111397   --------   42 % 
48000 edges added on 111397   --------   43 % 
49000 edges added on 111397   --------   44 % 
50000 edges added on 111397   --------   45 % 
51000 edges added on 111397   --------   46 % 
52000 edges added on 111397   --------   47 % 
53000 edges added on 111397   --------   48 % 
54000 edges added on 111397   --------   48 % 
55000 edges added on 111397   --------   49 % 
56000 edges added on 111397   --------   50 % 
57000 edges added on 111397   --------   51 % 
58000 edges added on 111397   --------   52 % 
59000 edges added on 111397   --------   53 % 
60000 edges added on 111397   --------   54 % 
61000 edges added on 111397   --------   55 % 
62000 edges added on 111397   --------   56 % 
63000 edges added on 111397   --------   57 % 
64000 edges added on 111397   --------   57 % 
65000 edges added on 111397   --------   58 % 
66000 edges added on 111397   --------   59 % 
67000 edges added on 111397   --------   60 % 
68000 edges added on 111397   --------   61 % 
69000 edges added on 111397   --------   62 % 
70000 edges added on 111397   --------   63 % 
71000 edges added on 111397   --------   64 % 
72000 edges added on 111397   --------   65 % 
73000 edges added on 111397   --------   66 % 
74000 edges added on 111397   --------   66 % 
75000 edges added on 111397   --------   67 % 
76000 edges added on 111397   --------   68 % 
77000 edges added on 111397   --------   69 % 
78000 edges added on 111397   --------   70 % 
79000 edges added on 111397   --------   71 % 
80000 edges added on 111397   --------   72 % 
81000 edges added on 111397   --------   73 % 
82000 edges added on 111397   --------   74 % 
83000 edges added on 111397   --------   75 % 
84000 edges added on 111397   --------   75 % 
85000 edges added on 111397   --------   76 % 
86000 edges added on 111397   --------   77 % 
87000 edges added on 111397   --------   78 % 
88000 edges added on 111397   --------   79 % 
89000 edges added on 111397   --------   80 % 
90000 edges added on 111397   --------   81 % 
91000 edges added on 111397   --------   82 % 
92000 edges added on 111397   --------   83 % 
93000 edges added on 111397   --------   83 % 
94000 edges added on 111397   --------   84 % 
95000 edges added on 111397   --------   85 % 
96000 edges added on 111397   --------   86 % 
97000 edges added on 111397   --------   87 % 
98000 edges added on 111397   --------   88 % 
99000 edges added on 111397   --------   89 % 
100000 edges added on 111397   --------   90 % 
101000 edges added on 111397   --------   91 % 
102000 edges added on 111397   --------   92 % 
103000 edges added on 111397   --------   92 % 
104000 edges added on 111397   --------   93 % 
105000 edges added on 111397   --------   94 % 
106000 edges added on 111397   --------   95 % 
107000 edges added on 111397   --------   96 % 
108000 edges added on 111397   --------   97 % 
109000 edges added on 111397   --------   98 % 
110000 edges added on 111397   --------   99 % 
111000 edges added on 111397   --------   100 % 
avant: 7685
apres: 7301
2021-02-20 16:32:08.926787: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-02-20 16:32:08.927447: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-02-20 16:32:08.927475: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-02-20 16:32:08.927512: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (cedar006.saclay.inria.fr): /proc/driver/nvidia/version does not exist
2021-02-20 16:32:08.932139: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
EPOCH  0 #################################
/data/projet_citations/sage/edgeMinibatch.py:119: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.train_edges[i][2])
509
loss: tf.Tensor(1.1163901, shape=(), dtype=float32)
loss: tf.Tensor(1.0557038, shape=(), dtype=float32)
loss: tf.Tensor(0.8715217, shape=(), dtype=float32)
loss: tf.Tensor(1.0469346, shape=(), dtype=float32)
loss: tf.Tensor(0.992597, shape=(), dtype=float32)
loss: tf.Tensor(1.0240865, shape=(), dtype=float32)
loss: tf.Tensor(0.9022882, shape=(), dtype=float32)
loss: tf.Tensor(0.99756956, shape=(), dtype=float32)
loss: tf.Tensor(0.954022, shape=(), dtype=float32)
loss: tf.Tensor(0.84126616, shape=(), dtype=float32)
loss: tf.Tensor(0.9041535, shape=(), dtype=float32)
loss: tf.Tensor(1.011882, shape=(), dtype=float32)
loss: tf.Tensor(0.82360023, shape=(), dtype=float32)
loss: tf.Tensor(0.836397, shape=(), dtype=float32)
loss: tf.Tensor(0.7980561, shape=(), dtype=float32)
loss: tf.Tensor(0.75934905, shape=(), dtype=float32)
loss: tf.Tensor(0.8044095, shape=(), dtype=float32)
loss: tf.Tensor(0.7528074, shape=(), dtype=float32)
loss: tf.Tensor(0.8544185, shape=(), dtype=float32)
loss: tf.Tensor(0.7863606, shape=(), dtype=float32)
loss: tf.Tensor(0.71171606, shape=(), dtype=float32)
loss: tf.Tensor(0.750457, shape=(), dtype=float32)
loss: tf.Tensor(0.66791815, shape=(), dtype=float32)
loss: tf.Tensor(0.63548297, shape=(), dtype=float32)
loss: tf.Tensor(0.57238925, shape=(), dtype=float32)
loss: tf.Tensor(0.6787521, shape=(), dtype=float32)
loss: tf.Tensor(0.5969296, shape=(), dtype=float32)
loss: tf.Tensor(0.5105936, shape=(), dtype=float32)
loss: tf.Tensor(0.53556335, shape=(), dtype=float32)
loss: tf.Tensor(0.6633789, shape=(), dtype=float32)
loss: tf.Tensor(0.57118607, shape=(), dtype=float32)
loss: tf.Tensor(0.49519774, shape=(), dtype=float32)
loss: tf.Tensor(0.71861094, shape=(), dtype=float32)
loss: tf.Tensor(0.6158431, shape=(), dtype=float32)
loss: tf.Tensor(0.57298124, shape=(), dtype=float32)
loss: tf.Tensor(0.7142964, shape=(), dtype=float32)
loss: tf.Tensor(0.5362152, shape=(), dtype=float32)
loss: tf.Tensor(0.61193705, shape=(), dtype=float32)
loss: tf.Tensor(0.7866362, shape=(), dtype=float32)
loss: tf.Tensor(0.65519714, shape=(), dtype=float32)
loss: tf.Tensor(0.6104011, shape=(), dtype=float32)
loss: tf.Tensor(0.669517, shape=(), dtype=float32)
loss: tf.Tensor(0.40512207, shape=(), dtype=float32)
loss: tf.Tensor(0.5139643, shape=(), dtype=float32)
loss: tf.Tensor(0.52139896, shape=(), dtype=float32)
loss: tf.Tensor(0.5812032, shape=(), dtype=float32)
loss: tf.Tensor(0.56332, shape=(), dtype=float32)
loss: tf.Tensor(0.6000246, shape=(), dtype=float32)
loss: tf.Tensor(0.5263513, shape=(), dtype=float32)
loss: tf.Tensor(0.54288673, shape=(), dtype=float32)
loss: tf.Tensor(0.43757927, shape=(), dtype=float32)
loss: tf.Tensor(0.5650577, shape=(), dtype=float32)
loss: tf.Tensor(0.50707114, shape=(), dtype=float32)
loss: tf.Tensor(0.6715741, shape=(), dtype=float32)
loss: tf.Tensor(0.61521673, shape=(), dtype=float32)
loss: tf.Tensor(0.6005715, shape=(), dtype=float32)
loss: tf.Tensor(0.49220973, shape=(), dtype=float32)
loss: tf.Tensor(0.4170514, shape=(), dtype=float32)
loss: tf.Tensor(0.49066022, shape=(), dtype=float32)
loss: tf.Tensor(0.758621, shape=(), dtype=float32)
loss: tf.Tensor(0.5649993, shape=(), dtype=float32)
loss: tf.Tensor(0.62963486, shape=(), dtype=float32)
loss: tf.Tensor(0.5575795, shape=(), dtype=float32)
loss: tf.Tensor(0.49591476, shape=(), dtype=float32)
loss: tf.Tensor(0.52171683, shape=(), dtype=float32)
loss: tf.Tensor(0.53454584, shape=(), dtype=float32)
loss: tf.Tensor(0.59111947, shape=(), dtype=float32)
loss: tf.Tensor(0.52215016, shape=(), dtype=float32)
loss: tf.Tensor(0.42801312, shape=(), dtype=float32)
loss: tf.Tensor(0.56845146, shape=(), dtype=float32)
loss: tf.Tensor(0.4410821, shape=(), dtype=float32)
loss: tf.Tensor(0.63034594, shape=(), dtype=float32)
loss: tf.Tensor(0.56828594, shape=(), dtype=float32)
loss: tf.Tensor(0.24826322, shape=(), dtype=float32)
TEST LOSS: #####################################
/data/projet_citations/sage/edgeMinibatch.py:163: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.test_edges[i][2])
2021-02-20 16:53:40.108318: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-02-20 16:53:40.110017: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2399860000 Hz
tf.Tensor(0.7573878, shape=(), dtype=float32)
F1 SCORE:
0.7847202
EPOCH  1 #################################
loss: tf.Tensor(0.5908694, shape=(), dtype=float32)
loss: tf.Tensor(0.5551147, shape=(), dtype=float32)
loss: tf.Tensor(0.5781061, shape=(), dtype=float32)
loss: tf.Tensor(0.55790395, shape=(), dtype=float32)
loss: tf.Tensor(0.44525433, shape=(), dtype=float32)
loss: tf.Tensor(0.5212768, shape=(), dtype=float32)
loss: tf.Tensor(0.6707137, shape=(), dtype=float32)
loss: tf.Tensor(0.48006538, shape=(), dtype=float32)
loss: tf.Tensor(0.43712598, shape=(), dtype=float32)
loss: tf.Tensor(0.3795811, shape=(), dtype=float32)
loss: tf.Tensor(0.48162973, shape=(), dtype=float32)
loss: tf.Tensor(0.47922948, shape=(), dtype=float32)
loss: tf.Tensor(0.5716064, shape=(), dtype=float32)
loss: tf.Tensor(0.58302987, shape=(), dtype=float32)
loss: tf.Tensor(0.44360256, shape=(), dtype=float32)
loss: tf.Tensor(0.43384826, shape=(), dtype=float32)
loss: tf.Tensor(0.50140226, shape=(), dtype=float32)
loss: tf.Tensor(0.6067701, shape=(), dtype=float32)
loss: tf.Tensor(0.4904494, shape=(), dtype=float32)
loss: tf.Tensor(0.44826466, shape=(), dtype=float32)
loss: tf.Tensor(0.5952427, shape=(), dtype=float32)
loss: tf.Tensor(0.48647878, shape=(), dtype=float32)
loss: tf.Tensor(0.29540965, shape=(), dtype=float32)
loss: tf.Tensor(0.39041024, shape=(), dtype=float32)
loss: tf.Tensor(0.35765052, shape=(), dtype=float32)
loss: tf.Tensor(0.6434073, shape=(), dtype=float32)
loss: tf.Tensor(0.50607955, shape=(), dtype=float32)
loss: tf.Tensor(0.48695335, shape=(), dtype=float32)
loss: tf.Tensor(0.40221322, shape=(), dtype=float32)
loss: tf.Tensor(0.47334993, shape=(), dtype=float32)
loss: tf.Tensor(0.51584166, shape=(), dtype=float32)
loss: tf.Tensor(0.47308254, shape=(), dtype=float32)
loss: tf.Tensor(0.4722118, shape=(), dtype=float32)
loss: tf.Tensor(0.5974638, shape=(), dtype=float32)
loss: tf.Tensor(0.4118523, shape=(), dtype=float32)
loss: tf.Tensor(0.44494766, shape=(), dtype=float32)
loss: tf.Tensor(0.49956104, shape=(), dtype=float32)
loss: tf.Tensor(0.38201156, shape=(), dtype=float32)
loss: tf.Tensor(0.39102265, shape=(), dtype=float32)
loss: tf.Tensor(0.3700291, shape=(), dtype=float32)
loss: tf.Tensor(0.39696476, shape=(), dtype=float32)
loss: tf.Tensor(0.43793374, shape=(), dtype=float32)
loss: tf.Tensor(0.4867543, shape=(), dtype=float32)
loss: tf.Tensor(0.5405936, shape=(), dtype=float32)
loss: tf.Tensor(0.53201056, shape=(), dtype=float32)
loss: tf.Tensor(0.45292798, shape=(), dtype=float32)
loss: tf.Tensor(0.47796518, shape=(), dtype=float32)
loss: tf.Tensor(0.5372444, shape=(), dtype=float32)
loss: tf.Tensor(0.32456422, shape=(), dtype=float32)
loss: tf.Tensor(0.44796357, shape=(), dtype=float32)
loss: tf.Tensor(0.44541728, shape=(), dtype=float32)
loss: tf.Tensor(0.5580772, shape=(), dtype=float32)
loss: tf.Tensor(0.52797186, shape=(), dtype=float32)
loss: tf.Tensor(0.4849502, shape=(), dtype=float32)
loss: tf.Tensor(0.5475778, shape=(), dtype=float32)
loss: tf.Tensor(0.49060372, shape=(), dtype=float32)
loss: tf.Tensor(0.35262775, shape=(), dtype=float32)
loss: tf.Tensor(0.51075643, shape=(), dtype=float32)
loss: tf.Tensor(0.4491916, shape=(), dtype=float32)
loss: tf.Tensor(0.4264852, shape=(), dtype=float32)
loss: tf.Tensor(0.48915124, shape=(), dtype=float32)
loss: tf.Tensor(0.6196786, shape=(), dtype=float32)
loss: tf.Tensor(0.4870897, shape=(), dtype=float32)
loss: tf.Tensor(0.47205803, shape=(), dtype=float32)
loss: tf.Tensor(0.3458883, shape=(), dtype=float32)
loss: tf.Tensor(0.3733157, shape=(), dtype=float32)
loss: tf.Tensor(0.46203297, shape=(), dtype=float32)
loss: tf.Tensor(0.33284354, shape=(), dtype=float32)
loss: tf.Tensor(0.5025419, shape=(), dtype=float32)
loss: tf.Tensor(0.54195756, shape=(), dtype=float32)
loss: tf.Tensor(0.4368335, shape=(), dtype=float32)
loss: tf.Tensor(0.5462826, shape=(), dtype=float32)
loss: tf.Tensor(0.4309325, shape=(), dtype=float32)
loss: tf.Tensor(0.048766162, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.71879643, shape=(), dtype=float32)
F1 SCORE:
0.81165105
EPOCH  2 #################################
loss: tf.Tensor(0.5544443, shape=(), dtype=float32)
loss: tf.Tensor(0.4345561, shape=(), dtype=float32)
loss: tf.Tensor(0.44116765, shape=(), dtype=float32)
loss: tf.Tensor(0.46422863, shape=(), dtype=float32)
loss: tf.Tensor(0.33406675, shape=(), dtype=float32)
loss: tf.Tensor(0.5162101, shape=(), dtype=float32)
loss: tf.Tensor(0.32204932, shape=(), dtype=float32)
loss: tf.Tensor(0.43013775, shape=(), dtype=float32)
loss: tf.Tensor(0.54362553, shape=(), dtype=float32)
loss: tf.Tensor(0.5717737, shape=(), dtype=float32)
loss: tf.Tensor(0.32538036, shape=(), dtype=float32)
loss: tf.Tensor(0.46414807, shape=(), dtype=float32)
loss: tf.Tensor(0.45263082, shape=(), dtype=float32)
loss: tf.Tensor(0.33825657, shape=(), dtype=float32)
loss: tf.Tensor(0.5000614, shape=(), dtype=float32)
loss: tf.Tensor(0.48244843, shape=(), dtype=float32)
loss: tf.Tensor(0.4212871, shape=(), dtype=float32)
loss: tf.Tensor(0.58410704, shape=(), dtype=float32)
loss: tf.Tensor(0.4337541, shape=(), dtype=float32)
loss: tf.Tensor(0.39349598, shape=(), dtype=float32)
loss: tf.Tensor(0.42364234, shape=(), dtype=float32)
loss: tf.Tensor(0.48697135, shape=(), dtype=float32)
loss: tf.Tensor(0.36161405, shape=(), dtype=float32)
loss: tf.Tensor(0.39840186, shape=(), dtype=float32)
loss: tf.Tensor(0.46895173, shape=(), dtype=float32)
loss: tf.Tensor(0.33451054, shape=(), dtype=float32)
loss: tf.Tensor(0.34160042, shape=(), dtype=float32)
loss: tf.Tensor(0.38749433, shape=(), dtype=float32)
loss: tf.Tensor(0.27555913, shape=(), dtype=float32)
loss: tf.Tensor(0.39804986, shape=(), dtype=float32)
loss: tf.Tensor(0.34911403, shape=(), dtype=float32)
loss: tf.Tensor(0.3837723, shape=(), dtype=float32)
loss: tf.Tensor(0.4090688, shape=(), dtype=float32)
loss: tf.Tensor(0.6009183, shape=(), dtype=float32)
loss: tf.Tensor(0.45844838, shape=(), dtype=float32)
loss: tf.Tensor(0.50842446, shape=(), dtype=float32)
loss: tf.Tensor(0.33772033, shape=(), dtype=float32)
loss: tf.Tensor(0.41111064, shape=(), dtype=float32)
loss: tf.Tensor(0.4000989, shape=(), dtype=float32)
loss: tf.Tensor(0.4767041, shape=(), dtype=float32)
loss: tf.Tensor(0.47182766, shape=(), dtype=float32)
loss: tf.Tensor(0.4990516, shape=(), dtype=float32)
loss: tf.Tensor(0.41622308, shape=(), dtype=float32)
loss: tf.Tensor(0.4756546, shape=(), dtype=float32)
loss: tf.Tensor(0.34986442, shape=(), dtype=float32)
loss: tf.Tensor(0.43921188, shape=(), dtype=float32)
loss: tf.Tensor(0.42605674, shape=(), dtype=float32)
loss: tf.Tensor(0.50016314, shape=(), dtype=float32)
loss: tf.Tensor(0.44525757, shape=(), dtype=float32)
loss: tf.Tensor(0.4386443, shape=(), dtype=float32)
loss: tf.Tensor(0.5317426, shape=(), dtype=float32)
loss: tf.Tensor(0.35700443, shape=(), dtype=float32)
loss: tf.Tensor(0.36602488, shape=(), dtype=float32)
loss: tf.Tensor(0.519636, shape=(), dtype=float32)
loss: tf.Tensor(0.41514006, shape=(), dtype=float32)
loss: tf.Tensor(0.43983394, shape=(), dtype=float32)
loss: tf.Tensor(0.4019736, shape=(), dtype=float32)
loss: tf.Tensor(0.39138454, shape=(), dtype=float32)
loss: tf.Tensor(0.39005673, shape=(), dtype=float32)
loss: tf.Tensor(0.4298722, shape=(), dtype=float32)
loss: tf.Tensor(0.2799486, shape=(), dtype=float32)
loss: tf.Tensor(0.38858622, shape=(), dtype=float32)
loss: tf.Tensor(0.38536674, shape=(), dtype=float32)
loss: tf.Tensor(0.5859955, shape=(), dtype=float32)
loss: tf.Tensor(0.63710874, shape=(), dtype=float32)
loss: tf.Tensor(0.40699252, shape=(), dtype=float32)
loss: tf.Tensor(0.42199367, shape=(), dtype=float32)
loss: tf.Tensor(0.4429919, shape=(), dtype=float32)
loss: tf.Tensor(0.48681536, shape=(), dtype=float32)
loss: tf.Tensor(0.5285091, shape=(), dtype=float32)
loss: tf.Tensor(0.27008578, shape=(), dtype=float32)
loss: tf.Tensor(0.42866242, shape=(), dtype=float32)
loss: tf.Tensor(0.472568, shape=(), dtype=float32)
loss: tf.Tensor(3.5237002, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.7529074, shape=(), dtype=float32)
F1 SCORE:
0.81387097
EPOCH  3 #################################
loss: tf.Tensor(0.36169478, shape=(), dtype=float32)
loss: tf.Tensor(0.40298402, shape=(), dtype=float32)
loss: tf.Tensor(0.43979958, shape=(), dtype=float32)
loss: tf.Tensor(0.45042706, shape=(), dtype=float32)
loss: tf.Tensor(0.44387966, shape=(), dtype=float32)
loss: tf.Tensor(0.52326345, shape=(), dtype=float32)
loss: tf.Tensor(0.40234748, shape=(), dtype=float32)
loss: tf.Tensor(0.5115828, shape=(), dtype=float32)
loss: tf.Tensor(0.575419, shape=(), dtype=float32)
loss: tf.Tensor(0.45022634, shape=(), dtype=float32)
loss: tf.Tensor(0.41628924, shape=(), dtype=float32)
loss: tf.Tensor(0.39535463, shape=(), dtype=float32)
loss: tf.Tensor(0.32963875, shape=(), dtype=float32)
loss: tf.Tensor(0.4645861, shape=(), dtype=float32)
loss: tf.Tensor(0.42416692, shape=(), dtype=float32)
loss: tf.Tensor(0.48807317, shape=(), dtype=float32)
loss: tf.Tensor(0.45534977, shape=(), dtype=float32)
loss: tf.Tensor(0.3890746, shape=(), dtype=float32)
loss: tf.Tensor(0.398198, shape=(), dtype=float32)
loss: tf.Tensor(0.3965521, shape=(), dtype=float32)
loss: tf.Tensor(0.44858196, shape=(), dtype=float32)
loss: tf.Tensor(0.42277116, shape=(), dtype=float32)
loss: tf.Tensor(0.35064006, shape=(), dtype=float32)
loss: tf.Tensor(0.5533469, shape=(), dtype=float32)
loss: tf.Tensor(0.48932898, shape=(), dtype=float32)
loss: tf.Tensor(0.46691242, shape=(), dtype=float32)
loss: tf.Tensor(0.47804055, shape=(), dtype=float32)
loss: tf.Tensor(0.47905645, shape=(), dtype=float32)
loss: tf.Tensor(0.580075, shape=(), dtype=float32)
loss: tf.Tensor(0.5387695, shape=(), dtype=float32)
loss: tf.Tensor(0.4652484, shape=(), dtype=float32)
loss: tf.Tensor(0.47425717, shape=(), dtype=float32)
loss: tf.Tensor(0.36962608, shape=(), dtype=float32)
loss: tf.Tensor(0.44953087, shape=(), dtype=float32)
loss: tf.Tensor(0.37967736, shape=(), dtype=float32)
loss: tf.Tensor(0.4999165, shape=(), dtype=float32)
loss: tf.Tensor(0.3760741, shape=(), dtype=float32)
loss: tf.Tensor(0.3970867, shape=(), dtype=float32)
loss: tf.Tensor(0.3937279, shape=(), dtype=float32)
loss: tf.Tensor(0.5185892, shape=(), dtype=float32)
loss: tf.Tensor(0.47017464, shape=(), dtype=float32)
loss: tf.Tensor(0.389629, shape=(), dtype=float32)
loss: tf.Tensor(0.46258277, shape=(), dtype=float32)
loss: tf.Tensor(0.4008258, shape=(), dtype=float32)
loss: tf.Tensor(0.39406654, shape=(), dtype=float32)
loss: tf.Tensor(0.36454734, shape=(), dtype=float32)
loss: tf.Tensor(0.55247825, shape=(), dtype=float32)
loss: tf.Tensor(0.5411175, shape=(), dtype=float32)
loss: tf.Tensor(0.43770123, shape=(), dtype=float32)
loss: tf.Tensor(0.41830975, shape=(), dtype=float32)
loss: tf.Tensor(0.370141, shape=(), dtype=float32)
loss: tf.Tensor(0.4791079, shape=(), dtype=float32)
loss: tf.Tensor(0.42495337, shape=(), dtype=float32)
loss: tf.Tensor(0.39226848, shape=(), dtype=float32)
loss: tf.Tensor(0.4015232, shape=(), dtype=float32)
loss: tf.Tensor(0.6383395, shape=(), dtype=float32)
loss: tf.Tensor(0.42927375, shape=(), dtype=float32)
loss: tf.Tensor(0.5950596, shape=(), dtype=float32)
loss: tf.Tensor(0.4792535, shape=(), dtype=float32)
loss: tf.Tensor(0.44859937, shape=(), dtype=float32)
loss: tf.Tensor(0.3668876, shape=(), dtype=float32)
loss: tf.Tensor(0.5528699, shape=(), dtype=float32)
loss: tf.Tensor(0.52497274, shape=(), dtype=float32)
loss: tf.Tensor(0.5370117, shape=(), dtype=float32)
loss: tf.Tensor(0.32901427, shape=(), dtype=float32)
loss: tf.Tensor(0.51696813, shape=(), dtype=float32)
loss: tf.Tensor(0.37760413, shape=(), dtype=float32)
loss: tf.Tensor(0.39836478, shape=(), dtype=float32)
loss: tf.Tensor(0.48273915, shape=(), dtype=float32)
loss: tf.Tensor(0.50139815, shape=(), dtype=float32)
loss: tf.Tensor(0.42418262, shape=(), dtype=float32)
loss: tf.Tensor(0.35886788, shape=(), dtype=float32)
loss: tf.Tensor(0.41178802, shape=(), dtype=float32)
loss: tf.Tensor(0.14286938, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.7271075, shape=(), dtype=float32)
F1 SCORE:
0.8188638
EPOCH  4 #################################
loss: tf.Tensor(0.41843644, shape=(), dtype=float32)
loss: tf.Tensor(0.379429, shape=(), dtype=float32)
loss: tf.Tensor(0.31549683, shape=(), dtype=float32)
loss: tf.Tensor(0.36353374, shape=(), dtype=float32)
loss: tf.Tensor(0.33045673, shape=(), dtype=float32)
loss: tf.Tensor(0.36264327, shape=(), dtype=float32)
loss: tf.Tensor(0.4856021, shape=(), dtype=float32)
loss: tf.Tensor(0.45542863, shape=(), dtype=float32)
loss: tf.Tensor(0.5529711, shape=(), dtype=float32)
loss: tf.Tensor(0.45065454, shape=(), dtype=float32)
loss: tf.Tensor(0.34432116, shape=(), dtype=float32)
loss: tf.Tensor(0.47994483, shape=(), dtype=float32)
loss: tf.Tensor(0.3958908, shape=(), dtype=float32)
loss: tf.Tensor(0.32343605, shape=(), dtype=float32)
loss: tf.Tensor(0.40030327, shape=(), dtype=float32)
loss: tf.Tensor(0.33171254, shape=(), dtype=float32)
loss: tf.Tensor(0.41268337, shape=(), dtype=float32)
loss: tf.Tensor(0.543219, shape=(), dtype=float32)
loss: tf.Tensor(0.4551167, shape=(), dtype=float32)
loss: tf.Tensor(0.30606252, shape=(), dtype=float32)
loss: tf.Tensor(0.46011648, shape=(), dtype=float32)
loss: tf.Tensor(0.4832813, shape=(), dtype=float32)
loss: tf.Tensor(0.33951935, shape=(), dtype=float32)
loss: tf.Tensor(0.42868686, shape=(), dtype=float32)
loss: tf.Tensor(0.5036087, shape=(), dtype=float32)
loss: tf.Tensor(0.33560312, shape=(), dtype=float32)
loss: tf.Tensor(0.39928794, shape=(), dtype=float32)
loss: tf.Tensor(0.36188784, shape=(), dtype=float32)
loss: tf.Tensor(0.3872716, shape=(), dtype=float32)
loss: tf.Tensor(0.45231223, shape=(), dtype=float32)
loss: tf.Tensor(0.37721834, shape=(), dtype=float32)
loss: tf.Tensor(0.33160773, shape=(), dtype=float32)
loss: tf.Tensor(0.40818962, shape=(), dtype=float32)
loss: tf.Tensor(0.32910088, shape=(), dtype=float32)
loss: tf.Tensor(0.6303177, shape=(), dtype=float32)
loss: tf.Tensor(0.37334427, shape=(), dtype=float32)
loss: tf.Tensor(0.35085812, shape=(), dtype=float32)
loss: tf.Tensor(0.49842906, shape=(), dtype=float32)
loss: tf.Tensor(0.4390324, shape=(), dtype=float32)
loss: tf.Tensor(0.39984977, shape=(), dtype=float32)
loss: tf.Tensor(0.50534326, shape=(), dtype=float32)
loss: tf.Tensor(0.375509, shape=(), dtype=float32)
loss: tf.Tensor(0.4934434, shape=(), dtype=float32)
loss: tf.Tensor(0.36530566, shape=(), dtype=float32)
loss: tf.Tensor(0.34624976, shape=(), dtype=float32)
loss: tf.Tensor(0.37649697, shape=(), dtype=float32)
loss: tf.Tensor(0.41523302, shape=(), dtype=float32)
loss: tf.Tensor(0.46064228, shape=(), dtype=float32)
loss: tf.Tensor(0.3920182, shape=(), dtype=float32)
loss: tf.Tensor(0.3407176, shape=(), dtype=float32)
loss: tf.Tensor(0.29249454, shape=(), dtype=float32)
loss: tf.Tensor(0.45710808, shape=(), dtype=float32)
loss: tf.Tensor(0.452049, shape=(), dtype=float32)
loss: tf.Tensor(0.33503377, shape=(), dtype=float32)
loss: tf.Tensor(0.43967524, shape=(), dtype=float32)
loss: tf.Tensor(0.30492002, shape=(), dtype=float32)
loss: tf.Tensor(0.372674, shape=(), dtype=float32)
loss: tf.Tensor(0.456521, shape=(), dtype=float32)
loss: tf.Tensor(0.38810882, shape=(), dtype=float32)
loss: tf.Tensor(0.39772657, shape=(), dtype=float32)
loss: tf.Tensor(0.41941503, shape=(), dtype=float32)
loss: tf.Tensor(0.5655134, shape=(), dtype=float32)
loss: tf.Tensor(0.3285303, shape=(), dtype=float32)
loss: tf.Tensor(0.410402, shape=(), dtype=float32)
loss: tf.Tensor(0.45593238, shape=(), dtype=float32)
loss: tf.Tensor(0.22301109, shape=(), dtype=float32)
loss: tf.Tensor(0.4352557, shape=(), dtype=float32)
loss: tf.Tensor(0.3600231, shape=(), dtype=float32)
loss: tf.Tensor(0.4518574, shape=(), dtype=float32)
loss: tf.Tensor(0.51083606, shape=(), dtype=float32)
loss: tf.Tensor(0.37692657, shape=(), dtype=float32)
loss: tf.Tensor(0.37161347, shape=(), dtype=float32)
loss: tf.Tensor(0.43017197, shape=(), dtype=float32)
loss: tf.Tensor(0.5809122, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:5 out of the last 5 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71172875, shape=(), dtype=float32)
F1 SCORE:
0.8261933
EPOCH  5 #################################
loss: tf.Tensor(0.38738656, shape=(), dtype=float32)
loss: tf.Tensor(0.3749753, shape=(), dtype=float32)
loss: tf.Tensor(0.3339693, shape=(), dtype=float32)
loss: tf.Tensor(0.42797568, shape=(), dtype=float32)
loss: tf.Tensor(0.49371517, shape=(), dtype=float32)
loss: tf.Tensor(0.38724542, shape=(), dtype=float32)
loss: tf.Tensor(0.42871588, shape=(), dtype=float32)
loss: tf.Tensor(0.517494, shape=(), dtype=float32)
loss: tf.Tensor(0.47375885, shape=(), dtype=float32)
loss: tf.Tensor(0.49707258, shape=(), dtype=float32)
loss: tf.Tensor(0.4904295, shape=(), dtype=float32)
loss: tf.Tensor(0.34584913, shape=(), dtype=float32)
loss: tf.Tensor(0.31867307, shape=(), dtype=float32)
loss: tf.Tensor(0.3949717, shape=(), dtype=float32)
loss: tf.Tensor(0.21876323, shape=(), dtype=float32)
loss: tf.Tensor(0.34417754, shape=(), dtype=float32)
loss: tf.Tensor(0.3513953, shape=(), dtype=float32)
loss: tf.Tensor(0.39987686, shape=(), dtype=float32)
loss: tf.Tensor(0.29196075, shape=(), dtype=float32)
loss: tf.Tensor(0.3550542, shape=(), dtype=float32)
loss: tf.Tensor(0.38850373, shape=(), dtype=float32)
loss: tf.Tensor(0.5296894, shape=(), dtype=float32)
loss: tf.Tensor(0.32226798, shape=(), dtype=float32)
loss: tf.Tensor(0.33567247, shape=(), dtype=float32)
loss: tf.Tensor(0.3101793, shape=(), dtype=float32)
loss: tf.Tensor(0.36700103, shape=(), dtype=float32)
loss: tf.Tensor(0.42113236, shape=(), dtype=float32)
loss: tf.Tensor(0.39776635, shape=(), dtype=float32)
loss: tf.Tensor(0.5183367, shape=(), dtype=float32)
loss: tf.Tensor(0.34257764, shape=(), dtype=float32)
loss: tf.Tensor(0.23562983, shape=(), dtype=float32)
loss: tf.Tensor(0.34901834, shape=(), dtype=float32)
loss: tf.Tensor(0.2474551, shape=(), dtype=float32)
loss: tf.Tensor(0.468993, shape=(), dtype=float32)
loss: tf.Tensor(0.44680443, shape=(), dtype=float32)
loss: tf.Tensor(0.26094672, shape=(), dtype=float32)
loss: tf.Tensor(0.3347727, shape=(), dtype=float32)
loss: tf.Tensor(0.36047253, shape=(), dtype=float32)
loss: tf.Tensor(0.43586448, shape=(), dtype=float32)
loss: tf.Tensor(0.3796041, shape=(), dtype=float32)
loss: tf.Tensor(0.4778663, shape=(), dtype=float32)
loss: tf.Tensor(0.41268072, shape=(), dtype=float32)
loss: tf.Tensor(0.30932954, shape=(), dtype=float32)
loss: tf.Tensor(0.3393565, shape=(), dtype=float32)
loss: tf.Tensor(0.45978138, shape=(), dtype=float32)
loss: tf.Tensor(0.28896952, shape=(), dtype=float32)
loss: tf.Tensor(0.42781478, shape=(), dtype=float32)
loss: tf.Tensor(0.36891824, shape=(), dtype=float32)
loss: tf.Tensor(0.39411372, shape=(), dtype=float32)
loss: tf.Tensor(0.4702606, shape=(), dtype=float32)
loss: tf.Tensor(0.2993302, shape=(), dtype=float32)
loss: tf.Tensor(0.42885035, shape=(), dtype=float32)
loss: tf.Tensor(0.3190756, shape=(), dtype=float32)
loss: tf.Tensor(0.48534337, shape=(), dtype=float32)
loss: tf.Tensor(0.50831103, shape=(), dtype=float32)
loss: tf.Tensor(0.43836215, shape=(), dtype=float32)
loss: tf.Tensor(0.37745705, shape=(), dtype=float32)
loss: tf.Tensor(0.4315348, shape=(), dtype=float32)
loss: tf.Tensor(0.30634683, shape=(), dtype=float32)
loss: tf.Tensor(0.37728545, shape=(), dtype=float32)
loss: tf.Tensor(0.46527758, shape=(), dtype=float32)
loss: tf.Tensor(0.28990734, shape=(), dtype=float32)
loss: tf.Tensor(0.37214097, shape=(), dtype=float32)
loss: tf.Tensor(0.26922718, shape=(), dtype=float32)
loss: tf.Tensor(0.36182144, shape=(), dtype=float32)
loss: tf.Tensor(0.5629551, shape=(), dtype=float32)
loss: tf.Tensor(0.5322043, shape=(), dtype=float32)
loss: tf.Tensor(0.4722199, shape=(), dtype=float32)
loss: tf.Tensor(0.41939643, shape=(), dtype=float32)
loss: tf.Tensor(0.46290222, shape=(), dtype=float32)
loss: tf.Tensor(0.35548764, shape=(), dtype=float32)
loss: tf.Tensor(0.1891339, shape=(), dtype=float32)
loss: tf.Tensor(0.27480516, shape=(), dtype=float32)
loss: tf.Tensor(0.12420781, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:6 out of the last 6 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71444577, shape=(), dtype=float32)
F1 SCORE:
0.82555836
EPOCH  6 #################################
loss: tf.Tensor(0.29144487, shape=(), dtype=float32)
loss: tf.Tensor(0.34408185, shape=(), dtype=float32)
loss: tf.Tensor(0.5041128, shape=(), dtype=float32)
loss: tf.Tensor(0.40617535, shape=(), dtype=float32)
loss: tf.Tensor(0.4541796, shape=(), dtype=float32)
loss: tf.Tensor(0.31761193, shape=(), dtype=float32)
loss: tf.Tensor(0.4050248, shape=(), dtype=float32)
loss: tf.Tensor(0.34561348, shape=(), dtype=float32)
loss: tf.Tensor(0.34270766, shape=(), dtype=float32)
loss: tf.Tensor(0.35568553, shape=(), dtype=float32)
loss: tf.Tensor(0.3343115, shape=(), dtype=float32)
loss: tf.Tensor(0.36484826, shape=(), dtype=float32)
loss: tf.Tensor(0.37747002, shape=(), dtype=float32)
loss: tf.Tensor(0.5194203, shape=(), dtype=float32)
loss: tf.Tensor(0.43752307, shape=(), dtype=float32)
loss: tf.Tensor(0.3135553, shape=(), dtype=float32)
loss: tf.Tensor(0.42163658, shape=(), dtype=float32)
loss: tf.Tensor(0.33140633, shape=(), dtype=float32)
loss: tf.Tensor(0.43139187, shape=(), dtype=float32)
loss: tf.Tensor(0.42233858, shape=(), dtype=float32)
loss: tf.Tensor(0.29256475, shape=(), dtype=float32)
loss: tf.Tensor(0.28899944, shape=(), dtype=float32)
loss: tf.Tensor(0.36045226, shape=(), dtype=float32)
loss: tf.Tensor(0.2960128, shape=(), dtype=float32)
loss: tf.Tensor(0.20143612, shape=(), dtype=float32)
loss: tf.Tensor(0.34772563, shape=(), dtype=float32)
loss: tf.Tensor(0.4054515, shape=(), dtype=float32)
loss: tf.Tensor(0.38160023, shape=(), dtype=float32)
loss: tf.Tensor(0.39612126, shape=(), dtype=float32)
loss: tf.Tensor(0.44125497, shape=(), dtype=float32)
loss: tf.Tensor(0.37487862, shape=(), dtype=float32)
loss: tf.Tensor(0.25128287, shape=(), dtype=float32)
loss: tf.Tensor(0.37391624, shape=(), dtype=float32)
loss: tf.Tensor(0.42003527, shape=(), dtype=float32)
loss: tf.Tensor(0.36150292, shape=(), dtype=float32)
loss: tf.Tensor(0.4264756, shape=(), dtype=float32)
loss: tf.Tensor(0.2423288, shape=(), dtype=float32)
loss: tf.Tensor(0.36269242, shape=(), dtype=float32)
loss: tf.Tensor(0.30248433, shape=(), dtype=float32)
loss: tf.Tensor(0.4561423, shape=(), dtype=float32)
loss: tf.Tensor(0.30614665, shape=(), dtype=float32)
loss: tf.Tensor(0.40938655, shape=(), dtype=float32)
loss: tf.Tensor(0.4922338, shape=(), dtype=float32)
loss: tf.Tensor(0.2854199, shape=(), dtype=float32)
loss: tf.Tensor(0.37991685, shape=(), dtype=float32)
loss: tf.Tensor(0.41773456, shape=(), dtype=float32)
loss: tf.Tensor(0.44278812, shape=(), dtype=float32)
loss: tf.Tensor(0.27669352, shape=(), dtype=float32)
loss: tf.Tensor(0.29393876, shape=(), dtype=float32)
loss: tf.Tensor(0.49444556, shape=(), dtype=float32)
loss: tf.Tensor(0.34857786, shape=(), dtype=float32)
loss: tf.Tensor(0.42300206, shape=(), dtype=float32)
loss: tf.Tensor(0.3484505, shape=(), dtype=float32)
loss: tf.Tensor(0.25834236, shape=(), dtype=float32)
loss: tf.Tensor(0.3494157, shape=(), dtype=float32)
loss: tf.Tensor(0.34422648, shape=(), dtype=float32)
loss: tf.Tensor(0.43908742, shape=(), dtype=float32)
loss: tf.Tensor(0.386824, shape=(), dtype=float32)
loss: tf.Tensor(0.31467855, shape=(), dtype=float32)
loss: tf.Tensor(0.29167053, shape=(), dtype=float32)
loss: tf.Tensor(0.34315747, shape=(), dtype=float32)
loss: tf.Tensor(0.41340813, shape=(), dtype=float32)
loss: tf.Tensor(0.28055775, shape=(), dtype=float32)
loss: tf.Tensor(0.4218066, shape=(), dtype=float32)
loss: tf.Tensor(0.4789499, shape=(), dtype=float32)
loss: tf.Tensor(0.27247432, shape=(), dtype=float32)
loss: tf.Tensor(0.34224114, shape=(), dtype=float32)
loss: tf.Tensor(0.500152, shape=(), dtype=float32)
loss: tf.Tensor(0.3405707, shape=(), dtype=float32)
loss: tf.Tensor(0.35020584, shape=(), dtype=float32)
loss: tf.Tensor(0.37886447, shape=(), dtype=float32)
loss: tf.Tensor(0.36866572, shape=(), dtype=float32)
loss: tf.Tensor(0.38355982, shape=(), dtype=float32)
loss: tf.Tensor(0.0031047496, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:7 out of the last 7 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71062684, shape=(), dtype=float32)
F1 SCORE:
0.82672554
EPOCH  7 #################################
loss: tf.Tensor(0.2953306, shape=(), dtype=float32)
loss: tf.Tensor(0.4203746, shape=(), dtype=float32)
loss: tf.Tensor(0.43662602, shape=(), dtype=float32)
loss: tf.Tensor(0.3190532, shape=(), dtype=float32)
loss: tf.Tensor(0.45085526, shape=(), dtype=float32)
loss: tf.Tensor(0.37222517, shape=(), dtype=float32)
loss: tf.Tensor(0.36161822, shape=(), dtype=float32)
loss: tf.Tensor(0.45691222, shape=(), dtype=float32)
loss: tf.Tensor(0.36937034, shape=(), dtype=float32)
loss: tf.Tensor(0.3132811, shape=(), dtype=float32)
loss: tf.Tensor(0.39430836, shape=(), dtype=float32)
loss: tf.Tensor(0.23886986, shape=(), dtype=float32)
loss: tf.Tensor(0.3824115, shape=(), dtype=float32)
loss: tf.Tensor(0.47296947, shape=(), dtype=float32)
loss: tf.Tensor(0.32903764, shape=(), dtype=float32)
loss: tf.Tensor(0.3783827, shape=(), dtype=float32)
loss: tf.Tensor(0.34455678, shape=(), dtype=float32)
loss: tf.Tensor(0.38782176, shape=(), dtype=float32)
loss: tf.Tensor(0.30756286, shape=(), dtype=float32)
loss: tf.Tensor(0.3126982, shape=(), dtype=float32)
loss: tf.Tensor(0.30188245, shape=(), dtype=float32)
loss: tf.Tensor(0.33206168, shape=(), dtype=float32)
loss: tf.Tensor(0.3352173, shape=(), dtype=float32)
loss: tf.Tensor(0.31265303, shape=(), dtype=float32)
loss: tf.Tensor(0.34826759, shape=(), dtype=float32)
loss: tf.Tensor(0.30557728, shape=(), dtype=float32)
loss: tf.Tensor(0.27087316, shape=(), dtype=float32)
loss: tf.Tensor(0.29275736, shape=(), dtype=float32)
loss: tf.Tensor(0.4246898, shape=(), dtype=float32)
loss: tf.Tensor(0.25783944, shape=(), dtype=float32)
loss: tf.Tensor(0.24852645, shape=(), dtype=float32)
loss: tf.Tensor(0.33929756, shape=(), dtype=float32)
loss: tf.Tensor(0.27354568, shape=(), dtype=float32)
loss: tf.Tensor(0.38537297, shape=(), dtype=float32)
loss: tf.Tensor(0.30456123, shape=(), dtype=float32)
loss: tf.Tensor(0.40697825, shape=(), dtype=float32)
loss: tf.Tensor(0.35951427, shape=(), dtype=float32)
loss: tf.Tensor(0.19736576, shape=(), dtype=float32)
loss: tf.Tensor(0.2369342, shape=(), dtype=float32)
loss: tf.Tensor(0.4233091, shape=(), dtype=float32)
loss: tf.Tensor(0.32164794, shape=(), dtype=float32)
loss: tf.Tensor(0.2585991, shape=(), dtype=float32)
loss: tf.Tensor(0.23006107, shape=(), dtype=float32)
loss: tf.Tensor(0.37045392, shape=(), dtype=float32)
loss: tf.Tensor(0.4210198, shape=(), dtype=float32)
loss: tf.Tensor(0.4362664, shape=(), dtype=float32)
loss: tf.Tensor(0.42299697, shape=(), dtype=float32)
loss: tf.Tensor(0.33136287, shape=(), dtype=float32)
loss: tf.Tensor(0.3177987, shape=(), dtype=float32)
loss: tf.Tensor(0.34359452, shape=(), dtype=float32)
loss: tf.Tensor(0.29918677, shape=(), dtype=float32)
loss: tf.Tensor(0.27179435, shape=(), dtype=float32)
loss: tf.Tensor(0.3123585, shape=(), dtype=float32)
loss: tf.Tensor(0.31155863, shape=(), dtype=float32)
loss: tf.Tensor(0.30812144, shape=(), dtype=float32)
loss: tf.Tensor(0.2715568, shape=(), dtype=float32)
loss: tf.Tensor(0.27993572, shape=(), dtype=float32)
loss: tf.Tensor(0.27905786, shape=(), dtype=float32)
loss: tf.Tensor(0.21218853, shape=(), dtype=float32)
loss: tf.Tensor(0.3078891, shape=(), dtype=float32)
loss: tf.Tensor(0.18910764, shape=(), dtype=float32)
loss: tf.Tensor(0.2480219, shape=(), dtype=float32)
loss: tf.Tensor(0.36407325, shape=(), dtype=float32)
loss: tf.Tensor(0.35073316, shape=(), dtype=float32)
loss: tf.Tensor(0.4692315, shape=(), dtype=float32)
loss: tf.Tensor(0.25634953, shape=(), dtype=float32)
loss: tf.Tensor(0.45434254, shape=(), dtype=float32)
loss: tf.Tensor(0.31358293, shape=(), dtype=float32)
loss: tf.Tensor(0.43454745, shape=(), dtype=float32)
loss: tf.Tensor(0.3582093, shape=(), dtype=float32)
loss: tf.Tensor(0.29908034, shape=(), dtype=float32)
loss: tf.Tensor(0.40250102, shape=(), dtype=float32)
loss: tf.Tensor(0.4213332, shape=(), dtype=float32)
loss: tf.Tensor(0.013223098, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:8 out of the last 8 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7207545, shape=(), dtype=float32)
F1 SCORE:
0.8264711
EPOCH  8 #################################
loss: tf.Tensor(0.28148574, shape=(), dtype=float32)
loss: tf.Tensor(0.30343097, shape=(), dtype=float32)
loss: tf.Tensor(0.27869663, shape=(), dtype=float32)
loss: tf.Tensor(0.32785282, shape=(), dtype=float32)
loss: tf.Tensor(0.40373063, shape=(), dtype=float32)
loss: tf.Tensor(0.2687291, shape=(), dtype=float32)
loss: tf.Tensor(0.30856693, shape=(), dtype=float32)
loss: tf.Tensor(0.343121, shape=(), dtype=float32)
loss: tf.Tensor(0.32314044, shape=(), dtype=float32)
loss: tf.Tensor(0.26652765, shape=(), dtype=float32)
loss: tf.Tensor(0.33620042, shape=(), dtype=float32)
loss: tf.Tensor(0.32940075, shape=(), dtype=float32)
loss: tf.Tensor(0.27531627, shape=(), dtype=float32)
loss: tf.Tensor(0.33686253, shape=(), dtype=float32)
loss: tf.Tensor(0.37102723, shape=(), dtype=float32)
loss: tf.Tensor(0.29947904, shape=(), dtype=float32)
loss: tf.Tensor(0.24374181, shape=(), dtype=float32)
loss: tf.Tensor(0.347382, shape=(), dtype=float32)
loss: tf.Tensor(0.4054401, shape=(), dtype=float32)
loss: tf.Tensor(0.39799032, shape=(), dtype=float32)
loss: tf.Tensor(0.2175073, shape=(), dtype=float32)
loss: tf.Tensor(0.35046872, shape=(), dtype=float32)
loss: tf.Tensor(0.19999461, shape=(), dtype=float32)
loss: tf.Tensor(0.29463136, shape=(), dtype=float32)
loss: tf.Tensor(0.3097757, shape=(), dtype=float32)
loss: tf.Tensor(0.383363, shape=(), dtype=float32)
loss: tf.Tensor(0.36942533, shape=(), dtype=float32)
loss: tf.Tensor(0.26618242, shape=(), dtype=float32)
loss: tf.Tensor(0.2308205, shape=(), dtype=float32)
loss: tf.Tensor(0.3128347, shape=(), dtype=float32)
loss: tf.Tensor(0.28948987, shape=(), dtype=float32)
loss: tf.Tensor(0.18515326, shape=(), dtype=float32)
loss: tf.Tensor(0.14886466, shape=(), dtype=float32)
loss: tf.Tensor(0.45397437, shape=(), dtype=float32)
loss: tf.Tensor(0.27149025, shape=(), dtype=float32)
loss: tf.Tensor(0.49253595, shape=(), dtype=float32)
loss: tf.Tensor(0.2394306, shape=(), dtype=float32)
loss: tf.Tensor(0.28662768, shape=(), dtype=float32)
loss: tf.Tensor(0.3546694, shape=(), dtype=float32)
loss: tf.Tensor(0.29241025, shape=(), dtype=float32)
loss: tf.Tensor(0.2715091, shape=(), dtype=float32)
loss: tf.Tensor(0.30920205, shape=(), dtype=float32)
loss: tf.Tensor(0.2877761, shape=(), dtype=float32)
loss: tf.Tensor(0.20206381, shape=(), dtype=float32)
loss: tf.Tensor(0.37923542, shape=(), dtype=float32)
loss: tf.Tensor(0.3308941, shape=(), dtype=float32)
loss: tf.Tensor(0.19943672, shape=(), dtype=float32)
loss: tf.Tensor(0.26858515, shape=(), dtype=float32)
loss: tf.Tensor(0.33816758, shape=(), dtype=float32)
loss: tf.Tensor(0.38157514, shape=(), dtype=float32)
loss: tf.Tensor(0.39243168, shape=(), dtype=float32)
loss: tf.Tensor(0.28333518, shape=(), dtype=float32)
loss: tf.Tensor(0.40514854, shape=(), dtype=float32)
loss: tf.Tensor(0.26292437, shape=(), dtype=float32)
loss: tf.Tensor(0.38542253, shape=(), dtype=float32)
loss: tf.Tensor(0.28007677, shape=(), dtype=float32)
loss: tf.Tensor(0.32723668, shape=(), dtype=float32)
loss: tf.Tensor(0.2626153, shape=(), dtype=float32)
loss: tf.Tensor(0.3123577, shape=(), dtype=float32)
loss: tf.Tensor(0.38525844, shape=(), dtype=float32)
loss: tf.Tensor(0.3020274, shape=(), dtype=float32)
loss: tf.Tensor(0.3745677, shape=(), dtype=float32)
loss: tf.Tensor(0.23612495, shape=(), dtype=float32)
loss: tf.Tensor(0.1947117, shape=(), dtype=float32)
loss: tf.Tensor(0.3212056, shape=(), dtype=float32)
loss: tf.Tensor(0.36892784, shape=(), dtype=float32)
loss: tf.Tensor(0.3077002, shape=(), dtype=float32)
loss: tf.Tensor(0.32139012, shape=(), dtype=float32)
loss: tf.Tensor(0.2922039, shape=(), dtype=float32)
loss: tf.Tensor(0.3140843, shape=(), dtype=float32)
loss: tf.Tensor(0.23231317, shape=(), dtype=float32)
loss: tf.Tensor(0.3248722, shape=(), dtype=float32)
loss: tf.Tensor(0.3440326, shape=(), dtype=float32)
loss: tf.Tensor(0.01695495, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:9 out of the last 9 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71853226, shape=(), dtype=float32)
F1 SCORE:
0.82637763
EPOCH  9 #################################
loss: tf.Tensor(0.3288994, shape=(), dtype=float32)
loss: tf.Tensor(0.1914756, shape=(), dtype=float32)
loss: tf.Tensor(0.28554088, shape=(), dtype=float32)
loss: tf.Tensor(0.2164323, shape=(), dtype=float32)
loss: tf.Tensor(0.27510324, shape=(), dtype=float32)
loss: tf.Tensor(0.121879146, shape=(), dtype=float32)
loss: tf.Tensor(0.2590658, shape=(), dtype=float32)
loss: tf.Tensor(0.291126, shape=(), dtype=float32)
loss: tf.Tensor(0.27511308, shape=(), dtype=float32)
loss: tf.Tensor(0.26225993, shape=(), dtype=float32)
loss: tf.Tensor(0.34903476, shape=(), dtype=float32)
loss: tf.Tensor(0.24597558, shape=(), dtype=float32)
loss: tf.Tensor(0.27639866, shape=(), dtype=float32)
loss: tf.Tensor(0.33470127, shape=(), dtype=float32)
loss: tf.Tensor(0.278157, shape=(), dtype=float32)
loss: tf.Tensor(0.25127503, shape=(), dtype=float32)
loss: tf.Tensor(0.22523966, shape=(), dtype=float32)
loss: tf.Tensor(0.25562787, shape=(), dtype=float32)
loss: tf.Tensor(0.23881024, shape=(), dtype=float32)
loss: tf.Tensor(0.2754098, shape=(), dtype=float32)
loss: tf.Tensor(0.37793335, shape=(), dtype=float32)
loss: tf.Tensor(0.2947, shape=(), dtype=float32)
loss: tf.Tensor(0.33264053, shape=(), dtype=float32)
loss: tf.Tensor(0.23521893, shape=(), dtype=float32)
loss: tf.Tensor(0.22878236, shape=(), dtype=float32)
loss: tf.Tensor(0.25251454, shape=(), dtype=float32)
loss: tf.Tensor(0.22423719, shape=(), dtype=float32)
loss: tf.Tensor(0.24004911, shape=(), dtype=float32)
loss: tf.Tensor(0.3405703, shape=(), dtype=float32)
loss: tf.Tensor(0.41509265, shape=(), dtype=float32)
loss: tf.Tensor(0.373306, shape=(), dtype=float32)
loss: tf.Tensor(0.20989999, shape=(), dtype=float32)
loss: tf.Tensor(0.28616223, shape=(), dtype=float32)
loss: tf.Tensor(0.43879268, shape=(), dtype=float32)
loss: tf.Tensor(0.34060848, shape=(), dtype=float32)
loss: tf.Tensor(0.25446397, shape=(), dtype=float32)
loss: tf.Tensor(0.32769227, shape=(), dtype=float32)
loss: tf.Tensor(0.20342481, shape=(), dtype=float32)
loss: tf.Tensor(0.43858978, shape=(), dtype=float32)
loss: tf.Tensor(0.39203823, shape=(), dtype=float32)
loss: tf.Tensor(0.3095252, shape=(), dtype=float32)
loss: tf.Tensor(0.45145923, shape=(), dtype=float32)
loss: tf.Tensor(0.22037719, shape=(), dtype=float32)
loss: tf.Tensor(0.27329704, shape=(), dtype=float32)
loss: tf.Tensor(0.38186675, shape=(), dtype=float32)
loss: tf.Tensor(0.39644402, shape=(), dtype=float32)
loss: tf.Tensor(0.28492466, shape=(), dtype=float32)
loss: tf.Tensor(0.23931359, shape=(), dtype=float32)
loss: tf.Tensor(0.36294422, shape=(), dtype=float32)
loss: tf.Tensor(0.28418624, shape=(), dtype=float32)
loss: tf.Tensor(0.31543902, shape=(), dtype=float32)
loss: tf.Tensor(0.28938952, shape=(), dtype=float32)
loss: tf.Tensor(0.3447173, shape=(), dtype=float32)
loss: tf.Tensor(0.26076967, shape=(), dtype=float32)
loss: tf.Tensor(0.31078744, shape=(), dtype=float32)
loss: tf.Tensor(0.22411713, shape=(), dtype=float32)
loss: tf.Tensor(0.23070948, shape=(), dtype=float32)
loss: tf.Tensor(0.27333346, shape=(), dtype=float32)
loss: tf.Tensor(0.27023992, shape=(), dtype=float32)
loss: tf.Tensor(0.34194794, shape=(), dtype=float32)
loss: tf.Tensor(0.30749848, shape=(), dtype=float32)
loss: tf.Tensor(0.3160296, shape=(), dtype=float32)
loss: tf.Tensor(0.19068035, shape=(), dtype=float32)
loss: tf.Tensor(0.20178828, shape=(), dtype=float32)
loss: tf.Tensor(0.3541489, shape=(), dtype=float32)
loss: tf.Tensor(0.31858358, shape=(), dtype=float32)
loss: tf.Tensor(0.30114946, shape=(), dtype=float32)
loss: tf.Tensor(0.35274985, shape=(), dtype=float32)
loss: tf.Tensor(0.39808038, shape=(), dtype=float32)
loss: tf.Tensor(0.2790471, shape=(), dtype=float32)
loss: tf.Tensor(0.2997306, shape=(), dtype=float32)
loss: tf.Tensor(0.3127233, shape=(), dtype=float32)
loss: tf.Tensor(0.29749423, shape=(), dtype=float32)
loss: tf.Tensor(0.46430445, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:10 out of the last 10 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.72073096, shape=(), dtype=float32)
F1 SCORE:
0.8255363
EPOCH  10 #################################
loss: tf.Tensor(0.25455418, shape=(), dtype=float32)
loss: tf.Tensor(0.3602684, shape=(), dtype=float32)
loss: tf.Tensor(0.48149422, shape=(), dtype=float32)
loss: tf.Tensor(0.2908698, shape=(), dtype=float32)
loss: tf.Tensor(0.2968852, shape=(), dtype=float32)
loss: tf.Tensor(0.19518952, shape=(), dtype=float32)
loss: tf.Tensor(0.18583657, shape=(), dtype=float32)
loss: tf.Tensor(0.2651724, shape=(), dtype=float32)
loss: tf.Tensor(0.2663306, shape=(), dtype=float32)
loss: tf.Tensor(0.3344367, shape=(), dtype=float32)
loss: tf.Tensor(0.34308755, shape=(), dtype=float32)
loss: tf.Tensor(0.18957777, shape=(), dtype=float32)
loss: tf.Tensor(0.30334932, shape=(), dtype=float32)
loss: tf.Tensor(0.31266358, shape=(), dtype=float32)
loss: tf.Tensor(0.28011122, shape=(), dtype=float32)
loss: tf.Tensor(0.24967669, shape=(), dtype=float32)
loss: tf.Tensor(0.2157523, shape=(), dtype=float32)
loss: tf.Tensor(0.33370456, shape=(), dtype=float32)
loss: tf.Tensor(0.3873486, shape=(), dtype=float32)
loss: tf.Tensor(0.22862078, shape=(), dtype=float32)
loss: tf.Tensor(0.37846115, shape=(), dtype=float32)
loss: tf.Tensor(0.2566526, shape=(), dtype=float32)
loss: tf.Tensor(0.3785512, shape=(), dtype=float32)
loss: tf.Tensor(0.24614246, shape=(), dtype=float32)
loss: tf.Tensor(0.31636098, shape=(), dtype=float32)
loss: tf.Tensor(0.36180508, shape=(), dtype=float32)
loss: tf.Tensor(0.25615528, shape=(), dtype=float32)
loss: tf.Tensor(0.25076026, shape=(), dtype=float32)
loss: tf.Tensor(0.2828372, shape=(), dtype=float32)
loss: tf.Tensor(0.27693996, shape=(), dtype=float32)
loss: tf.Tensor(0.30322096, shape=(), dtype=float32)
loss: tf.Tensor(0.23913933, shape=(), dtype=float32)
loss: tf.Tensor(0.17397171, shape=(), dtype=float32)
loss: tf.Tensor(0.2739858, shape=(), dtype=float32)
loss: tf.Tensor(0.40449226, shape=(), dtype=float32)
loss: tf.Tensor(0.24495916, shape=(), dtype=float32)
loss: tf.Tensor(0.15435384, shape=(), dtype=float32)
loss: tf.Tensor(0.28368104, shape=(), dtype=float32)
loss: tf.Tensor(0.156038, shape=(), dtype=float32)
loss: tf.Tensor(0.27882203, shape=(), dtype=float32)
loss: tf.Tensor(0.26531202, shape=(), dtype=float32)
loss: tf.Tensor(0.25768718, shape=(), dtype=float32)
loss: tf.Tensor(0.36977172, shape=(), dtype=float32)
loss: tf.Tensor(0.3751407, shape=(), dtype=float32)
loss: tf.Tensor(0.18954228, shape=(), dtype=float32)
loss: tf.Tensor(0.2370237, shape=(), dtype=float32)
loss: tf.Tensor(0.37132415, shape=(), dtype=float32)
loss: tf.Tensor(0.25858483, shape=(), dtype=float32)
loss: tf.Tensor(0.232486, shape=(), dtype=float32)
loss: tf.Tensor(0.20159611, shape=(), dtype=float32)
loss: tf.Tensor(0.22515067, shape=(), dtype=float32)
loss: tf.Tensor(0.3192735, shape=(), dtype=float32)
loss: tf.Tensor(0.21944073, shape=(), dtype=float32)
loss: tf.Tensor(0.29992202, shape=(), dtype=float32)
loss: tf.Tensor(0.38479972, shape=(), dtype=float32)
loss: tf.Tensor(0.30340767, shape=(), dtype=float32)
loss: tf.Tensor(0.22634289, shape=(), dtype=float32)
loss: tf.Tensor(0.2564962, shape=(), dtype=float32)
loss: tf.Tensor(0.24838309, shape=(), dtype=float32)
loss: tf.Tensor(0.18244131, shape=(), dtype=float32)
loss: tf.Tensor(0.25870353, shape=(), dtype=float32)
loss: tf.Tensor(0.17721952, shape=(), dtype=float32)
loss: tf.Tensor(0.37497193, shape=(), dtype=float32)
loss: tf.Tensor(0.2974039, shape=(), dtype=float32)
loss: tf.Tensor(0.28481102, shape=(), dtype=float32)
loss: tf.Tensor(0.25603494, shape=(), dtype=float32)
loss: tf.Tensor(0.22046329, shape=(), dtype=float32)
loss: tf.Tensor(0.3000226, shape=(), dtype=float32)
loss: tf.Tensor(0.23906158, shape=(), dtype=float32)
loss: tf.Tensor(0.21382196, shape=(), dtype=float32)
loss: tf.Tensor(0.39291844, shape=(), dtype=float32)
loss: tf.Tensor(0.40690246, shape=(), dtype=float32)
loss: tf.Tensor(0.18341638, shape=(), dtype=float32)
loss: tf.Tensor(0.020738665, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71387094, shape=(), dtype=float32)
F1 SCORE:
0.82659715
EPOCH  11 #################################
loss: tf.Tensor(0.28019312, shape=(), dtype=float32)
loss: tf.Tensor(0.23603237, shape=(), dtype=float32)
loss: tf.Tensor(0.25969514, shape=(), dtype=float32)
loss: tf.Tensor(0.15915403, shape=(), dtype=float32)
loss: tf.Tensor(0.22903375, shape=(), dtype=float32)
loss: tf.Tensor(0.2471721, shape=(), dtype=float32)
loss: tf.Tensor(0.26729548, shape=(), dtype=float32)
loss: tf.Tensor(0.3580044, shape=(), dtype=float32)
loss: tf.Tensor(0.17556767, shape=(), dtype=float32)
loss: tf.Tensor(0.24342668, shape=(), dtype=float32)
loss: tf.Tensor(0.21961115, shape=(), dtype=float32)
loss: tf.Tensor(0.26673764, shape=(), dtype=float32)
loss: tf.Tensor(0.2092151, shape=(), dtype=float32)
loss: tf.Tensor(0.19822091, shape=(), dtype=float32)
loss: tf.Tensor(0.19564459, shape=(), dtype=float32)
loss: tf.Tensor(0.22800764, shape=(), dtype=float32)
loss: tf.Tensor(0.25000712, shape=(), dtype=float32)
loss: tf.Tensor(0.19840308, shape=(), dtype=float32)
loss: tf.Tensor(0.19277579, shape=(), dtype=float32)
loss: tf.Tensor(0.27080098, shape=(), dtype=float32)
loss: tf.Tensor(0.2982441, shape=(), dtype=float32)
loss: tf.Tensor(0.27817822, shape=(), dtype=float32)
loss: tf.Tensor(0.20747177, shape=(), dtype=float32)
loss: tf.Tensor(0.2770038, shape=(), dtype=float32)
loss: tf.Tensor(0.24454975, shape=(), dtype=float32)
loss: tf.Tensor(0.31119683, shape=(), dtype=float32)
loss: tf.Tensor(0.18218042, shape=(), dtype=float32)
loss: tf.Tensor(0.24699073, shape=(), dtype=float32)
loss: tf.Tensor(0.23660266, shape=(), dtype=float32)
loss: tf.Tensor(0.28981987, shape=(), dtype=float32)
loss: tf.Tensor(0.30028376, shape=(), dtype=float32)
loss: tf.Tensor(0.24071604, shape=(), dtype=float32)
loss: tf.Tensor(0.1301335, shape=(), dtype=float32)
loss: tf.Tensor(0.27231625, shape=(), dtype=float32)
loss: tf.Tensor(0.25655586, shape=(), dtype=float32)
loss: tf.Tensor(0.26257062, shape=(), dtype=float32)
loss: tf.Tensor(0.28408715, shape=(), dtype=float32)
loss: tf.Tensor(0.20719528, shape=(), dtype=float32)
loss: tf.Tensor(0.20982414, shape=(), dtype=float32)
loss: tf.Tensor(0.3146688, shape=(), dtype=float32)
loss: tf.Tensor(0.24295454, shape=(), dtype=float32)
loss: tf.Tensor(0.13126592, shape=(), dtype=float32)
loss: tf.Tensor(0.20684588, shape=(), dtype=float32)
loss: tf.Tensor(0.14270005, shape=(), dtype=float32)
loss: tf.Tensor(0.25820166, shape=(), dtype=float32)
loss: tf.Tensor(0.24723, shape=(), dtype=float32)
loss: tf.Tensor(0.27577302, shape=(), dtype=float32)
loss: tf.Tensor(0.23213963, shape=(), dtype=float32)
loss: tf.Tensor(0.3063999, shape=(), dtype=float32)
loss: tf.Tensor(0.16842729, shape=(), dtype=float32)
loss: tf.Tensor(0.24571432, shape=(), dtype=float32)
loss: tf.Tensor(0.26812875, shape=(), dtype=float32)
loss: tf.Tensor(0.21532823, shape=(), dtype=float32)
loss: tf.Tensor(0.24744232, shape=(), dtype=float32)
loss: tf.Tensor(0.18072337, shape=(), dtype=float32)
loss: tf.Tensor(0.23390454, shape=(), dtype=float32)
loss: tf.Tensor(0.19943753, shape=(), dtype=float32)
loss: tf.Tensor(0.23315407, shape=(), dtype=float32)
loss: tf.Tensor(0.21302195, shape=(), dtype=float32)
loss: tf.Tensor(0.17913479, shape=(), dtype=float32)
loss: tf.Tensor(0.31919742, shape=(), dtype=float32)
loss: tf.Tensor(0.21436363, shape=(), dtype=float32)
loss: tf.Tensor(0.29723948, shape=(), dtype=float32)
loss: tf.Tensor(0.18495275, shape=(), dtype=float32)
loss: tf.Tensor(0.2744036, shape=(), dtype=float32)
loss: tf.Tensor(0.2647117, shape=(), dtype=float32)
loss: tf.Tensor(0.28910273, shape=(), dtype=float32)
loss: tf.Tensor(0.14575364, shape=(), dtype=float32)
loss: tf.Tensor(0.26998207, shape=(), dtype=float32)
loss: tf.Tensor(0.23596784, shape=(), dtype=float32)
loss: tf.Tensor(0.19495474, shape=(), dtype=float32)
loss: tf.Tensor(0.3011211, shape=(), dtype=float32)
loss: tf.Tensor(0.15063724, shape=(), dtype=float32)
loss: tf.Tensor(0.029500326, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71586174, shape=(), dtype=float32)
F1 SCORE:
0.8257456
EPOCH  12 #################################
loss: tf.Tensor(0.13015541, shape=(), dtype=float32)
loss: tf.Tensor(0.2752194, shape=(), dtype=float32)
loss: tf.Tensor(0.12912796, shape=(), dtype=float32)
loss: tf.Tensor(0.26784933, shape=(), dtype=float32)
loss: tf.Tensor(0.23999958, shape=(), dtype=float32)
loss: tf.Tensor(0.20720783, shape=(), dtype=float32)
loss: tf.Tensor(0.2657267, shape=(), dtype=float32)
loss: tf.Tensor(0.2192081, shape=(), dtype=float32)
loss: tf.Tensor(0.21189351, shape=(), dtype=float32)
loss: tf.Tensor(0.2097969, shape=(), dtype=float32)
loss: tf.Tensor(0.13553564, shape=(), dtype=float32)
loss: tf.Tensor(0.17752683, shape=(), dtype=float32)
loss: tf.Tensor(0.26391762, shape=(), dtype=float32)
loss: tf.Tensor(0.18979426, shape=(), dtype=float32)
loss: tf.Tensor(0.17404476, shape=(), dtype=float32)
loss: tf.Tensor(0.26850212, shape=(), dtype=float32)
loss: tf.Tensor(0.20758834, shape=(), dtype=float32)
loss: tf.Tensor(0.17828064, shape=(), dtype=float32)
loss: tf.Tensor(0.19924656, shape=(), dtype=float32)
loss: tf.Tensor(0.3113315, shape=(), dtype=float32)
loss: tf.Tensor(0.30790913, shape=(), dtype=float32)
loss: tf.Tensor(0.18292052, shape=(), dtype=float32)
loss: tf.Tensor(0.14016847, shape=(), dtype=float32)
loss: tf.Tensor(0.25621083, shape=(), dtype=float32)
loss: tf.Tensor(0.12371047, shape=(), dtype=float32)
loss: tf.Tensor(0.13684116, shape=(), dtype=float32)
loss: tf.Tensor(0.20202555, shape=(), dtype=float32)
loss: tf.Tensor(0.22593778, shape=(), dtype=float32)
loss: tf.Tensor(0.20421246, shape=(), dtype=float32)
loss: tf.Tensor(0.12935817, shape=(), dtype=float32)
loss: tf.Tensor(0.22571903, shape=(), dtype=float32)
loss: tf.Tensor(0.28178218, shape=(), dtype=float32)
loss: tf.Tensor(0.14017504, shape=(), dtype=float32)
loss: tf.Tensor(0.2244678, shape=(), dtype=float32)
loss: tf.Tensor(0.23751543, shape=(), dtype=float32)
loss: tf.Tensor(0.17418303, shape=(), dtype=float32)
loss: tf.Tensor(0.29149348, shape=(), dtype=float32)
loss: tf.Tensor(0.14202875, shape=(), dtype=float32)
loss: tf.Tensor(0.1375045, shape=(), dtype=float32)
loss: tf.Tensor(0.22622763, shape=(), dtype=float32)
loss: tf.Tensor(0.18753557, shape=(), dtype=float32)
loss: tf.Tensor(0.2433618, shape=(), dtype=float32)
loss: tf.Tensor(0.26621333, shape=(), dtype=float32)
loss: tf.Tensor(0.18991096, shape=(), dtype=float32)
loss: tf.Tensor(0.22802427, shape=(), dtype=float32)
loss: tf.Tensor(0.16362388, shape=(), dtype=float32)
loss: tf.Tensor(0.27505302, shape=(), dtype=float32)
loss: tf.Tensor(0.12475335, shape=(), dtype=float32)
loss: tf.Tensor(0.1803903, shape=(), dtype=float32)
loss: tf.Tensor(0.27889442, shape=(), dtype=float32)
loss: tf.Tensor(0.18923609, shape=(), dtype=float32)
loss: tf.Tensor(0.15268013, shape=(), dtype=float32)
loss: tf.Tensor(0.2455268, shape=(), dtype=float32)
loss: tf.Tensor(0.22212669, shape=(), dtype=float32)
loss: tf.Tensor(0.15740259, shape=(), dtype=float32)
loss: tf.Tensor(0.37398538, shape=(), dtype=float32)
loss: tf.Tensor(0.30494678, shape=(), dtype=float32)
loss: tf.Tensor(0.21763162, shape=(), dtype=float32)
loss: tf.Tensor(0.23439102, shape=(), dtype=float32)
loss: tf.Tensor(0.22852598, shape=(), dtype=float32)
loss: tf.Tensor(0.23171785, shape=(), dtype=float32)
loss: tf.Tensor(0.26029307, shape=(), dtype=float32)
loss: tf.Tensor(0.22901411, shape=(), dtype=float32)
loss: tf.Tensor(0.2574964, shape=(), dtype=float32)
loss: tf.Tensor(0.27736482, shape=(), dtype=float32)
loss: tf.Tensor(0.17507422, shape=(), dtype=float32)
loss: tf.Tensor(0.16697563, shape=(), dtype=float32)
loss: tf.Tensor(0.16159117, shape=(), dtype=float32)
loss: tf.Tensor(0.2930237, shape=(), dtype=float32)
loss: tf.Tensor(0.21103832, shape=(), dtype=float32)
loss: tf.Tensor(0.21959089, shape=(), dtype=float32)
loss: tf.Tensor(0.26160038, shape=(), dtype=float32)
loss: tf.Tensor(0.18150625, shape=(), dtype=float32)
loss: tf.Tensor(0.0007836132, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.73441595, shape=(), dtype=float32)
F1 SCORE:
0.82295203
EPOCH  13 #################################
loss: tf.Tensor(0.20717989, shape=(), dtype=float32)
loss: tf.Tensor(0.18115897, shape=(), dtype=float32)
loss: tf.Tensor(0.24470522, shape=(), dtype=float32)
loss: tf.Tensor(0.12791876, shape=(), dtype=float32)
loss: tf.Tensor(0.21281013, shape=(), dtype=float32)
loss: tf.Tensor(0.116417654, shape=(), dtype=float32)
loss: tf.Tensor(0.33172652, shape=(), dtype=float32)
loss: tf.Tensor(0.16139984, shape=(), dtype=float32)
loss: tf.Tensor(0.13563035, shape=(), dtype=float32)
loss: tf.Tensor(0.24733497, shape=(), dtype=float32)
loss: tf.Tensor(0.20690218, shape=(), dtype=float32)
loss: tf.Tensor(0.29071245, shape=(), dtype=float32)
loss: tf.Tensor(0.16768251, shape=(), dtype=float32)
loss: tf.Tensor(0.15773706, shape=(), dtype=float32)
loss: tf.Tensor(0.16672109, shape=(), dtype=float32)
loss: tf.Tensor(0.1827795, shape=(), dtype=float32)
loss: tf.Tensor(0.24490742, shape=(), dtype=float32)
loss: tf.Tensor(0.06471529, shape=(), dtype=float32)
loss: tf.Tensor(0.24432006, shape=(), dtype=float32)
loss: tf.Tensor(0.18560337, shape=(), dtype=float32)
loss: tf.Tensor(0.27071112, shape=(), dtype=float32)
loss: tf.Tensor(0.1964068, shape=(), dtype=float32)
loss: tf.Tensor(0.18332896, shape=(), dtype=float32)
loss: tf.Tensor(0.219316, shape=(), dtype=float32)
loss: tf.Tensor(0.25818092, shape=(), dtype=float32)
loss: tf.Tensor(0.15718716, shape=(), dtype=float32)
loss: tf.Tensor(0.23063871, shape=(), dtype=float32)
loss: tf.Tensor(0.22618061, shape=(), dtype=float32)
loss: tf.Tensor(0.1310552, shape=(), dtype=float32)
loss: tf.Tensor(0.16804132, shape=(), dtype=float32)
loss: tf.Tensor(0.12391325, shape=(), dtype=float32)
loss: tf.Tensor(0.15843153, shape=(), dtype=float32)
loss: tf.Tensor(0.11473257, shape=(), dtype=float32)
loss: tf.Tensor(0.06994444, shape=(), dtype=float32)
loss: tf.Tensor(0.24576467, shape=(), dtype=float32)
loss: tf.Tensor(0.18160795, shape=(), dtype=float32)
loss: tf.Tensor(0.05693471, shape=(), dtype=float32)
loss: tf.Tensor(0.16091706, shape=(), dtype=float32)
loss: tf.Tensor(0.20734106, shape=(), dtype=float32)
loss: tf.Tensor(0.3116958, shape=(), dtype=float32)
loss: tf.Tensor(0.17467415, shape=(), dtype=float32)
loss: tf.Tensor(0.0934458, shape=(), dtype=float32)
loss: tf.Tensor(0.22530486, shape=(), dtype=float32)
loss: tf.Tensor(0.13318042, shape=(), dtype=float32)
loss: tf.Tensor(0.21004017, shape=(), dtype=float32)
loss: tf.Tensor(0.17749451, shape=(), dtype=float32)
loss: tf.Tensor(0.14102688, shape=(), dtype=float32)
loss: tf.Tensor(0.14032266, shape=(), dtype=float32)
loss: tf.Tensor(0.19739653, shape=(), dtype=float32)
loss: tf.Tensor(0.21204948, shape=(), dtype=float32)
loss: tf.Tensor(0.14319205, shape=(), dtype=float32)
loss: tf.Tensor(0.4148485, shape=(), dtype=float32)
loss: tf.Tensor(0.22964007, shape=(), dtype=float32)
loss: tf.Tensor(0.14460999, shape=(), dtype=float32)
loss: tf.Tensor(0.21154487, shape=(), dtype=float32)
loss: tf.Tensor(0.23392807, shape=(), dtype=float32)
loss: tf.Tensor(0.15018243, shape=(), dtype=float32)
loss: tf.Tensor(0.26401535, shape=(), dtype=float32)
loss: tf.Tensor(0.124159336, shape=(), dtype=float32)
loss: tf.Tensor(0.18815374, shape=(), dtype=float32)
loss: tf.Tensor(0.17851838, shape=(), dtype=float32)
loss: tf.Tensor(0.12805316, shape=(), dtype=float32)
loss: tf.Tensor(0.21181633, shape=(), dtype=float32)
loss: tf.Tensor(0.2575931, shape=(), dtype=float32)
loss: tf.Tensor(0.24402498, shape=(), dtype=float32)
loss: tf.Tensor(0.22903103, shape=(), dtype=float32)
loss: tf.Tensor(0.15602951, shape=(), dtype=float32)
loss: tf.Tensor(0.12517154, shape=(), dtype=float32)
loss: tf.Tensor(0.27688095, shape=(), dtype=float32)
loss: tf.Tensor(0.14648934, shape=(), dtype=float32)
loss: tf.Tensor(0.11304941, shape=(), dtype=float32)
loss: tf.Tensor(0.10833679, shape=(), dtype=float32)
loss: tf.Tensor(0.18172026, shape=(), dtype=float32)
loss: tf.Tensor(9.7031654e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7109174, shape=(), dtype=float32)
F1 SCORE:
0.82290167
EPOCH  14 #################################
loss: tf.Tensor(0.14624953, shape=(), dtype=float32)
loss: tf.Tensor(0.11239422, shape=(), dtype=float32)
loss: tf.Tensor(0.0869804, shape=(), dtype=float32)
loss: tf.Tensor(0.113157615, shape=(), dtype=float32)
loss: tf.Tensor(0.1523232, shape=(), dtype=float32)
loss: tf.Tensor(0.19128448, shape=(), dtype=float32)
loss: tf.Tensor(0.10485402, shape=(), dtype=float32)
loss: tf.Tensor(0.17781349, shape=(), dtype=float32)
loss: tf.Tensor(0.06647448, shape=(), dtype=float32)
loss: tf.Tensor(0.113279775, shape=(), dtype=float32)
loss: tf.Tensor(0.10384498, shape=(), dtype=float32)
loss: tf.Tensor(0.11900879, shape=(), dtype=float32)
loss: tf.Tensor(0.080864295, shape=(), dtype=float32)
loss: tf.Tensor(0.16677943, shape=(), dtype=float32)
loss: tf.Tensor(0.08513605, shape=(), dtype=float32)
loss: tf.Tensor(0.20324041, shape=(), dtype=float32)
loss: tf.Tensor(0.21253933, shape=(), dtype=float32)
loss: tf.Tensor(0.19983144, shape=(), dtype=float32)
loss: tf.Tensor(0.17329143, shape=(), dtype=float32)
loss: tf.Tensor(0.15089603, shape=(), dtype=float32)
loss: tf.Tensor(0.11172697, shape=(), dtype=float32)
loss: tf.Tensor(0.06099598, shape=(), dtype=float32)
loss: tf.Tensor(0.13221727, shape=(), dtype=float32)
loss: tf.Tensor(0.18088879, shape=(), dtype=float32)
loss: tf.Tensor(0.18895024, shape=(), dtype=float32)
loss: tf.Tensor(0.2609726, shape=(), dtype=float32)
loss: tf.Tensor(0.17664376, shape=(), dtype=float32)
loss: tf.Tensor(0.18758105, shape=(), dtype=float32)
loss: tf.Tensor(0.22591019, shape=(), dtype=float32)
loss: tf.Tensor(0.13130194, shape=(), dtype=float32)
loss: tf.Tensor(0.10976518, shape=(), dtype=float32)
loss: tf.Tensor(0.24517666, shape=(), dtype=float32)
loss: tf.Tensor(0.18000712, shape=(), dtype=float32)
loss: tf.Tensor(0.14595653, shape=(), dtype=float32)
loss: tf.Tensor(0.10913601, shape=(), dtype=float32)
loss: tf.Tensor(0.17416134, shape=(), dtype=float32)
loss: tf.Tensor(0.16774684, shape=(), dtype=float32)
loss: tf.Tensor(0.10314813, shape=(), dtype=float32)
loss: tf.Tensor(0.1882462, shape=(), dtype=float32)
loss: tf.Tensor(0.19017357, shape=(), dtype=float32)
loss: tf.Tensor(0.14656876, shape=(), dtype=float32)
loss: tf.Tensor(0.19883873, shape=(), dtype=float32)
loss: tf.Tensor(0.12986654, shape=(), dtype=float32)
loss: tf.Tensor(0.28709972, shape=(), dtype=float32)
loss: tf.Tensor(0.1005343, shape=(), dtype=float32)
loss: tf.Tensor(0.26080275, shape=(), dtype=float32)
loss: tf.Tensor(0.26397684, shape=(), dtype=float32)
loss: tf.Tensor(0.20652987, shape=(), dtype=float32)
loss: tf.Tensor(0.06778249, shape=(), dtype=float32)
loss: tf.Tensor(0.1138842, shape=(), dtype=float32)
loss: tf.Tensor(0.23212297, shape=(), dtype=float32)
loss: tf.Tensor(0.1893286, shape=(), dtype=float32)
loss: tf.Tensor(0.177911, shape=(), dtype=float32)
loss: tf.Tensor(0.22425608, shape=(), dtype=float32)
loss: tf.Tensor(0.12196783, shape=(), dtype=float32)
loss: tf.Tensor(0.14904666, shape=(), dtype=float32)
loss: tf.Tensor(0.12515847, shape=(), dtype=float32)
loss: tf.Tensor(0.3025981, shape=(), dtype=float32)
loss: tf.Tensor(0.14752994, shape=(), dtype=float32)
loss: tf.Tensor(0.12171693, shape=(), dtype=float32)
loss: tf.Tensor(0.10679409, shape=(), dtype=float32)
loss: tf.Tensor(0.28819695, shape=(), dtype=float32)
loss: tf.Tensor(0.19568235, shape=(), dtype=float32)
loss: tf.Tensor(0.082201354, shape=(), dtype=float32)
loss: tf.Tensor(0.1315054, shape=(), dtype=float32)
loss: tf.Tensor(0.085714824, shape=(), dtype=float32)
loss: tf.Tensor(0.24678679, shape=(), dtype=float32)
loss: tf.Tensor(0.12313234, shape=(), dtype=float32)
loss: tf.Tensor(0.15653196, shape=(), dtype=float32)
loss: tf.Tensor(0.12101459, shape=(), dtype=float32)
loss: tf.Tensor(0.101387225, shape=(), dtype=float32)
loss: tf.Tensor(0.1642014, shape=(), dtype=float32)
loss: tf.Tensor(0.089876406, shape=(), dtype=float32)
loss: tf.Tensor(0.0115934685, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.711045, shape=(), dtype=float32)
F1 SCORE:
0.8225453
EPOCH  15 #################################
loss: tf.Tensor(0.21019106, shape=(), dtype=float32)
loss: tf.Tensor(0.12261737, shape=(), dtype=float32)
loss: tf.Tensor(0.13526134, shape=(), dtype=float32)
loss: tf.Tensor(0.16744348, shape=(), dtype=float32)
loss: tf.Tensor(0.12838484, shape=(), dtype=float32)
loss: tf.Tensor(0.24020737, shape=(), dtype=float32)
loss: tf.Tensor(0.06470004, shape=(), dtype=float32)
loss: tf.Tensor(0.13396898, shape=(), dtype=float32)
loss: tf.Tensor(0.18424211, shape=(), dtype=float32)
loss: tf.Tensor(0.10817624, shape=(), dtype=float32)
loss: tf.Tensor(0.069910415, shape=(), dtype=float32)
loss: tf.Tensor(0.19835219, shape=(), dtype=float32)
loss: tf.Tensor(0.22249864, shape=(), dtype=float32)
loss: tf.Tensor(0.10220521, shape=(), dtype=float32)
loss: tf.Tensor(0.18877907, shape=(), dtype=float32)
loss: tf.Tensor(0.07945811, shape=(), dtype=float32)
loss: tf.Tensor(0.20125137, shape=(), dtype=float32)
loss: tf.Tensor(0.07606507, shape=(), dtype=float32)
loss: tf.Tensor(0.17626427, shape=(), dtype=float32)
loss: tf.Tensor(0.26002076, shape=(), dtype=float32)
loss: tf.Tensor(0.121327356, shape=(), dtype=float32)
loss: tf.Tensor(0.09351093, shape=(), dtype=float32)
loss: tf.Tensor(0.13661166, shape=(), dtype=float32)
loss: tf.Tensor(0.1955151, shape=(), dtype=float32)
loss: tf.Tensor(0.11905729, shape=(), dtype=float32)
loss: tf.Tensor(0.15499133, shape=(), dtype=float32)
loss: tf.Tensor(0.114037246, shape=(), dtype=float32)
loss: tf.Tensor(0.1314903, shape=(), dtype=float32)
loss: tf.Tensor(0.15025839, shape=(), dtype=float32)
loss: tf.Tensor(0.12788318, shape=(), dtype=float32)
loss: tf.Tensor(0.12032157, shape=(), dtype=float32)
loss: tf.Tensor(0.24803786, shape=(), dtype=float32)
loss: tf.Tensor(0.1839754, shape=(), dtype=float32)
loss: tf.Tensor(0.15623224, shape=(), dtype=float32)
loss: tf.Tensor(0.14366096, shape=(), dtype=float32)
loss: tf.Tensor(0.10380557, shape=(), dtype=float32)
loss: tf.Tensor(0.13326193, shape=(), dtype=float32)
loss: tf.Tensor(0.24144118, shape=(), dtype=float32)
loss: tf.Tensor(0.07166282, shape=(), dtype=float32)
loss: tf.Tensor(0.08300537, shape=(), dtype=float32)
loss: tf.Tensor(0.17284489, shape=(), dtype=float32)
loss: tf.Tensor(0.14328285, shape=(), dtype=float32)
loss: tf.Tensor(0.24704121, shape=(), dtype=float32)
loss: tf.Tensor(0.176486, shape=(), dtype=float32)
loss: tf.Tensor(0.12514678, shape=(), dtype=float32)
loss: tf.Tensor(0.16225295, shape=(), dtype=float32)
loss: tf.Tensor(0.13618958, shape=(), dtype=float32)
loss: tf.Tensor(0.17813797, shape=(), dtype=float32)
loss: tf.Tensor(0.17647743, shape=(), dtype=float32)
loss: tf.Tensor(0.12121119, shape=(), dtype=float32)
loss: tf.Tensor(0.083272316, shape=(), dtype=float32)
loss: tf.Tensor(0.16702783, shape=(), dtype=float32)
loss: tf.Tensor(0.10108952, shape=(), dtype=float32)
loss: tf.Tensor(0.14464067, shape=(), dtype=float32)
loss: tf.Tensor(0.15826955, shape=(), dtype=float32)
loss: tf.Tensor(0.08283546, shape=(), dtype=float32)
loss: tf.Tensor(0.19620506, shape=(), dtype=float32)
loss: tf.Tensor(0.11673709, shape=(), dtype=float32)
loss: tf.Tensor(0.12162441, shape=(), dtype=float32)
loss: tf.Tensor(0.07398972, shape=(), dtype=float32)
loss: tf.Tensor(0.09802703, shape=(), dtype=float32)
loss: tf.Tensor(0.15648334, shape=(), dtype=float32)
loss: tf.Tensor(0.19987182, shape=(), dtype=float32)
loss: tf.Tensor(0.15598834, shape=(), dtype=float32)
loss: tf.Tensor(0.10418596, shape=(), dtype=float32)
loss: tf.Tensor(0.09502687, shape=(), dtype=float32)
loss: tf.Tensor(0.1258079, shape=(), dtype=float32)
loss: tf.Tensor(0.095582016, shape=(), dtype=float32)
loss: tf.Tensor(0.1913551, shape=(), dtype=float32)
loss: tf.Tensor(0.24597068, shape=(), dtype=float32)
loss: tf.Tensor(0.08888283, shape=(), dtype=float32)
loss: tf.Tensor(0.080360726, shape=(), dtype=float32)
loss: tf.Tensor(0.06753435, shape=(), dtype=float32)
loss: tf.Tensor(0.0008406681, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.72500753, shape=(), dtype=float32)
F1 SCORE:
0.8208614
EPOCH  16 #################################
loss: tf.Tensor(0.110000335, shape=(), dtype=float32)
loss: tf.Tensor(0.09791212, shape=(), dtype=float32)
loss: tf.Tensor(0.074889414, shape=(), dtype=float32)
loss: tf.Tensor(0.13524503, shape=(), dtype=float32)
loss: tf.Tensor(0.12783137, shape=(), dtype=float32)
loss: tf.Tensor(0.13601036, shape=(), dtype=float32)
loss: tf.Tensor(0.19262935, shape=(), dtype=float32)
loss: tf.Tensor(0.119456396, shape=(), dtype=float32)
loss: tf.Tensor(0.14259613, shape=(), dtype=float32)
loss: tf.Tensor(0.17348808, shape=(), dtype=float32)
loss: tf.Tensor(0.064428255, shape=(), dtype=float32)
loss: tf.Tensor(0.12028395, shape=(), dtype=float32)
loss: tf.Tensor(0.10226124, shape=(), dtype=float32)
loss: tf.Tensor(0.09855894, shape=(), dtype=float32)
loss: tf.Tensor(0.079044305, shape=(), dtype=float32)
loss: tf.Tensor(0.11766743, shape=(), dtype=float32)
loss: tf.Tensor(0.15803653, shape=(), dtype=float32)
loss: tf.Tensor(0.10959103, shape=(), dtype=float32)
loss: tf.Tensor(0.16980337, shape=(), dtype=float32)
loss: tf.Tensor(0.17917576, shape=(), dtype=float32)
loss: tf.Tensor(0.12887143, shape=(), dtype=float32)
loss: tf.Tensor(0.100053065, shape=(), dtype=float32)
loss: tf.Tensor(0.16195169, shape=(), dtype=float32)
loss: tf.Tensor(0.17194031, shape=(), dtype=float32)
loss: tf.Tensor(0.05530819, shape=(), dtype=float32)
loss: tf.Tensor(0.088079885, shape=(), dtype=float32)
loss: tf.Tensor(0.17230721, shape=(), dtype=float32)
loss: tf.Tensor(0.088953115, shape=(), dtype=float32)
loss: tf.Tensor(0.16118279, shape=(), dtype=float32)
loss: tf.Tensor(0.18083897, shape=(), dtype=float32)
loss: tf.Tensor(0.06181358, shape=(), dtype=float32)
loss: tf.Tensor(0.20645413, shape=(), dtype=float32)
loss: tf.Tensor(0.20289312, shape=(), dtype=float32)
loss: tf.Tensor(0.15086973, shape=(), dtype=float32)
loss: tf.Tensor(0.09257078, shape=(), dtype=float32)
loss: tf.Tensor(0.22573704, shape=(), dtype=float32)
loss: tf.Tensor(0.0917434, shape=(), dtype=float32)
loss: tf.Tensor(0.12938742, shape=(), dtype=float32)
loss: tf.Tensor(0.22178385, shape=(), dtype=float32)
loss: tf.Tensor(0.11377232, shape=(), dtype=float32)
loss: tf.Tensor(0.11184611, shape=(), dtype=float32)
loss: tf.Tensor(0.10482321, shape=(), dtype=float32)
loss: tf.Tensor(0.21247692, shape=(), dtype=float32)
loss: tf.Tensor(0.20712656, shape=(), dtype=float32)
loss: tf.Tensor(0.077429436, shape=(), dtype=float32)
loss: tf.Tensor(0.056724023, shape=(), dtype=float32)
loss: tf.Tensor(0.116103284, shape=(), dtype=float32)
loss: tf.Tensor(0.07430119, shape=(), dtype=float32)
loss: tf.Tensor(0.14220615, shape=(), dtype=float32)
loss: tf.Tensor(0.07177298, shape=(), dtype=float32)
loss: tf.Tensor(0.055253875, shape=(), dtype=float32)
loss: tf.Tensor(0.16613144, shape=(), dtype=float32)
loss: tf.Tensor(0.08992351, shape=(), dtype=float32)
loss: tf.Tensor(0.10012709, shape=(), dtype=float32)
loss: tf.Tensor(0.20898674, shape=(), dtype=float32)
loss: tf.Tensor(0.14086379, shape=(), dtype=float32)
loss: tf.Tensor(0.063290566, shape=(), dtype=float32)
loss: tf.Tensor(0.21426474, shape=(), dtype=float32)
loss: tf.Tensor(0.044720907, shape=(), dtype=float32)
loss: tf.Tensor(0.1317571, shape=(), dtype=float32)
loss: tf.Tensor(0.079370365, shape=(), dtype=float32)
loss: tf.Tensor(0.13956498, shape=(), dtype=float32)
loss: tf.Tensor(0.111068785, shape=(), dtype=float32)
loss: tf.Tensor(0.10553761, shape=(), dtype=float32)
loss: tf.Tensor(0.17137581, shape=(), dtype=float32)
loss: tf.Tensor(0.19832909, shape=(), dtype=float32)
loss: tf.Tensor(0.17137402, shape=(), dtype=float32)
loss: tf.Tensor(0.08661867, shape=(), dtype=float32)
loss: tf.Tensor(0.1386819, shape=(), dtype=float32)
loss: tf.Tensor(0.22987491, shape=(), dtype=float32)
loss: tf.Tensor(0.101923235, shape=(), dtype=float32)
loss: tf.Tensor(0.14542472, shape=(), dtype=float32)
loss: tf.Tensor(0.11864467, shape=(), dtype=float32)
loss: tf.Tensor(0.0026638757, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71931064, shape=(), dtype=float32)
F1 SCORE:
0.82032317
EPOCH  17 #################################
loss: tf.Tensor(0.099371575, shape=(), dtype=float32)
loss: tf.Tensor(0.109611556, shape=(), dtype=float32)
loss: tf.Tensor(0.09599809, shape=(), dtype=float32)
loss: tf.Tensor(0.16347401, shape=(), dtype=float32)
loss: tf.Tensor(0.07928493, shape=(), dtype=float32)
loss: tf.Tensor(0.08883898, shape=(), dtype=float32)
loss: tf.Tensor(0.10132707, shape=(), dtype=float32)
loss: tf.Tensor(0.1258204, shape=(), dtype=float32)
loss: tf.Tensor(0.0771018, shape=(), dtype=float32)
loss: tf.Tensor(0.08227223, shape=(), dtype=float32)
loss: tf.Tensor(0.09181133, shape=(), dtype=float32)
loss: tf.Tensor(0.053895153, shape=(), dtype=float32)
loss: tf.Tensor(0.11001092, shape=(), dtype=float32)
loss: tf.Tensor(0.15803269, shape=(), dtype=float32)
loss: tf.Tensor(0.058300037, shape=(), dtype=float32)
loss: tf.Tensor(0.15393084, shape=(), dtype=float32)
loss: tf.Tensor(0.14781184, shape=(), dtype=float32)
loss: tf.Tensor(0.05031436, shape=(), dtype=float32)
loss: tf.Tensor(0.06272172, shape=(), dtype=float32)
loss: tf.Tensor(0.15593003, shape=(), dtype=float32)
loss: tf.Tensor(0.12969585, shape=(), dtype=float32)
loss: tf.Tensor(0.15039967, shape=(), dtype=float32)
loss: tf.Tensor(0.1360577, shape=(), dtype=float32)
loss: tf.Tensor(0.09849268, shape=(), dtype=float32)
loss: tf.Tensor(0.10973739, shape=(), dtype=float32)
loss: tf.Tensor(0.12088526, shape=(), dtype=float32)
loss: tf.Tensor(0.10088164, shape=(), dtype=float32)
loss: tf.Tensor(0.087025784, shape=(), dtype=float32)
loss: tf.Tensor(0.11393389, shape=(), dtype=float32)
loss: tf.Tensor(0.14942376, shape=(), dtype=float32)
loss: tf.Tensor(0.08300499, shape=(), dtype=float32)
loss: tf.Tensor(0.09537336, shape=(), dtype=float32)
loss: tf.Tensor(0.05665141, shape=(), dtype=float32)
loss: tf.Tensor(0.20687248, shape=(), dtype=float32)
loss: tf.Tensor(0.07408749, shape=(), dtype=float32)
loss: tf.Tensor(0.06260653, shape=(), dtype=float32)
loss: tf.Tensor(0.15964694, shape=(), dtype=float32)
loss: tf.Tensor(0.13439153, shape=(), dtype=float32)
loss: tf.Tensor(0.1310243, shape=(), dtype=float32)
loss: tf.Tensor(0.13295877, shape=(), dtype=float32)
loss: tf.Tensor(0.18473959, shape=(), dtype=float32)
loss: tf.Tensor(0.20504807, shape=(), dtype=float32)
loss: tf.Tensor(0.17805727, shape=(), dtype=float32)
loss: tf.Tensor(0.10612458, shape=(), dtype=float32)
loss: tf.Tensor(0.04532548, shape=(), dtype=float32)
loss: tf.Tensor(0.17725946, shape=(), dtype=float32)
loss: tf.Tensor(0.16934566, shape=(), dtype=float32)
loss: tf.Tensor(0.120017946, shape=(), dtype=float32)
loss: tf.Tensor(0.08265663, shape=(), dtype=float32)
loss: tf.Tensor(0.13349804, shape=(), dtype=float32)
loss: tf.Tensor(0.1299867, shape=(), dtype=float32)
loss: tf.Tensor(0.1059683, shape=(), dtype=float32)
loss: tf.Tensor(0.1223059, shape=(), dtype=float32)
loss: tf.Tensor(0.12568732, shape=(), dtype=float32)
loss: tf.Tensor(0.10548972, shape=(), dtype=float32)
loss: tf.Tensor(0.08684289, shape=(), dtype=float32)
loss: tf.Tensor(0.13850543, shape=(), dtype=float32)
loss: tf.Tensor(0.09949281, shape=(), dtype=float32)
loss: tf.Tensor(0.14095546, shape=(), dtype=float32)
loss: tf.Tensor(0.12058162, shape=(), dtype=float32)
loss: tf.Tensor(0.13954067, shape=(), dtype=float32)
loss: tf.Tensor(0.11505816, shape=(), dtype=float32)
loss: tf.Tensor(0.12517378, shape=(), dtype=float32)
loss: tf.Tensor(0.15086664, shape=(), dtype=float32)
loss: tf.Tensor(0.27695346, shape=(), dtype=float32)
loss: tf.Tensor(0.096524574, shape=(), dtype=float32)
loss: tf.Tensor(0.15813977, shape=(), dtype=float32)
loss: tf.Tensor(0.13492733, shape=(), dtype=float32)
loss: tf.Tensor(0.115026735, shape=(), dtype=float32)
loss: tf.Tensor(0.0832903, shape=(), dtype=float32)
loss: tf.Tensor(0.0805425, shape=(), dtype=float32)
loss: tf.Tensor(0.07160982, shape=(), dtype=float32)
loss: tf.Tensor(0.09451213, shape=(), dtype=float32)
loss: tf.Tensor(0.0038962655, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71477956, shape=(), dtype=float32)
F1 SCORE:
0.81968546
EPOCH  18 #################################
loss: tf.Tensor(0.07783753, shape=(), dtype=float32)
loss: tf.Tensor(0.1483441, shape=(), dtype=float32)
loss: tf.Tensor(0.041181363, shape=(), dtype=float32)
loss: tf.Tensor(0.072013825, shape=(), dtype=float32)
loss: tf.Tensor(0.071721554, shape=(), dtype=float32)
loss: tf.Tensor(0.06675788, shape=(), dtype=float32)
loss: tf.Tensor(0.064305454, shape=(), dtype=float32)
loss: tf.Tensor(0.07240441, shape=(), dtype=float32)
loss: tf.Tensor(0.055655546, shape=(), dtype=float32)
loss: tf.Tensor(0.06403559, shape=(), dtype=float32)
loss: tf.Tensor(0.10325333, shape=(), dtype=float32)
loss: tf.Tensor(0.052027382, shape=(), dtype=float32)
loss: tf.Tensor(0.15152013, shape=(), dtype=float32)
loss: tf.Tensor(0.16946822, shape=(), dtype=float32)
loss: tf.Tensor(0.116519175, shape=(), dtype=float32)
loss: tf.Tensor(0.15954512, shape=(), dtype=float32)
loss: tf.Tensor(0.12991211, shape=(), dtype=float32)
loss: tf.Tensor(0.10124737, shape=(), dtype=float32)
loss: tf.Tensor(0.058785677, shape=(), dtype=float32)
loss: tf.Tensor(0.055732373, shape=(), dtype=float32)
loss: tf.Tensor(0.060101062, shape=(), dtype=float32)
loss: tf.Tensor(0.115243524, shape=(), dtype=float32)
loss: tf.Tensor(0.0748387, shape=(), dtype=float32)
loss: tf.Tensor(0.086052075, shape=(), dtype=float32)
loss: tf.Tensor(0.07509129, shape=(), dtype=float32)
loss: tf.Tensor(0.10177647, shape=(), dtype=float32)
loss: tf.Tensor(0.08946152, shape=(), dtype=float32)
loss: tf.Tensor(0.03670759, shape=(), dtype=float32)
loss: tf.Tensor(0.04590428, shape=(), dtype=float32)
loss: tf.Tensor(0.1824448, shape=(), dtype=float32)
loss: tf.Tensor(0.13824941, shape=(), dtype=float32)
loss: tf.Tensor(0.13051777, shape=(), dtype=float32)
loss: tf.Tensor(0.11986341, shape=(), dtype=float32)
loss: tf.Tensor(0.058558837, shape=(), dtype=float32)
loss: tf.Tensor(0.06314502, shape=(), dtype=float32)
loss: tf.Tensor(0.09558256, shape=(), dtype=float32)
loss: tf.Tensor(0.19720031, shape=(), dtype=float32)
loss: tf.Tensor(0.12786178, shape=(), dtype=float32)
loss: tf.Tensor(0.049335033, shape=(), dtype=float32)
loss: tf.Tensor(0.10133083, shape=(), dtype=float32)
loss: tf.Tensor(0.12690172, shape=(), dtype=float32)
loss: tf.Tensor(0.16872853, shape=(), dtype=float32)
loss: tf.Tensor(0.19299059, shape=(), dtype=float32)
loss: tf.Tensor(0.067286566, shape=(), dtype=float32)
loss: tf.Tensor(0.12861596, shape=(), dtype=float32)
loss: tf.Tensor(0.12707105, shape=(), dtype=float32)
loss: tf.Tensor(0.08522358, shape=(), dtype=float32)
loss: tf.Tensor(0.015221414, shape=(), dtype=float32)
loss: tf.Tensor(0.09953452, shape=(), dtype=float32)
loss: tf.Tensor(0.10140024, shape=(), dtype=float32)
loss: tf.Tensor(0.07123021, shape=(), dtype=float32)
loss: tf.Tensor(0.16842316, shape=(), dtype=float32)
loss: tf.Tensor(0.13657963, shape=(), dtype=float32)
loss: tf.Tensor(0.036931913, shape=(), dtype=float32)
loss: tf.Tensor(0.031254746, shape=(), dtype=float32)
loss: tf.Tensor(0.09016215, shape=(), dtype=float32)
loss: tf.Tensor(0.14028114, shape=(), dtype=float32)
loss: tf.Tensor(0.16275722, shape=(), dtype=float32)
loss: tf.Tensor(0.14028312, shape=(), dtype=float32)
loss: tf.Tensor(0.12090192, shape=(), dtype=float32)
loss: tf.Tensor(0.15049309, shape=(), dtype=float32)
loss: tf.Tensor(0.083735906, shape=(), dtype=float32)
loss: tf.Tensor(0.10235173, shape=(), dtype=float32)
loss: tf.Tensor(0.16434433, shape=(), dtype=float32)
loss: tf.Tensor(0.056886673, shape=(), dtype=float32)
loss: tf.Tensor(0.169206, shape=(), dtype=float32)
loss: tf.Tensor(0.096495, shape=(), dtype=float32)
loss: tf.Tensor(0.10935835, shape=(), dtype=float32)
loss: tf.Tensor(0.23152381, shape=(), dtype=float32)
loss: tf.Tensor(0.051760532, shape=(), dtype=float32)
loss: tf.Tensor(0.13596676, shape=(), dtype=float32)
loss: tf.Tensor(0.15279873, shape=(), dtype=float32)
loss: tf.Tensor(0.21229766, shape=(), dtype=float32)
loss: tf.Tensor(0.0014650814, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7186171, shape=(), dtype=float32)
F1 SCORE:
0.81932116
EPOCH  19 #################################
loss: tf.Tensor(0.13054198, shape=(), dtype=float32)
loss: tf.Tensor(0.07657768, shape=(), dtype=float32)
loss: tf.Tensor(0.12237188, shape=(), dtype=float32)
loss: tf.Tensor(0.08462919, shape=(), dtype=float32)
loss: tf.Tensor(0.038813956, shape=(), dtype=float32)
loss: tf.Tensor(0.16345936, shape=(), dtype=float32)
loss: tf.Tensor(0.044671126, shape=(), dtype=float32)
loss: tf.Tensor(0.14113094, shape=(), dtype=float32)
loss: tf.Tensor(0.12526482, shape=(), dtype=float32)
loss: tf.Tensor(0.113472365, shape=(), dtype=float32)
loss: tf.Tensor(0.07505489, shape=(), dtype=float32)
loss: tf.Tensor(0.112885885, shape=(), dtype=float32)
loss: tf.Tensor(0.086177684, shape=(), dtype=float32)
loss: tf.Tensor(0.15783948, shape=(), dtype=float32)
loss: tf.Tensor(0.039579738, shape=(), dtype=float32)
loss: tf.Tensor(0.092438966, shape=(), dtype=float32)
loss: tf.Tensor(0.05600452, shape=(), dtype=float32)
loss: tf.Tensor(0.10969177, shape=(), dtype=float32)
loss: tf.Tensor(0.07606156, shape=(), dtype=float32)
loss: tf.Tensor(0.06409356, shape=(), dtype=float32)
loss: tf.Tensor(0.14196609, shape=(), dtype=float32)
loss: tf.Tensor(0.10284124, shape=(), dtype=float32)
loss: tf.Tensor(0.07476308, shape=(), dtype=float32)
loss: tf.Tensor(0.07749038, shape=(), dtype=float32)
loss: tf.Tensor(0.06728154, shape=(), dtype=float32)
loss: tf.Tensor(0.07329079, shape=(), dtype=float32)
loss: tf.Tensor(0.07821309, shape=(), dtype=float32)
loss: tf.Tensor(0.14265649, shape=(), dtype=float32)
loss: tf.Tensor(0.09638486, shape=(), dtype=float32)
loss: tf.Tensor(0.07270097, shape=(), dtype=float32)
loss: tf.Tensor(0.07044182, shape=(), dtype=float32)
loss: tf.Tensor(0.108385496, shape=(), dtype=float32)
loss: tf.Tensor(0.07280295, shape=(), dtype=float32)
loss: tf.Tensor(0.099173546, shape=(), dtype=float32)
loss: tf.Tensor(0.07071143, shape=(), dtype=float32)
loss: tf.Tensor(0.07790809, shape=(), dtype=float32)
loss: tf.Tensor(0.09682852, shape=(), dtype=float32)
loss: tf.Tensor(0.080946, shape=(), dtype=float32)
loss: tf.Tensor(0.11189761, shape=(), dtype=float32)
loss: tf.Tensor(0.054737534, shape=(), dtype=float32)
loss: tf.Tensor(0.10001832, shape=(), dtype=float32)
loss: tf.Tensor(0.10524272, shape=(), dtype=float32)
loss: tf.Tensor(0.059015986, shape=(), dtype=float32)
loss: tf.Tensor(0.12135193, shape=(), dtype=float32)
loss: tf.Tensor(0.024227083, shape=(), dtype=float32)
loss: tf.Tensor(0.11742067, shape=(), dtype=float32)
loss: tf.Tensor(0.07685654, shape=(), dtype=float32)
loss: tf.Tensor(0.089041665, shape=(), dtype=float32)
loss: tf.Tensor(0.110083446, shape=(), dtype=float32)
loss: tf.Tensor(0.068001024, shape=(), dtype=float32)
loss: tf.Tensor(0.05175626, shape=(), dtype=float32)
loss: tf.Tensor(0.115222596, shape=(), dtype=float32)
loss: tf.Tensor(0.09323432, shape=(), dtype=float32)
loss: tf.Tensor(0.06404498, shape=(), dtype=float32)
loss: tf.Tensor(0.099842034, shape=(), dtype=float32)
loss: tf.Tensor(0.051375624, shape=(), dtype=float32)
loss: tf.Tensor(0.07341446, shape=(), dtype=float32)
loss: tf.Tensor(0.088353135, shape=(), dtype=float32)
loss: tf.Tensor(0.11279107, shape=(), dtype=float32)
loss: tf.Tensor(0.057445742, shape=(), dtype=float32)
loss: tf.Tensor(0.04241536, shape=(), dtype=float32)
loss: tf.Tensor(0.10372548, shape=(), dtype=float32)
loss: tf.Tensor(0.08144964, shape=(), dtype=float32)
loss: tf.Tensor(0.026054451, shape=(), dtype=float32)
loss: tf.Tensor(0.034596168, shape=(), dtype=float32)
loss: tf.Tensor(0.081893995, shape=(), dtype=float32)
loss: tf.Tensor(0.0883299, shape=(), dtype=float32)
loss: tf.Tensor(0.055554327, shape=(), dtype=float32)
loss: tf.Tensor(0.08777192, shape=(), dtype=float32)
loss: tf.Tensor(0.049212657, shape=(), dtype=float32)
loss: tf.Tensor(0.16121292, shape=(), dtype=float32)
loss: tf.Tensor(0.14438713, shape=(), dtype=float32)
loss: tf.Tensor(0.07967411, shape=(), dtype=float32)
loss: tf.Tensor(0.0, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.708063, shape=(), dtype=float32)
F1 SCORE:
0.81932163
EPOCH  20 #################################
loss: tf.Tensor(0.17624551, shape=(), dtype=float32)
loss: tf.Tensor(0.052925024, shape=(), dtype=float32)
loss: tf.Tensor(0.035808906, shape=(), dtype=float32)
loss: tf.Tensor(0.08357172, shape=(), dtype=float32)
loss: tf.Tensor(0.16499303, shape=(), dtype=float32)
loss: tf.Tensor(0.060147222, shape=(), dtype=float32)
loss: tf.Tensor(0.027141877, shape=(), dtype=float32)
loss: tf.Tensor(0.09422678, shape=(), dtype=float32)
loss: tf.Tensor(0.040488526, shape=(), dtype=float32)
loss: tf.Tensor(0.12472091, shape=(), dtype=float32)
loss: tf.Tensor(0.08711608, shape=(), dtype=float32)
loss: tf.Tensor(0.15115437, shape=(), dtype=float32)
loss: tf.Tensor(0.09438667, shape=(), dtype=float32)
loss: tf.Tensor(0.1261658, shape=(), dtype=float32)
loss: tf.Tensor(0.079384364, shape=(), dtype=float32)
loss: tf.Tensor(0.06203255, shape=(), dtype=float32)
loss: tf.Tensor(0.1242901, shape=(), dtype=float32)
loss: tf.Tensor(0.136536, shape=(), dtype=float32)
loss: tf.Tensor(0.07065506, shape=(), dtype=float32)
loss: tf.Tensor(0.13565882, shape=(), dtype=float32)
loss: tf.Tensor(0.07565866, shape=(), dtype=float32)
loss: tf.Tensor(0.11703148, shape=(), dtype=float32)
loss: tf.Tensor(0.071415566, shape=(), dtype=float32)
loss: tf.Tensor(0.06949033, shape=(), dtype=float32)
loss: tf.Tensor(0.100252174, shape=(), dtype=float32)
loss: tf.Tensor(0.098081715, shape=(), dtype=float32)
loss: tf.Tensor(0.07754178, shape=(), dtype=float32)
loss: tf.Tensor(0.029123943, shape=(), dtype=float32)
loss: tf.Tensor(0.037168004, shape=(), dtype=float32)
loss: tf.Tensor(0.08440102, shape=(), dtype=float32)
loss: tf.Tensor(0.06350953, shape=(), dtype=float32)
loss: tf.Tensor(0.10524182, shape=(), dtype=float32)
loss: tf.Tensor(0.10021629, shape=(), dtype=float32)
loss: tf.Tensor(0.04021014, shape=(), dtype=float32)
loss: tf.Tensor(0.13490394, shape=(), dtype=float32)
loss: tf.Tensor(0.09919089, shape=(), dtype=float32)
loss: tf.Tensor(0.10936489, shape=(), dtype=float32)
loss: tf.Tensor(0.10002321, shape=(), dtype=float32)
loss: tf.Tensor(0.13446335, shape=(), dtype=float32)
loss: tf.Tensor(0.10963897, shape=(), dtype=float32)
loss: tf.Tensor(0.10102939, shape=(), dtype=float32)
loss: tf.Tensor(0.07132133, shape=(), dtype=float32)
loss: tf.Tensor(0.055538107, shape=(), dtype=float32)
loss: tf.Tensor(0.08692105, shape=(), dtype=float32)
loss: tf.Tensor(0.08342453, shape=(), dtype=float32)
loss: tf.Tensor(0.12035003, shape=(), dtype=float32)
loss: tf.Tensor(0.072631754, shape=(), dtype=float32)
loss: tf.Tensor(0.09291257, shape=(), dtype=float32)
loss: tf.Tensor(0.107904844, shape=(), dtype=float32)
loss: tf.Tensor(0.15026733, shape=(), dtype=float32)
loss: tf.Tensor(0.05498379, shape=(), dtype=float32)
loss: tf.Tensor(0.070113026, shape=(), dtype=float32)
loss: tf.Tensor(0.08464258, shape=(), dtype=float32)
loss: tf.Tensor(0.13452497, shape=(), dtype=float32)
loss: tf.Tensor(0.12586674, shape=(), dtype=float32)
loss: tf.Tensor(0.15353544, shape=(), dtype=float32)
loss: tf.Tensor(0.05340024, shape=(), dtype=float32)
loss: tf.Tensor(0.077500634, shape=(), dtype=float32)
loss: tf.Tensor(0.13018326, shape=(), dtype=float32)
loss: tf.Tensor(0.15832214, shape=(), dtype=float32)
loss: tf.Tensor(0.076419346, shape=(), dtype=float32)
loss: tf.Tensor(0.093711704, shape=(), dtype=float32)
loss: tf.Tensor(0.139216, shape=(), dtype=float32)
loss: tf.Tensor(0.12176952, shape=(), dtype=float32)
loss: tf.Tensor(0.14076455, shape=(), dtype=float32)
loss: tf.Tensor(0.096412, shape=(), dtype=float32)
loss: tf.Tensor(0.15334955, shape=(), dtype=float32)
loss: tf.Tensor(0.120547086, shape=(), dtype=float32)
loss: tf.Tensor(0.13545379, shape=(), dtype=float32)
loss: tf.Tensor(0.046427675, shape=(), dtype=float32)
loss: tf.Tensor(0.1669078, shape=(), dtype=float32)
loss: tf.Tensor(0.08291405, shape=(), dtype=float32)
loss: tf.Tensor(0.039400183, shape=(), dtype=float32)
loss: tf.Tensor(0.0003314661, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7275163, shape=(), dtype=float32)
F1 SCORE:
0.81822115
EPOCH  21 #################################
loss: tf.Tensor(0.07059927, shape=(), dtype=float32)
loss: tf.Tensor(0.092380024, shape=(), dtype=float32)
loss: tf.Tensor(0.07335686, shape=(), dtype=float32)
loss: tf.Tensor(0.075334765, shape=(), dtype=float32)
loss: tf.Tensor(0.0605897, shape=(), dtype=float32)
loss: tf.Tensor(0.07403004, shape=(), dtype=float32)
loss: tf.Tensor(0.09118854, shape=(), dtype=float32)
loss: tf.Tensor(0.04542089, shape=(), dtype=float32)
loss: tf.Tensor(0.050794125, shape=(), dtype=float32)
loss: tf.Tensor(0.09559718, shape=(), dtype=float32)
loss: tf.Tensor(0.10480612, shape=(), dtype=float32)
loss: tf.Tensor(0.1063445, shape=(), dtype=float32)
loss: tf.Tensor(0.03446054, shape=(), dtype=float32)
loss: tf.Tensor(0.10417673, shape=(), dtype=float32)
loss: tf.Tensor(0.039424766, shape=(), dtype=float32)
loss: tf.Tensor(0.038369134, shape=(), dtype=float32)
loss: tf.Tensor(0.085551016, shape=(), dtype=float32)
loss: tf.Tensor(0.04094063, shape=(), dtype=float32)
loss: tf.Tensor(0.049062088, shape=(), dtype=float32)
loss: tf.Tensor(0.036032487, shape=(), dtype=float32)
loss: tf.Tensor(0.17105728, shape=(), dtype=float32)
loss: tf.Tensor(0.07725193, shape=(), dtype=float32)
loss: tf.Tensor(0.050118554, shape=(), dtype=float32)
loss: tf.Tensor(0.0652267, shape=(), dtype=float32)
loss: tf.Tensor(0.1347261, shape=(), dtype=float32)
loss: tf.Tensor(0.076429494, shape=(), dtype=float32)
loss: tf.Tensor(0.09010941, shape=(), dtype=float32)
loss: tf.Tensor(0.037966385, shape=(), dtype=float32)
loss: tf.Tensor(0.073689565, shape=(), dtype=float32)
loss: tf.Tensor(0.12703595, shape=(), dtype=float32)
loss: tf.Tensor(0.07088484, shape=(), dtype=float32)
loss: tf.Tensor(0.14815879, shape=(), dtype=float32)
loss: tf.Tensor(0.044641614, shape=(), dtype=float32)
loss: tf.Tensor(0.10833654, shape=(), dtype=float32)
loss: tf.Tensor(0.06253359, shape=(), dtype=float32)
loss: tf.Tensor(0.028329417, shape=(), dtype=float32)
loss: tf.Tensor(0.09727339, shape=(), dtype=float32)
loss: tf.Tensor(0.08126049, shape=(), dtype=float32)
loss: tf.Tensor(0.09468224, shape=(), dtype=float32)
loss: tf.Tensor(0.057895403, shape=(), dtype=float32)
loss: tf.Tensor(0.047994837, shape=(), dtype=float32)
loss: tf.Tensor(0.0665814, shape=(), dtype=float32)
loss: tf.Tensor(0.066658445, shape=(), dtype=float32)
loss: tf.Tensor(0.13908562, shape=(), dtype=float32)
loss: tf.Tensor(0.04695611, shape=(), dtype=float32)
loss: tf.Tensor(0.065172136, shape=(), dtype=float32)
loss: tf.Tensor(0.053670272, shape=(), dtype=float32)
loss: tf.Tensor(0.12881887, shape=(), dtype=float32)
loss: tf.Tensor(0.074604265, shape=(), dtype=float32)
loss: tf.Tensor(0.07357441, shape=(), dtype=float32)
loss: tf.Tensor(0.114876516, shape=(), dtype=float32)
loss: tf.Tensor(0.108183764, shape=(), dtype=float32)
loss: tf.Tensor(0.07662014, shape=(), dtype=float32)
loss: tf.Tensor(0.06621961, shape=(), dtype=float32)
loss: tf.Tensor(0.09150256, shape=(), dtype=float32)
loss: tf.Tensor(0.10739723, shape=(), dtype=float32)
loss: tf.Tensor(0.05628965, shape=(), dtype=float32)
loss: tf.Tensor(0.067663886, shape=(), dtype=float32)
loss: tf.Tensor(0.064412706, shape=(), dtype=float32)
loss: tf.Tensor(0.12967885, shape=(), dtype=float32)
loss: tf.Tensor(0.08555768, shape=(), dtype=float32)
loss: tf.Tensor(0.11858545, shape=(), dtype=float32)
loss: tf.Tensor(0.025258245, shape=(), dtype=float32)
loss: tf.Tensor(0.04930191, shape=(), dtype=float32)
loss: tf.Tensor(0.13953136, shape=(), dtype=float32)
loss: tf.Tensor(0.14108291, shape=(), dtype=float32)
loss: tf.Tensor(0.18387213, shape=(), dtype=float32)
loss: tf.Tensor(0.059838563, shape=(), dtype=float32)
loss: tf.Tensor(0.08830092, shape=(), dtype=float32)
loss: tf.Tensor(0.13138634, shape=(), dtype=float32)
loss: tf.Tensor(0.1511009, shape=(), dtype=float32)
loss: tf.Tensor(0.041148067, shape=(), dtype=float32)
loss: tf.Tensor(0.11636609, shape=(), dtype=float32)
loss: tf.Tensor(6.5564896e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.728103, shape=(), dtype=float32)
F1 SCORE:
0.8170528
EPOCH  22 #################################
loss: tf.Tensor(0.109494045, shape=(), dtype=float32)
loss: tf.Tensor(0.26645833, shape=(), dtype=float32)
loss: tf.Tensor(0.07595935, shape=(), dtype=float32)
loss: tf.Tensor(0.1696195, shape=(), dtype=float32)
loss: tf.Tensor(0.108498886, shape=(), dtype=float32)
loss: tf.Tensor(0.06623877, shape=(), dtype=float32)
loss: tf.Tensor(0.07986882, shape=(), dtype=float32)
loss: tf.Tensor(0.12524869, shape=(), dtype=float32)
loss: tf.Tensor(0.110367425, shape=(), dtype=float32)
loss: tf.Tensor(0.08096494, shape=(), dtype=float32)
loss: tf.Tensor(0.06681982, shape=(), dtype=float32)
loss: tf.Tensor(0.08816504, shape=(), dtype=float32)
loss: tf.Tensor(0.07744316, shape=(), dtype=float32)
loss: tf.Tensor(0.1339038, shape=(), dtype=float32)
loss: tf.Tensor(0.07305461, shape=(), dtype=float32)
loss: tf.Tensor(0.12733535, shape=(), dtype=float32)
loss: tf.Tensor(0.05537352, shape=(), dtype=float32)
loss: tf.Tensor(0.06715783, shape=(), dtype=float32)
loss: tf.Tensor(0.0541421, shape=(), dtype=float32)
loss: tf.Tensor(0.08520119, shape=(), dtype=float32)
loss: tf.Tensor(0.07435297, shape=(), dtype=float32)
loss: tf.Tensor(0.08323309, shape=(), dtype=float32)
loss: tf.Tensor(0.069006875, shape=(), dtype=float32)
loss: tf.Tensor(0.03801136, shape=(), dtype=float32)
loss: tf.Tensor(0.041330673, shape=(), dtype=float32)
loss: tf.Tensor(0.078723684, shape=(), dtype=float32)
loss: tf.Tensor(0.03870914, shape=(), dtype=float32)
loss: tf.Tensor(0.058044147, shape=(), dtype=float32)
loss: tf.Tensor(0.0820808, shape=(), dtype=float32)
loss: tf.Tensor(0.10200987, shape=(), dtype=float32)
loss: tf.Tensor(0.06484587, shape=(), dtype=float32)
loss: tf.Tensor(0.022434916, shape=(), dtype=float32)
loss: tf.Tensor(0.14909634, shape=(), dtype=float32)
loss: tf.Tensor(0.04370264, shape=(), dtype=float32)
loss: tf.Tensor(0.08369392, shape=(), dtype=float32)
loss: tf.Tensor(0.034958154, shape=(), dtype=float32)
loss: tf.Tensor(0.11040582, shape=(), dtype=float32)
loss: tf.Tensor(0.053882167, shape=(), dtype=float32)
loss: tf.Tensor(0.040873982, shape=(), dtype=float32)
loss: tf.Tensor(0.11416793, shape=(), dtype=float32)
loss: tf.Tensor(0.046049334, shape=(), dtype=float32)
loss: tf.Tensor(0.09680986, shape=(), dtype=float32)
loss: tf.Tensor(0.04579718, shape=(), dtype=float32)
loss: tf.Tensor(0.0371558, shape=(), dtype=float32)
loss: tf.Tensor(0.083354, shape=(), dtype=float32)
loss: tf.Tensor(0.13169639, shape=(), dtype=float32)
loss: tf.Tensor(0.08147229, shape=(), dtype=float32)
loss: tf.Tensor(0.09705146, shape=(), dtype=float32)
loss: tf.Tensor(0.057125658, shape=(), dtype=float32)
loss: tf.Tensor(0.15202303, shape=(), dtype=float32)
loss: tf.Tensor(0.07239205, shape=(), dtype=float32)
loss: tf.Tensor(0.054198742, shape=(), dtype=float32)
loss: tf.Tensor(0.11886022, shape=(), dtype=float32)
loss: tf.Tensor(0.04028714, shape=(), dtype=float32)
loss: tf.Tensor(0.037520822, shape=(), dtype=float32)
loss: tf.Tensor(0.075659946, shape=(), dtype=float32)
loss: tf.Tensor(0.09228817, shape=(), dtype=float32)
loss: tf.Tensor(0.06196901, shape=(), dtype=float32)
loss: tf.Tensor(0.034906134, shape=(), dtype=float32)
loss: tf.Tensor(0.15543684, shape=(), dtype=float32)
loss: tf.Tensor(0.122917965, shape=(), dtype=float32)
loss: tf.Tensor(0.027211495, shape=(), dtype=float32)
loss: tf.Tensor(0.06879301, shape=(), dtype=float32)
loss: tf.Tensor(0.07401117, shape=(), dtype=float32)
loss: tf.Tensor(0.075893946, shape=(), dtype=float32)
loss: tf.Tensor(0.08902845, shape=(), dtype=float32)
loss: tf.Tensor(0.0815524, shape=(), dtype=float32)
loss: tf.Tensor(0.13312426, shape=(), dtype=float32)
loss: tf.Tensor(0.102762245, shape=(), dtype=float32)
loss: tf.Tensor(0.17962606, shape=(), dtype=float32)
loss: tf.Tensor(0.09807087, shape=(), dtype=float32)
loss: tf.Tensor(0.091272734, shape=(), dtype=float32)
loss: tf.Tensor(0.047479097, shape=(), dtype=float32)
loss: tf.Tensor(0.0011582817, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7226016, shape=(), dtype=float32)
F1 SCORE:
0.816663
EPOCH  23 #################################
loss: tf.Tensor(0.089130856, shape=(), dtype=float32)
loss: tf.Tensor(0.030358126, shape=(), dtype=float32)
loss: tf.Tensor(0.08409181, shape=(), dtype=float32)
loss: tf.Tensor(0.099474885, shape=(), dtype=float32)
loss: tf.Tensor(0.092395104, shape=(), dtype=float32)
loss: tf.Tensor(0.018811708, shape=(), dtype=float32)
loss: tf.Tensor(0.06609448, shape=(), dtype=float32)
loss: tf.Tensor(0.057387125, shape=(), dtype=float32)
loss: tf.Tensor(0.08553007, shape=(), dtype=float32)
loss: tf.Tensor(0.11858576, shape=(), dtype=float32)
loss: tf.Tensor(0.02987928, shape=(), dtype=float32)
loss: tf.Tensor(0.034582764, shape=(), dtype=float32)
loss: tf.Tensor(0.04708273, shape=(), dtype=float32)
loss: tf.Tensor(0.08435696, shape=(), dtype=float32)
loss: tf.Tensor(0.060449645, shape=(), dtype=float32)
loss: tf.Tensor(0.104007095, shape=(), dtype=float32)
loss: tf.Tensor(0.07543849, shape=(), dtype=float32)
loss: tf.Tensor(0.14919285, shape=(), dtype=float32)
loss: tf.Tensor(0.06495473, shape=(), dtype=float32)
loss: tf.Tensor(0.07459268, shape=(), dtype=float32)
loss: tf.Tensor(0.09036237, shape=(), dtype=float32)
loss: tf.Tensor(0.0956411, shape=(), dtype=float32)
loss: tf.Tensor(0.041691095, shape=(), dtype=float32)
loss: tf.Tensor(0.1395374, shape=(), dtype=float32)
loss: tf.Tensor(0.05382568, shape=(), dtype=float32)
loss: tf.Tensor(0.06975568, shape=(), dtype=float32)
loss: tf.Tensor(0.09894731, shape=(), dtype=float32)
loss: tf.Tensor(0.10453249, shape=(), dtype=float32)
loss: tf.Tensor(0.05132698, shape=(), dtype=float32)
loss: tf.Tensor(0.007902764, shape=(), dtype=float32)
loss: tf.Tensor(0.07058126, shape=(), dtype=float32)
loss: tf.Tensor(0.05921265, shape=(), dtype=float32)
loss: tf.Tensor(0.023631558, shape=(), dtype=float32)
loss: tf.Tensor(0.09089559, shape=(), dtype=float32)
loss: tf.Tensor(0.03677975, shape=(), dtype=float32)
loss: tf.Tensor(0.07439197, shape=(), dtype=float32)
loss: tf.Tensor(0.041245278, shape=(), dtype=float32)
loss: tf.Tensor(0.04420562, shape=(), dtype=float32)
loss: tf.Tensor(0.07539619, shape=(), dtype=float32)
loss: tf.Tensor(0.05910708, shape=(), dtype=float32)
loss: tf.Tensor(0.038026888, shape=(), dtype=float32)
loss: tf.Tensor(0.08968293, shape=(), dtype=float32)
loss: tf.Tensor(0.04740131, shape=(), dtype=float32)
loss: tf.Tensor(0.05567842, shape=(), dtype=float32)
loss: tf.Tensor(0.09202957, shape=(), dtype=float32)
loss: tf.Tensor(0.033595104, shape=(), dtype=float32)
loss: tf.Tensor(0.117699996, shape=(), dtype=float32)
loss: tf.Tensor(0.031276427, shape=(), dtype=float32)
loss: tf.Tensor(0.074079774, shape=(), dtype=float32)
loss: tf.Tensor(0.08064546, shape=(), dtype=float32)
loss: tf.Tensor(0.024465527, shape=(), dtype=float32)
loss: tf.Tensor(0.10083889, shape=(), dtype=float32)
loss: tf.Tensor(0.074106164, shape=(), dtype=float32)
loss: tf.Tensor(0.06958356, shape=(), dtype=float32)
loss: tf.Tensor(0.055447508, shape=(), dtype=float32)
loss: tf.Tensor(0.09729466, shape=(), dtype=float32)
loss: tf.Tensor(0.047028273, shape=(), dtype=float32)
loss: tf.Tensor(0.06707485, shape=(), dtype=float32)
loss: tf.Tensor(0.049298715, shape=(), dtype=float32)
loss: tf.Tensor(0.03761283, shape=(), dtype=float32)
loss: tf.Tensor(0.07332188, shape=(), dtype=float32)
loss: tf.Tensor(0.039821927, shape=(), dtype=float32)
loss: tf.Tensor(0.050314736, shape=(), dtype=float32)
loss: tf.Tensor(0.034417402, shape=(), dtype=float32)
loss: tf.Tensor(0.038510077, shape=(), dtype=float32)
loss: tf.Tensor(0.13350801, shape=(), dtype=float32)
loss: tf.Tensor(0.07309787, shape=(), dtype=float32)
loss: tf.Tensor(0.041210834, shape=(), dtype=float32)
loss: tf.Tensor(0.06962965, shape=(), dtype=float32)
loss: tf.Tensor(0.039945234, shape=(), dtype=float32)
loss: tf.Tensor(0.08109622, shape=(), dtype=float32)
loss: tf.Tensor(0.058575746, shape=(), dtype=float32)
loss: tf.Tensor(0.03789961, shape=(), dtype=float32)
loss: tf.Tensor(0.00025638632, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71629786, shape=(), dtype=float32)
F1 SCORE:
0.8163605
EPOCH  24 #################################
loss: tf.Tensor(0.029339755, shape=(), dtype=float32)
loss: tf.Tensor(0.035465475, shape=(), dtype=float32)
loss: tf.Tensor(0.048976615, shape=(), dtype=float32)
loss: tf.Tensor(0.07229798, shape=(), dtype=float32)
loss: tf.Tensor(0.04718079, shape=(), dtype=float32)
loss: tf.Tensor(0.068128355, shape=(), dtype=float32)
loss: tf.Tensor(0.02770121, shape=(), dtype=float32)
loss: tf.Tensor(0.032265473, shape=(), dtype=float32)
loss: tf.Tensor(0.0339074, shape=(), dtype=float32)
loss: tf.Tensor(0.018392837, shape=(), dtype=float32)
loss: tf.Tensor(0.03057325, shape=(), dtype=float32)
loss: tf.Tensor(0.036669444, shape=(), dtype=float32)
loss: tf.Tensor(0.07082053, shape=(), dtype=float32)
loss: tf.Tensor(0.024348114, shape=(), dtype=float32)
loss: tf.Tensor(0.066760756, shape=(), dtype=float32)
loss: tf.Tensor(0.07652733, shape=(), dtype=float32)
loss: tf.Tensor(0.06996049, shape=(), dtype=float32)
loss: tf.Tensor(0.051295284, shape=(), dtype=float32)
loss: tf.Tensor(0.057566162, shape=(), dtype=float32)
loss: tf.Tensor(0.063924864, shape=(), dtype=float32)
loss: tf.Tensor(0.11929849, shape=(), dtype=float32)
loss: tf.Tensor(0.046784334, shape=(), dtype=float32)
loss: tf.Tensor(0.047721375, shape=(), dtype=float32)
loss: tf.Tensor(0.026530558, shape=(), dtype=float32)
loss: tf.Tensor(0.06703551, shape=(), dtype=float32)
loss: tf.Tensor(0.06457352, shape=(), dtype=float32)
loss: tf.Tensor(0.049693715, shape=(), dtype=float32)
loss: tf.Tensor(0.043673016, shape=(), dtype=float32)
loss: tf.Tensor(0.058255777, shape=(), dtype=float32)
loss: tf.Tensor(0.13913232, shape=(), dtype=float32)
loss: tf.Tensor(0.01568955, shape=(), dtype=float32)
loss: tf.Tensor(0.09578293, shape=(), dtype=float32)
loss: tf.Tensor(0.042952746, shape=(), dtype=float32)
loss: tf.Tensor(0.1186609, shape=(), dtype=float32)
loss: tf.Tensor(0.07252827, shape=(), dtype=float32)
loss: tf.Tensor(0.03420916, shape=(), dtype=float32)
loss: tf.Tensor(0.19530609, shape=(), dtype=float32)
loss: tf.Tensor(0.15087746, shape=(), dtype=float32)
loss: tf.Tensor(0.022058392, shape=(), dtype=float32)
loss: tf.Tensor(0.044862896, shape=(), dtype=float32)
loss: tf.Tensor(0.09650241, shape=(), dtype=float32)
loss: tf.Tensor(0.21636207, shape=(), dtype=float32)
loss: tf.Tensor(0.11010494, shape=(), dtype=float32)
loss: tf.Tensor(0.10367104, shape=(), dtype=float32)
loss: tf.Tensor(0.03367157, shape=(), dtype=float32)
loss: tf.Tensor(0.018160153, shape=(), dtype=float32)
loss: tf.Tensor(0.06184335, shape=(), dtype=float32)
loss: tf.Tensor(0.09059906, shape=(), dtype=float32)
loss: tf.Tensor(0.069701344, shape=(), dtype=float32)
loss: tf.Tensor(0.100715525, shape=(), dtype=float32)
loss: tf.Tensor(0.06314558, shape=(), dtype=float32)
loss: tf.Tensor(0.011178691, shape=(), dtype=float32)
loss: tf.Tensor(0.048478078, shape=(), dtype=float32)
loss: tf.Tensor(0.07103316, shape=(), dtype=float32)
loss: tf.Tensor(0.068122104, shape=(), dtype=float32)
loss: tf.Tensor(0.052874546, shape=(), dtype=float32)
loss: tf.Tensor(0.07780446, shape=(), dtype=float32)
loss: tf.Tensor(0.053985883, shape=(), dtype=float32)
loss: tf.Tensor(0.063174, shape=(), dtype=float32)
loss: tf.Tensor(0.090870135, shape=(), dtype=float32)
loss: tf.Tensor(0.089658394, shape=(), dtype=float32)
loss: tf.Tensor(0.106694624, shape=(), dtype=float32)
loss: tf.Tensor(0.072458275, shape=(), dtype=float32)
loss: tf.Tensor(0.048783254, shape=(), dtype=float32)
loss: tf.Tensor(0.021859163, shape=(), dtype=float32)
loss: tf.Tensor(0.10553497, shape=(), dtype=float32)
loss: tf.Tensor(0.07227861, shape=(), dtype=float32)
loss: tf.Tensor(0.037188686, shape=(), dtype=float32)
loss: tf.Tensor(0.059024554, shape=(), dtype=float32)
loss: tf.Tensor(0.07022835, shape=(), dtype=float32)
loss: tf.Tensor(0.092670515, shape=(), dtype=float32)
loss: tf.Tensor(0.049050163, shape=(), dtype=float32)
loss: tf.Tensor(0.020865455, shape=(), dtype=float32)
loss: tf.Tensor(0.0033829147, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71319866, shape=(), dtype=float32)
F1 SCORE:
0.8161583
EPOCH  25 #################################
loss: tf.Tensor(0.048919477, shape=(), dtype=float32)
loss: tf.Tensor(0.07759834, shape=(), dtype=float32)
loss: tf.Tensor(0.024782391, shape=(), dtype=float32)
loss: tf.Tensor(0.016387584, shape=(), dtype=float32)
loss: tf.Tensor(0.028061574, shape=(), dtype=float32)
loss: tf.Tensor(0.07083345, shape=(), dtype=float32)
loss: tf.Tensor(0.11048069, shape=(), dtype=float32)
loss: tf.Tensor(0.034565035, shape=(), dtype=float32)
loss: tf.Tensor(0.09054038, shape=(), dtype=float32)
loss: tf.Tensor(0.062394362, shape=(), dtype=float32)
loss: tf.Tensor(0.029085007, shape=(), dtype=float32)
loss: tf.Tensor(0.060772397, shape=(), dtype=float32)
loss: tf.Tensor(0.110584594, shape=(), dtype=float32)
loss: tf.Tensor(0.12243591, shape=(), dtype=float32)
loss: tf.Tensor(0.054071665, shape=(), dtype=float32)
loss: tf.Tensor(0.06682896, shape=(), dtype=float32)
loss: tf.Tensor(0.040195484, shape=(), dtype=float32)
loss: tf.Tensor(0.041823953, shape=(), dtype=float32)
loss: tf.Tensor(0.110837676, shape=(), dtype=float32)
loss: tf.Tensor(0.090951815, shape=(), dtype=float32)
loss: tf.Tensor(0.07895911, shape=(), dtype=float32)
loss: tf.Tensor(0.063905254, shape=(), dtype=float32)
loss: tf.Tensor(0.10434839, shape=(), dtype=float32)
loss: tf.Tensor(0.03217453, shape=(), dtype=float32)
loss: tf.Tensor(0.06978225, shape=(), dtype=float32)
loss: tf.Tensor(0.08572387, shape=(), dtype=float32)
loss: tf.Tensor(0.09663641, shape=(), dtype=float32)
loss: tf.Tensor(0.038467392, shape=(), dtype=float32)
loss: tf.Tensor(0.039027944, shape=(), dtype=float32)
loss: tf.Tensor(0.077624895, shape=(), dtype=float32)
loss: tf.Tensor(0.07448441, shape=(), dtype=float32)
loss: tf.Tensor(0.01293036, shape=(), dtype=float32)
loss: tf.Tensor(0.024623848, shape=(), dtype=float32)
loss: tf.Tensor(0.09091445, shape=(), dtype=float32)
loss: tf.Tensor(0.051997285, shape=(), dtype=float32)
loss: tf.Tensor(0.03824444, shape=(), dtype=float32)
loss: tf.Tensor(0.077783406, shape=(), dtype=float32)
loss: tf.Tensor(0.051631127, shape=(), dtype=float32)
loss: tf.Tensor(0.034889914, shape=(), dtype=float32)
loss: tf.Tensor(0.013468733, shape=(), dtype=float32)
loss: tf.Tensor(0.07058829, shape=(), dtype=float32)
loss: tf.Tensor(0.04888837, shape=(), dtype=float32)
loss: tf.Tensor(0.03169829, shape=(), dtype=float32)
loss: tf.Tensor(0.043597136, shape=(), dtype=float32)
loss: tf.Tensor(0.04002666, shape=(), dtype=float32)
loss: tf.Tensor(0.09021167, shape=(), dtype=float32)
loss: tf.Tensor(0.08814747, shape=(), dtype=float32)
loss: tf.Tensor(0.0438282, shape=(), dtype=float32)
loss: tf.Tensor(0.06074025, shape=(), dtype=float32)
loss: tf.Tensor(0.042318426, shape=(), dtype=float32)
loss: tf.Tensor(0.012667442, shape=(), dtype=float32)
loss: tf.Tensor(0.06304544, shape=(), dtype=float32)
loss: tf.Tensor(0.069979824, shape=(), dtype=float32)
loss: tf.Tensor(0.021807926, shape=(), dtype=float32)
loss: tf.Tensor(0.058624733, shape=(), dtype=float32)
loss: tf.Tensor(0.099918514, shape=(), dtype=float32)
loss: tf.Tensor(0.035949267, shape=(), dtype=float32)
loss: tf.Tensor(0.0620002, shape=(), dtype=float32)
loss: tf.Tensor(0.060287543, shape=(), dtype=float32)
loss: tf.Tensor(0.025067855, shape=(), dtype=float32)
loss: tf.Tensor(0.06714366, shape=(), dtype=float32)
loss: tf.Tensor(0.027990598, shape=(), dtype=float32)
loss: tf.Tensor(0.056080543, shape=(), dtype=float32)
loss: tf.Tensor(0.02747122, shape=(), dtype=float32)
loss: tf.Tensor(0.02018332, shape=(), dtype=float32)
loss: tf.Tensor(0.026213132, shape=(), dtype=float32)
loss: tf.Tensor(0.11007316, shape=(), dtype=float32)
loss: tf.Tensor(0.045561388, shape=(), dtype=float32)
loss: tf.Tensor(0.040634446, shape=(), dtype=float32)
loss: tf.Tensor(0.052340034, shape=(), dtype=float32)
loss: tf.Tensor(0.12486995, shape=(), dtype=float32)
loss: tf.Tensor(0.080077276, shape=(), dtype=float32)
loss: tf.Tensor(0.025856651, shape=(), dtype=float32)
loss: tf.Tensor(0.00068247865, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7081666, shape=(), dtype=float32)
F1 SCORE:
0.8165259
EPOCH  26 #################################
loss: tf.Tensor(0.022833433, shape=(), dtype=float32)
loss: tf.Tensor(0.0801615, shape=(), dtype=float32)
loss: tf.Tensor(0.08551374, shape=(), dtype=float32)
loss: tf.Tensor(0.05044413, shape=(), dtype=float32)
loss: tf.Tensor(0.023514723, shape=(), dtype=float32)
loss: tf.Tensor(0.054097973, shape=(), dtype=float32)
loss: tf.Tensor(0.09524026, shape=(), dtype=float32)
loss: tf.Tensor(0.06369904, shape=(), dtype=float32)
loss: tf.Tensor(0.017212609, shape=(), dtype=float32)
loss: tf.Tensor(0.04987473, shape=(), dtype=float32)
loss: tf.Tensor(0.0648478, shape=(), dtype=float32)
loss: tf.Tensor(0.022814594, shape=(), dtype=float32)
loss: tf.Tensor(0.13946967, shape=(), dtype=float32)
loss: tf.Tensor(0.09203738, shape=(), dtype=float32)
loss: tf.Tensor(0.08907266, shape=(), dtype=float32)
loss: tf.Tensor(0.14069282, shape=(), dtype=float32)
loss: tf.Tensor(0.014699042, shape=(), dtype=float32)
loss: tf.Tensor(0.06848964, shape=(), dtype=float32)
loss: tf.Tensor(0.03154939, shape=(), dtype=float32)
loss: tf.Tensor(0.033564, shape=(), dtype=float32)
loss: tf.Tensor(0.051280174, shape=(), dtype=float32)
loss: tf.Tensor(0.018077286, shape=(), dtype=float32)
loss: tf.Tensor(0.07693196, shape=(), dtype=float32)
loss: tf.Tensor(0.03483769, shape=(), dtype=float32)
loss: tf.Tensor(0.03815434, shape=(), dtype=float32)
loss: tf.Tensor(0.03502927, shape=(), dtype=float32)
loss: tf.Tensor(0.017853847, shape=(), dtype=float32)
loss: tf.Tensor(0.027050212, shape=(), dtype=float32)
loss: tf.Tensor(0.018404141, shape=(), dtype=float32)
loss: tf.Tensor(0.009114606, shape=(), dtype=float32)
loss: tf.Tensor(0.028522816, shape=(), dtype=float32)
loss: tf.Tensor(0.053256135, shape=(), dtype=float32)
loss: tf.Tensor(0.035969734, shape=(), dtype=float32)
loss: tf.Tensor(0.04766254, shape=(), dtype=float32)
loss: tf.Tensor(0.049170397, shape=(), dtype=float32)
loss: tf.Tensor(0.08988955, shape=(), dtype=float32)
loss: tf.Tensor(0.02147042, shape=(), dtype=float32)
loss: tf.Tensor(0.035074156, shape=(), dtype=float32)
loss: tf.Tensor(0.08037164, shape=(), dtype=float32)
loss: tf.Tensor(0.023186443, shape=(), dtype=float32)
loss: tf.Tensor(0.036063176, shape=(), dtype=float32)
loss: tf.Tensor(0.017386865, shape=(), dtype=float32)
loss: tf.Tensor(0.03466181, shape=(), dtype=float32)
loss: tf.Tensor(0.048170067, shape=(), dtype=float32)
loss: tf.Tensor(0.06223527, shape=(), dtype=float32)
loss: tf.Tensor(0.09418635, shape=(), dtype=float32)
loss: tf.Tensor(0.09243792, shape=(), dtype=float32)
loss: tf.Tensor(0.03425534, shape=(), dtype=float32)
loss: tf.Tensor(0.041894034, shape=(), dtype=float32)
loss: tf.Tensor(0.04771744, shape=(), dtype=float32)
loss: tf.Tensor(0.04938136, shape=(), dtype=float32)
loss: tf.Tensor(0.021233454, shape=(), dtype=float32)
loss: tf.Tensor(0.032340895, shape=(), dtype=float32)
loss: tf.Tensor(0.046945006, shape=(), dtype=float32)
loss: tf.Tensor(0.02964567, shape=(), dtype=float32)
loss: tf.Tensor(0.08218154, shape=(), dtype=float32)
loss: tf.Tensor(0.07145772, shape=(), dtype=float32)
loss: tf.Tensor(0.063978, shape=(), dtype=float32)
loss: tf.Tensor(0.062004503, shape=(), dtype=float32)
loss: tf.Tensor(0.04401352, shape=(), dtype=float32)
loss: tf.Tensor(0.041024238, shape=(), dtype=float32)
loss: tf.Tensor(0.051950637, shape=(), dtype=float32)
loss: tf.Tensor(0.0494709, shape=(), dtype=float32)
loss: tf.Tensor(0.035141308, shape=(), dtype=float32)
loss: tf.Tensor(0.02244517, shape=(), dtype=float32)
loss: tf.Tensor(0.06725317, shape=(), dtype=float32)
loss: tf.Tensor(0.01773541, shape=(), dtype=float32)
loss: tf.Tensor(0.028207641, shape=(), dtype=float32)
loss: tf.Tensor(0.08465256, shape=(), dtype=float32)
loss: tf.Tensor(0.069067776, shape=(), dtype=float32)
loss: tf.Tensor(0.0698091, shape=(), dtype=float32)
loss: tf.Tensor(0.04396954, shape=(), dtype=float32)
loss: tf.Tensor(0.107703, shape=(), dtype=float32)
loss: tf.Tensor(0.0027007316, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7261405, shape=(), dtype=float32)
F1 SCORE:
0.81593037
EPOCH  27 #################################
loss: tf.Tensor(0.047399756, shape=(), dtype=float32)
loss: tf.Tensor(0.10573516, shape=(), dtype=float32)
loss: tf.Tensor(0.07193341, shape=(), dtype=float32)
loss: tf.Tensor(0.07095478, shape=(), dtype=float32)
loss: tf.Tensor(0.040154032, shape=(), dtype=float32)
loss: tf.Tensor(0.11712875, shape=(), dtype=float32)
loss: tf.Tensor(0.03790246, shape=(), dtype=float32)
loss: tf.Tensor(0.02041218, shape=(), dtype=float32)
loss: tf.Tensor(0.07997702, shape=(), dtype=float32)
loss: tf.Tensor(0.14019951, shape=(), dtype=float32)
loss: tf.Tensor(0.02661309, shape=(), dtype=float32)
loss: tf.Tensor(0.012627197, shape=(), dtype=float32)
loss: tf.Tensor(0.0117180105, shape=(), dtype=float32)
loss: tf.Tensor(0.08817264, shape=(), dtype=float32)
loss: tf.Tensor(0.11780239, shape=(), dtype=float32)
loss: tf.Tensor(0.029210685, shape=(), dtype=float32)
loss: tf.Tensor(0.026975868, shape=(), dtype=float32)
loss: tf.Tensor(0.063452475, shape=(), dtype=float32)
loss: tf.Tensor(0.08028777, shape=(), dtype=float32)
loss: tf.Tensor(0.036283735, shape=(), dtype=float32)
loss: tf.Tensor(0.14898352, shape=(), dtype=float32)
loss: tf.Tensor(0.080733344, shape=(), dtype=float32)
loss: tf.Tensor(0.08539333, shape=(), dtype=float32)
loss: tf.Tensor(0.024005337, shape=(), dtype=float32)
loss: tf.Tensor(0.053716403, shape=(), dtype=float32)
loss: tf.Tensor(0.08927883, shape=(), dtype=float32)
loss: tf.Tensor(0.062850535, shape=(), dtype=float32)
loss: tf.Tensor(0.16243368, shape=(), dtype=float32)
loss: tf.Tensor(0.101764575, shape=(), dtype=float32)
loss: tf.Tensor(0.022799367, shape=(), dtype=float32)
loss: tf.Tensor(0.0100446595, shape=(), dtype=float32)
loss: tf.Tensor(0.034630407, shape=(), dtype=float32)
loss: tf.Tensor(0.025342898, shape=(), dtype=float32)
loss: tf.Tensor(0.04675318, shape=(), dtype=float32)
loss: tf.Tensor(0.096810944, shape=(), dtype=float32)
loss: tf.Tensor(0.05132282, shape=(), dtype=float32)
loss: tf.Tensor(0.041813716, shape=(), dtype=float32)
loss: tf.Tensor(0.07354876, shape=(), dtype=float32)
loss: tf.Tensor(0.05824974, shape=(), dtype=float32)
loss: tf.Tensor(0.035958625, shape=(), dtype=float32)
loss: tf.Tensor(0.050362304, shape=(), dtype=float32)
loss: tf.Tensor(0.070643164, shape=(), dtype=float32)
loss: tf.Tensor(0.03808249, shape=(), dtype=float32)
loss: tf.Tensor(0.08941139, shape=(), dtype=float32)
loss: tf.Tensor(0.018061366, shape=(), dtype=float32)
loss: tf.Tensor(0.007175422, shape=(), dtype=float32)
loss: tf.Tensor(0.12685424, shape=(), dtype=float32)
loss: tf.Tensor(0.1747438, shape=(), dtype=float32)
loss: tf.Tensor(0.06562268, shape=(), dtype=float32)
loss: tf.Tensor(0.023805374, shape=(), dtype=float32)
loss: tf.Tensor(0.040301576, shape=(), dtype=float32)
loss: tf.Tensor(0.13340375, shape=(), dtype=float32)
loss: tf.Tensor(0.0416, shape=(), dtype=float32)
loss: tf.Tensor(0.028074495, shape=(), dtype=float32)
loss: tf.Tensor(0.12586106, shape=(), dtype=float32)
loss: tf.Tensor(0.065908894, shape=(), dtype=float32)
loss: tf.Tensor(0.01562917, shape=(), dtype=float32)
loss: tf.Tensor(0.018841278, shape=(), dtype=float32)
loss: tf.Tensor(0.018256161, shape=(), dtype=float32)
loss: tf.Tensor(0.08139389, shape=(), dtype=float32)
loss: tf.Tensor(0.032603454, shape=(), dtype=float32)
loss: tf.Tensor(0.02462479, shape=(), dtype=float32)
loss: tf.Tensor(0.06681774, shape=(), dtype=float32)
loss: tf.Tensor(0.06017296, shape=(), dtype=float32)
loss: tf.Tensor(0.028600711, shape=(), dtype=float32)
loss: tf.Tensor(0.16535206, shape=(), dtype=float32)
loss: tf.Tensor(0.07313354, shape=(), dtype=float32)
loss: tf.Tensor(0.041156936, shape=(), dtype=float32)
loss: tf.Tensor(0.0563916, shape=(), dtype=float32)
loss: tf.Tensor(0.058917884, shape=(), dtype=float32)
loss: tf.Tensor(0.025526557, shape=(), dtype=float32)
loss: tf.Tensor(0.109473966, shape=(), dtype=float32)
loss: tf.Tensor(0.03274451, shape=(), dtype=float32)
loss: tf.Tensor(5.090107e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7269206, shape=(), dtype=float32)
F1 SCORE:
0.8151143
EPOCH  28 #################################
loss: tf.Tensor(0.06553601, shape=(), dtype=float32)
loss: tf.Tensor(0.056571227, shape=(), dtype=float32)
loss: tf.Tensor(0.01615907, shape=(), dtype=float32)
loss: tf.Tensor(0.07551727, shape=(), dtype=float32)
loss: tf.Tensor(0.05454063, shape=(), dtype=float32)
loss: tf.Tensor(0.012465786, shape=(), dtype=float32)
loss: tf.Tensor(0.020820944, shape=(), dtype=float32)
loss: tf.Tensor(0.010822879, shape=(), dtype=float32)
loss: tf.Tensor(0.02339782, shape=(), dtype=float32)
loss: tf.Tensor(0.013848892, shape=(), dtype=float32)
loss: tf.Tensor(0.019007212, shape=(), dtype=float32)
loss: tf.Tensor(0.08654605, shape=(), dtype=float32)
loss: tf.Tensor(0.04577329, shape=(), dtype=float32)
loss: tf.Tensor(0.051693812, shape=(), dtype=float32)
loss: tf.Tensor(0.045470703, shape=(), dtype=float32)
loss: tf.Tensor(0.05965057, shape=(), dtype=float32)
loss: tf.Tensor(0.05277419, shape=(), dtype=float32)
loss: tf.Tensor(0.04396886, shape=(), dtype=float32)
loss: tf.Tensor(0.058857817, shape=(), dtype=float32)
loss: tf.Tensor(0.08468818, shape=(), dtype=float32)
loss: tf.Tensor(0.045126796, shape=(), dtype=float32)
loss: tf.Tensor(0.022317838, shape=(), dtype=float32)
loss: tf.Tensor(0.061816756, shape=(), dtype=float32)
loss: tf.Tensor(0.035590783, shape=(), dtype=float32)
loss: tf.Tensor(0.0076593244, shape=(), dtype=float32)
loss: tf.Tensor(0.07446597, shape=(), dtype=float32)
loss: tf.Tensor(0.035598308, shape=(), dtype=float32)
loss: tf.Tensor(0.017181588, shape=(), dtype=float32)
loss: tf.Tensor(0.03147002, shape=(), dtype=float32)
loss: tf.Tensor(0.005979427, shape=(), dtype=float32)
loss: tf.Tensor(0.026116183, shape=(), dtype=float32)
loss: tf.Tensor(0.039424088, shape=(), dtype=float32)
loss: tf.Tensor(0.09720948, shape=(), dtype=float32)
loss: tf.Tensor(0.079534926, shape=(), dtype=float32)
loss: tf.Tensor(0.048970222, shape=(), dtype=float32)
loss: tf.Tensor(0.046214018, shape=(), dtype=float32)
loss: tf.Tensor(0.121011876, shape=(), dtype=float32)
loss: tf.Tensor(0.045975532, shape=(), dtype=float32)
loss: tf.Tensor(0.012157169, shape=(), dtype=float32)
loss: tf.Tensor(0.02463913, shape=(), dtype=float32)
loss: tf.Tensor(0.08477254, shape=(), dtype=float32)
loss: tf.Tensor(0.05861896, shape=(), dtype=float32)
loss: tf.Tensor(0.10633333, shape=(), dtype=float32)
loss: tf.Tensor(0.054069027, shape=(), dtype=float32)
loss: tf.Tensor(0.05277972, shape=(), dtype=float32)
loss: tf.Tensor(0.049542613, shape=(), dtype=float32)
loss: tf.Tensor(0.034832858, shape=(), dtype=float32)
loss: tf.Tensor(0.07796023, shape=(), dtype=float32)
loss: tf.Tensor(0.14496301, shape=(), dtype=float32)
loss: tf.Tensor(0.053627156, shape=(), dtype=float32)
loss: tf.Tensor(0.2105388, shape=(), dtype=float32)
loss: tf.Tensor(0.030205276, shape=(), dtype=float32)
loss: tf.Tensor(0.06035193, shape=(), dtype=float32)
loss: tf.Tensor(0.073484994, shape=(), dtype=float32)
loss: tf.Tensor(0.056400724, shape=(), dtype=float32)
loss: tf.Tensor(0.075457275, shape=(), dtype=float32)
loss: tf.Tensor(0.066582434, shape=(), dtype=float32)
loss: tf.Tensor(0.070377775, shape=(), dtype=float32)
loss: tf.Tensor(0.014006609, shape=(), dtype=float32)
loss: tf.Tensor(0.03939717, shape=(), dtype=float32)
loss: tf.Tensor(0.026583027, shape=(), dtype=float32)
loss: tf.Tensor(0.024832068, shape=(), dtype=float32)
loss: tf.Tensor(0.061635464, shape=(), dtype=float32)
loss: tf.Tensor(0.09471151, shape=(), dtype=float32)
loss: tf.Tensor(0.036175795, shape=(), dtype=float32)
loss: tf.Tensor(0.034303702, shape=(), dtype=float32)
loss: tf.Tensor(0.06934662, shape=(), dtype=float32)
loss: tf.Tensor(0.038003646, shape=(), dtype=float32)
loss: tf.Tensor(0.02837703, shape=(), dtype=float32)
loss: tf.Tensor(0.037916057, shape=(), dtype=float32)
loss: tf.Tensor(0.022700684, shape=(), dtype=float32)
loss: tf.Tensor(0.0063549425, shape=(), dtype=float32)
loss: tf.Tensor(0.01708835, shape=(), dtype=float32)
loss: tf.Tensor(0.0010077643, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71741086, shape=(), dtype=float32)
F1 SCORE:
0.8150463
EPOCH  29 #################################
loss: tf.Tensor(0.060173508, shape=(), dtype=float32)
loss: tf.Tensor(0.02702353, shape=(), dtype=float32)
loss: tf.Tensor(0.011650801, shape=(), dtype=float32)
loss: tf.Tensor(0.0165473, shape=(), dtype=float32)
loss: tf.Tensor(0.02336371, shape=(), dtype=float32)
loss: tf.Tensor(0.035153087, shape=(), dtype=float32)
loss: tf.Tensor(0.05465843, shape=(), dtype=float32)
loss: tf.Tensor(0.03801974, shape=(), dtype=float32)
loss: tf.Tensor(0.039165877, shape=(), dtype=float32)
loss: tf.Tensor(0.009755174, shape=(), dtype=float32)
loss: tf.Tensor(0.035413995, shape=(), dtype=float32)
loss: tf.Tensor(0.032583777, shape=(), dtype=float32)
loss: tf.Tensor(0.037606094, shape=(), dtype=float32)
loss: tf.Tensor(0.08616178, shape=(), dtype=float32)
loss: tf.Tensor(0.04187049, shape=(), dtype=float32)
loss: tf.Tensor(0.056128863, shape=(), dtype=float32)
loss: tf.Tensor(0.04575763, shape=(), dtype=float32)
loss: tf.Tensor(0.055485595, shape=(), dtype=float32)
loss: tf.Tensor(0.035166014, shape=(), dtype=float32)
loss: tf.Tensor(0.031908438, shape=(), dtype=float32)
loss: tf.Tensor(0.011170312, shape=(), dtype=float32)
loss: tf.Tensor(0.050664425, shape=(), dtype=float32)
loss: tf.Tensor(0.06656949, shape=(), dtype=float32)
loss: tf.Tensor(0.012843157, shape=(), dtype=float32)
loss: tf.Tensor(0.031189771, shape=(), dtype=float32)
loss: tf.Tensor(0.014087173, shape=(), dtype=float32)
loss: tf.Tensor(0.062116724, shape=(), dtype=float32)
loss: tf.Tensor(0.014721412, shape=(), dtype=float32)
loss: tf.Tensor(0.05542173, shape=(), dtype=float32)
loss: tf.Tensor(0.099183075, shape=(), dtype=float32)
loss: tf.Tensor(0.019842178, shape=(), dtype=float32)
loss: tf.Tensor(0.014969025, shape=(), dtype=float32)
loss: tf.Tensor(0.0052112807, shape=(), dtype=float32)
loss: tf.Tensor(0.034355804, shape=(), dtype=float32)
loss: tf.Tensor(0.15444434, shape=(), dtype=float32)
loss: tf.Tensor(0.089125134, shape=(), dtype=float32)
loss: tf.Tensor(0.02607913, shape=(), dtype=float32)
loss: tf.Tensor(0.08099154, shape=(), dtype=float32)
loss: tf.Tensor(0.031610187, shape=(), dtype=float32)
loss: tf.Tensor(0.024489788, shape=(), dtype=float32)
loss: tf.Tensor(0.07425362, shape=(), dtype=float32)
loss: tf.Tensor(0.037765823, shape=(), dtype=float32)
loss: tf.Tensor(0.013401624, shape=(), dtype=float32)
loss: tf.Tensor(0.039408535, shape=(), dtype=float32)
loss: tf.Tensor(0.018980313, shape=(), dtype=float32)
loss: tf.Tensor(0.04790759, shape=(), dtype=float32)
loss: tf.Tensor(0.046553463, shape=(), dtype=float32)
loss: tf.Tensor(0.070461586, shape=(), dtype=float32)
loss: tf.Tensor(0.042016312, shape=(), dtype=float32)
loss: tf.Tensor(0.040983196, shape=(), dtype=float32)
loss: tf.Tensor(0.09149047, shape=(), dtype=float32)
loss: tf.Tensor(0.045546364, shape=(), dtype=float32)
loss: tf.Tensor(0.08825293, shape=(), dtype=float32)
loss: tf.Tensor(0.010494193, shape=(), dtype=float32)
loss: tf.Tensor(0.032716893, shape=(), dtype=float32)
loss: tf.Tensor(0.018271727, shape=(), dtype=float32)
loss: tf.Tensor(0.024076119, shape=(), dtype=float32)
loss: tf.Tensor(0.04854815, shape=(), dtype=float32)
loss: tf.Tensor(0.014507493, shape=(), dtype=float32)
loss: tf.Tensor(0.04608521, shape=(), dtype=float32)
loss: tf.Tensor(0.042951897, shape=(), dtype=float32)
loss: tf.Tensor(0.03747455, shape=(), dtype=float32)
loss: tf.Tensor(0.036201656, shape=(), dtype=float32)
loss: tf.Tensor(0.04347658, shape=(), dtype=float32)
loss: tf.Tensor(0.04676716, shape=(), dtype=float32)
loss: tf.Tensor(0.033070017, shape=(), dtype=float32)
loss: tf.Tensor(0.03574369, shape=(), dtype=float32)
loss: tf.Tensor(0.026757928, shape=(), dtype=float32)
loss: tf.Tensor(0.05426443, shape=(), dtype=float32)
loss: tf.Tensor(0.058534857, shape=(), dtype=float32)
loss: tf.Tensor(0.019936461, shape=(), dtype=float32)
loss: tf.Tensor(0.025557594, shape=(), dtype=float32)
loss: tf.Tensor(0.04867128, shape=(), dtype=float32)
loss: tf.Tensor(0.0053954935, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7142805, shape=(), dtype=float32)
F1 SCORE:
0.8149822
EPOCH  30 #################################
loss: tf.Tensor(0.016521797, shape=(), dtype=float32)
loss: tf.Tensor(0.02138938, shape=(), dtype=float32)
loss: tf.Tensor(0.044542786, shape=(), dtype=float32)
loss: tf.Tensor(0.012066871, shape=(), dtype=float32)
loss: tf.Tensor(0.012081403, shape=(), dtype=float32)
loss: tf.Tensor(0.03207953, shape=(), dtype=float32)
loss: tf.Tensor(0.04869579, shape=(), dtype=float32)
loss: tf.Tensor(0.041003093, shape=(), dtype=float32)
loss: tf.Tensor(0.06372856, shape=(), dtype=float32)
loss: tf.Tensor(0.14348489, shape=(), dtype=float32)
loss: tf.Tensor(0.051422957, shape=(), dtype=float32)
loss: tf.Tensor(0.102889426, shape=(), dtype=float32)
loss: tf.Tensor(0.06020474, shape=(), dtype=float32)
loss: tf.Tensor(0.035997927, shape=(), dtype=float32)
loss: tf.Tensor(0.0706657, shape=(), dtype=float32)
loss: tf.Tensor(0.0119774975, shape=(), dtype=float32)
loss: tf.Tensor(0.015116759, shape=(), dtype=float32)
loss: tf.Tensor(0.10819608, shape=(), dtype=float32)
loss: tf.Tensor(0.016358184, shape=(), dtype=float32)
loss: tf.Tensor(0.049069367, shape=(), dtype=float32)
loss: tf.Tensor(0.012450419, shape=(), dtype=float32)
loss: tf.Tensor(0.017185869, shape=(), dtype=float32)
loss: tf.Tensor(0.025866728, shape=(), dtype=float32)
loss: tf.Tensor(0.038545374, shape=(), dtype=float32)
loss: tf.Tensor(0.07162775, shape=(), dtype=float32)
loss: tf.Tensor(0.04755337, shape=(), dtype=float32)
loss: tf.Tensor(0.09470835, shape=(), dtype=float32)
loss: tf.Tensor(0.0121383285, shape=(), dtype=float32)
loss: tf.Tensor(0.085077666, shape=(), dtype=float32)
loss: tf.Tensor(0.018492993, shape=(), dtype=float32)
loss: tf.Tensor(0.090568, shape=(), dtype=float32)
loss: tf.Tensor(0.078943975, shape=(), dtype=float32)
loss: tf.Tensor(0.05587828, shape=(), dtype=float32)
loss: tf.Tensor(0.045691825, shape=(), dtype=float32)
loss: tf.Tensor(0.034049466, shape=(), dtype=float32)
loss: tf.Tensor(0.11299706, shape=(), dtype=float32)
loss: tf.Tensor(0.118749335, shape=(), dtype=float32)
loss: tf.Tensor(0.0149421515, shape=(), dtype=float32)
loss: tf.Tensor(0.017070474, shape=(), dtype=float32)
loss: tf.Tensor(0.07730496, shape=(), dtype=float32)
loss: tf.Tensor(0.061272178, shape=(), dtype=float32)
loss: tf.Tensor(0.033523932, shape=(), dtype=float32)
loss: tf.Tensor(0.02537353, shape=(), dtype=float32)
loss: tf.Tensor(0.01708205, shape=(), dtype=float32)
loss: tf.Tensor(0.012102378, shape=(), dtype=float32)
loss: tf.Tensor(0.029612973, shape=(), dtype=float32)
loss: tf.Tensor(0.08379498, shape=(), dtype=float32)
loss: tf.Tensor(0.038057722, shape=(), dtype=float32)
loss: tf.Tensor(0.060168333, shape=(), dtype=float32)
loss: tf.Tensor(0.06269354, shape=(), dtype=float32)
loss: tf.Tensor(0.10047728, shape=(), dtype=float32)
loss: tf.Tensor(0.15923458, shape=(), dtype=float32)
loss: tf.Tensor(0.043719023, shape=(), dtype=float32)
loss: tf.Tensor(0.045229986, shape=(), dtype=float32)
loss: tf.Tensor(0.038068146, shape=(), dtype=float32)
loss: tf.Tensor(0.053064536, shape=(), dtype=float32)
loss: tf.Tensor(0.04731776, shape=(), dtype=float32)
loss: tf.Tensor(0.025126707, shape=(), dtype=float32)
loss: tf.Tensor(0.02950238, shape=(), dtype=float32)
loss: tf.Tensor(0.056422655, shape=(), dtype=float32)
loss: tf.Tensor(0.09988533, shape=(), dtype=float32)
loss: tf.Tensor(0.028600171, shape=(), dtype=float32)
loss: tf.Tensor(0.07310965, shape=(), dtype=float32)
loss: tf.Tensor(0.042497836, shape=(), dtype=float32)
loss: tf.Tensor(0.01476025, shape=(), dtype=float32)
loss: tf.Tensor(0.06906917, shape=(), dtype=float32)
loss: tf.Tensor(0.022400152, shape=(), dtype=float32)
loss: tf.Tensor(0.040802654, shape=(), dtype=float32)
loss: tf.Tensor(0.09029313, shape=(), dtype=float32)
loss: tf.Tensor(0.094930135, shape=(), dtype=float32)
loss: tf.Tensor(0.024373097, shape=(), dtype=float32)
loss: tf.Tensor(0.07988754, shape=(), dtype=float32)
loss: tf.Tensor(0.05350398, shape=(), dtype=float32)
loss: tf.Tensor(7.0333235e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7170189, shape=(), dtype=float32)
F1 SCORE:
0.8147827
EPOCH  31 #################################
loss: tf.Tensor(0.009582293, shape=(), dtype=float32)
loss: tf.Tensor(0.063309446, shape=(), dtype=float32)
loss: tf.Tensor(0.023144495, shape=(), dtype=float32)
loss: tf.Tensor(0.05845182, shape=(), dtype=float32)
loss: tf.Tensor(0.014767184, shape=(), dtype=float32)
loss: tf.Tensor(0.0070960564, shape=(), dtype=float32)
loss: tf.Tensor(0.06105964, shape=(), dtype=float32)
loss: tf.Tensor(0.03579027, shape=(), dtype=float32)
loss: tf.Tensor(0.03826462, shape=(), dtype=float32)
loss: tf.Tensor(0.009704628, shape=(), dtype=float32)
loss: tf.Tensor(0.039973255, shape=(), dtype=float32)
loss: tf.Tensor(0.038239796, shape=(), dtype=float32)
loss: tf.Tensor(0.011364728, shape=(), dtype=float32)
loss: tf.Tensor(0.04152734, shape=(), dtype=float32)
loss: tf.Tensor(0.05716507, shape=(), dtype=float32)
loss: tf.Tensor(0.04801371, shape=(), dtype=float32)
loss: tf.Tensor(0.05643512, shape=(), dtype=float32)
loss: tf.Tensor(0.047594145, shape=(), dtype=float32)
loss: tf.Tensor(0.043036345, shape=(), dtype=float32)
loss: tf.Tensor(0.044389177, shape=(), dtype=float32)
loss: tf.Tensor(0.047736816, shape=(), dtype=float32)
loss: tf.Tensor(0.014467473, shape=(), dtype=float32)
loss: tf.Tensor(0.066039965, shape=(), dtype=float32)
loss: tf.Tensor(0.02331228, shape=(), dtype=float32)
loss: tf.Tensor(0.071426146, shape=(), dtype=float32)
loss: tf.Tensor(0.04615898, shape=(), dtype=float32)
loss: tf.Tensor(0.090837024, shape=(), dtype=float32)
loss: tf.Tensor(0.032713007, shape=(), dtype=float32)
loss: tf.Tensor(0.018436987, shape=(), dtype=float32)
loss: tf.Tensor(0.04167379, shape=(), dtype=float32)
loss: tf.Tensor(0.02173451, shape=(), dtype=float32)
loss: tf.Tensor(0.04554586, shape=(), dtype=float32)
loss: tf.Tensor(0.023730965, shape=(), dtype=float32)
loss: tf.Tensor(0.011100011, shape=(), dtype=float32)
loss: tf.Tensor(0.07123762, shape=(), dtype=float32)
loss: tf.Tensor(0.061405063, shape=(), dtype=float32)
loss: tf.Tensor(0.04206461, shape=(), dtype=float32)
loss: tf.Tensor(0.0358918, shape=(), dtype=float32)
loss: tf.Tensor(0.017286371, shape=(), dtype=float32)
loss: tf.Tensor(0.0032781055, shape=(), dtype=float32)
loss: tf.Tensor(0.075126104, shape=(), dtype=float32)
loss: tf.Tensor(0.038725514, shape=(), dtype=float32)
loss: tf.Tensor(0.029941196, shape=(), dtype=float32)
loss: tf.Tensor(0.081677444, shape=(), dtype=float32)
loss: tf.Tensor(0.020247867, shape=(), dtype=float32)
loss: tf.Tensor(0.013376031, shape=(), dtype=float32)
loss: tf.Tensor(0.023554029, shape=(), dtype=float32)
loss: tf.Tensor(0.026206505, shape=(), dtype=float32)
loss: tf.Tensor(0.044300012, shape=(), dtype=float32)
loss: tf.Tensor(0.10534812, shape=(), dtype=float32)
loss: tf.Tensor(0.07105159, shape=(), dtype=float32)
loss: tf.Tensor(0.049565963, shape=(), dtype=float32)
loss: tf.Tensor(0.017587122, shape=(), dtype=float32)
loss: tf.Tensor(0.017112011, shape=(), dtype=float32)
loss: tf.Tensor(0.02938545, shape=(), dtype=float32)
loss: tf.Tensor(0.015702164, shape=(), dtype=float32)
loss: tf.Tensor(0.08861132, shape=(), dtype=float32)
loss: tf.Tensor(0.07926979, shape=(), dtype=float32)
loss: tf.Tensor(0.1328799, shape=(), dtype=float32)
loss: tf.Tensor(0.036640234, shape=(), dtype=float32)
loss: tf.Tensor(0.07391794, shape=(), dtype=float32)
loss: tf.Tensor(0.0356445, shape=(), dtype=float32)
loss: tf.Tensor(0.0054116077, shape=(), dtype=float32)
loss: tf.Tensor(0.037351195, shape=(), dtype=float32)
loss: tf.Tensor(0.07292764, shape=(), dtype=float32)
loss: tf.Tensor(0.048968285, shape=(), dtype=float32)
loss: tf.Tensor(0.13985968, shape=(), dtype=float32)
loss: tf.Tensor(0.03146506, shape=(), dtype=float32)
loss: tf.Tensor(0.031861592, shape=(), dtype=float32)
loss: tf.Tensor(0.028419547, shape=(), dtype=float32)
loss: tf.Tensor(0.038614772, shape=(), dtype=float32)
loss: tf.Tensor(0.053173658, shape=(), dtype=float32)
loss: tf.Tensor(0.03168283, shape=(), dtype=float32)
loss: tf.Tensor(3.266281e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7225785, shape=(), dtype=float32)
F1 SCORE:
0.81441927
EPOCH  32 #################################
loss: tf.Tensor(0.02944266, shape=(), dtype=float32)
loss: tf.Tensor(0.035962082, shape=(), dtype=float32)
loss: tf.Tensor(0.031127024, shape=(), dtype=float32)
loss: tf.Tensor(0.049848367, shape=(), dtype=float32)
loss: tf.Tensor(0.08316617, shape=(), dtype=float32)
loss: tf.Tensor(0.01877471, shape=(), dtype=float32)
loss: tf.Tensor(0.05872283, shape=(), dtype=float32)
loss: tf.Tensor(0.058641676, shape=(), dtype=float32)
loss: tf.Tensor(0.011984684, shape=(), dtype=float32)
loss: tf.Tensor(0.057894927, shape=(), dtype=float32)
loss: tf.Tensor(0.15838131, shape=(), dtype=float32)
loss: tf.Tensor(0.04776857, shape=(), dtype=float32)
loss: tf.Tensor(0.044531465, shape=(), dtype=float32)
loss: tf.Tensor(0.020126805, shape=(), dtype=float32)
loss: tf.Tensor(0.03923941, shape=(), dtype=float32)
loss: tf.Tensor(0.0334596, shape=(), dtype=float32)
loss: tf.Tensor(0.037270546, shape=(), dtype=float32)
loss: tf.Tensor(0.0148598, shape=(), dtype=float32)
loss: tf.Tensor(0.039126884, shape=(), dtype=float32)
loss: tf.Tensor(0.027772468, shape=(), dtype=float32)
loss: tf.Tensor(0.020385897, shape=(), dtype=float32)
loss: tf.Tensor(0.013598713, shape=(), dtype=float32)
loss: tf.Tensor(0.052453857, shape=(), dtype=float32)
loss: tf.Tensor(0.065231144, shape=(), dtype=float32)
loss: tf.Tensor(0.031219034, shape=(), dtype=float32)
loss: tf.Tensor(0.015694348, shape=(), dtype=float32)
loss: tf.Tensor(0.05152984, shape=(), dtype=float32)
loss: tf.Tensor(0.028747091, shape=(), dtype=float32)
loss: tf.Tensor(0.017385466, shape=(), dtype=float32)
loss: tf.Tensor(0.021888316, shape=(), dtype=float32)
loss: tf.Tensor(0.03434552, shape=(), dtype=float32)
loss: tf.Tensor(0.029067885, shape=(), dtype=float32)
loss: tf.Tensor(0.010933503, shape=(), dtype=float32)
loss: tf.Tensor(0.019599164, shape=(), dtype=float32)
loss: tf.Tensor(0.026444374, shape=(), dtype=float32)
loss: tf.Tensor(0.014557119, shape=(), dtype=float32)
loss: tf.Tensor(0.008285692, shape=(), dtype=float32)
loss: tf.Tensor(0.011438963, shape=(), dtype=float32)
loss: tf.Tensor(0.042814463, shape=(), dtype=float32)
loss: tf.Tensor(0.034574565, shape=(), dtype=float32)
loss: tf.Tensor(0.017629296, shape=(), dtype=float32)
loss: tf.Tensor(0.08348131, shape=(), dtype=float32)
loss: tf.Tensor(0.022736259, shape=(), dtype=float32)
loss: tf.Tensor(0.04649006, shape=(), dtype=float32)
loss: tf.Tensor(0.049827214, shape=(), dtype=float32)
loss: tf.Tensor(0.014199786, shape=(), dtype=float32)
loss: tf.Tensor(0.02236438, shape=(), dtype=float32)
loss: tf.Tensor(0.0663059, shape=(), dtype=float32)
loss: tf.Tensor(0.045049895, shape=(), dtype=float32)
loss: tf.Tensor(0.015176182, shape=(), dtype=float32)
loss: tf.Tensor(0.03460907, shape=(), dtype=float32)
loss: tf.Tensor(0.008467731, shape=(), dtype=float32)
loss: tf.Tensor(0.009398227, shape=(), dtype=float32)
loss: tf.Tensor(0.046990167, shape=(), dtype=float32)
loss: tf.Tensor(0.077812724, shape=(), dtype=float32)
loss: tf.Tensor(0.060259633, shape=(), dtype=float32)
loss: tf.Tensor(0.08795036, shape=(), dtype=float32)
loss: tf.Tensor(0.04095563, shape=(), dtype=float32)
loss: tf.Tensor(0.032700703, shape=(), dtype=float32)
loss: tf.Tensor(0.036702894, shape=(), dtype=float32)
loss: tf.Tensor(0.11177111, shape=(), dtype=float32)
loss: tf.Tensor(0.053839747, shape=(), dtype=float32)
loss: tf.Tensor(0.058482938, shape=(), dtype=float32)
loss: tf.Tensor(0.015845459, shape=(), dtype=float32)
loss: tf.Tensor(0.030547613, shape=(), dtype=float32)
loss: tf.Tensor(0.04042101, shape=(), dtype=float32)
loss: tf.Tensor(0.04944275, shape=(), dtype=float32)
loss: tf.Tensor(0.03773944, shape=(), dtype=float32)
loss: tf.Tensor(0.028525464, shape=(), dtype=float32)
loss: tf.Tensor(0.010161755, shape=(), dtype=float32)
loss: tf.Tensor(0.07805006, shape=(), dtype=float32)
loss: tf.Tensor(0.0038056844, shape=(), dtype=float32)
loss: tf.Tensor(0.00798717, shape=(), dtype=float32)
loss: tf.Tensor(0.000105137064, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.70879686, shape=(), dtype=float32)
F1 SCORE:
0.8145857
EPOCH  33 #################################
loss: tf.Tensor(0.006388764, shape=(), dtype=float32)
loss: tf.Tensor(0.012634606, shape=(), dtype=float32)
loss: tf.Tensor(0.026725454, shape=(), dtype=float32)
loss: tf.Tensor(0.029577509, shape=(), dtype=float32)
loss: tf.Tensor(0.0068934453, shape=(), dtype=float32)
loss: tf.Tensor(0.023889313, shape=(), dtype=float32)
loss: tf.Tensor(0.0071511455, shape=(), dtype=float32)
loss: tf.Tensor(0.039518483, shape=(), dtype=float32)
loss: tf.Tensor(0.033056103, shape=(), dtype=float32)
loss: tf.Tensor(0.0041727205, shape=(), dtype=float32)
loss: tf.Tensor(0.0054604416, shape=(), dtype=float32)
loss: tf.Tensor(0.03896225, shape=(), dtype=float32)
loss: tf.Tensor(0.03666552, shape=(), dtype=float32)
loss: tf.Tensor(0.011290491, shape=(), dtype=float32)
loss: tf.Tensor(0.06798795, shape=(), dtype=float32)
loss: tf.Tensor(0.023590796, shape=(), dtype=float32)
loss: tf.Tensor(0.016146697, shape=(), dtype=float32)
loss: tf.Tensor(0.033318244, shape=(), dtype=float32)
loss: tf.Tensor(0.008646053, shape=(), dtype=float32)
loss: tf.Tensor(0.012417924, shape=(), dtype=float32)
loss: tf.Tensor(0.022850394, shape=(), dtype=float32)
loss: tf.Tensor(0.02014166, shape=(), dtype=float32)
loss: tf.Tensor(0.03114369, shape=(), dtype=float32)
loss: tf.Tensor(0.043043688, shape=(), dtype=float32)
loss: tf.Tensor(0.04603834, shape=(), dtype=float32)
loss: tf.Tensor(0.02780113, shape=(), dtype=float32)
loss: tf.Tensor(0.023097998, shape=(), dtype=float32)
loss: tf.Tensor(0.012494692, shape=(), dtype=float32)
loss: tf.Tensor(0.04334438, shape=(), dtype=float32)
loss: tf.Tensor(0.027607946, shape=(), dtype=float32)
loss: tf.Tensor(0.02766347, shape=(), dtype=float32)
loss: tf.Tensor(0.009532376, shape=(), dtype=float32)
loss: tf.Tensor(0.015147959, shape=(), dtype=float32)
loss: tf.Tensor(0.011714666, shape=(), dtype=float32)
loss: tf.Tensor(0.012761715, shape=(), dtype=float32)
loss: tf.Tensor(0.005607747, shape=(), dtype=float32)
loss: tf.Tensor(0.00652203, shape=(), dtype=float32)
loss: tf.Tensor(0.044763554, shape=(), dtype=float32)
loss: tf.Tensor(0.04939018, shape=(), dtype=float32)
loss: tf.Tensor(0.03481695, shape=(), dtype=float32)
loss: tf.Tensor(0.060986843, shape=(), dtype=float32)
loss: tf.Tensor(0.03272067, shape=(), dtype=float32)
loss: tf.Tensor(0.028478764, shape=(), dtype=float32)
loss: tf.Tensor(0.03556207, shape=(), dtype=float32)
loss: tf.Tensor(0.02652411, shape=(), dtype=float32)
loss: tf.Tensor(0.03440163, shape=(), dtype=float32)
loss: tf.Tensor(0.05346801, shape=(), dtype=float32)
loss: tf.Tensor(0.048464123, shape=(), dtype=float32)
loss: tf.Tensor(0.06717798, shape=(), dtype=float32)
loss: tf.Tensor(0.009839051, shape=(), dtype=float32)
loss: tf.Tensor(0.02061022, shape=(), dtype=float32)
loss: tf.Tensor(0.017198015, shape=(), dtype=float32)
loss: tf.Tensor(0.06680562, shape=(), dtype=float32)
loss: tf.Tensor(0.030484423, shape=(), dtype=float32)
loss: tf.Tensor(0.02638298, shape=(), dtype=float32)
loss: tf.Tensor(0.107601546, shape=(), dtype=float32)
loss: tf.Tensor(0.007513812, shape=(), dtype=float32)
loss: tf.Tensor(0.014960983, shape=(), dtype=float32)
loss: tf.Tensor(0.023056127, shape=(), dtype=float32)
loss: tf.Tensor(0.05805319, shape=(), dtype=float32)
loss: tf.Tensor(0.009101188, shape=(), dtype=float32)
loss: tf.Tensor(0.04526937, shape=(), dtype=float32)
loss: tf.Tensor(0.00668302, shape=(), dtype=float32)
loss: tf.Tensor(0.06324013, shape=(), dtype=float32)
loss: tf.Tensor(0.08498679, shape=(), dtype=float32)
loss: tf.Tensor(0.05549445, shape=(), dtype=float32)
loss: tf.Tensor(0.050128482, shape=(), dtype=float32)
loss: tf.Tensor(0.012995746, shape=(), dtype=float32)
loss: tf.Tensor(0.014793602, shape=(), dtype=float32)
loss: tf.Tensor(0.055585515, shape=(), dtype=float32)
loss: tf.Tensor(0.016288865, shape=(), dtype=float32)
loss: tf.Tensor(0.20676945, shape=(), dtype=float32)
loss: tf.Tensor(0.021984747, shape=(), dtype=float32)
loss: tf.Tensor(0.00018642595, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.73668164, shape=(), dtype=float32)
F1 SCORE:
0.81389517
EPOCH  34 #################################
loss: tf.Tensor(0.050628252, shape=(), dtype=float32)
loss: tf.Tensor(0.041124664, shape=(), dtype=float32)
loss: tf.Tensor(0.015737033, shape=(), dtype=float32)
loss: tf.Tensor(0.033298675, shape=(), dtype=float32)
loss: tf.Tensor(0.014717251, shape=(), dtype=float32)
loss: tf.Tensor(0.007227082, shape=(), dtype=float32)
loss: tf.Tensor(0.01948572, shape=(), dtype=float32)
loss: tf.Tensor(0.02003411, shape=(), dtype=float32)
loss: tf.Tensor(0.032573327, shape=(), dtype=float32)
loss: tf.Tensor(0.008304366, shape=(), dtype=float32)
loss: tf.Tensor(0.013730159, shape=(), dtype=float32)
loss: tf.Tensor(0.03942276, shape=(), dtype=float32)
loss: tf.Tensor(0.015062839, shape=(), dtype=float32)
loss: tf.Tensor(0.068693064, shape=(), dtype=float32)
loss: tf.Tensor(0.10316586, shape=(), dtype=float32)
loss: tf.Tensor(0.054472838, shape=(), dtype=float32)
loss: tf.Tensor(0.01713054, shape=(), dtype=float32)
loss: tf.Tensor(0.01651688, shape=(), dtype=float32)
loss: tf.Tensor(0.027910044, shape=(), dtype=float32)
loss: tf.Tensor(0.014825251, shape=(), dtype=float32)
loss: tf.Tensor(0.018359603, shape=(), dtype=float32)
loss: tf.Tensor(0.041449413, shape=(), dtype=float32)
loss: tf.Tensor(0.081019565, shape=(), dtype=float32)
loss: tf.Tensor(0.008578742, shape=(), dtype=float32)
loss: tf.Tensor(0.07645817, shape=(), dtype=float32)
loss: tf.Tensor(0.006521562, shape=(), dtype=float32)
loss: tf.Tensor(0.028319044, shape=(), dtype=float32)
loss: tf.Tensor(0.030428553, shape=(), dtype=float32)
loss: tf.Tensor(0.108284175, shape=(), dtype=float32)
loss: tf.Tensor(0.01287948, shape=(), dtype=float32)
loss: tf.Tensor(0.078245044, shape=(), dtype=float32)
loss: tf.Tensor(0.010023995, shape=(), dtype=float32)
loss: tf.Tensor(0.07903044, shape=(), dtype=float32)
loss: tf.Tensor(0.011780735, shape=(), dtype=float32)
loss: tf.Tensor(0.102339745, shape=(), dtype=float32)
loss: tf.Tensor(0.039674446, shape=(), dtype=float32)
loss: tf.Tensor(0.01298399, shape=(), dtype=float32)
loss: tf.Tensor(0.045046106, shape=(), dtype=float32)
loss: tf.Tensor(0.006759637, shape=(), dtype=float32)
loss: tf.Tensor(0.027692942, shape=(), dtype=float32)
loss: tf.Tensor(0.024137512, shape=(), dtype=float32)
loss: tf.Tensor(0.13072667, shape=(), dtype=float32)
loss: tf.Tensor(0.022583133, shape=(), dtype=float32)
loss: tf.Tensor(0.021635965, shape=(), dtype=float32)
loss: tf.Tensor(0.006314783, shape=(), dtype=float32)
loss: tf.Tensor(0.022255508, shape=(), dtype=float32)
loss: tf.Tensor(0.064312786, shape=(), dtype=float32)
loss: tf.Tensor(0.05205436, shape=(), dtype=float32)
loss: tf.Tensor(0.08356731, shape=(), dtype=float32)
loss: tf.Tensor(0.018449228, shape=(), dtype=float32)
loss: tf.Tensor(0.02658121, shape=(), dtype=float32)
loss: tf.Tensor(0.0108720055, shape=(), dtype=float32)
loss: tf.Tensor(0.07505342, shape=(), dtype=float32)
loss: tf.Tensor(0.01332625, shape=(), dtype=float32)
loss: tf.Tensor(0.06289757, shape=(), dtype=float32)
loss: tf.Tensor(0.03014481, shape=(), dtype=float32)
loss: tf.Tensor(0.046424843, shape=(), dtype=float32)
loss: tf.Tensor(0.021994095, shape=(), dtype=float32)
loss: tf.Tensor(0.037586145, shape=(), dtype=float32)
loss: tf.Tensor(0.14647742, shape=(), dtype=float32)
loss: tf.Tensor(0.12964444, shape=(), dtype=float32)
loss: tf.Tensor(0.040691745, shape=(), dtype=float32)
loss: tf.Tensor(0.056098774, shape=(), dtype=float32)
loss: tf.Tensor(0.04887404, shape=(), dtype=float32)
loss: tf.Tensor(0.018141741, shape=(), dtype=float32)
loss: tf.Tensor(0.01355424, shape=(), dtype=float32)
loss: tf.Tensor(0.030557988, shape=(), dtype=float32)
loss: tf.Tensor(0.0849477, shape=(), dtype=float32)
loss: tf.Tensor(0.030836338, shape=(), dtype=float32)
loss: tf.Tensor(0.07293712, shape=(), dtype=float32)
loss: tf.Tensor(0.053193398, shape=(), dtype=float32)
loss: tf.Tensor(0.0076664533, shape=(), dtype=float32)
loss: tf.Tensor(0.008587802, shape=(), dtype=float32)
loss: tf.Tensor(0.005554243, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7147678, shape=(), dtype=float32)
F1 SCORE:
0.8137705
EPOCH  35 #################################
loss: tf.Tensor(0.015441805, shape=(), dtype=float32)
loss: tf.Tensor(0.040641088, shape=(), dtype=float32)
loss: tf.Tensor(0.017669179, shape=(), dtype=float32)
loss: tf.Tensor(0.049213786, shape=(), dtype=float32)
loss: tf.Tensor(0.03605665, shape=(), dtype=float32)
loss: tf.Tensor(0.0502188, shape=(), dtype=float32)
loss: tf.Tensor(0.038978353, shape=(), dtype=float32)
loss: tf.Tensor(0.09628459, shape=(), dtype=float32)
loss: tf.Tensor(0.05075378, shape=(), dtype=float32)
loss: tf.Tensor(0.03998775, shape=(), dtype=float32)
loss: tf.Tensor(0.016601747, shape=(), dtype=float32)
loss: tf.Tensor(0.0062513757, shape=(), dtype=float32)
loss: tf.Tensor(0.013616631, shape=(), dtype=float32)
loss: tf.Tensor(0.004527331, shape=(), dtype=float32)
loss: tf.Tensor(0.09343431, shape=(), dtype=float32)
loss: tf.Tensor(0.053874817, shape=(), dtype=float32)
loss: tf.Tensor(0.06413105, shape=(), dtype=float32)
loss: tf.Tensor(0.018463733, shape=(), dtype=float32)
loss: tf.Tensor(0.021257205, shape=(), dtype=float32)
loss: tf.Tensor(0.025394391, shape=(), dtype=float32)
loss: tf.Tensor(0.054976225, shape=(), dtype=float32)
loss: tf.Tensor(0.05827989, shape=(), dtype=float32)
loss: tf.Tensor(0.012501579, shape=(), dtype=float32)
loss: tf.Tensor(0.06874135, shape=(), dtype=float32)
loss: tf.Tensor(0.13321023, shape=(), dtype=float32)
loss: tf.Tensor(0.034682654, shape=(), dtype=float32)
loss: tf.Tensor(0.069448546, shape=(), dtype=float32)
loss: tf.Tensor(0.018612226, shape=(), dtype=float32)
loss: tf.Tensor(0.055455025, shape=(), dtype=float32)
loss: tf.Tensor(0.042130005, shape=(), dtype=float32)
loss: tf.Tensor(0.068831645, shape=(), dtype=float32)
loss: tf.Tensor(0.0643708, shape=(), dtype=float32)
loss: tf.Tensor(0.011749332, shape=(), dtype=float32)
loss: tf.Tensor(0.10695181, shape=(), dtype=float32)
loss: tf.Tensor(0.025696132, shape=(), dtype=float32)
loss: tf.Tensor(0.04546498, shape=(), dtype=float32)
loss: tf.Tensor(0.0055471985, shape=(), dtype=float32)
loss: tf.Tensor(0.019040862, shape=(), dtype=float32)
loss: tf.Tensor(0.011027106, shape=(), dtype=float32)
loss: tf.Tensor(0.009439991, shape=(), dtype=float32)
loss: tf.Tensor(0.06806821, shape=(), dtype=float32)
loss: tf.Tensor(0.042402457, shape=(), dtype=float32)
loss: tf.Tensor(0.035472237, shape=(), dtype=float32)
loss: tf.Tensor(0.009322659, shape=(), dtype=float32)
loss: tf.Tensor(0.05804365, shape=(), dtype=float32)
loss: tf.Tensor(0.03192433, shape=(), dtype=float32)
loss: tf.Tensor(0.015776662, shape=(), dtype=float32)
loss: tf.Tensor(0.01104362, shape=(), dtype=float32)
loss: tf.Tensor(0.017416108, shape=(), dtype=float32)
loss: tf.Tensor(0.04541342, shape=(), dtype=float32)
loss: tf.Tensor(0.015101556, shape=(), dtype=float32)
loss: tf.Tensor(0.009478196, shape=(), dtype=float32)
loss: tf.Tensor(0.05807738, shape=(), dtype=float32)
loss: tf.Tensor(0.024198594, shape=(), dtype=float32)
loss: tf.Tensor(0.031175854, shape=(), dtype=float32)
loss: tf.Tensor(0.019372322, shape=(), dtype=float32)
loss: tf.Tensor(0.011737737, shape=(), dtype=float32)
loss: tf.Tensor(0.009510826, shape=(), dtype=float32)
loss: tf.Tensor(0.06845358, shape=(), dtype=float32)
loss: tf.Tensor(0.0069487626, shape=(), dtype=float32)
loss: tf.Tensor(0.022270124, shape=(), dtype=float32)
loss: tf.Tensor(0.020775428, shape=(), dtype=float32)
loss: tf.Tensor(0.033668783, shape=(), dtype=float32)
loss: tf.Tensor(0.026151257, shape=(), dtype=float32)
loss: tf.Tensor(0.024684027, shape=(), dtype=float32)
loss: tf.Tensor(0.025077648, shape=(), dtype=float32)
loss: tf.Tensor(0.010361078, shape=(), dtype=float32)
loss: tf.Tensor(0.032742206, shape=(), dtype=float32)
loss: tf.Tensor(0.008369559, shape=(), dtype=float32)
loss: tf.Tensor(0.026181297, shape=(), dtype=float32)
loss: tf.Tensor(0.0142642595, shape=(), dtype=float32)
loss: tf.Tensor(0.08000172, shape=(), dtype=float32)
loss: tf.Tensor(0.016969891, shape=(), dtype=float32)
loss: tf.Tensor(1.1920928e-07, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71484756, shape=(), dtype=float32)
F1 SCORE:
0.8138148
EPOCH  36 #################################
loss: tf.Tensor(0.017027928, shape=(), dtype=float32)
loss: tf.Tensor(0.023422256, shape=(), dtype=float32)
loss: tf.Tensor(0.0053672884, shape=(), dtype=float32)
loss: tf.Tensor(0.02453133, shape=(), dtype=float32)
loss: tf.Tensor(0.008936959, shape=(), dtype=float32)
loss: tf.Tensor(0.013979411, shape=(), dtype=float32)
loss: tf.Tensor(0.008919555, shape=(), dtype=float32)
loss: tf.Tensor(0.018178016, shape=(), dtype=float32)
loss: tf.Tensor(0.05460243, shape=(), dtype=float32)
loss: tf.Tensor(0.018919721, shape=(), dtype=float32)
loss: tf.Tensor(0.057387177, shape=(), dtype=float32)
loss: tf.Tensor(0.0031595575, shape=(), dtype=float32)
loss: tf.Tensor(0.009905197, shape=(), dtype=float32)
loss: tf.Tensor(0.050334748, shape=(), dtype=float32)
loss: tf.Tensor(0.06239993, shape=(), dtype=float32)
loss: tf.Tensor(0.021074872, shape=(), dtype=float32)
loss: tf.Tensor(0.11098302, shape=(), dtype=float32)
loss: tf.Tensor(0.021515261, shape=(), dtype=float32)
loss: tf.Tensor(0.08526392, shape=(), dtype=float32)
loss: tf.Tensor(0.010318977, shape=(), dtype=float32)
loss: tf.Tensor(0.033651095, shape=(), dtype=float32)
loss: tf.Tensor(0.053038932, shape=(), dtype=float32)
loss: tf.Tensor(0.0042618634, shape=(), dtype=float32)
loss: tf.Tensor(0.02544801, shape=(), dtype=float32)
loss: tf.Tensor(0.036523227, shape=(), dtype=float32)
loss: tf.Tensor(0.017598014, shape=(), dtype=float32)
loss: tf.Tensor(0.07413756, shape=(), dtype=float32)
loss: tf.Tensor(0.068861105, shape=(), dtype=float32)
loss: tf.Tensor(0.0054597165, shape=(), dtype=float32)
loss: tf.Tensor(0.037358288, shape=(), dtype=float32)
loss: tf.Tensor(0.0143039385, shape=(), dtype=float32)
loss: tf.Tensor(0.02968496, shape=(), dtype=float32)
loss: tf.Tensor(0.045946747, shape=(), dtype=float32)
loss: tf.Tensor(0.0475025, shape=(), dtype=float32)
loss: tf.Tensor(0.01903641, shape=(), dtype=float32)
loss: tf.Tensor(0.059192266, shape=(), dtype=float32)
loss: tf.Tensor(0.04194871, shape=(), dtype=float32)
loss: tf.Tensor(0.039920293, shape=(), dtype=float32)
loss: tf.Tensor(0.055449635, shape=(), dtype=float32)
loss: tf.Tensor(0.06627775, shape=(), dtype=float32)
loss: tf.Tensor(0.012727629, shape=(), dtype=float32)
loss: tf.Tensor(0.04249636, shape=(), dtype=float32)
loss: tf.Tensor(0.042456374, shape=(), dtype=float32)
loss: tf.Tensor(0.09038803, shape=(), dtype=float32)
loss: tf.Tensor(0.009537187, shape=(), dtype=float32)
loss: tf.Tensor(0.011328072, shape=(), dtype=float32)
loss: tf.Tensor(0.024672484, shape=(), dtype=float32)
loss: tf.Tensor(0.06416547, shape=(), dtype=float32)
loss: tf.Tensor(0.04609631, shape=(), dtype=float32)
loss: tf.Tensor(0.034830984, shape=(), dtype=float32)
loss: tf.Tensor(0.03704326, shape=(), dtype=float32)
loss: tf.Tensor(0.026301067, shape=(), dtype=float32)
loss: tf.Tensor(0.00421246, shape=(), dtype=float32)
loss: tf.Tensor(0.033419568, shape=(), dtype=float32)
loss: tf.Tensor(0.008335668, shape=(), dtype=float32)
loss: tf.Tensor(0.015212948, shape=(), dtype=float32)
loss: tf.Tensor(0.022441855, shape=(), dtype=float32)
loss: tf.Tensor(0.06617467, shape=(), dtype=float32)
loss: tf.Tensor(0.011255014, shape=(), dtype=float32)
loss: tf.Tensor(0.017066741, shape=(), dtype=float32)
loss: tf.Tensor(0.009145292, shape=(), dtype=float32)
loss: tf.Tensor(0.039002966, shape=(), dtype=float32)
loss: tf.Tensor(0.037762754, shape=(), dtype=float32)
loss: tf.Tensor(0.005233722, shape=(), dtype=float32)
loss: tf.Tensor(0.03147308, shape=(), dtype=float32)
loss: tf.Tensor(0.0141797885, shape=(), dtype=float32)
loss: tf.Tensor(0.012116252, shape=(), dtype=float32)
loss: tf.Tensor(0.012399247, shape=(), dtype=float32)
loss: tf.Tensor(0.050933253, shape=(), dtype=float32)
loss: tf.Tensor(0.041726295, shape=(), dtype=float32)
loss: tf.Tensor(0.04801255, shape=(), dtype=float32)
loss: tf.Tensor(0.034741975, shape=(), dtype=float32)
loss: tf.Tensor(0.016477715, shape=(), dtype=float32)
loss: tf.Tensor(0.0, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7266171, shape=(), dtype=float32)
F1 SCORE:
0.8134458
EPOCH  37 #################################
loss: tf.Tensor(0.05055918, shape=(), dtype=float32)
loss: tf.Tensor(0.029751189, shape=(), dtype=float32)
loss: tf.Tensor(0.030964347, shape=(), dtype=float32)
loss: tf.Tensor(0.015538719, shape=(), dtype=float32)
loss: tf.Tensor(0.063505515, shape=(), dtype=float32)
loss: tf.Tensor(0.011609581, shape=(), dtype=float32)
loss: tf.Tensor(0.0049858484, shape=(), dtype=float32)
loss: tf.Tensor(0.0025802935, shape=(), dtype=float32)
loss: tf.Tensor(0.03610002, shape=(), dtype=float32)
loss: tf.Tensor(0.009225737, shape=(), dtype=float32)
loss: tf.Tensor(0.08844848, shape=(), dtype=float32)
loss: tf.Tensor(0.019302847, shape=(), dtype=float32)
loss: tf.Tensor(0.013847815, shape=(), dtype=float32)
loss: tf.Tensor(0.0030319842, shape=(), dtype=float32)
loss: tf.Tensor(0.022060223, shape=(), dtype=float32)
loss: tf.Tensor(0.0660844, shape=(), dtype=float32)
loss: tf.Tensor(0.0034981542, shape=(), dtype=float32)
loss: tf.Tensor(0.045942344, shape=(), dtype=float32)
loss: tf.Tensor(0.054509833, shape=(), dtype=float32)
loss: tf.Tensor(0.004564088, shape=(), dtype=float32)
loss: tf.Tensor(0.014318623, shape=(), dtype=float32)
loss: tf.Tensor(0.026172534, shape=(), dtype=float32)
loss: tf.Tensor(0.07623969, shape=(), dtype=float32)
loss: tf.Tensor(0.008894529, shape=(), dtype=float32)
loss: tf.Tensor(0.019080501, shape=(), dtype=float32)
loss: tf.Tensor(0.01034582, shape=(), dtype=float32)
loss: tf.Tensor(0.039111767, shape=(), dtype=float32)
loss: tf.Tensor(0.02861424, shape=(), dtype=float32)
loss: tf.Tensor(0.026479358, shape=(), dtype=float32)
loss: tf.Tensor(0.035934143, shape=(), dtype=float32)
loss: tf.Tensor(0.03584398, shape=(), dtype=float32)
loss: tf.Tensor(0.058596388, shape=(), dtype=float32)
loss: tf.Tensor(0.008743832, shape=(), dtype=float32)
loss: tf.Tensor(0.09947466, shape=(), dtype=float32)
loss: tf.Tensor(0.05785212, shape=(), dtype=float32)
loss: tf.Tensor(0.051828824, shape=(), dtype=float32)
loss: tf.Tensor(0.09187965, shape=(), dtype=float32)
loss: tf.Tensor(0.029107241, shape=(), dtype=float32)
loss: tf.Tensor(0.0113384845, shape=(), dtype=float32)
loss: tf.Tensor(0.043608636, shape=(), dtype=float32)
loss: tf.Tensor(0.040551968, shape=(), dtype=float32)
loss: tf.Tensor(0.022399854, shape=(), dtype=float32)
loss: tf.Tensor(0.012924458, shape=(), dtype=float32)
loss: tf.Tensor(0.057186875, shape=(), dtype=float32)
loss: tf.Tensor(0.011431972, shape=(), dtype=float32)
loss: tf.Tensor(0.073014945, shape=(), dtype=float32)
loss: tf.Tensor(0.06235009, shape=(), dtype=float32)
loss: tf.Tensor(0.044649776, shape=(), dtype=float32)
loss: tf.Tensor(0.06273232, shape=(), dtype=float32)
loss: tf.Tensor(0.088753365, shape=(), dtype=float32)
loss: tf.Tensor(0.08365348, shape=(), dtype=float32)
loss: tf.Tensor(0.03171187, shape=(), dtype=float32)
loss: tf.Tensor(0.011954603, shape=(), dtype=float32)
loss: tf.Tensor(0.014608732, shape=(), dtype=float32)
loss: tf.Tensor(0.024009313, shape=(), dtype=float32)
loss: tf.Tensor(0.042524252, shape=(), dtype=float32)
loss: tf.Tensor(0.018696588, shape=(), dtype=float32)
loss: tf.Tensor(0.012932441, shape=(), dtype=float32)
loss: tf.Tensor(0.05391686, shape=(), dtype=float32)
loss: tf.Tensor(0.030069863, shape=(), dtype=float32)
loss: tf.Tensor(0.005475638, shape=(), dtype=float32)
loss: tf.Tensor(0.0661969, shape=(), dtype=float32)
loss: tf.Tensor(0.0883782, shape=(), dtype=float32)
loss: tf.Tensor(0.088445194, shape=(), dtype=float32)
loss: tf.Tensor(0.021393212, shape=(), dtype=float32)
loss: tf.Tensor(0.023691557, shape=(), dtype=float32)
loss: tf.Tensor(0.02079744, shape=(), dtype=float32)
loss: tf.Tensor(0.07006762, shape=(), dtype=float32)
loss: tf.Tensor(0.008062274, shape=(), dtype=float32)
loss: tf.Tensor(0.05060349, shape=(), dtype=float32)
loss: tf.Tensor(0.011672731, shape=(), dtype=float32)
loss: tf.Tensor(0.017405886, shape=(), dtype=float32)
loss: tf.Tensor(0.013890693, shape=(), dtype=float32)
loss: tf.Tensor(1.6212332e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7144874, shape=(), dtype=float32)
F1 SCORE:
0.81347984
EPOCH  38 #################################
loss: tf.Tensor(0.013171972, shape=(), dtype=float32)
loss: tf.Tensor(0.0064701927, shape=(), dtype=float32)
loss: tf.Tensor(0.015460532, shape=(), dtype=float32)
loss: tf.Tensor(0.028092043, shape=(), dtype=float32)
loss: tf.Tensor(0.012768184, shape=(), dtype=float32)
loss: tf.Tensor(0.043985125, shape=(), dtype=float32)
loss: tf.Tensor(0.026425516, shape=(), dtype=float32)
loss: tf.Tensor(0.018299498, shape=(), dtype=float32)
loss: tf.Tensor(0.020916842, shape=(), dtype=float32)
loss: tf.Tensor(0.007363937, shape=(), dtype=float32)
loss: tf.Tensor(0.022854518, shape=(), dtype=float32)
loss: tf.Tensor(0.0057451767, shape=(), dtype=float32)
loss: tf.Tensor(0.08992138, shape=(), dtype=float32)
loss: tf.Tensor(0.042944826, shape=(), dtype=float32)
loss: tf.Tensor(0.017692503, shape=(), dtype=float32)
loss: tf.Tensor(0.031334717, shape=(), dtype=float32)
loss: tf.Tensor(0.0025112412, shape=(), dtype=float32)
loss: tf.Tensor(0.015643567, shape=(), dtype=float32)
loss: tf.Tensor(0.026931217, shape=(), dtype=float32)
loss: tf.Tensor(0.0418867, shape=(), dtype=float32)
loss: tf.Tensor(0.021257536, shape=(), dtype=float32)
loss: tf.Tensor(0.015737303, shape=(), dtype=float32)
loss: tf.Tensor(0.010486666, shape=(), dtype=float32)
loss: tf.Tensor(0.043866828, shape=(), dtype=float32)
loss: tf.Tensor(0.07039583, shape=(), dtype=float32)
loss: tf.Tensor(0.012373087, shape=(), dtype=float32)
loss: tf.Tensor(0.041884374, shape=(), dtype=float32)
loss: tf.Tensor(0.06971081, shape=(), dtype=float32)
loss: tf.Tensor(0.008292472, shape=(), dtype=float32)
loss: tf.Tensor(0.0506783, shape=(), dtype=float32)
loss: tf.Tensor(0.032835435, shape=(), dtype=float32)
loss: tf.Tensor(0.0092972405, shape=(), dtype=float32)
loss: tf.Tensor(0.016056057, shape=(), dtype=float32)
loss: tf.Tensor(0.002233633, shape=(), dtype=float32)
loss: tf.Tensor(0.015868513, shape=(), dtype=float32)
loss: tf.Tensor(0.010456601, shape=(), dtype=float32)
loss: tf.Tensor(0.025095934, shape=(), dtype=float32)
loss: tf.Tensor(0.04099771, shape=(), dtype=float32)
loss: tf.Tensor(0.006747352, shape=(), dtype=float32)
loss: tf.Tensor(0.039361693, shape=(), dtype=float32)
loss: tf.Tensor(0.047534708, shape=(), dtype=float32)
loss: tf.Tensor(0.012025687, shape=(), dtype=float32)
loss: tf.Tensor(0.08389077, shape=(), dtype=float32)
loss: tf.Tensor(0.028101938, shape=(), dtype=float32)
loss: tf.Tensor(0.029635794, shape=(), dtype=float32)
loss: tf.Tensor(0.011986907, shape=(), dtype=float32)
loss: tf.Tensor(0.05022029, shape=(), dtype=float32)
loss: tf.Tensor(0.026202459, shape=(), dtype=float32)
loss: tf.Tensor(0.069282524, shape=(), dtype=float32)
loss: tf.Tensor(0.037565973, shape=(), dtype=float32)
loss: tf.Tensor(0.01641772, shape=(), dtype=float32)
loss: tf.Tensor(0.0111489985, shape=(), dtype=float32)
loss: tf.Tensor(0.035851784, shape=(), dtype=float32)
loss: tf.Tensor(0.054850668, shape=(), dtype=float32)
loss: tf.Tensor(0.0077168113, shape=(), dtype=float32)
loss: tf.Tensor(0.028663203, shape=(), dtype=float32)
loss: tf.Tensor(0.00850926, shape=(), dtype=float32)
loss: tf.Tensor(0.030612215, shape=(), dtype=float32)
loss: tf.Tensor(0.013303879, shape=(), dtype=float32)
loss: tf.Tensor(0.057105936, shape=(), dtype=float32)
loss: tf.Tensor(0.032987148, shape=(), dtype=float32)
loss: tf.Tensor(0.07568894, shape=(), dtype=float32)
loss: tf.Tensor(0.004747693, shape=(), dtype=float32)
loss: tf.Tensor(0.07289907, shape=(), dtype=float32)
loss: tf.Tensor(0.058358278, shape=(), dtype=float32)
loss: tf.Tensor(0.08329825, shape=(), dtype=float32)
loss: tf.Tensor(0.04175029, shape=(), dtype=float32)
loss: tf.Tensor(0.043563295, shape=(), dtype=float32)
loss: tf.Tensor(0.044335973, shape=(), dtype=float32)
loss: tf.Tensor(0.041671887, shape=(), dtype=float32)
loss: tf.Tensor(0.04232344, shape=(), dtype=float32)
loss: tf.Tensor(0.02929026, shape=(), dtype=float32)
loss: tf.Tensor(0.10168985, shape=(), dtype=float32)
loss: tf.Tensor(8.344647e-07, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7235036, shape=(), dtype=float32)
F1 SCORE:
0.8132674
EPOCH  39 #################################
loss: tf.Tensor(0.007625135, shape=(), dtype=float32)
loss: tf.Tensor(0.029981757, shape=(), dtype=float32)
loss: tf.Tensor(0.01200956, shape=(), dtype=float32)
loss: tf.Tensor(0.03419823, shape=(), dtype=float32)
loss: tf.Tensor(0.025985377, shape=(), dtype=float32)
loss: tf.Tensor(0.099729404, shape=(), dtype=float32)
loss: tf.Tensor(0.105024315, shape=(), dtype=float32)
loss: tf.Tensor(0.04058959, shape=(), dtype=float32)
loss: tf.Tensor(0.039415717, shape=(), dtype=float32)
loss: tf.Tensor(0.01763582, shape=(), dtype=float32)
loss: tf.Tensor(0.025392951, shape=(), dtype=float32)
loss: tf.Tensor(0.06738794, shape=(), dtype=float32)
loss: tf.Tensor(0.07150763, shape=(), dtype=float32)
loss: tf.Tensor(0.048294067, shape=(), dtype=float32)
loss: tf.Tensor(0.017275505, shape=(), dtype=float32)
loss: tf.Tensor(0.062423293, shape=(), dtype=float32)
loss: tf.Tensor(0.019853577, shape=(), dtype=float32)
loss: tf.Tensor(0.041147742, shape=(), dtype=float32)
loss: tf.Tensor(0.03269122, shape=(), dtype=float32)
loss: tf.Tensor(0.015953181, shape=(), dtype=float32)
loss: tf.Tensor(0.007773459, shape=(), dtype=float32)
loss: tf.Tensor(0.040397696, shape=(), dtype=float32)
loss: tf.Tensor(0.022729136, shape=(), dtype=float32)
loss: tf.Tensor(0.03265807, shape=(), dtype=float32)
loss: tf.Tensor(0.009977408, shape=(), dtype=float32)
loss: tf.Tensor(0.08255587, shape=(), dtype=float32)
loss: tf.Tensor(0.058858067, shape=(), dtype=float32)
loss: tf.Tensor(0.04072833, shape=(), dtype=float32)
loss: tf.Tensor(0.018792905, shape=(), dtype=float32)
loss: tf.Tensor(0.051340654, shape=(), dtype=float32)
loss: tf.Tensor(0.054070506, shape=(), dtype=float32)
loss: tf.Tensor(0.013493464, shape=(), dtype=float32)
loss: tf.Tensor(0.037694167, shape=(), dtype=float32)
loss: tf.Tensor(0.026229255, shape=(), dtype=float32)
loss: tf.Tensor(0.004956023, shape=(), dtype=float32)
loss: tf.Tensor(0.015081013, shape=(), dtype=float32)
loss: tf.Tensor(0.02244681, shape=(), dtype=float32)
loss: tf.Tensor(0.005237905, shape=(), dtype=float32)
loss: tf.Tensor(0.02130401, shape=(), dtype=float32)
loss: tf.Tensor(0.03978446, shape=(), dtype=float32)
loss: tf.Tensor(0.026031628, shape=(), dtype=float32)
loss: tf.Tensor(0.011824261, shape=(), dtype=float32)
loss: tf.Tensor(0.020300176, shape=(), dtype=float32)
loss: tf.Tensor(0.05063624, shape=(), dtype=float32)
loss: tf.Tensor(0.045345172, shape=(), dtype=float32)
loss: tf.Tensor(0.019900024, shape=(), dtype=float32)
loss: tf.Tensor(0.026448786, shape=(), dtype=float32)
loss: tf.Tensor(0.06670149, shape=(), dtype=float32)
loss: tf.Tensor(0.017318647, shape=(), dtype=float32)
loss: tf.Tensor(0.040189423, shape=(), dtype=float32)
loss: tf.Tensor(0.015665136, shape=(), dtype=float32)
loss: tf.Tensor(0.094048634, shape=(), dtype=float32)
loss: tf.Tensor(0.02091848, shape=(), dtype=float32)
loss: tf.Tensor(0.0141360685, shape=(), dtype=float32)
loss: tf.Tensor(0.05960991, shape=(), dtype=float32)
loss: tf.Tensor(0.014157764, shape=(), dtype=float32)
loss: tf.Tensor(0.055976816, shape=(), dtype=float32)
loss: tf.Tensor(0.01272543, shape=(), dtype=float32)
loss: tf.Tensor(0.06219508, shape=(), dtype=float32)
loss: tf.Tensor(0.008871226, shape=(), dtype=float32)
loss: tf.Tensor(0.0019704874, shape=(), dtype=float32)
loss: tf.Tensor(0.038379785, shape=(), dtype=float32)
loss: tf.Tensor(0.02257111, shape=(), dtype=float32)
loss: tf.Tensor(0.083815195, shape=(), dtype=float32)
loss: tf.Tensor(0.04471758, shape=(), dtype=float32)
loss: tf.Tensor(0.018610274, shape=(), dtype=float32)
loss: tf.Tensor(0.021577725, shape=(), dtype=float32)
loss: tf.Tensor(0.01948353, shape=(), dtype=float32)
loss: tf.Tensor(0.013721733, shape=(), dtype=float32)
loss: tf.Tensor(0.018665109, shape=(), dtype=float32)
loss: tf.Tensor(0.14573346, shape=(), dtype=float32)
loss: tf.Tensor(0.033599965, shape=(), dtype=float32)
loss: tf.Tensor(0.033459794, shape=(), dtype=float32)
loss: tf.Tensor(2.3841855e-07, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71102893, shape=(), dtype=float32)
F1 SCORE:
0.81340903
EPOCH  40 #################################
loss: tf.Tensor(0.05448634, shape=(), dtype=float32)
loss: tf.Tensor(0.094522074, shape=(), dtype=float32)
loss: tf.Tensor(0.019747805, shape=(), dtype=float32)
loss: tf.Tensor(0.033760622, shape=(), dtype=float32)
loss: tf.Tensor(0.12561029, shape=(), dtype=float32)
loss: tf.Tensor(0.010127828, shape=(), dtype=float32)
loss: tf.Tensor(0.032917973, shape=(), dtype=float32)
loss: tf.Tensor(0.018742543, shape=(), dtype=float32)
loss: tf.Tensor(0.0671626, shape=(), dtype=float32)
loss: tf.Tensor(0.071346894, shape=(), dtype=float32)
loss: tf.Tensor(0.018847674, shape=(), dtype=float32)
loss: tf.Tensor(0.046284713, shape=(), dtype=float32)
loss: tf.Tensor(0.010971831, shape=(), dtype=float32)
loss: tf.Tensor(0.03489254, shape=(), dtype=float32)
loss: tf.Tensor(0.14512199, shape=(), dtype=float32)
loss: tf.Tensor(0.020790912, shape=(), dtype=float32)
loss: tf.Tensor(0.03139375, shape=(), dtype=float32)
loss: tf.Tensor(0.028430834, shape=(), dtype=float32)
loss: tf.Tensor(0.015055834, shape=(), dtype=float32)
loss: tf.Tensor(0.021100493, shape=(), dtype=float32)
loss: tf.Tensor(0.010704297, shape=(), dtype=float32)
loss: tf.Tensor(0.009091423, shape=(), dtype=float32)
loss: tf.Tensor(0.015479196, shape=(), dtype=float32)
loss: tf.Tensor(0.0059355483, shape=(), dtype=float32)
loss: tf.Tensor(0.027279627, shape=(), dtype=float32)
loss: tf.Tensor(0.009334857, shape=(), dtype=float32)
loss: tf.Tensor(0.046631817, shape=(), dtype=float32)
loss: tf.Tensor(0.04185375, shape=(), dtype=float32)
loss: tf.Tensor(0.035813726, shape=(), dtype=float32)
loss: tf.Tensor(0.022986986, shape=(), dtype=float32)
loss: tf.Tensor(0.030566454, shape=(), dtype=float32)
loss: tf.Tensor(0.020594377, shape=(), dtype=float32)
loss: tf.Tensor(0.10455099, shape=(), dtype=float32)
loss: tf.Tensor(0.011603096, shape=(), dtype=float32)
loss: tf.Tensor(0.04059003, shape=(), dtype=float32)
loss: tf.Tensor(0.080829404, shape=(), dtype=float32)
loss: tf.Tensor(0.017956186, shape=(), dtype=float32)
loss: tf.Tensor(0.04271953, shape=(), dtype=float32)
loss: tf.Tensor(0.0130781075, shape=(), dtype=float32)
loss: tf.Tensor(0.00992353, shape=(), dtype=float32)
loss: tf.Tensor(0.022123344, shape=(), dtype=float32)
loss: tf.Tensor(0.029249525, shape=(), dtype=float32)
loss: tf.Tensor(0.034204826, shape=(), dtype=float32)
loss: tf.Tensor(0.036810573, shape=(), dtype=float32)
loss: tf.Tensor(0.013867557, shape=(), dtype=float32)
loss: tf.Tensor(0.08410826, shape=(), dtype=float32)
loss: tf.Tensor(0.012731293, shape=(), dtype=float32)
loss: tf.Tensor(0.025841665, shape=(), dtype=float32)
loss: tf.Tensor(0.060436934, shape=(), dtype=float32)
loss: tf.Tensor(0.023514798, shape=(), dtype=float32)
loss: tf.Tensor(0.028886728, shape=(), dtype=float32)
loss: tf.Tensor(0.023452409, shape=(), dtype=float32)
loss: tf.Tensor(0.09982488, shape=(), dtype=float32)
loss: tf.Tensor(0.004206979, shape=(), dtype=float32)
loss: tf.Tensor(0.0037987265, shape=(), dtype=float32)
loss: tf.Tensor(0.03284343, shape=(), dtype=float32)
loss: tf.Tensor(0.022341164, shape=(), dtype=float32)
loss: tf.Tensor(0.049559172, shape=(), dtype=float32)
loss: tf.Tensor(0.059064608, shape=(), dtype=float32)
loss: tf.Tensor(0.017254138, shape=(), dtype=float32)
loss: tf.Tensor(0.015057245, shape=(), dtype=float32)
loss: tf.Tensor(0.06323184, shape=(), dtype=float32)
loss: tf.Tensor(0.0118384035, shape=(), dtype=float32)
loss: tf.Tensor(0.01045022, shape=(), dtype=float32)
loss: tf.Tensor(0.011938551, shape=(), dtype=float32)
loss: tf.Tensor(0.08044154, shape=(), dtype=float32)
loss: tf.Tensor(0.013171876, shape=(), dtype=float32)
loss: tf.Tensor(0.023132829, shape=(), dtype=float32)
loss: tf.Tensor(0.022794867, shape=(), dtype=float32)
loss: tf.Tensor(0.052291088, shape=(), dtype=float32)
loss: tf.Tensor(0.011024146, shape=(), dtype=float32)
loss: tf.Tensor(0.017176652, shape=(), dtype=float32)
loss: tf.Tensor(0.017211847, shape=(), dtype=float32)
loss: tf.Tensor(0.0005069878, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7180188, shape=(), dtype=float32)
F1 SCORE:
0.81331366
EPOCH  41 #################################
loss: tf.Tensor(0.026942678, shape=(), dtype=float32)
loss: tf.Tensor(0.020413838, shape=(), dtype=float32)
loss: tf.Tensor(0.058411747, shape=(), dtype=float32)
loss: tf.Tensor(0.028278274, shape=(), dtype=float32)
loss: tf.Tensor(0.01740633, shape=(), dtype=float32)
loss: tf.Tensor(0.025587933, shape=(), dtype=float32)
loss: tf.Tensor(0.0061310064, shape=(), dtype=float32)
loss: tf.Tensor(0.00081134937, shape=(), dtype=float32)
loss: tf.Tensor(0.046102572, shape=(), dtype=float32)
loss: tf.Tensor(0.05846547, shape=(), dtype=float32)
loss: tf.Tensor(0.061062507, shape=(), dtype=float32)
loss: tf.Tensor(0.02689392, shape=(), dtype=float32)
loss: tf.Tensor(0.019475074, shape=(), dtype=float32)
loss: tf.Tensor(0.06993552, shape=(), dtype=float32)
loss: tf.Tensor(0.0077948067, shape=(), dtype=float32)
loss: tf.Tensor(0.033763226, shape=(), dtype=float32)
loss: tf.Tensor(0.0062223333, shape=(), dtype=float32)
loss: tf.Tensor(0.062822536, shape=(), dtype=float32)
loss: tf.Tensor(0.007502164, shape=(), dtype=float32)
loss: tf.Tensor(0.06031857, shape=(), dtype=float32)
loss: tf.Tensor(0.009724755, shape=(), dtype=float32)
loss: tf.Tensor(0.00528805, shape=(), dtype=float32)
loss: tf.Tensor(0.10356338, shape=(), dtype=float32)
loss: tf.Tensor(0.0970236, shape=(), dtype=float32)
loss: tf.Tensor(0.00510036, shape=(), dtype=float32)
loss: tf.Tensor(0.0033012084, shape=(), dtype=float32)
loss: tf.Tensor(0.023622317, shape=(), dtype=float32)
loss: tf.Tensor(0.007964573, shape=(), dtype=float32)
loss: tf.Tensor(0.043206464, shape=(), dtype=float32)
loss: tf.Tensor(0.03171935, shape=(), dtype=float32)
loss: tf.Tensor(0.04176271, shape=(), dtype=float32)
loss: tf.Tensor(0.02845146, shape=(), dtype=float32)
loss: tf.Tensor(0.009954173, shape=(), dtype=float32)
loss: tf.Tensor(0.012217063, shape=(), dtype=float32)
loss: tf.Tensor(0.008522675, shape=(), dtype=float32)
loss: tf.Tensor(0.037249714, shape=(), dtype=float32)
loss: tf.Tensor(0.016124161, shape=(), dtype=float32)
loss: tf.Tensor(0.00467126, shape=(), dtype=float32)
loss: tf.Tensor(0.040301576, shape=(), dtype=float32)
loss: tf.Tensor(0.009064292, shape=(), dtype=float32)
loss: tf.Tensor(0.019254263, shape=(), dtype=float32)
loss: tf.Tensor(0.014504541, shape=(), dtype=float32)
loss: tf.Tensor(0.029183006, shape=(), dtype=float32)
loss: tf.Tensor(0.0034135985, shape=(), dtype=float32)
loss: tf.Tensor(0.09051323, shape=(), dtype=float32)
loss: tf.Tensor(0.0045686406, shape=(), dtype=float32)
loss: tf.Tensor(0.03964761, shape=(), dtype=float32)
loss: tf.Tensor(0.008779369, shape=(), dtype=float32)
loss: tf.Tensor(0.034031514, shape=(), dtype=float32)
loss: tf.Tensor(0.0018658303, shape=(), dtype=float32)
loss: tf.Tensor(0.025879622, shape=(), dtype=float32)
loss: tf.Tensor(0.118907474, shape=(), dtype=float32)
loss: tf.Tensor(0.025052082, shape=(), dtype=float32)
loss: tf.Tensor(0.073675945, shape=(), dtype=float32)
loss: tf.Tensor(0.07946596, shape=(), dtype=float32)
loss: tf.Tensor(0.019165216, shape=(), dtype=float32)
loss: tf.Tensor(0.028571207, shape=(), dtype=float32)
loss: tf.Tensor(0.006824566, shape=(), dtype=float32)
loss: tf.Tensor(0.02954814, shape=(), dtype=float32)
loss: tf.Tensor(0.026867256, shape=(), dtype=float32)
loss: tf.Tensor(0.041758038, shape=(), dtype=float32)
loss: tf.Tensor(0.0751945, shape=(), dtype=float32)
loss: tf.Tensor(0.012005437, shape=(), dtype=float32)
loss: tf.Tensor(0.0037472236, shape=(), dtype=float32)
loss: tf.Tensor(0.03539102, shape=(), dtype=float32)
loss: tf.Tensor(0.015490288, shape=(), dtype=float32)
loss: tf.Tensor(0.021997418, shape=(), dtype=float32)
loss: tf.Tensor(0.07695593, shape=(), dtype=float32)
loss: tf.Tensor(0.027399777, shape=(), dtype=float32)
loss: tf.Tensor(0.094455935, shape=(), dtype=float32)
loss: tf.Tensor(0.009400803, shape=(), dtype=float32)
loss: tf.Tensor(0.018997151, shape=(), dtype=float32)
loss: tf.Tensor(0.021835133, shape=(), dtype=float32)
loss: tf.Tensor(0.00011395759, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7119582, shape=(), dtype=float32)
F1 SCORE:
0.81339455
EPOCH  42 #################################
loss: tf.Tensor(0.004567601, shape=(), dtype=float32)
loss: tf.Tensor(0.0027738959, shape=(), dtype=float32)
loss: tf.Tensor(0.06163365, shape=(), dtype=float32)
loss: tf.Tensor(0.021582056, shape=(), dtype=float32)
loss: tf.Tensor(0.009903587, shape=(), dtype=float32)
loss: tf.Tensor(0.050153032, shape=(), dtype=float32)
loss: tf.Tensor(0.0125915995, shape=(), dtype=float32)
loss: tf.Tensor(0.006649047, shape=(), dtype=float32)
loss: tf.Tensor(0.003599719, shape=(), dtype=float32)
loss: tf.Tensor(0.0020403499, shape=(), dtype=float32)
loss: tf.Tensor(0.015399662, shape=(), dtype=float32)
loss: tf.Tensor(0.02411253, shape=(), dtype=float32)
loss: tf.Tensor(0.008702859, shape=(), dtype=float32)
loss: tf.Tensor(0.015898574, shape=(), dtype=float32)
loss: tf.Tensor(0.03929509, shape=(), dtype=float32)
loss: tf.Tensor(0.031566292, shape=(), dtype=float32)
loss: tf.Tensor(0.01538148, shape=(), dtype=float32)
loss: tf.Tensor(0.0050772796, shape=(), dtype=float32)
loss: tf.Tensor(0.023850672, shape=(), dtype=float32)
loss: tf.Tensor(0.009474694, shape=(), dtype=float32)
loss: tf.Tensor(0.06947343, shape=(), dtype=float32)
loss: tf.Tensor(0.15045296, shape=(), dtype=float32)
loss: tf.Tensor(0.016115282, shape=(), dtype=float32)
loss: tf.Tensor(0.07080601, shape=(), dtype=float32)
loss: tf.Tensor(0.042663887, shape=(), dtype=float32)
loss: tf.Tensor(0.014492236, shape=(), dtype=float32)
loss: tf.Tensor(0.003325954, shape=(), dtype=float32)
loss: tf.Tensor(0.02836733, shape=(), dtype=float32)
loss: tf.Tensor(0.05250999, shape=(), dtype=float32)
loss: tf.Tensor(0.0708207, shape=(), dtype=float32)
loss: tf.Tensor(0.032528367, shape=(), dtype=float32)
loss: tf.Tensor(0.018852437, shape=(), dtype=float32)
loss: tf.Tensor(0.086477116, shape=(), dtype=float32)
loss: tf.Tensor(0.026769305, shape=(), dtype=float32)
loss: tf.Tensor(0.04206061, shape=(), dtype=float32)
loss: tf.Tensor(0.03578536, shape=(), dtype=float32)
loss: tf.Tensor(0.00732871, shape=(), dtype=float32)
loss: tf.Tensor(0.039024875, shape=(), dtype=float32)
loss: tf.Tensor(0.012392941, shape=(), dtype=float32)
loss: tf.Tensor(0.05972251, shape=(), dtype=float32)
loss: tf.Tensor(0.0053889886, shape=(), dtype=float32)
loss: tf.Tensor(0.011740281, shape=(), dtype=float32)
loss: tf.Tensor(0.050753962, shape=(), dtype=float32)
loss: tf.Tensor(0.09446196, shape=(), dtype=float32)
loss: tf.Tensor(0.005869227, shape=(), dtype=float32)
loss: tf.Tensor(0.03914303, shape=(), dtype=float32)
loss: tf.Tensor(0.00833412, shape=(), dtype=float32)
loss: tf.Tensor(0.08387207, shape=(), dtype=float32)
loss: tf.Tensor(0.06065606, shape=(), dtype=float32)
loss: tf.Tensor(0.037655666, shape=(), dtype=float32)
loss: tf.Tensor(0.124275215, shape=(), dtype=float32)
loss: tf.Tensor(0.018682165, shape=(), dtype=float32)
loss: tf.Tensor(0.0084852185, shape=(), dtype=float32)
loss: tf.Tensor(0.016273728, shape=(), dtype=float32)
loss: tf.Tensor(0.012794323, shape=(), dtype=float32)
loss: tf.Tensor(0.030687893, shape=(), dtype=float32)
loss: tf.Tensor(0.020302782, shape=(), dtype=float32)
loss: tf.Tensor(0.012907496, shape=(), dtype=float32)
loss: tf.Tensor(0.02734508, shape=(), dtype=float32)
loss: tf.Tensor(0.008713847, shape=(), dtype=float32)
loss: tf.Tensor(0.04868077, shape=(), dtype=float32)
loss: tf.Tensor(0.03467813, shape=(), dtype=float32)
loss: tf.Tensor(0.02185302, shape=(), dtype=float32)
loss: tf.Tensor(0.02316948, shape=(), dtype=float32)
loss: tf.Tensor(0.020002322, shape=(), dtype=float32)
loss: tf.Tensor(0.02243065, shape=(), dtype=float32)
loss: tf.Tensor(0.020721884, shape=(), dtype=float32)
loss: tf.Tensor(0.011662521, shape=(), dtype=float32)
loss: tf.Tensor(0.065635115, shape=(), dtype=float32)
loss: tf.Tensor(0.057843044, shape=(), dtype=float32)
loss: tf.Tensor(0.0087405015, shape=(), dtype=float32)
loss: tf.Tensor(0.0055428036, shape=(), dtype=float32)
loss: tf.Tensor(0.04836298, shape=(), dtype=float32)
loss: tf.Tensor(1.9073468e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7083247, shape=(), dtype=float32)
F1 SCORE:
0.8135476
EPOCH  43 #################################
loss: tf.Tensor(0.00479952, shape=(), dtype=float32)
loss: tf.Tensor(0.025363788, shape=(), dtype=float32)
loss: tf.Tensor(0.055508245, shape=(), dtype=float32)
loss: tf.Tensor(0.024748402, shape=(), dtype=float32)
loss: tf.Tensor(0.020819835, shape=(), dtype=float32)
loss: tf.Tensor(0.023906335, shape=(), dtype=float32)
loss: tf.Tensor(0.026953984, shape=(), dtype=float32)
loss: tf.Tensor(0.0071553416, shape=(), dtype=float32)
loss: tf.Tensor(0.008068471, shape=(), dtype=float32)
loss: tf.Tensor(0.0064979563, shape=(), dtype=float32)
loss: tf.Tensor(0.04830108, shape=(), dtype=float32)
loss: tf.Tensor(0.022720212, shape=(), dtype=float32)
loss: tf.Tensor(0.010765736, shape=(), dtype=float32)
loss: tf.Tensor(0.01541999, shape=(), dtype=float32)
loss: tf.Tensor(0.0077625196, shape=(), dtype=float32)
loss: tf.Tensor(0.009607104, shape=(), dtype=float32)
loss: tf.Tensor(0.06379028, shape=(), dtype=float32)
loss: tf.Tensor(0.0068414207, shape=(), dtype=float32)
loss: tf.Tensor(0.0020282548, shape=(), dtype=float32)
loss: tf.Tensor(0.059638567, shape=(), dtype=float32)
loss: tf.Tensor(0.046065636, shape=(), dtype=float32)
loss: tf.Tensor(0.015286923, shape=(), dtype=float32)
loss: tf.Tensor(0.012978681, shape=(), dtype=float32)
loss: tf.Tensor(0.021121614, shape=(), dtype=float32)
loss: tf.Tensor(0.013997935, shape=(), dtype=float32)
loss: tf.Tensor(0.00869304, shape=(), dtype=float32)
loss: tf.Tensor(0.0014018024, shape=(), dtype=float32)
loss: tf.Tensor(0.04950883, shape=(), dtype=float32)
loss: tf.Tensor(0.121140964, shape=(), dtype=float32)
loss: tf.Tensor(0.013288975, shape=(), dtype=float32)
loss: tf.Tensor(0.020164602, shape=(), dtype=float32)
loss: tf.Tensor(0.059858385, shape=(), dtype=float32)
loss: tf.Tensor(0.05892682, shape=(), dtype=float32)
loss: tf.Tensor(0.07406554, shape=(), dtype=float32)
loss: tf.Tensor(0.04817932, shape=(), dtype=float32)
loss: tf.Tensor(0.030989602, shape=(), dtype=float32)
loss: tf.Tensor(0.0045737266, shape=(), dtype=float32)
loss: tf.Tensor(0.015429475, shape=(), dtype=float32)
loss: tf.Tensor(0.04689274, shape=(), dtype=float32)
loss: tf.Tensor(0.020578008, shape=(), dtype=float32)
loss: tf.Tensor(0.0065995012, shape=(), dtype=float32)
loss: tf.Tensor(0.059948493, shape=(), dtype=float32)
loss: tf.Tensor(0.015445015, shape=(), dtype=float32)
loss: tf.Tensor(0.059038762, shape=(), dtype=float32)
loss: tf.Tensor(0.027626967, shape=(), dtype=float32)
loss: tf.Tensor(0.028502814, shape=(), dtype=float32)
loss: tf.Tensor(0.017042259, shape=(), dtype=float32)
loss: tf.Tensor(0.012462913, shape=(), dtype=float32)
loss: tf.Tensor(0.03425096, shape=(), dtype=float32)
loss: tf.Tensor(0.005345681, shape=(), dtype=float32)
loss: tf.Tensor(0.021905616, shape=(), dtype=float32)
loss: tf.Tensor(0.06995279, shape=(), dtype=float32)
loss: tf.Tensor(0.019836636, shape=(), dtype=float32)
loss: tf.Tensor(0.023385026, shape=(), dtype=float32)
loss: tf.Tensor(0.008443222, shape=(), dtype=float32)
loss: tf.Tensor(0.06067717, shape=(), dtype=float32)
loss: tf.Tensor(0.097941, shape=(), dtype=float32)
loss: tf.Tensor(0.03648042, shape=(), dtype=float32)
loss: tf.Tensor(0.0033659171, shape=(), dtype=float32)
loss: tf.Tensor(0.038280897, shape=(), dtype=float32)
loss: tf.Tensor(0.0105196275, shape=(), dtype=float32)
loss: tf.Tensor(0.041974608, shape=(), dtype=float32)
loss: tf.Tensor(0.0056244032, shape=(), dtype=float32)
loss: tf.Tensor(0.045681342, shape=(), dtype=float32)
loss: tf.Tensor(0.0065713744, shape=(), dtype=float32)
loss: tf.Tensor(0.029424274, shape=(), dtype=float32)
loss: tf.Tensor(0.022127515, shape=(), dtype=float32)
loss: tf.Tensor(0.008415521, shape=(), dtype=float32)
loss: tf.Tensor(0.0060962033, shape=(), dtype=float32)
loss: tf.Tensor(0.031847592, shape=(), dtype=float32)
loss: tf.Tensor(0.023544258, shape=(), dtype=float32)
loss: tf.Tensor(0.012434162, shape=(), dtype=float32)
loss: tf.Tensor(0.02226266, shape=(), dtype=float32)
loss: tf.Tensor(0.0, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71656936, shape=(), dtype=float32)
F1 SCORE:
0.81361276
EPOCH  44 #################################
loss: tf.Tensor(0.0752734, shape=(), dtype=float32)
loss: tf.Tensor(0.01997003, shape=(), dtype=float32)
loss: tf.Tensor(0.008911753, shape=(), dtype=float32)
loss: tf.Tensor(0.006287079, shape=(), dtype=float32)
loss: tf.Tensor(0.02062835, shape=(), dtype=float32)
loss: tf.Tensor(0.015610585, shape=(), dtype=float32)
loss: tf.Tensor(0.0024702204, shape=(), dtype=float32)
loss: tf.Tensor(0.026294164, shape=(), dtype=float32)
loss: tf.Tensor(0.013100397, shape=(), dtype=float32)
loss: tf.Tensor(0.0048534377, shape=(), dtype=float32)
loss: tf.Tensor(0.0064622234, shape=(), dtype=float32)
loss: tf.Tensor(0.022484036, shape=(), dtype=float32)
loss: tf.Tensor(0.082242616, shape=(), dtype=float32)
loss: tf.Tensor(0.03794151, shape=(), dtype=float32)
loss: tf.Tensor(0.023247316, shape=(), dtype=float32)
loss: tf.Tensor(0.023839535, shape=(), dtype=float32)
loss: tf.Tensor(0.005186789, shape=(), dtype=float32)
loss: tf.Tensor(0.07340788, shape=(), dtype=float32)
loss: tf.Tensor(0.022111857, shape=(), dtype=float32)
loss: tf.Tensor(0.029411087, shape=(), dtype=float32)
loss: tf.Tensor(0.018921275, shape=(), dtype=float32)
loss: tf.Tensor(0.0048997365, shape=(), dtype=float32)
loss: tf.Tensor(0.043274898, shape=(), dtype=float32)
loss: tf.Tensor(0.013668668, shape=(), dtype=float32)
loss: tf.Tensor(0.09954009, shape=(), dtype=float32)
loss: tf.Tensor(0.03887124, shape=(), dtype=float32)
loss: tf.Tensor(0.0046373187, shape=(), dtype=float32)
loss: tf.Tensor(0.010478459, shape=(), dtype=float32)
loss: tf.Tensor(0.0053561693, shape=(), dtype=float32)
loss: tf.Tensor(0.03602333, shape=(), dtype=float32)
loss: tf.Tensor(0.006414075, shape=(), dtype=float32)
loss: tf.Tensor(0.015400517, shape=(), dtype=float32)
loss: tf.Tensor(0.022229893, shape=(), dtype=float32)
loss: tf.Tensor(0.034733262, shape=(), dtype=float32)
loss: tf.Tensor(0.02267091, shape=(), dtype=float32)
loss: tf.Tensor(0.021723857, shape=(), dtype=float32)
loss: tf.Tensor(0.024704305, shape=(), dtype=float32)
loss: tf.Tensor(0.021425502, shape=(), dtype=float32)
loss: tf.Tensor(0.026536496, shape=(), dtype=float32)
loss: tf.Tensor(0.04356853, shape=(), dtype=float32)
loss: tf.Tensor(0.0042482917, shape=(), dtype=float32)
loss: tf.Tensor(0.0939785, shape=(), dtype=float32)
loss: tf.Tensor(0.05660125, shape=(), dtype=float32)
loss: tf.Tensor(0.0067445245, shape=(), dtype=float32)
loss: tf.Tensor(0.0828242, shape=(), dtype=float32)
loss: tf.Tensor(0.017698001, shape=(), dtype=float32)
loss: tf.Tensor(0.041380282, shape=(), dtype=float32)
loss: tf.Tensor(0.05630238, shape=(), dtype=float32)
loss: tf.Tensor(0.009598114, shape=(), dtype=float32)
loss: tf.Tensor(0.0075045656, shape=(), dtype=float32)
loss: tf.Tensor(0.027315125, shape=(), dtype=float32)
loss: tf.Tensor(0.050987937, shape=(), dtype=float32)
loss: tf.Tensor(0.022697931, shape=(), dtype=float32)
loss: tf.Tensor(0.0380427, shape=(), dtype=float32)
loss: tf.Tensor(0.015573017, shape=(), dtype=float32)
loss: tf.Tensor(0.009451898, shape=(), dtype=float32)
loss: tf.Tensor(0.039964385, shape=(), dtype=float32)
loss: tf.Tensor(0.024194898, shape=(), dtype=float32)
loss: tf.Tensor(0.0123560615, shape=(), dtype=float32)
loss: tf.Tensor(0.010513078, shape=(), dtype=float32)
loss: tf.Tensor(0.026761673, shape=(), dtype=float32)
loss: tf.Tensor(0.017374398, shape=(), dtype=float32)
loss: tf.Tensor(0.07819037, shape=(), dtype=float32)
loss: tf.Tensor(0.03939448, shape=(), dtype=float32)
loss: tf.Tensor(0.05831397, shape=(), dtype=float32)
loss: tf.Tensor(0.0038388236, shape=(), dtype=float32)
loss: tf.Tensor(0.010574419, shape=(), dtype=float32)
loss: tf.Tensor(0.007177321, shape=(), dtype=float32)
loss: tf.Tensor(0.0071289064, shape=(), dtype=float32)
loss: tf.Tensor(0.047130853, shape=(), dtype=float32)
loss: tf.Tensor(0.025765851, shape=(), dtype=float32)
loss: tf.Tensor(0.003421329, shape=(), dtype=float32)
loss: tf.Tensor(0.043001276, shape=(), dtype=float32)
loss: tf.Tensor(2.0265374e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71150774, shape=(), dtype=float32)
F1 SCORE:
0.8137784
EPOCH  45 #################################
loss: tf.Tensor(0.055137366, shape=(), dtype=float32)
loss: tf.Tensor(0.004010145, shape=(), dtype=float32)
loss: tf.Tensor(0.008392191, shape=(), dtype=float32)
loss: tf.Tensor(0.19238083, shape=(), dtype=float32)
loss: tf.Tensor(0.012957514, shape=(), dtype=float32)
loss: tf.Tensor(0.015559972, shape=(), dtype=float32)
loss: tf.Tensor(0.09000941, shape=(), dtype=float32)
loss: tf.Tensor(0.014356382, shape=(), dtype=float32)
loss: tf.Tensor(0.0132346805, shape=(), dtype=float32)
loss: tf.Tensor(0.036719564, shape=(), dtype=float32)
loss: tf.Tensor(0.008628151, shape=(), dtype=float32)
loss: tf.Tensor(0.011777865, shape=(), dtype=float32)
loss: tf.Tensor(0.012246159, shape=(), dtype=float32)
loss: tf.Tensor(0.040708408, shape=(), dtype=float32)
loss: tf.Tensor(0.012745649, shape=(), dtype=float32)
loss: tf.Tensor(0.050299335, shape=(), dtype=float32)
loss: tf.Tensor(0.00835746, shape=(), dtype=float32)
loss: tf.Tensor(0.0242132, shape=(), dtype=float32)
loss: tf.Tensor(0.034783427, shape=(), dtype=float32)
loss: tf.Tensor(0.0260534, shape=(), dtype=float32)
loss: tf.Tensor(0.012112435, shape=(), dtype=float32)
loss: tf.Tensor(0.032128025, shape=(), dtype=float32)
loss: tf.Tensor(0.02744104, shape=(), dtype=float32)
loss: tf.Tensor(0.008836147, shape=(), dtype=float32)
loss: tf.Tensor(0.012708931, shape=(), dtype=float32)
loss: tf.Tensor(0.037544, shape=(), dtype=float32)
loss: tf.Tensor(0.0040212064, shape=(), dtype=float32)
loss: tf.Tensor(0.05518089, shape=(), dtype=float32)
loss: tf.Tensor(0.026640775, shape=(), dtype=float32)
loss: tf.Tensor(0.030361433, shape=(), dtype=float32)
loss: tf.Tensor(0.025533482, shape=(), dtype=float32)
loss: tf.Tensor(0.03546518, shape=(), dtype=float32)
loss: tf.Tensor(0.08002537, shape=(), dtype=float32)
loss: tf.Tensor(0.033939928, shape=(), dtype=float32)
loss: tf.Tensor(0.012199087, shape=(), dtype=float32)
loss: tf.Tensor(0.005611054, shape=(), dtype=float32)
loss: tf.Tensor(0.011728994, shape=(), dtype=float32)
loss: tf.Tensor(0.038305663, shape=(), dtype=float32)
loss: tf.Tensor(0.0141110085, shape=(), dtype=float32)
loss: tf.Tensor(0.0044116587, shape=(), dtype=float32)
loss: tf.Tensor(0.033026673, shape=(), dtype=float32)
loss: tf.Tensor(0.049573757, shape=(), dtype=float32)
loss: tf.Tensor(0.05665586, shape=(), dtype=float32)
loss: tf.Tensor(0.050624423, shape=(), dtype=float32)
loss: tf.Tensor(0.06313746, shape=(), dtype=float32)
loss: tf.Tensor(0.044057794, shape=(), dtype=float32)
loss: tf.Tensor(0.036864467, shape=(), dtype=float32)
loss: tf.Tensor(0.0180109, shape=(), dtype=float32)
loss: tf.Tensor(0.053526416, shape=(), dtype=float32)
loss: tf.Tensor(0.08879332, shape=(), dtype=float32)
loss: tf.Tensor(0.01612669, shape=(), dtype=float32)
loss: tf.Tensor(0.04837613, shape=(), dtype=float32)
loss: tf.Tensor(0.0029491824, shape=(), dtype=float32)
loss: tf.Tensor(0.019575194, shape=(), dtype=float32)
loss: tf.Tensor(0.0033852449, shape=(), dtype=float32)
loss: tf.Tensor(0.065643035, shape=(), dtype=float32)
loss: tf.Tensor(0.036065537, shape=(), dtype=float32)
loss: tf.Tensor(0.034249954, shape=(), dtype=float32)
loss: tf.Tensor(0.042006657, shape=(), dtype=float32)
loss: tf.Tensor(0.0043338435, shape=(), dtype=float32)
loss: tf.Tensor(0.037089176, shape=(), dtype=float32)
loss: tf.Tensor(0.0056338226, shape=(), dtype=float32)
loss: tf.Tensor(0.05037286, shape=(), dtype=float32)
loss: tf.Tensor(0.019521095, shape=(), dtype=float32)
loss: tf.Tensor(0.04229915, shape=(), dtype=float32)
loss: tf.Tensor(0.03927158, shape=(), dtype=float32)
loss: tf.Tensor(0.03366168, shape=(), dtype=float32)
loss: tf.Tensor(0.044705357, shape=(), dtype=float32)
loss: tf.Tensor(0.036459014, shape=(), dtype=float32)
loss: tf.Tensor(0.0064930683, shape=(), dtype=float32)
loss: tf.Tensor(0.016335996, shape=(), dtype=float32)
loss: tf.Tensor(0.0271641, shape=(), dtype=float32)
loss: tf.Tensor(0.039914347, shape=(), dtype=float32)
loss: tf.Tensor(0.00077396474, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.73362833, shape=(), dtype=float32)
F1 SCORE:
0.81304175
EPOCH  46 #################################
loss: tf.Tensor(0.036250874, shape=(), dtype=float32)
loss: tf.Tensor(0.030350138, shape=(), dtype=float32)
loss: tf.Tensor(0.025534749, shape=(), dtype=float32)
loss: tf.Tensor(0.02004189, shape=(), dtype=float32)
loss: tf.Tensor(0.047435008, shape=(), dtype=float32)
loss: tf.Tensor(0.07352213, shape=(), dtype=float32)
loss: tf.Tensor(0.02246679, shape=(), dtype=float32)
loss: tf.Tensor(0.07438073, shape=(), dtype=float32)
loss: tf.Tensor(0.010256811, shape=(), dtype=float32)
loss: tf.Tensor(0.022389019, shape=(), dtype=float32)
loss: tf.Tensor(0.0083509125, shape=(), dtype=float32)
loss: tf.Tensor(0.008026656, shape=(), dtype=float32)
loss: tf.Tensor(0.024602083, shape=(), dtype=float32)
loss: tf.Tensor(0.01743543, shape=(), dtype=float32)
loss: tf.Tensor(0.06925634, shape=(), dtype=float32)
loss: tf.Tensor(0.04370855, shape=(), dtype=float32)
loss: tf.Tensor(0.007034792, shape=(), dtype=float32)
loss: tf.Tensor(0.004207836, shape=(), dtype=float32)
loss: tf.Tensor(0.07027967, shape=(), dtype=float32)
loss: tf.Tensor(0.04443269, shape=(), dtype=float32)
loss: tf.Tensor(0.046008807, shape=(), dtype=float32)
loss: tf.Tensor(0.102463506, shape=(), dtype=float32)
loss: tf.Tensor(0.005747773, shape=(), dtype=float32)
loss: tf.Tensor(0.031734392, shape=(), dtype=float32)
loss: tf.Tensor(0.0116888, shape=(), dtype=float32)
loss: tf.Tensor(0.011966508, shape=(), dtype=float32)
loss: tf.Tensor(0.02909949, shape=(), dtype=float32)
loss: tf.Tensor(0.0031568836, shape=(), dtype=float32)
loss: tf.Tensor(0.0013465624, shape=(), dtype=float32)
loss: tf.Tensor(0.017241258, shape=(), dtype=float32)
loss: tf.Tensor(0.0028636688, shape=(), dtype=float32)
loss: tf.Tensor(0.067805216, shape=(), dtype=float32)
loss: tf.Tensor(0.08764428, shape=(), dtype=float32)
loss: tf.Tensor(0.018985292, shape=(), dtype=float32)
loss: tf.Tensor(0.027965298, shape=(), dtype=float32)
loss: tf.Tensor(0.046510845, shape=(), dtype=float32)
loss: tf.Tensor(0.022822445, shape=(), dtype=float32)
loss: tf.Tensor(0.1009692, shape=(), dtype=float32)
loss: tf.Tensor(0.020270942, shape=(), dtype=float32)
loss: tf.Tensor(0.031842273, shape=(), dtype=float32)
loss: tf.Tensor(0.01989634, shape=(), dtype=float32)
loss: tf.Tensor(0.008025104, shape=(), dtype=float32)
loss: tf.Tensor(0.0070082443, shape=(), dtype=float32)
loss: tf.Tensor(0.10359509, shape=(), dtype=float32)
loss: tf.Tensor(0.024851086, shape=(), dtype=float32)
loss: tf.Tensor(0.06359849, shape=(), dtype=float32)
loss: tf.Tensor(0.059367865, shape=(), dtype=float32)
loss: tf.Tensor(0.035476945, shape=(), dtype=float32)
loss: tf.Tensor(0.07743824, shape=(), dtype=float32)
loss: tf.Tensor(0.015661182, shape=(), dtype=float32)
loss: tf.Tensor(0.030924466, shape=(), dtype=float32)
loss: tf.Tensor(0.0072853337, shape=(), dtype=float32)
loss: tf.Tensor(0.012218542, shape=(), dtype=float32)
loss: tf.Tensor(0.045950554, shape=(), dtype=float32)
loss: tf.Tensor(0.03149346, shape=(), dtype=float32)
loss: tf.Tensor(0.09417704, shape=(), dtype=float32)
loss: tf.Tensor(0.02543385, shape=(), dtype=float32)
loss: tf.Tensor(0.02350529, shape=(), dtype=float32)
loss: tf.Tensor(0.07429105, shape=(), dtype=float32)
loss: tf.Tensor(0.028831845, shape=(), dtype=float32)
loss: tf.Tensor(0.016263794, shape=(), dtype=float32)
loss: tf.Tensor(0.06498476, shape=(), dtype=float32)
loss: tf.Tensor(0.028241232, shape=(), dtype=float32)
loss: tf.Tensor(0.008612544, shape=(), dtype=float32)
loss: tf.Tensor(0.010820828, shape=(), dtype=float32)
loss: tf.Tensor(0.06334944, shape=(), dtype=float32)
loss: tf.Tensor(0.025293468, shape=(), dtype=float32)
loss: tf.Tensor(0.054280415, shape=(), dtype=float32)
loss: tf.Tensor(0.013031156, shape=(), dtype=float32)
loss: tf.Tensor(0.0096784225, shape=(), dtype=float32)
loss: tf.Tensor(0.041308556, shape=(), dtype=float32)
loss: tf.Tensor(0.051647287, shape=(), dtype=float32)
loss: tf.Tensor(0.012158927, shape=(), dtype=float32)
loss: tf.Tensor(1.8119648e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.73151743, shape=(), dtype=float32)
F1 SCORE:
0.8126685
EPOCH  47 #################################
loss: tf.Tensor(0.03813501, shape=(), dtype=float32)
loss: tf.Tensor(0.07743028, shape=(), dtype=float32)
loss: tf.Tensor(0.019458413, shape=(), dtype=float32)
loss: tf.Tensor(0.026161732, shape=(), dtype=float32)
loss: tf.Tensor(0.0103494255, shape=(), dtype=float32)
loss: tf.Tensor(0.062805675, shape=(), dtype=float32)
loss: tf.Tensor(0.0036176937, shape=(), dtype=float32)
loss: tf.Tensor(0.033171847, shape=(), dtype=float32)
loss: tf.Tensor(0.009010687, shape=(), dtype=float32)
loss: tf.Tensor(0.02417858, shape=(), dtype=float32)
loss: tf.Tensor(0.0059473636, shape=(), dtype=float32)
loss: tf.Tensor(0.041700486, shape=(), dtype=float32)
loss: tf.Tensor(0.010306415, shape=(), dtype=float32)
loss: tf.Tensor(0.008449381, shape=(), dtype=float32)
loss: tf.Tensor(0.0063209683, shape=(), dtype=float32)
loss: tf.Tensor(0.045218933, shape=(), dtype=float32)
loss: tf.Tensor(0.0073435963, shape=(), dtype=float32)
loss: tf.Tensor(0.04220011, shape=(), dtype=float32)
loss: tf.Tensor(0.0607325, shape=(), dtype=float32)
loss: tf.Tensor(0.018109018, shape=(), dtype=float32)
loss: tf.Tensor(0.050364364, shape=(), dtype=float32)
loss: tf.Tensor(0.037087232, shape=(), dtype=float32)
loss: tf.Tensor(0.058699336, shape=(), dtype=float32)
loss: tf.Tensor(0.02528061, shape=(), dtype=float32)
loss: tf.Tensor(0.022577489, shape=(), dtype=float32)
loss: tf.Tensor(0.015050823, shape=(), dtype=float32)
loss: tf.Tensor(0.0018048364, shape=(), dtype=float32)
loss: tf.Tensor(0.014665043, shape=(), dtype=float32)
loss: tf.Tensor(0.015331655, shape=(), dtype=float32)
loss: tf.Tensor(0.051467713, shape=(), dtype=float32)
loss: tf.Tensor(0.0123465005, shape=(), dtype=float32)
loss: tf.Tensor(0.005325262, shape=(), dtype=float32)
loss: tf.Tensor(0.023020772, shape=(), dtype=float32)
loss: tf.Tensor(0.04024327, shape=(), dtype=float32)
loss: tf.Tensor(0.015617265, shape=(), dtype=float32)
loss: tf.Tensor(0.0046076975, shape=(), dtype=float32)
loss: tf.Tensor(0.0033791913, shape=(), dtype=float32)
loss: tf.Tensor(0.02357845, shape=(), dtype=float32)
loss: tf.Tensor(0.0023919963, shape=(), dtype=float32)
loss: tf.Tensor(0.045476943, shape=(), dtype=float32)
loss: tf.Tensor(0.017476289, shape=(), dtype=float32)
loss: tf.Tensor(0.00639458, shape=(), dtype=float32)
loss: tf.Tensor(0.020224612, shape=(), dtype=float32)
loss: tf.Tensor(0.013970598, shape=(), dtype=float32)
loss: tf.Tensor(0.027705226, shape=(), dtype=float32)
loss: tf.Tensor(0.06311968, shape=(), dtype=float32)
loss: tf.Tensor(0.061855458, shape=(), dtype=float32)
loss: tf.Tensor(0.008058662, shape=(), dtype=float32)
loss: tf.Tensor(0.029792737, shape=(), dtype=float32)
loss: tf.Tensor(0.025898406, shape=(), dtype=float32)
loss: tf.Tensor(0.037573338, shape=(), dtype=float32)
loss: tf.Tensor(0.0032524404, shape=(), dtype=float32)
loss: tf.Tensor(0.057669997, shape=(), dtype=float32)
loss: tf.Tensor(0.018993268, shape=(), dtype=float32)
loss: tf.Tensor(0.017921165, shape=(), dtype=float32)
loss: tf.Tensor(0.016750367, shape=(), dtype=float32)
loss: tf.Tensor(0.020753931, shape=(), dtype=float32)
loss: tf.Tensor(0.042886052, shape=(), dtype=float32)
loss: tf.Tensor(0.037096724, shape=(), dtype=float32)
loss: tf.Tensor(0.05944095, shape=(), dtype=float32)
loss: tf.Tensor(0.01608153, shape=(), dtype=float32)
loss: tf.Tensor(0.015513208, shape=(), dtype=float32)
loss: tf.Tensor(0.0028753981, shape=(), dtype=float32)
loss: tf.Tensor(0.02656099, shape=(), dtype=float32)
loss: tf.Tensor(0.032754555, shape=(), dtype=float32)
loss: tf.Tensor(0.060514282, shape=(), dtype=float32)
loss: tf.Tensor(0.024853393, shape=(), dtype=float32)
loss: tf.Tensor(0.014506216, shape=(), dtype=float32)
loss: tf.Tensor(0.0074397754, shape=(), dtype=float32)
loss: tf.Tensor(0.014565207, shape=(), dtype=float32)
loss: tf.Tensor(0.049970664, shape=(), dtype=float32)
loss: tf.Tensor(0.008418016, shape=(), dtype=float32)
loss: tf.Tensor(0.0121061085, shape=(), dtype=float32)
loss: tf.Tensor(0.032719534, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7365267, shape=(), dtype=float32)
F1 SCORE:
0.81226486
EPOCH  48 #################################
loss: tf.Tensor(0.042047568, shape=(), dtype=float32)
loss: tf.Tensor(0.056896307, shape=(), dtype=float32)
loss: tf.Tensor(0.02634502, shape=(), dtype=float32)
loss: tf.Tensor(0.028191999, shape=(), dtype=float32)
loss: tf.Tensor(0.008900337, shape=(), dtype=float32)
loss: tf.Tensor(0.07859702, shape=(), dtype=float32)
loss: tf.Tensor(0.065442674, shape=(), dtype=float32)
loss: tf.Tensor(0.035892747, shape=(), dtype=float32)
loss: tf.Tensor(0.007055981, shape=(), dtype=float32)
loss: tf.Tensor(0.035594296, shape=(), dtype=float32)
loss: tf.Tensor(0.040459305, shape=(), dtype=float32)
loss: tf.Tensor(0.14710642, shape=(), dtype=float32)
loss: tf.Tensor(0.056220006, shape=(), dtype=float32)
loss: tf.Tensor(0.042477928, shape=(), dtype=float32)
loss: tf.Tensor(0.03357576, shape=(), dtype=float32)
loss: tf.Tensor(0.00827074, shape=(), dtype=float32)
loss: tf.Tensor(0.00936028, shape=(), dtype=float32)
loss: tf.Tensor(0.017354907, shape=(), dtype=float32)
loss: tf.Tensor(0.024278034, shape=(), dtype=float32)
loss: tf.Tensor(0.012617483, shape=(), dtype=float32)
loss: tf.Tensor(0.032003224, shape=(), dtype=float32)
loss: tf.Tensor(0.00505978, shape=(), dtype=float32)
loss: tf.Tensor(0.031383764, shape=(), dtype=float32)
loss: tf.Tensor(0.008126911, shape=(), dtype=float32)
loss: tf.Tensor(0.05346439, shape=(), dtype=float32)
loss: tf.Tensor(0.010936222, shape=(), dtype=float32)
loss: tf.Tensor(0.02543138, shape=(), dtype=float32)
loss: tf.Tensor(0.06737372, shape=(), dtype=float32)
loss: tf.Tensor(0.014851468, shape=(), dtype=float32)
loss: tf.Tensor(0.048625074, shape=(), dtype=float32)
loss: tf.Tensor(0.018093806, shape=(), dtype=float32)
loss: tf.Tensor(0.017247904, shape=(), dtype=float32)
loss: tf.Tensor(0.0017591451, shape=(), dtype=float32)
loss: tf.Tensor(0.010053285, shape=(), dtype=float32)
loss: tf.Tensor(0.001451815, shape=(), dtype=float32)
loss: tf.Tensor(0.04983549, shape=(), dtype=float32)
loss: tf.Tensor(0.014823198, shape=(), dtype=float32)
loss: tf.Tensor(0.089865096, shape=(), dtype=float32)
loss: tf.Tensor(0.014710357, shape=(), dtype=float32)
loss: tf.Tensor(0.094414026, shape=(), dtype=float32)
loss: tf.Tensor(0.018052315, shape=(), dtype=float32)
loss: tf.Tensor(0.051841173, shape=(), dtype=float32)
loss: tf.Tensor(0.009077322, shape=(), dtype=float32)
loss: tf.Tensor(0.01926072, shape=(), dtype=float32)
loss: tf.Tensor(0.04572679, shape=(), dtype=float32)
loss: tf.Tensor(0.025731834, shape=(), dtype=float32)
loss: tf.Tensor(0.050488766, shape=(), dtype=float32)
loss: tf.Tensor(0.020873003, shape=(), dtype=float32)
loss: tf.Tensor(0.119124435, shape=(), dtype=float32)
loss: tf.Tensor(0.04932933, shape=(), dtype=float32)
loss: tf.Tensor(0.0048399214, shape=(), dtype=float32)
loss: tf.Tensor(0.07795154, shape=(), dtype=float32)
loss: tf.Tensor(0.011036396, shape=(), dtype=float32)
loss: tf.Tensor(0.07137076, shape=(), dtype=float32)
loss: tf.Tensor(0.07534566, shape=(), dtype=float32)
loss: tf.Tensor(0.09233481, shape=(), dtype=float32)
loss: tf.Tensor(0.044213668, shape=(), dtype=float32)
loss: tf.Tensor(0.02969338, shape=(), dtype=float32)
loss: tf.Tensor(0.03592219, shape=(), dtype=float32)
loss: tf.Tensor(0.007930554, shape=(), dtype=float32)
loss: tf.Tensor(0.010594423, shape=(), dtype=float32)
loss: tf.Tensor(0.005651145, shape=(), dtype=float32)
loss: tf.Tensor(0.019954965, shape=(), dtype=float32)
loss: tf.Tensor(0.03267758, shape=(), dtype=float32)
loss: tf.Tensor(0.035020646, shape=(), dtype=float32)
loss: tf.Tensor(0.04741473, shape=(), dtype=float32)
loss: tf.Tensor(0.03419678, shape=(), dtype=float32)
loss: tf.Tensor(0.037554752, shape=(), dtype=float32)
loss: tf.Tensor(0.016566766, shape=(), dtype=float32)
loss: tf.Tensor(0.037197813, shape=(), dtype=float32)
loss: tf.Tensor(0.042398144, shape=(), dtype=float32)
loss: tf.Tensor(0.012848306, shape=(), dtype=float32)
loss: tf.Tensor(0.054733243, shape=(), dtype=float32)
loss: tf.Tensor(0.0022933392, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7208541, shape=(), dtype=float32)
F1 SCORE:
0.8121361
EPOCH  49 #################################
loss: tf.Tensor(0.03327657, shape=(), dtype=float32)
loss: tf.Tensor(0.010097518, shape=(), dtype=float32)
loss: tf.Tensor(0.018356616, shape=(), dtype=float32)
loss: tf.Tensor(0.014940407, shape=(), dtype=float32)
loss: tf.Tensor(0.018309407, shape=(), dtype=float32)
loss: tf.Tensor(0.0035602886, shape=(), dtype=float32)
loss: tf.Tensor(0.013970549, shape=(), dtype=float32)
loss: tf.Tensor(0.049606137, shape=(), dtype=float32)
loss: tf.Tensor(0.014508308, shape=(), dtype=float32)
loss: tf.Tensor(0.005844252, shape=(), dtype=float32)
loss: tf.Tensor(0.0040705986, shape=(), dtype=float32)
loss: tf.Tensor(0.046262264, shape=(), dtype=float32)
loss: tf.Tensor(0.013774455, shape=(), dtype=float32)
loss: tf.Tensor(0.048055734, shape=(), dtype=float32)
loss: tf.Tensor(0.012335041, shape=(), dtype=float32)
loss: tf.Tensor(0.025130445, shape=(), dtype=float32)
loss: tf.Tensor(0.0051519643, shape=(), dtype=float32)
loss: tf.Tensor(0.03045439, shape=(), dtype=float32)
loss: tf.Tensor(0.0306244, shape=(), dtype=float32)
loss: tf.Tensor(0.04766706, shape=(), dtype=float32)
loss: tf.Tensor(0.057825, shape=(), dtype=float32)
loss: tf.Tensor(0.016693972, shape=(), dtype=float32)
loss: tf.Tensor(0.063011825, shape=(), dtype=float32)
loss: tf.Tensor(0.026336605, shape=(), dtype=float32)
loss: tf.Tensor(0.0035730582, shape=(), dtype=float32)
loss: tf.Tensor(0.008266672, shape=(), dtype=float32)
loss: tf.Tensor(0.03500038, shape=(), dtype=float32)
loss: tf.Tensor(0.048909083, shape=(), dtype=float32)
loss: tf.Tensor(0.034897342, shape=(), dtype=float32)
loss: tf.Tensor(0.052077107, shape=(), dtype=float32)
loss: tf.Tensor(0.008515176, shape=(), dtype=float32)
loss: tf.Tensor(0.020437263, shape=(), dtype=float32)
loss: tf.Tensor(0.020611994, shape=(), dtype=float32)
loss: tf.Tensor(0.1066119, shape=(), dtype=float32)
loss: tf.Tensor(0.0086138705, shape=(), dtype=float32)
loss: tf.Tensor(0.020158691, shape=(), dtype=float32)
loss: tf.Tensor(0.023204243, shape=(), dtype=float32)
loss: tf.Tensor(0.011054567, shape=(), dtype=float32)
loss: tf.Tensor(0.012159283, shape=(), dtype=float32)
loss: tf.Tensor(0.076705046, shape=(), dtype=float32)
loss: tf.Tensor(0.015065317, shape=(), dtype=float32)
loss: tf.Tensor(0.0039206026, shape=(), dtype=float32)
loss: tf.Tensor(0.053111583, shape=(), dtype=float32)
loss: tf.Tensor(0.025723848, shape=(), dtype=float32)
loss: tf.Tensor(0.025494007, shape=(), dtype=float32)
loss: tf.Tensor(0.015561982, shape=(), dtype=float32)
loss: tf.Tensor(0.017428776, shape=(), dtype=float32)
loss: tf.Tensor(0.01889379, shape=(), dtype=float32)
loss: tf.Tensor(0.005854624, shape=(), dtype=float32)
loss: tf.Tensor(0.07900124, shape=(), dtype=float32)
loss: tf.Tensor(0.018886238, shape=(), dtype=float32)
loss: tf.Tensor(0.04713554, shape=(), dtype=float32)
loss: tf.Tensor(0.008414382, shape=(), dtype=float32)
loss: tf.Tensor(0.004899999, shape=(), dtype=float32)
loss: tf.Tensor(0.022481065, shape=(), dtype=float32)
loss: tf.Tensor(0.036664445, shape=(), dtype=float32)
loss: tf.Tensor(0.023753338, shape=(), dtype=float32)
loss: tf.Tensor(0.0148944035, shape=(), dtype=float32)
loss: tf.Tensor(0.0132373655, shape=(), dtype=float32)
loss: tf.Tensor(0.010042951, shape=(), dtype=float32)
loss: tf.Tensor(0.0078193955, shape=(), dtype=float32)
loss: tf.Tensor(0.15463875, shape=(), dtype=float32)
loss: tf.Tensor(0.011650153, shape=(), dtype=float32)
loss: tf.Tensor(0.0006976396, shape=(), dtype=float32)
loss: tf.Tensor(0.0022746841, shape=(), dtype=float32)
loss: tf.Tensor(0.013519802, shape=(), dtype=float32)
loss: tf.Tensor(0.10795228, shape=(), dtype=float32)
loss: tf.Tensor(0.08877052, shape=(), dtype=float32)
loss: tf.Tensor(0.011092441, shape=(), dtype=float32)
loss: tf.Tensor(0.005664978, shape=(), dtype=float32)
loss: tf.Tensor(0.08406214, shape=(), dtype=float32)
loss: tf.Tensor(0.039127376, shape=(), dtype=float32)
loss: tf.Tensor(0.028496638, shape=(), dtype=float32)
loss: tf.Tensor(0.0, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f897f0929d8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7140398, shape=(), dtype=float32)
F1 SCORE:
0.812119
2021-02-23 21:00:03.237365: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-02-23 21:00:03.237403: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
LOADING DICO FINI
1000 edges added on 111397   --------   1 % 
2000 edges added on 111397   --------   2 % 
3000 edges added on 111397   --------   3 % 
4000 edges added on 111397   --------   4 % 
5000 edges added on 111397   --------   4 % 
6000 edges added on 111397   --------   5 % 
7000 edges added on 111397   --------   6 % 
8000 edges added on 111397   --------   7 % 
9000 edges added on 111397   --------   8 % 
10000 edges added on 111397   --------   9 % 
11000 edges added on 111397   --------   10 % 
12000 edges added on 111397   --------   11 % 
13000 edges added on 111397   --------   12 % 
14000 edges added on 111397   --------   13 % 
15000 edges added on 111397   --------   13 % 
16000 edges added on 111397   --------   14 % 
17000 edges added on 111397   --------   15 % 
18000 edges added on 111397   --------   16 % 
19000 edges added on 111397   --------   17 % 
20000 edges added on 111397   --------   18 % 
21000 edges added on 111397   --------   19 % 
22000 edges added on 111397   --------   20 % 
23000 edges added on 111397   --------   21 % 
24000 edges added on 111397   --------   22 % 
25000 edges added on 111397   --------   22 % 
26000 edges added on 111397   --------   23 % 
27000 edges added on 111397   --------   24 % 
28000 edges added on 111397   --------   25 % 
29000 edges added on 111397   --------   26 % 
30000 edges added on 111397   --------   27 % 
31000 edges added on 111397   --------   28 % 
32000 edges added on 111397   --------   29 % 
33000 edges added on 111397   --------   30 % 
34000 edges added on 111397   --------   31 % 
35000 edges added on 111397   --------   31 % 
36000 edges added on 111397   --------   32 % 
37000 edges added on 111397   --------   33 % 
38000 edges added on 111397   --------   34 % 
39000 edges added on 111397   --------   35 % 
40000 edges added on 111397   --------   36 % 
41000 edges added on 111397   --------   37 % 
42000 edges added on 111397   --------   38 % 
43000 edges added on 111397   --------   39 % 
44000 edges added on 111397   --------   39 % 
45000 edges added on 111397   --------   40 % 
46000 edges added on 111397   --------   41 % 
47000 edges added on 111397   --------   42 % 
48000 edges added on 111397   --------   43 % 
49000 edges added on 111397   --------   44 % 
50000 edges added on 111397   --------   45 % 
51000 edges added on 111397   --------   46 % 
52000 edges added on 111397   --------   47 % 
53000 edges added on 111397   --------   48 % 
54000 edges added on 111397   --------   48 % 
55000 edges added on 111397   --------   49 % 
56000 edges added on 111397   --------   50 % 
57000 edges added on 111397   --------   51 % 
58000 edges added on 111397   --------   52 % 
59000 edges added on 111397   --------   53 % 
60000 edges added on 111397   --------   54 % 
61000 edges added on 111397   --------   55 % 
62000 edges added on 111397   --------   56 % 
63000 edges added on 111397   --------   57 % 
64000 edges added on 111397   --------   57 % 
65000 edges added on 111397   --------   58 % 
66000 edges added on 111397   --------   59 % 
67000 edges added on 111397   --------   60 % 
68000 edges added on 111397   --------   61 % 
69000 edges added on 111397   --------   62 % 
70000 edges added on 111397   --------   63 % 
71000 edges added on 111397   --------   64 % 
72000 edges added on 111397   --------   65 % 
73000 edges added on 111397   --------   66 % 
74000 edges added on 111397   --------   66 % 
75000 edges added on 111397   --------   67 % 
76000 edges added on 111397   --------   68 % 
77000 edges added on 111397   --------   69 % 
78000 edges added on 111397   --------   70 % 
79000 edges added on 111397   --------   71 % 
80000 edges added on 111397   --------   72 % 
81000 edges added on 111397   --------   73 % 
82000 edges added on 111397   --------   74 % 
83000 edges added on 111397   --------   75 % 
84000 edges added on 111397   --------   75 % 
85000 edges added on 111397   --------   76 % 
86000 edges added on 111397   --------   77 % 
87000 edges added on 111397   --------   78 % 
88000 edges added on 111397   --------   79 % 
89000 edges added on 111397   --------   80 % 
90000 edges added on 111397   --------   81 % 
91000 edges added on 111397   --------   82 % 
92000 edges added on 111397   --------   83 % 
93000 edges added on 111397   --------   83 % 
94000 edges added on 111397   --------   84 % 
95000 edges added on 111397   --------   85 % 
96000 edges added on 111397   --------   86 % 
97000 edges added on 111397   --------   87 % 
98000 edges added on 111397   --------   88 % 
99000 edges added on 111397   --------   89 % 
100000 edges added on 111397   --------   90 % 
101000 edges added on 111397   --------   91 % 
102000 edges added on 111397   --------   92 % 
103000 edges added on 111397   --------   92 % 
104000 edges added on 111397   --------   93 % 
105000 edges added on 111397   --------   94 % 
106000 edges added on 111397   --------   95 % 
107000 edges added on 111397   --------   96 % 
108000 edges added on 111397   --------   97 % 
109000 edges added on 111397   --------   98 % 
110000 edges added on 111397   --------   99 % 
111000 edges added on 111397   --------   100 % 
avant: 7685
apres: 7301
2021-02-23 21:00:35.350895: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-02-23 21:00:35.351110: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/hadoop/lib/native:
2021-02-23 21:00:35.351147: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-02-23 21:00:35.351185: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (cedar006.saclay.inria.fr): /proc/driver/nvidia/version does not exist
2021-02-23 21:00:35.357317: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
EPOCH  0 #################################
/data/projet_citations/sage/edgeMinibatch.py:119: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.train_edges[i][2])
509
loss: tf.Tensor(1.1216754, shape=(), dtype=float32)
loss: tf.Tensor(1.0388759, shape=(), dtype=float32)
loss: tf.Tensor(0.8892078, shape=(), dtype=float32)
loss: tf.Tensor(0.9252944, shape=(), dtype=float32)
loss: tf.Tensor(0.988794, shape=(), dtype=float32)
loss: tf.Tensor(0.9832845, shape=(), dtype=float32)
loss: tf.Tensor(0.93522316, shape=(), dtype=float32)
loss: tf.Tensor(0.93075734, shape=(), dtype=float32)
loss: tf.Tensor(0.9591238, shape=(), dtype=float32)
loss: tf.Tensor(0.85329384, shape=(), dtype=float32)
loss: tf.Tensor(0.91482484, shape=(), dtype=float32)
loss: tf.Tensor(0.9945136, shape=(), dtype=float32)
loss: tf.Tensor(0.88515127, shape=(), dtype=float32)
loss: tf.Tensor(0.8942524, shape=(), dtype=float32)
loss: tf.Tensor(0.8560474, shape=(), dtype=float32)
loss: tf.Tensor(0.7637072, shape=(), dtype=float32)
loss: tf.Tensor(0.8459116, shape=(), dtype=float32)
loss: tf.Tensor(0.78297323, shape=(), dtype=float32)
loss: tf.Tensor(0.9093808, shape=(), dtype=float32)
loss: tf.Tensor(0.86595935, shape=(), dtype=float32)
loss: tf.Tensor(0.7968303, shape=(), dtype=float32)
loss: tf.Tensor(0.7985616, shape=(), dtype=float32)
loss: tf.Tensor(0.8217929, shape=(), dtype=float32)
loss: tf.Tensor(0.69184977, shape=(), dtype=float32)
loss: tf.Tensor(0.6783001, shape=(), dtype=float32)
loss: tf.Tensor(0.6805597, shape=(), dtype=float32)
loss: tf.Tensor(0.6257645, shape=(), dtype=float32)
loss: tf.Tensor(0.534725, shape=(), dtype=float32)
loss: tf.Tensor(0.70430785, shape=(), dtype=float32)
loss: tf.Tensor(0.78585535, shape=(), dtype=float32)
loss: tf.Tensor(0.69100493, shape=(), dtype=float32)
loss: tf.Tensor(0.66865164, shape=(), dtype=float32)
loss: tf.Tensor(0.77133745, shape=(), dtype=float32)
loss: tf.Tensor(0.68694234, shape=(), dtype=float32)
loss: tf.Tensor(0.6477672, shape=(), dtype=float32)
loss: tf.Tensor(0.7662108, shape=(), dtype=float32)
loss: tf.Tensor(0.7224071, shape=(), dtype=float32)
loss: tf.Tensor(0.69220924, shape=(), dtype=float32)
loss: tf.Tensor(0.726256, shape=(), dtype=float32)
loss: tf.Tensor(0.74824977, shape=(), dtype=float32)
loss: tf.Tensor(0.6618838, shape=(), dtype=float32)
loss: tf.Tensor(0.7848096, shape=(), dtype=float32)
loss: tf.Tensor(0.502902, shape=(), dtype=float32)
loss: tf.Tensor(0.60647225, shape=(), dtype=float32)
loss: tf.Tensor(0.5513486, shape=(), dtype=float32)
loss: tf.Tensor(0.6258682, shape=(), dtype=float32)
loss: tf.Tensor(0.556001, shape=(), dtype=float32)
loss: tf.Tensor(0.63163453, shape=(), dtype=float32)
loss: tf.Tensor(0.57675207, shape=(), dtype=float32)
loss: tf.Tensor(0.5410559, shape=(), dtype=float32)
loss: tf.Tensor(0.54872626, shape=(), dtype=float32)
loss: tf.Tensor(0.5593866, shape=(), dtype=float32)
loss: tf.Tensor(0.5985676, shape=(), dtype=float32)
loss: tf.Tensor(0.5431684, shape=(), dtype=float32)
loss: tf.Tensor(0.64638937, shape=(), dtype=float32)
loss: tf.Tensor(0.6320554, shape=(), dtype=float32)
loss: tf.Tensor(0.60612935, shape=(), dtype=float32)
loss: tf.Tensor(0.50134295, shape=(), dtype=float32)
loss: tf.Tensor(0.50465876, shape=(), dtype=float32)
loss: tf.Tensor(0.6823458, shape=(), dtype=float32)
loss: tf.Tensor(0.4993207, shape=(), dtype=float32)
loss: tf.Tensor(0.56346136, shape=(), dtype=float32)
loss: tf.Tensor(0.5426691, shape=(), dtype=float32)
loss: tf.Tensor(0.5294585, shape=(), dtype=float32)
loss: tf.Tensor(0.53575754, shape=(), dtype=float32)
loss: tf.Tensor(0.58400023, shape=(), dtype=float32)
loss: tf.Tensor(0.7077334, shape=(), dtype=float32)
loss: tf.Tensor(0.5167436, shape=(), dtype=float32)
loss: tf.Tensor(0.4969083, shape=(), dtype=float32)
loss: tf.Tensor(0.6291324, shape=(), dtype=float32)
loss: tf.Tensor(0.45177484, shape=(), dtype=float32)
loss: tf.Tensor(0.5248904, shape=(), dtype=float32)
loss: tf.Tensor(0.61938703, shape=(), dtype=float32)
loss: tf.Tensor(0.37806112, shape=(), dtype=float32)
TEST LOSS: #####################################
/data/projet_citations/sage/edgeMinibatch.py:163: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  text_embed = torch.tensor(self.test_edges[i][2])
2021-02-23 21:21:34.802258: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-02-23 21:21:34.803782: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2399860000 Hz
tf.Tensor(0.7520829, shape=(), dtype=float32)
F1 SCORE:
0.7886428
EPOCH  1 #################################
loss: tf.Tensor(0.4981411, shape=(), dtype=float32)
loss: tf.Tensor(0.5382288, shape=(), dtype=float32)
loss: tf.Tensor(0.5556715, shape=(), dtype=float32)
loss: tf.Tensor(0.7781715, shape=(), dtype=float32)
loss: tf.Tensor(0.53936535, shape=(), dtype=float32)
loss: tf.Tensor(0.5683829, shape=(), dtype=float32)
loss: tf.Tensor(0.6840428, shape=(), dtype=float32)
loss: tf.Tensor(0.42491516, shape=(), dtype=float32)
loss: tf.Tensor(0.5048089, shape=(), dtype=float32)
loss: tf.Tensor(0.34532556, shape=(), dtype=float32)
loss: tf.Tensor(0.4613899, shape=(), dtype=float32)
loss: tf.Tensor(0.53276014, shape=(), dtype=float32)
loss: tf.Tensor(0.7150263, shape=(), dtype=float32)
loss: tf.Tensor(0.50465035, shape=(), dtype=float32)
loss: tf.Tensor(0.39116138, shape=(), dtype=float32)
loss: tf.Tensor(0.41670147, shape=(), dtype=float32)
loss: tf.Tensor(0.5610673, shape=(), dtype=float32)
loss: tf.Tensor(0.51640284, shape=(), dtype=float32)
loss: tf.Tensor(0.44674844, shape=(), dtype=float32)
loss: tf.Tensor(0.3806184, shape=(), dtype=float32)
loss: tf.Tensor(0.60043603, shape=(), dtype=float32)
loss: tf.Tensor(0.4686723, shape=(), dtype=float32)
loss: tf.Tensor(0.3166878, shape=(), dtype=float32)
loss: tf.Tensor(0.3676247, shape=(), dtype=float32)
loss: tf.Tensor(0.3188081, shape=(), dtype=float32)
loss: tf.Tensor(0.5976981, shape=(), dtype=float32)
loss: tf.Tensor(0.5317527, shape=(), dtype=float32)
loss: tf.Tensor(0.44190812, shape=(), dtype=float32)
loss: tf.Tensor(0.42093742, shape=(), dtype=float32)
loss: tf.Tensor(0.48728552, shape=(), dtype=float32)
loss: tf.Tensor(0.42893302, shape=(), dtype=float32)
loss: tf.Tensor(0.45278445, shape=(), dtype=float32)
loss: tf.Tensor(0.53358996, shape=(), dtype=float32)
loss: tf.Tensor(0.56518006, shape=(), dtype=float32)
loss: tf.Tensor(0.3730215, shape=(), dtype=float32)
loss: tf.Tensor(0.44235602, shape=(), dtype=float32)
loss: tf.Tensor(0.5246767, shape=(), dtype=float32)
loss: tf.Tensor(0.433741, shape=(), dtype=float32)
loss: tf.Tensor(0.41296795, shape=(), dtype=float32)
loss: tf.Tensor(0.4280217, shape=(), dtype=float32)
loss: tf.Tensor(0.41676342, shape=(), dtype=float32)
loss: tf.Tensor(0.46375874, shape=(), dtype=float32)
loss: tf.Tensor(0.4294217, shape=(), dtype=float32)
loss: tf.Tensor(0.56408346, shape=(), dtype=float32)
loss: tf.Tensor(0.44913986, shape=(), dtype=float32)
loss: tf.Tensor(0.41842976, shape=(), dtype=float32)
loss: tf.Tensor(0.50127906, shape=(), dtype=float32)
loss: tf.Tensor(0.56732416, shape=(), dtype=float32)
loss: tf.Tensor(0.28818807, shape=(), dtype=float32)
loss: tf.Tensor(0.37912422, shape=(), dtype=float32)
loss: tf.Tensor(0.4955203, shape=(), dtype=float32)
loss: tf.Tensor(0.62827635, shape=(), dtype=float32)
loss: tf.Tensor(0.4776376, shape=(), dtype=float32)
loss: tf.Tensor(0.4432209, shape=(), dtype=float32)
loss: tf.Tensor(0.42940605, shape=(), dtype=float32)
loss: tf.Tensor(0.5167215, shape=(), dtype=float32)
loss: tf.Tensor(0.32983053, shape=(), dtype=float32)
loss: tf.Tensor(0.49243775, shape=(), dtype=float32)
loss: tf.Tensor(0.36086208, shape=(), dtype=float32)
loss: tf.Tensor(0.39502662, shape=(), dtype=float32)
loss: tf.Tensor(0.4813632, shape=(), dtype=float32)
loss: tf.Tensor(0.64656013, shape=(), dtype=float32)
loss: tf.Tensor(0.5022965, shape=(), dtype=float32)
loss: tf.Tensor(0.51501876, shape=(), dtype=float32)
loss: tf.Tensor(0.36931583, shape=(), dtype=float32)
loss: tf.Tensor(0.39118722, shape=(), dtype=float32)
loss: tf.Tensor(0.37862355, shape=(), dtype=float32)
loss: tf.Tensor(0.2994349, shape=(), dtype=float32)
loss: tf.Tensor(0.4414734, shape=(), dtype=float32)
loss: tf.Tensor(0.5786598, shape=(), dtype=float32)
loss: tf.Tensor(0.4686039, shape=(), dtype=float32)
loss: tf.Tensor(0.49023864, shape=(), dtype=float32)
loss: tf.Tensor(0.45330507, shape=(), dtype=float32)
loss: tf.Tensor(0.13822699, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.7229055, shape=(), dtype=float32)
F1 SCORE:
0.81059355
EPOCH  2 #################################
loss: tf.Tensor(0.47864303, shape=(), dtype=float32)
loss: tf.Tensor(0.4361639, shape=(), dtype=float32)
loss: tf.Tensor(0.47802657, shape=(), dtype=float32)
loss: tf.Tensor(0.49633855, shape=(), dtype=float32)
loss: tf.Tensor(0.30861503, shape=(), dtype=float32)
loss: tf.Tensor(0.45218375, shape=(), dtype=float32)
loss: tf.Tensor(0.28729898, shape=(), dtype=float32)
loss: tf.Tensor(0.45441547, shape=(), dtype=float32)
loss: tf.Tensor(0.48258412, shape=(), dtype=float32)
loss: tf.Tensor(0.5378061, shape=(), dtype=float32)
loss: tf.Tensor(0.3368514, shape=(), dtype=float32)
loss: tf.Tensor(0.3868059, shape=(), dtype=float32)
loss: tf.Tensor(0.4786354, shape=(), dtype=float32)
loss: tf.Tensor(0.31951138, shape=(), dtype=float32)
loss: tf.Tensor(0.5623349, shape=(), dtype=float32)
loss: tf.Tensor(0.45918775, shape=(), dtype=float32)
loss: tf.Tensor(0.3816087, shape=(), dtype=float32)
loss: tf.Tensor(0.59777164, shape=(), dtype=float32)
loss: tf.Tensor(0.38059306, shape=(), dtype=float32)
loss: tf.Tensor(0.39437324, shape=(), dtype=float32)
loss: tf.Tensor(0.4696484, shape=(), dtype=float32)
loss: tf.Tensor(0.43527928, shape=(), dtype=float32)
loss: tf.Tensor(0.35246247, shape=(), dtype=float32)
loss: tf.Tensor(0.4926315, shape=(), dtype=float32)
loss: tf.Tensor(0.4098862, shape=(), dtype=float32)
loss: tf.Tensor(0.4170976, shape=(), dtype=float32)
loss: tf.Tensor(0.31691435, shape=(), dtype=float32)
loss: tf.Tensor(0.41429302, shape=(), dtype=float32)
loss: tf.Tensor(0.32270774, shape=(), dtype=float32)
loss: tf.Tensor(0.32121292, shape=(), dtype=float32)
loss: tf.Tensor(0.45628938, shape=(), dtype=float32)
loss: tf.Tensor(0.32012448, shape=(), dtype=float32)
loss: tf.Tensor(0.39682117, shape=(), dtype=float32)
loss: tf.Tensor(0.6440898, shape=(), dtype=float32)
loss: tf.Tensor(0.38120925, shape=(), dtype=float32)
loss: tf.Tensor(0.53422093, shape=(), dtype=float32)
loss: tf.Tensor(0.31165704, shape=(), dtype=float32)
loss: tf.Tensor(0.5266557, shape=(), dtype=float32)
loss: tf.Tensor(0.40164837, shape=(), dtype=float32)
loss: tf.Tensor(0.42903602, shape=(), dtype=float32)
loss: tf.Tensor(0.4698405, shape=(), dtype=float32)
loss: tf.Tensor(0.5062452, shape=(), dtype=float32)
loss: tf.Tensor(0.4165712, shape=(), dtype=float32)
loss: tf.Tensor(0.51645046, shape=(), dtype=float32)
loss: tf.Tensor(0.37186456, shape=(), dtype=float32)
loss: tf.Tensor(0.44690612, shape=(), dtype=float32)
loss: tf.Tensor(0.49645624, shape=(), dtype=float32)
loss: tf.Tensor(0.52792454, shape=(), dtype=float32)
loss: tf.Tensor(0.416211, shape=(), dtype=float32)
loss: tf.Tensor(0.4548513, shape=(), dtype=float32)
loss: tf.Tensor(0.42935693, shape=(), dtype=float32)
loss: tf.Tensor(0.37609825, shape=(), dtype=float32)
loss: tf.Tensor(0.39718357, shape=(), dtype=float32)
loss: tf.Tensor(0.5172531, shape=(), dtype=float32)
loss: tf.Tensor(0.3967162, shape=(), dtype=float32)
loss: tf.Tensor(0.3901566, shape=(), dtype=float32)
loss: tf.Tensor(0.40089625, shape=(), dtype=float32)
loss: tf.Tensor(0.41551524, shape=(), dtype=float32)
loss: tf.Tensor(0.47078666, shape=(), dtype=float32)
loss: tf.Tensor(0.44876942, shape=(), dtype=float32)
loss: tf.Tensor(0.29367206, shape=(), dtype=float32)
loss: tf.Tensor(0.36619437, shape=(), dtype=float32)
loss: tf.Tensor(0.35394093, shape=(), dtype=float32)
loss: tf.Tensor(0.49823424, shape=(), dtype=float32)
loss: tf.Tensor(0.6991154, shape=(), dtype=float32)
loss: tf.Tensor(0.4704516, shape=(), dtype=float32)
loss: tf.Tensor(0.47820142, shape=(), dtype=float32)
loss: tf.Tensor(0.48937064, shape=(), dtype=float32)
loss: tf.Tensor(0.5941179, shape=(), dtype=float32)
loss: tf.Tensor(0.57434523, shape=(), dtype=float32)
loss: tf.Tensor(0.2665529, shape=(), dtype=float32)
loss: tf.Tensor(0.3852657, shape=(), dtype=float32)
loss: tf.Tensor(0.45649448, shape=(), dtype=float32)
loss: tf.Tensor(2.0214064, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.7442514, shape=(), dtype=float32)
F1 SCORE:
0.8213106
EPOCH  3 #################################
loss: tf.Tensor(0.3545525, shape=(), dtype=float32)
loss: tf.Tensor(0.4231001, shape=(), dtype=float32)
loss: tf.Tensor(0.39430213, shape=(), dtype=float32)
loss: tf.Tensor(0.46954262, shape=(), dtype=float32)
loss: tf.Tensor(0.496686, shape=(), dtype=float32)
loss: tf.Tensor(0.55548, shape=(), dtype=float32)
loss: tf.Tensor(0.4031865, shape=(), dtype=float32)
loss: tf.Tensor(0.49214303, shape=(), dtype=float32)
loss: tf.Tensor(0.58790314, shape=(), dtype=float32)
loss: tf.Tensor(0.47653678, shape=(), dtype=float32)
loss: tf.Tensor(0.42064667, shape=(), dtype=float32)
loss: tf.Tensor(0.38567936, shape=(), dtype=float32)
loss: tf.Tensor(0.3538744, shape=(), dtype=float32)
loss: tf.Tensor(0.39688304, shape=(), dtype=float32)
loss: tf.Tensor(0.4185841, shape=(), dtype=float32)
loss: tf.Tensor(0.485108, shape=(), dtype=float32)
loss: tf.Tensor(0.47817573, shape=(), dtype=float32)
loss: tf.Tensor(0.3877803, shape=(), dtype=float32)
loss: tf.Tensor(0.33913338, shape=(), dtype=float32)
loss: tf.Tensor(0.46141818, shape=(), dtype=float32)
loss: tf.Tensor(0.32717445, shape=(), dtype=float32)
loss: tf.Tensor(0.31993544, shape=(), dtype=float32)
loss: tf.Tensor(0.36336717, shape=(), dtype=float32)
loss: tf.Tensor(0.4660486, shape=(), dtype=float32)
loss: tf.Tensor(0.4011333, shape=(), dtype=float32)
loss: tf.Tensor(0.45379695, shape=(), dtype=float32)
loss: tf.Tensor(0.358065, shape=(), dtype=float32)
loss: tf.Tensor(0.44730583, shape=(), dtype=float32)
loss: tf.Tensor(0.46176437, shape=(), dtype=float32)
loss: tf.Tensor(0.4397911, shape=(), dtype=float32)
loss: tf.Tensor(0.4561751, shape=(), dtype=float32)
loss: tf.Tensor(0.4241231, shape=(), dtype=float32)
loss: tf.Tensor(0.34117618, shape=(), dtype=float32)
loss: tf.Tensor(0.34360945, shape=(), dtype=float32)
loss: tf.Tensor(0.28704625, shape=(), dtype=float32)
loss: tf.Tensor(0.42966625, shape=(), dtype=float32)
loss: tf.Tensor(0.37922576, shape=(), dtype=float32)
loss: tf.Tensor(0.439644, shape=(), dtype=float32)
loss: tf.Tensor(0.34692657, shape=(), dtype=float32)
loss: tf.Tensor(0.43260202, shape=(), dtype=float32)
loss: tf.Tensor(0.49210015, shape=(), dtype=float32)
loss: tf.Tensor(0.37696552, shape=(), dtype=float32)
loss: tf.Tensor(0.39915195, shape=(), dtype=float32)
loss: tf.Tensor(0.4950637, shape=(), dtype=float32)
loss: tf.Tensor(0.3440902, shape=(), dtype=float32)
loss: tf.Tensor(0.37782148, shape=(), dtype=float32)
loss: tf.Tensor(0.45111358, shape=(), dtype=float32)
loss: tf.Tensor(0.51849014, shape=(), dtype=float32)
loss: tf.Tensor(0.40861744, shape=(), dtype=float32)
loss: tf.Tensor(0.44055322, shape=(), dtype=float32)
loss: tf.Tensor(0.35777855, shape=(), dtype=float32)
loss: tf.Tensor(0.43366346, shape=(), dtype=float32)
loss: tf.Tensor(0.45539895, shape=(), dtype=float32)
loss: tf.Tensor(0.26324153, shape=(), dtype=float32)
loss: tf.Tensor(0.48796785, shape=(), dtype=float32)
loss: tf.Tensor(0.5142673, shape=(), dtype=float32)
loss: tf.Tensor(0.38041246, shape=(), dtype=float32)
loss: tf.Tensor(0.52833533, shape=(), dtype=float32)
loss: tf.Tensor(0.4304453, shape=(), dtype=float32)
loss: tf.Tensor(0.40407032, shape=(), dtype=float32)
loss: tf.Tensor(0.40716663, shape=(), dtype=float32)
loss: tf.Tensor(0.5633551, shape=(), dtype=float32)
loss: tf.Tensor(0.4832294, shape=(), dtype=float32)
loss: tf.Tensor(0.5529863, shape=(), dtype=float32)
loss: tf.Tensor(0.33959633, shape=(), dtype=float32)
loss: tf.Tensor(0.55436313, shape=(), dtype=float32)
loss: tf.Tensor(0.3834333, shape=(), dtype=float32)
loss: tf.Tensor(0.4392836, shape=(), dtype=float32)
loss: tf.Tensor(0.40203843, shape=(), dtype=float32)
loss: tf.Tensor(0.48834592, shape=(), dtype=float32)
loss: tf.Tensor(0.37455994, shape=(), dtype=float32)
loss: tf.Tensor(0.3262012, shape=(), dtype=float32)
loss: tf.Tensor(0.35540462, shape=(), dtype=float32)
loss: tf.Tensor(0.024102649, shape=(), dtype=float32)
TEST LOSS: #####################################
tf.Tensor(0.7133158, shape=(), dtype=float32)
F1 SCORE:
0.8267639
EPOCH  4 #################################
loss: tf.Tensor(0.373859, shape=(), dtype=float32)
loss: tf.Tensor(0.35996652, shape=(), dtype=float32)
loss: tf.Tensor(0.2835699, shape=(), dtype=float32)
loss: tf.Tensor(0.36593378, shape=(), dtype=float32)
loss: tf.Tensor(0.30135387, shape=(), dtype=float32)
loss: tf.Tensor(0.34314385, shape=(), dtype=float32)
loss: tf.Tensor(0.5155012, shape=(), dtype=float32)
loss: tf.Tensor(0.48897713, shape=(), dtype=float32)
loss: tf.Tensor(0.4955349, shape=(), dtype=float32)
loss: tf.Tensor(0.4515769, shape=(), dtype=float32)
loss: tf.Tensor(0.34513628, shape=(), dtype=float32)
loss: tf.Tensor(0.47495437, shape=(), dtype=float32)
loss: tf.Tensor(0.39893466, shape=(), dtype=float32)
loss: tf.Tensor(0.38435635, shape=(), dtype=float32)
loss: tf.Tensor(0.4749971, shape=(), dtype=float32)
loss: tf.Tensor(0.32858217, shape=(), dtype=float32)
loss: tf.Tensor(0.3766197, shape=(), dtype=float32)
loss: tf.Tensor(0.48010242, shape=(), dtype=float32)
loss: tf.Tensor(0.4444583, shape=(), dtype=float32)
loss: tf.Tensor(0.32185555, shape=(), dtype=float32)
loss: tf.Tensor(0.41865054, shape=(), dtype=float32)
loss: tf.Tensor(0.47569093, shape=(), dtype=float32)
loss: tf.Tensor(0.3335392, shape=(), dtype=float32)
loss: tf.Tensor(0.426674, shape=(), dtype=float32)
loss: tf.Tensor(0.47017086, shape=(), dtype=float32)
loss: tf.Tensor(0.30398473, shape=(), dtype=float32)
loss: tf.Tensor(0.3461578, shape=(), dtype=float32)
loss: tf.Tensor(0.37633774, shape=(), dtype=float32)
loss: tf.Tensor(0.3123339, shape=(), dtype=float32)
loss: tf.Tensor(0.44194224, shape=(), dtype=float32)
loss: tf.Tensor(0.29842052, shape=(), dtype=float32)
loss: tf.Tensor(0.26654643, shape=(), dtype=float32)
loss: tf.Tensor(0.37966597, shape=(), dtype=float32)
loss: tf.Tensor(0.2718504, shape=(), dtype=float32)
loss: tf.Tensor(0.57824975, shape=(), dtype=float32)
loss: tf.Tensor(0.31266958, shape=(), dtype=float32)
loss: tf.Tensor(0.4029997, shape=(), dtype=float32)
loss: tf.Tensor(0.41940203, shape=(), dtype=float32)
loss: tf.Tensor(0.33635104, shape=(), dtype=float32)
loss: tf.Tensor(0.2885343, shape=(), dtype=float32)
loss: tf.Tensor(0.5921418, shape=(), dtype=float32)
loss: tf.Tensor(0.3093536, shape=(), dtype=float32)
loss: tf.Tensor(0.3778019, shape=(), dtype=float32)
loss: tf.Tensor(0.38100037, shape=(), dtype=float32)
loss: tf.Tensor(0.2573424, shape=(), dtype=float32)
loss: tf.Tensor(0.34748372, shape=(), dtype=float32)
loss: tf.Tensor(0.4053191, shape=(), dtype=float32)
loss: tf.Tensor(0.41656017, shape=(), dtype=float32)
loss: tf.Tensor(0.39846098, shape=(), dtype=float32)
loss: tf.Tensor(0.3343037, shape=(), dtype=float32)
loss: tf.Tensor(0.27017385, shape=(), dtype=float32)
loss: tf.Tensor(0.38003334, shape=(), dtype=float32)
loss: tf.Tensor(0.43875384, shape=(), dtype=float32)
loss: tf.Tensor(0.31808007, shape=(), dtype=float32)
loss: tf.Tensor(0.39233673, shape=(), dtype=float32)
loss: tf.Tensor(0.27777326, shape=(), dtype=float32)
loss: tf.Tensor(0.3196449, shape=(), dtype=float32)
loss: tf.Tensor(0.5043467, shape=(), dtype=float32)
loss: tf.Tensor(0.34343106, shape=(), dtype=float32)
loss: tf.Tensor(0.34319758, shape=(), dtype=float32)
loss: tf.Tensor(0.40549192, shape=(), dtype=float32)
loss: tf.Tensor(0.5178557, shape=(), dtype=float32)
loss: tf.Tensor(0.35525444, shape=(), dtype=float32)
loss: tf.Tensor(0.43498638, shape=(), dtype=float32)
loss: tf.Tensor(0.40251, shape=(), dtype=float32)
loss: tf.Tensor(0.2391835, shape=(), dtype=float32)
loss: tf.Tensor(0.43220454, shape=(), dtype=float32)
loss: tf.Tensor(0.305864, shape=(), dtype=float32)
loss: tf.Tensor(0.43771148, shape=(), dtype=float32)
loss: tf.Tensor(0.53168046, shape=(), dtype=float32)
loss: tf.Tensor(0.37843946, shape=(), dtype=float32)
loss: tf.Tensor(0.3571975, shape=(), dtype=float32)
loss: tf.Tensor(0.41212422, shape=(), dtype=float32)
loss: tf.Tensor(0.5251279, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:5 out of the last 5 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71319914, shape=(), dtype=float32)
F1 SCORE:
0.82923436
EPOCH  5 #################################
loss: tf.Tensor(0.39343205, shape=(), dtype=float32)
loss: tf.Tensor(0.365025, shape=(), dtype=float32)
loss: tf.Tensor(0.31070676, shape=(), dtype=float32)
loss: tf.Tensor(0.47787842, shape=(), dtype=float32)
loss: tf.Tensor(0.33354074, shape=(), dtype=float32)
loss: tf.Tensor(0.3424937, shape=(), dtype=float32)
loss: tf.Tensor(0.42237556, shape=(), dtype=float32)
loss: tf.Tensor(0.46451682, shape=(), dtype=float32)
loss: tf.Tensor(0.62421876, shape=(), dtype=float32)
loss: tf.Tensor(0.5340923, shape=(), dtype=float32)
loss: tf.Tensor(0.46319366, shape=(), dtype=float32)
loss: tf.Tensor(0.42324516, shape=(), dtype=float32)
loss: tf.Tensor(0.3222355, shape=(), dtype=float32)
loss: tf.Tensor(0.29493588, shape=(), dtype=float32)
loss: tf.Tensor(0.250004, shape=(), dtype=float32)
loss: tf.Tensor(0.27494836, shape=(), dtype=float32)
loss: tf.Tensor(0.3471872, shape=(), dtype=float32)
loss: tf.Tensor(0.32680324, shape=(), dtype=float32)
loss: tf.Tensor(0.2714699, shape=(), dtype=float32)
loss: tf.Tensor(0.33780354, shape=(), dtype=float32)
loss: tf.Tensor(0.4455256, shape=(), dtype=float32)
loss: tf.Tensor(0.5518422, shape=(), dtype=float32)
loss: tf.Tensor(0.37705177, shape=(), dtype=float32)
loss: tf.Tensor(0.33146936, shape=(), dtype=float32)
loss: tf.Tensor(0.3621709, shape=(), dtype=float32)
loss: tf.Tensor(0.33106393, shape=(), dtype=float32)
loss: tf.Tensor(0.49705848, shape=(), dtype=float32)
loss: tf.Tensor(0.43556544, shape=(), dtype=float32)
loss: tf.Tensor(0.4884744, shape=(), dtype=float32)
loss: tf.Tensor(0.3696538, shape=(), dtype=float32)
loss: tf.Tensor(0.26616794, shape=(), dtype=float32)
loss: tf.Tensor(0.43429443, shape=(), dtype=float32)
loss: tf.Tensor(0.25356472, shape=(), dtype=float32)
loss: tf.Tensor(0.40622443, shape=(), dtype=float32)
loss: tf.Tensor(0.36735535, shape=(), dtype=float32)
loss: tf.Tensor(0.26299146, shape=(), dtype=float32)
loss: tf.Tensor(0.32463133, shape=(), dtype=float32)
loss: tf.Tensor(0.4222187, shape=(), dtype=float32)
loss: tf.Tensor(0.46636462, shape=(), dtype=float32)
loss: tf.Tensor(0.43915123, shape=(), dtype=float32)
loss: tf.Tensor(0.45515624, shape=(), dtype=float32)
loss: tf.Tensor(0.4385273, shape=(), dtype=float32)
loss: tf.Tensor(0.38375363, shape=(), dtype=float32)
loss: tf.Tensor(0.37604183, shape=(), dtype=float32)
loss: tf.Tensor(0.46780685, shape=(), dtype=float32)
loss: tf.Tensor(0.25896788, shape=(), dtype=float32)
loss: tf.Tensor(0.40656486, shape=(), dtype=float32)
loss: tf.Tensor(0.3588764, shape=(), dtype=float32)
loss: tf.Tensor(0.45455262, shape=(), dtype=float32)
loss: tf.Tensor(0.38567707, shape=(), dtype=float32)
loss: tf.Tensor(0.28112668, shape=(), dtype=float32)
loss: tf.Tensor(0.444549, shape=(), dtype=float32)
loss: tf.Tensor(0.31545496, shape=(), dtype=float32)
loss: tf.Tensor(0.4331774, shape=(), dtype=float32)
loss: tf.Tensor(0.42502868, shape=(), dtype=float32)
loss: tf.Tensor(0.39822495, shape=(), dtype=float32)
loss: tf.Tensor(0.36466464, shape=(), dtype=float32)
loss: tf.Tensor(0.34952414, shape=(), dtype=float32)
loss: tf.Tensor(0.28137553, shape=(), dtype=float32)
loss: tf.Tensor(0.30152592, shape=(), dtype=float32)
loss: tf.Tensor(0.3609201, shape=(), dtype=float32)
loss: tf.Tensor(0.33961758, shape=(), dtype=float32)
loss: tf.Tensor(0.37931675, shape=(), dtype=float32)
loss: tf.Tensor(0.23140629, shape=(), dtype=float32)
loss: tf.Tensor(0.31001645, shape=(), dtype=float32)
loss: tf.Tensor(0.53304505, shape=(), dtype=float32)
loss: tf.Tensor(0.44931924, shape=(), dtype=float32)
loss: tf.Tensor(0.4310499, shape=(), dtype=float32)
loss: tf.Tensor(0.3865111, shape=(), dtype=float32)
loss: tf.Tensor(0.4007057, shape=(), dtype=float32)
loss: tf.Tensor(0.34531474, shape=(), dtype=float32)
loss: tf.Tensor(0.19126397, shape=(), dtype=float32)
loss: tf.Tensor(0.30025077, shape=(), dtype=float32)
loss: tf.Tensor(0.050603293, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:6 out of the last 6 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7018888, shape=(), dtype=float32)
F1 SCORE:
0.83334684
EPOCH  6 #################################
loss: tf.Tensor(0.31819043, shape=(), dtype=float32)
loss: tf.Tensor(0.32952154, shape=(), dtype=float32)
loss: tf.Tensor(0.4434527, shape=(), dtype=float32)
loss: tf.Tensor(0.33582786, shape=(), dtype=float32)
loss: tf.Tensor(0.36466366, shape=(), dtype=float32)
loss: tf.Tensor(0.32505363, shape=(), dtype=float32)
loss: tf.Tensor(0.4038604, shape=(), dtype=float32)
loss: tf.Tensor(0.30721927, shape=(), dtype=float32)
loss: tf.Tensor(0.24157992, shape=(), dtype=float32)
loss: tf.Tensor(0.33609208, shape=(), dtype=float32)
loss: tf.Tensor(0.32659245, shape=(), dtype=float32)
loss: tf.Tensor(0.23982091, shape=(), dtype=float32)
loss: tf.Tensor(0.3600968, shape=(), dtype=float32)
loss: tf.Tensor(0.57252795, shape=(), dtype=float32)
loss: tf.Tensor(0.3856784, shape=(), dtype=float32)
loss: tf.Tensor(0.2493769, shape=(), dtype=float32)
loss: tf.Tensor(0.40000847, shape=(), dtype=float32)
loss: tf.Tensor(0.30421922, shape=(), dtype=float32)
loss: tf.Tensor(0.4857309, shape=(), dtype=float32)
loss: tf.Tensor(0.30047554, shape=(), dtype=float32)
loss: tf.Tensor(0.30067554, shape=(), dtype=float32)
loss: tf.Tensor(0.35536438, shape=(), dtype=float32)
loss: tf.Tensor(0.44028816, shape=(), dtype=float32)
loss: tf.Tensor(0.24735871, shape=(), dtype=float32)
loss: tf.Tensor(0.22895989, shape=(), dtype=float32)
loss: tf.Tensor(0.2564892, shape=(), dtype=float32)
loss: tf.Tensor(0.38397613, shape=(), dtype=float32)
loss: tf.Tensor(0.34084868, shape=(), dtype=float32)
loss: tf.Tensor(0.35162637, shape=(), dtype=float32)
loss: tf.Tensor(0.3463341, shape=(), dtype=float32)
loss: tf.Tensor(0.3345002, shape=(), dtype=float32)
loss: tf.Tensor(0.25883168, shape=(), dtype=float32)
loss: tf.Tensor(0.29571208, shape=(), dtype=float32)
loss: tf.Tensor(0.41622677, shape=(), dtype=float32)
loss: tf.Tensor(0.43107578, shape=(), dtype=float32)
loss: tf.Tensor(0.47363648, shape=(), dtype=float32)
loss: tf.Tensor(0.26171353, shape=(), dtype=float32)
loss: tf.Tensor(0.2693334, shape=(), dtype=float32)
loss: tf.Tensor(0.28265423, shape=(), dtype=float32)
loss: tf.Tensor(0.39702037, shape=(), dtype=float32)
loss: tf.Tensor(0.3917174, shape=(), dtype=float32)
loss: tf.Tensor(0.40458083, shape=(), dtype=float32)
loss: tf.Tensor(0.4589692, shape=(), dtype=float32)
loss: tf.Tensor(0.34827298, shape=(), dtype=float32)
loss: tf.Tensor(0.3934589, shape=(), dtype=float32)
loss: tf.Tensor(0.3951916, shape=(), dtype=float32)
loss: tf.Tensor(0.35217515, shape=(), dtype=float32)
loss: tf.Tensor(0.27906337, shape=(), dtype=float32)
loss: tf.Tensor(0.36993763, shape=(), dtype=float32)
loss: tf.Tensor(0.4125248, shape=(), dtype=float32)
loss: tf.Tensor(0.3402754, shape=(), dtype=float32)
loss: tf.Tensor(0.37232712, shape=(), dtype=float32)
loss: tf.Tensor(0.31040946, shape=(), dtype=float32)
loss: tf.Tensor(0.2704431, shape=(), dtype=float32)
loss: tf.Tensor(0.35344166, shape=(), dtype=float32)
loss: tf.Tensor(0.34288308, shape=(), dtype=float32)
loss: tf.Tensor(0.367822, shape=(), dtype=float32)
loss: tf.Tensor(0.3166115, shape=(), dtype=float32)
loss: tf.Tensor(0.26430196, shape=(), dtype=float32)
loss: tf.Tensor(0.27038813, shape=(), dtype=float32)
loss: tf.Tensor(0.27898312, shape=(), dtype=float32)
loss: tf.Tensor(0.34758648, shape=(), dtype=float32)
loss: tf.Tensor(0.2940196, shape=(), dtype=float32)
loss: tf.Tensor(0.4084412, shape=(), dtype=float32)
loss: tf.Tensor(0.43378136, shape=(), dtype=float32)
loss: tf.Tensor(0.28465456, shape=(), dtype=float32)
loss: tf.Tensor(0.39649308, shape=(), dtype=float32)
loss: tf.Tensor(0.4460673, shape=(), dtype=float32)
loss: tf.Tensor(0.24745889, shape=(), dtype=float32)
loss: tf.Tensor(0.3231852, shape=(), dtype=float32)
loss: tf.Tensor(0.36769283, shape=(), dtype=float32)
loss: tf.Tensor(0.28591222, shape=(), dtype=float32)
loss: tf.Tensor(0.4082971, shape=(), dtype=float32)
loss: tf.Tensor(0.035745885, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:7 out of the last 7 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7009335, shape=(), dtype=float32)
F1 SCORE:
0.8359526
EPOCH  7 #################################
loss: tf.Tensor(0.29770488, shape=(), dtype=float32)
loss: tf.Tensor(0.3399254, shape=(), dtype=float32)
loss: tf.Tensor(0.37466496, shape=(), dtype=float32)
loss: tf.Tensor(0.28830525, shape=(), dtype=float32)
loss: tf.Tensor(0.40087265, shape=(), dtype=float32)
loss: tf.Tensor(0.3044543, shape=(), dtype=float32)
loss: tf.Tensor(0.31074044, shape=(), dtype=float32)
loss: tf.Tensor(0.3804577, shape=(), dtype=float32)
loss: tf.Tensor(0.33978522, shape=(), dtype=float32)
loss: tf.Tensor(0.28327036, shape=(), dtype=float32)
loss: tf.Tensor(0.33168182, shape=(), dtype=float32)
loss: tf.Tensor(0.26745984, shape=(), dtype=float32)
loss: tf.Tensor(0.34166175, shape=(), dtype=float32)
loss: tf.Tensor(0.46941108, shape=(), dtype=float32)
loss: tf.Tensor(0.35758907, shape=(), dtype=float32)
loss: tf.Tensor(0.29174984, shape=(), dtype=float32)
loss: tf.Tensor(0.40996236, shape=(), dtype=float32)
loss: tf.Tensor(0.32915175, shape=(), dtype=float32)
loss: tf.Tensor(0.27329558, shape=(), dtype=float32)
loss: tf.Tensor(0.3948261, shape=(), dtype=float32)
loss: tf.Tensor(0.250323, shape=(), dtype=float32)
loss: tf.Tensor(0.51091444, shape=(), dtype=float32)
loss: tf.Tensor(0.3322279, shape=(), dtype=float32)
loss: tf.Tensor(0.28277257, shape=(), dtype=float32)
loss: tf.Tensor(0.41289702, shape=(), dtype=float32)
loss: tf.Tensor(0.27454686, shape=(), dtype=float32)
loss: tf.Tensor(0.31846893, shape=(), dtype=float32)
loss: tf.Tensor(0.3845392, shape=(), dtype=float32)
loss: tf.Tensor(0.36972237, shape=(), dtype=float32)
loss: tf.Tensor(0.2595822, shape=(), dtype=float32)
loss: tf.Tensor(0.20592524, shape=(), dtype=float32)
loss: tf.Tensor(0.37643597, shape=(), dtype=float32)
loss: tf.Tensor(0.27907348, shape=(), dtype=float32)
loss: tf.Tensor(0.42061538, shape=(), dtype=float32)
loss: tf.Tensor(0.3253627, shape=(), dtype=float32)
loss: tf.Tensor(0.35002938, shape=(), dtype=float32)
loss: tf.Tensor(0.35704976, shape=(), dtype=float32)
loss: tf.Tensor(0.28355643, shape=(), dtype=float32)
loss: tf.Tensor(0.2662474, shape=(), dtype=float32)
loss: tf.Tensor(0.44684383, shape=(), dtype=float32)
loss: tf.Tensor(0.2667795, shape=(), dtype=float32)
loss: tf.Tensor(0.28851232, shape=(), dtype=float32)
loss: tf.Tensor(0.19403306, shape=(), dtype=float32)
loss: tf.Tensor(0.35156396, shape=(), dtype=float32)
loss: tf.Tensor(0.3880191, shape=(), dtype=float32)
loss: tf.Tensor(0.3785285, shape=(), dtype=float32)
loss: tf.Tensor(0.38537356, shape=(), dtype=float32)
loss: tf.Tensor(0.33910483, shape=(), dtype=float32)
loss: tf.Tensor(0.3009876, shape=(), dtype=float32)
loss: tf.Tensor(0.3777676, shape=(), dtype=float32)
loss: tf.Tensor(0.2876672, shape=(), dtype=float32)
loss: tf.Tensor(0.30252364, shape=(), dtype=float32)
loss: tf.Tensor(0.29667628, shape=(), dtype=float32)
loss: tf.Tensor(0.32187557, shape=(), dtype=float32)
loss: tf.Tensor(0.28641227, shape=(), dtype=float32)
loss: tf.Tensor(0.31216204, shape=(), dtype=float32)
loss: tf.Tensor(0.2377089, shape=(), dtype=float32)
loss: tf.Tensor(0.25054458, shape=(), dtype=float32)
loss: tf.Tensor(0.25751936, shape=(), dtype=float32)
loss: tf.Tensor(0.3802678, shape=(), dtype=float32)
loss: tf.Tensor(0.24932049, shape=(), dtype=float32)
loss: tf.Tensor(0.2620505, shape=(), dtype=float32)
loss: tf.Tensor(0.3344848, shape=(), dtype=float32)
loss: tf.Tensor(0.32270363, shape=(), dtype=float32)
loss: tf.Tensor(0.41695535, shape=(), dtype=float32)
loss: tf.Tensor(0.3083333, shape=(), dtype=float32)
loss: tf.Tensor(0.38929856, shape=(), dtype=float32)
loss: tf.Tensor(0.385863, shape=(), dtype=float32)
loss: tf.Tensor(0.40611613, shape=(), dtype=float32)
loss: tf.Tensor(0.3326917, shape=(), dtype=float32)
loss: tf.Tensor(0.2691043, shape=(), dtype=float32)
loss: tf.Tensor(0.3590999, shape=(), dtype=float32)
loss: tf.Tensor(0.3956279, shape=(), dtype=float32)
loss: tf.Tensor(0.01402769, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:8 out of the last 8 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6969476, shape=(), dtype=float32)
F1 SCORE:
0.83881384
EPOCH  8 #################################
loss: tf.Tensor(0.30046985, shape=(), dtype=float32)
loss: tf.Tensor(0.27142987, shape=(), dtype=float32)
loss: tf.Tensor(0.30353352, shape=(), dtype=float32)
loss: tf.Tensor(0.25741792, shape=(), dtype=float32)
loss: tf.Tensor(0.31451038, shape=(), dtype=float32)
loss: tf.Tensor(0.23348182, shape=(), dtype=float32)
loss: tf.Tensor(0.31683645, shape=(), dtype=float32)
loss: tf.Tensor(0.37685317, shape=(), dtype=float32)
loss: tf.Tensor(0.31213388, shape=(), dtype=float32)
loss: tf.Tensor(0.20046873, shape=(), dtype=float32)
loss: tf.Tensor(0.24397051, shape=(), dtype=float32)
loss: tf.Tensor(0.37596536, shape=(), dtype=float32)
loss: tf.Tensor(0.31386667, shape=(), dtype=float32)
loss: tf.Tensor(0.28251725, shape=(), dtype=float32)
loss: tf.Tensor(0.43460327, shape=(), dtype=float32)
loss: tf.Tensor(0.32288092, shape=(), dtype=float32)
loss: tf.Tensor(0.24172625, shape=(), dtype=float32)
loss: tf.Tensor(0.31205115, shape=(), dtype=float32)
loss: tf.Tensor(0.37562153, shape=(), dtype=float32)
loss: tf.Tensor(0.45036572, shape=(), dtype=float32)
loss: tf.Tensor(0.23215185, shape=(), dtype=float32)
loss: tf.Tensor(0.34097087, shape=(), dtype=float32)
loss: tf.Tensor(0.16223633, shape=(), dtype=float32)
loss: tf.Tensor(0.34186286, shape=(), dtype=float32)
loss: tf.Tensor(0.33159217, shape=(), dtype=float32)
loss: tf.Tensor(0.35963318, shape=(), dtype=float32)
loss: tf.Tensor(0.33894238, shape=(), dtype=float32)
loss: tf.Tensor(0.28616577, shape=(), dtype=float32)
loss: tf.Tensor(0.31133646, shape=(), dtype=float32)
loss: tf.Tensor(0.2926253, shape=(), dtype=float32)
loss: tf.Tensor(0.30880448, shape=(), dtype=float32)
loss: tf.Tensor(0.24786712, shape=(), dtype=float32)
loss: tf.Tensor(0.24387236, shape=(), dtype=float32)
loss: tf.Tensor(0.36174974, shape=(), dtype=float32)
loss: tf.Tensor(0.3425571, shape=(), dtype=float32)
loss: tf.Tensor(0.4740546, shape=(), dtype=float32)
loss: tf.Tensor(0.25407317, shape=(), dtype=float32)
loss: tf.Tensor(0.28413188, shape=(), dtype=float32)
loss: tf.Tensor(0.34937248, shape=(), dtype=float32)
loss: tf.Tensor(0.2925245, shape=(), dtype=float32)
loss: tf.Tensor(0.32261902, shape=(), dtype=float32)
loss: tf.Tensor(0.33612698, shape=(), dtype=float32)
loss: tf.Tensor(0.26138818, shape=(), dtype=float32)
loss: tf.Tensor(0.20362923, shape=(), dtype=float32)
loss: tf.Tensor(0.3201291, shape=(), dtype=float32)
loss: tf.Tensor(0.26348037, shape=(), dtype=float32)
loss: tf.Tensor(0.21474779, shape=(), dtype=float32)
loss: tf.Tensor(0.22289942, shape=(), dtype=float32)
loss: tf.Tensor(0.30759546, shape=(), dtype=float32)
loss: tf.Tensor(0.23171732, shape=(), dtype=float32)
loss: tf.Tensor(0.41736287, shape=(), dtype=float32)
loss: tf.Tensor(0.33249542, shape=(), dtype=float32)
loss: tf.Tensor(0.4935075, shape=(), dtype=float32)
loss: tf.Tensor(0.29281056, shape=(), dtype=float32)
loss: tf.Tensor(0.42259377, shape=(), dtype=float32)
loss: tf.Tensor(0.31141078, shape=(), dtype=float32)
loss: tf.Tensor(0.35835972, shape=(), dtype=float32)
loss: tf.Tensor(0.26687428, shape=(), dtype=float32)
loss: tf.Tensor(0.366974, shape=(), dtype=float32)
loss: tf.Tensor(0.27532387, shape=(), dtype=float32)
loss: tf.Tensor(0.25852212, shape=(), dtype=float32)
loss: tf.Tensor(0.44736525, shape=(), dtype=float32)
loss: tf.Tensor(0.28478178, shape=(), dtype=float32)
loss: tf.Tensor(0.22843225, shape=(), dtype=float32)
loss: tf.Tensor(0.38900226, shape=(), dtype=float32)
loss: tf.Tensor(0.3293533, shape=(), dtype=float32)
loss: tf.Tensor(0.31294906, shape=(), dtype=float32)
loss: tf.Tensor(0.2729387, shape=(), dtype=float32)
loss: tf.Tensor(0.27307063, shape=(), dtype=float32)
loss: tf.Tensor(0.371727, shape=(), dtype=float32)
loss: tf.Tensor(0.25996247, shape=(), dtype=float32)
loss: tf.Tensor(0.3160009, shape=(), dtype=float32)
loss: tf.Tensor(0.32805625, shape=(), dtype=float32)
loss: tf.Tensor(0.0640693, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:9 out of the last 9 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69594234, shape=(), dtype=float32)
F1 SCORE:
0.8392078
EPOCH  9 #################################
loss: tf.Tensor(0.3391124, shape=(), dtype=float32)
loss: tf.Tensor(0.21388605, shape=(), dtype=float32)
loss: tf.Tensor(0.2694522, shape=(), dtype=float32)
loss: tf.Tensor(0.25243953, shape=(), dtype=float32)
loss: tf.Tensor(0.2757649, shape=(), dtype=float32)
loss: tf.Tensor(0.18465245, shape=(), dtype=float32)
loss: tf.Tensor(0.21578278, shape=(), dtype=float32)
loss: tf.Tensor(0.31914875, shape=(), dtype=float32)
loss: tf.Tensor(0.25671852, shape=(), dtype=float32)
loss: tf.Tensor(0.2812607, shape=(), dtype=float32)
loss: tf.Tensor(0.4308401, shape=(), dtype=float32)
loss: tf.Tensor(0.24976783, shape=(), dtype=float32)
loss: tf.Tensor(0.26210895, shape=(), dtype=float32)
loss: tf.Tensor(0.3460078, shape=(), dtype=float32)
loss: tf.Tensor(0.29819444, shape=(), dtype=float32)
loss: tf.Tensor(0.22642517, shape=(), dtype=float32)
loss: tf.Tensor(0.23279914, shape=(), dtype=float32)
loss: tf.Tensor(0.2511016, shape=(), dtype=float32)
loss: tf.Tensor(0.2694561, shape=(), dtype=float32)
loss: tf.Tensor(0.26964554, shape=(), dtype=float32)
loss: tf.Tensor(0.3422128, shape=(), dtype=float32)
loss: tf.Tensor(0.26063377, shape=(), dtype=float32)
loss: tf.Tensor(0.32482, shape=(), dtype=float32)
loss: tf.Tensor(0.24650213, shape=(), dtype=float32)
loss: tf.Tensor(0.27833536, shape=(), dtype=float32)
loss: tf.Tensor(0.20960905, shape=(), dtype=float32)
loss: tf.Tensor(0.22764088, shape=(), dtype=float32)
loss: tf.Tensor(0.24695355, shape=(), dtype=float32)
loss: tf.Tensor(0.22308072, shape=(), dtype=float32)
loss: tf.Tensor(0.27234593, shape=(), dtype=float32)
loss: tf.Tensor(0.30233365, shape=(), dtype=float32)
loss: tf.Tensor(0.31410798, shape=(), dtype=float32)
loss: tf.Tensor(0.216376, shape=(), dtype=float32)
loss: tf.Tensor(0.31767026, shape=(), dtype=float32)
loss: tf.Tensor(0.26094842, shape=(), dtype=float32)
loss: tf.Tensor(0.26834157, shape=(), dtype=float32)
loss: tf.Tensor(0.46895847, shape=(), dtype=float32)
loss: tf.Tensor(0.30011597, shape=(), dtype=float32)
loss: tf.Tensor(0.35428086, shape=(), dtype=float32)
loss: tf.Tensor(0.28414267, shape=(), dtype=float32)
loss: tf.Tensor(0.32369828, shape=(), dtype=float32)
loss: tf.Tensor(0.34676802, shape=(), dtype=float32)
loss: tf.Tensor(0.27888, shape=(), dtype=float32)
loss: tf.Tensor(0.35869983, shape=(), dtype=float32)
loss: tf.Tensor(0.32540303, shape=(), dtype=float32)
loss: tf.Tensor(0.22471829, shape=(), dtype=float32)
loss: tf.Tensor(0.25249812, shape=(), dtype=float32)
loss: tf.Tensor(0.2237987, shape=(), dtype=float32)
loss: tf.Tensor(0.40084612, shape=(), dtype=float32)
loss: tf.Tensor(0.28233305, shape=(), dtype=float32)
loss: tf.Tensor(0.25664625, shape=(), dtype=float32)
loss: tf.Tensor(0.29084548, shape=(), dtype=float32)
loss: tf.Tensor(0.29194215, shape=(), dtype=float32)
loss: tf.Tensor(0.21481234, shape=(), dtype=float32)
loss: tf.Tensor(0.22687645, shape=(), dtype=float32)
loss: tf.Tensor(0.18793352, shape=(), dtype=float32)
loss: tf.Tensor(0.22556354, shape=(), dtype=float32)
loss: tf.Tensor(0.23543353, shape=(), dtype=float32)
loss: tf.Tensor(0.30971727, shape=(), dtype=float32)
loss: tf.Tensor(0.40027487, shape=(), dtype=float32)
loss: tf.Tensor(0.2957909, shape=(), dtype=float32)
loss: tf.Tensor(0.33832973, shape=(), dtype=float32)
loss: tf.Tensor(0.20940088, shape=(), dtype=float32)
loss: tf.Tensor(0.18183799, shape=(), dtype=float32)
loss: tf.Tensor(0.3915366, shape=(), dtype=float32)
loss: tf.Tensor(0.29587543, shape=(), dtype=float32)
loss: tf.Tensor(0.29031172, shape=(), dtype=float32)
loss: tf.Tensor(0.26337028, shape=(), dtype=float32)
loss: tf.Tensor(0.30507702, shape=(), dtype=float32)
loss: tf.Tensor(0.3183122, shape=(), dtype=float32)
loss: tf.Tensor(0.27918535, shape=(), dtype=float32)
loss: tf.Tensor(0.28875676, shape=(), dtype=float32)
loss: tf.Tensor(0.28201044, shape=(), dtype=float32)
loss: tf.Tensor(0.01634424, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:10 out of the last 10 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.696302, shape=(), dtype=float32)
F1 SCORE:
0.8396222
EPOCH  10 #################################
loss: tf.Tensor(0.2893007, shape=(), dtype=float32)
loss: tf.Tensor(0.23688918, shape=(), dtype=float32)
loss: tf.Tensor(0.2964004, shape=(), dtype=float32)
loss: tf.Tensor(0.275165, shape=(), dtype=float32)
loss: tf.Tensor(0.19691522, shape=(), dtype=float32)
loss: tf.Tensor(0.16419736, shape=(), dtype=float32)
loss: tf.Tensor(0.17526428, shape=(), dtype=float32)
loss: tf.Tensor(0.22404534, shape=(), dtype=float32)
loss: tf.Tensor(0.24120897, shape=(), dtype=float32)
loss: tf.Tensor(0.17535408, shape=(), dtype=float32)
loss: tf.Tensor(0.16763324, shape=(), dtype=float32)
loss: tf.Tensor(0.09797324, shape=(), dtype=float32)
loss: tf.Tensor(0.20101921, shape=(), dtype=float32)
loss: tf.Tensor(0.3235589, shape=(), dtype=float32)
loss: tf.Tensor(0.21685673, shape=(), dtype=float32)
loss: tf.Tensor(0.2745965, shape=(), dtype=float32)
loss: tf.Tensor(0.15587564, shape=(), dtype=float32)
loss: tf.Tensor(0.2565243, shape=(), dtype=float32)
loss: tf.Tensor(0.2710225, shape=(), dtype=float32)
loss: tf.Tensor(0.22550917, shape=(), dtype=float32)
loss: tf.Tensor(0.29067203, shape=(), dtype=float32)
loss: tf.Tensor(0.22126396, shape=(), dtype=float32)
loss: tf.Tensor(0.369377, shape=(), dtype=float32)
loss: tf.Tensor(0.3284039, shape=(), dtype=float32)
loss: tf.Tensor(0.29079065, shape=(), dtype=float32)
loss: tf.Tensor(0.34279197, shape=(), dtype=float32)
loss: tf.Tensor(0.2780516, shape=(), dtype=float32)
loss: tf.Tensor(0.25203973, shape=(), dtype=float32)
loss: tf.Tensor(0.25365546, shape=(), dtype=float32)
loss: tf.Tensor(0.2632315, shape=(), dtype=float32)
loss: tf.Tensor(0.23801196, shape=(), dtype=float32)
loss: tf.Tensor(0.27327487, shape=(), dtype=float32)
loss: tf.Tensor(0.22925915, shape=(), dtype=float32)
loss: tf.Tensor(0.2518561, shape=(), dtype=float32)
loss: tf.Tensor(0.33512583, shape=(), dtype=float32)
loss: tf.Tensor(0.24004343, shape=(), dtype=float32)
loss: tf.Tensor(0.17712784, shape=(), dtype=float32)
loss: tf.Tensor(0.2595744, shape=(), dtype=float32)
loss: tf.Tensor(0.24554686, shape=(), dtype=float32)
loss: tf.Tensor(0.26258218, shape=(), dtype=float32)
loss: tf.Tensor(0.27099204, shape=(), dtype=float32)
loss: tf.Tensor(0.22873008, shape=(), dtype=float32)
loss: tf.Tensor(0.39550522, shape=(), dtype=float32)
loss: tf.Tensor(0.42740586, shape=(), dtype=float32)
loss: tf.Tensor(0.25989702, shape=(), dtype=float32)
loss: tf.Tensor(0.195457, shape=(), dtype=float32)
loss: tf.Tensor(0.31117976, shape=(), dtype=float32)
loss: tf.Tensor(0.30604836, shape=(), dtype=float32)
loss: tf.Tensor(0.20314632, shape=(), dtype=float32)
loss: tf.Tensor(0.26160288, shape=(), dtype=float32)
loss: tf.Tensor(0.2605995, shape=(), dtype=float32)
loss: tf.Tensor(0.28936362, shape=(), dtype=float32)
loss: tf.Tensor(0.27416557, shape=(), dtype=float32)
loss: tf.Tensor(0.26942176, shape=(), dtype=float32)
loss: tf.Tensor(0.29674903, shape=(), dtype=float32)
loss: tf.Tensor(0.3758176, shape=(), dtype=float32)
loss: tf.Tensor(0.2559818, shape=(), dtype=float32)
loss: tf.Tensor(0.1777426, shape=(), dtype=float32)
loss: tf.Tensor(0.23561166, shape=(), dtype=float32)
loss: tf.Tensor(0.25099498, shape=(), dtype=float32)
loss: tf.Tensor(0.3048937, shape=(), dtype=float32)
loss: tf.Tensor(0.2019737, shape=(), dtype=float32)
loss: tf.Tensor(0.2999733, shape=(), dtype=float32)
loss: tf.Tensor(0.2922878, shape=(), dtype=float32)
loss: tf.Tensor(0.26200187, shape=(), dtype=float32)
loss: tf.Tensor(0.2084373, shape=(), dtype=float32)
loss: tf.Tensor(0.28165996, shape=(), dtype=float32)
loss: tf.Tensor(0.28655118, shape=(), dtype=float32)
loss: tf.Tensor(0.24436207, shape=(), dtype=float32)
loss: tf.Tensor(0.24325544, shape=(), dtype=float32)
loss: tf.Tensor(0.29531887, shape=(), dtype=float32)
loss: tf.Tensor(0.35846835, shape=(), dtype=float32)
loss: tf.Tensor(0.29041463, shape=(), dtype=float32)
loss: tf.Tensor(0.5134238, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6891232, shape=(), dtype=float32)
F1 SCORE:
0.84036416
EPOCH  11 #################################
loss: tf.Tensor(0.3101948, shape=(), dtype=float32)
loss: tf.Tensor(0.21866436, shape=(), dtype=float32)
loss: tf.Tensor(0.35681018, shape=(), dtype=float32)
loss: tf.Tensor(0.23432471, shape=(), dtype=float32)
loss: tf.Tensor(0.17737402, shape=(), dtype=float32)
loss: tf.Tensor(0.24179657, shape=(), dtype=float32)
loss: tf.Tensor(0.20885672, shape=(), dtype=float32)
loss: tf.Tensor(0.32754487, shape=(), dtype=float32)
loss: tf.Tensor(0.30576023, shape=(), dtype=float32)
loss: tf.Tensor(0.33583856, shape=(), dtype=float32)
loss: tf.Tensor(0.306389, shape=(), dtype=float32)
loss: tf.Tensor(0.21148175, shape=(), dtype=float32)
loss: tf.Tensor(0.32989952, shape=(), dtype=float32)
loss: tf.Tensor(0.18425362, shape=(), dtype=float32)
loss: tf.Tensor(0.24367571, shape=(), dtype=float32)
loss: tf.Tensor(0.2615467, shape=(), dtype=float32)
loss: tf.Tensor(0.315156, shape=(), dtype=float32)
loss: tf.Tensor(0.27051294, shape=(), dtype=float32)
loss: tf.Tensor(0.20820034, shape=(), dtype=float32)
loss: tf.Tensor(0.3330581, shape=(), dtype=float32)
loss: tf.Tensor(0.2835714, shape=(), dtype=float32)
loss: tf.Tensor(0.25543725, shape=(), dtype=float32)
loss: tf.Tensor(0.23421839, shape=(), dtype=float32)
loss: tf.Tensor(0.40339404, shape=(), dtype=float32)
loss: tf.Tensor(0.2551499, shape=(), dtype=float32)
loss: tf.Tensor(0.3458673, shape=(), dtype=float32)
loss: tf.Tensor(0.24591815, shape=(), dtype=float32)
loss: tf.Tensor(0.2913983, shape=(), dtype=float32)
loss: tf.Tensor(0.3260713, shape=(), dtype=float32)
loss: tf.Tensor(0.2631979, shape=(), dtype=float32)
loss: tf.Tensor(0.25996235, shape=(), dtype=float32)
loss: tf.Tensor(0.29270223, shape=(), dtype=float32)
loss: tf.Tensor(0.14172177, shape=(), dtype=float32)
loss: tf.Tensor(0.31531385, shape=(), dtype=float32)
loss: tf.Tensor(0.35984603, shape=(), dtype=float32)
loss: tf.Tensor(0.22572128, shape=(), dtype=float32)
loss: tf.Tensor(0.29004136, shape=(), dtype=float32)
loss: tf.Tensor(0.16249362, shape=(), dtype=float32)
loss: tf.Tensor(0.24145208, shape=(), dtype=float32)
loss: tf.Tensor(0.25524136, shape=(), dtype=float32)
loss: tf.Tensor(0.21303314, shape=(), dtype=float32)
loss: tf.Tensor(0.13801788, shape=(), dtype=float32)
loss: tf.Tensor(0.2090972, shape=(), dtype=float32)
loss: tf.Tensor(0.13705947, shape=(), dtype=float32)
loss: tf.Tensor(0.26537755, shape=(), dtype=float32)
loss: tf.Tensor(0.19949014, shape=(), dtype=float32)
loss: tf.Tensor(0.2978892, shape=(), dtype=float32)
loss: tf.Tensor(0.22175571, shape=(), dtype=float32)
loss: tf.Tensor(0.27588177, shape=(), dtype=float32)
loss: tf.Tensor(0.19032133, shape=(), dtype=float32)
loss: tf.Tensor(0.36214742, shape=(), dtype=float32)
loss: tf.Tensor(0.42338875, shape=(), dtype=float32)
loss: tf.Tensor(0.2712656, shape=(), dtype=float32)
loss: tf.Tensor(0.28815025, shape=(), dtype=float32)
loss: tf.Tensor(0.25190848, shape=(), dtype=float32)
loss: tf.Tensor(0.2861327, shape=(), dtype=float32)
loss: tf.Tensor(0.36016017, shape=(), dtype=float32)
loss: tf.Tensor(0.31724596, shape=(), dtype=float32)
loss: tf.Tensor(0.16822477, shape=(), dtype=float32)
loss: tf.Tensor(0.27854353, shape=(), dtype=float32)
loss: tf.Tensor(0.37514526, shape=(), dtype=float32)
loss: tf.Tensor(0.22775117, shape=(), dtype=float32)
loss: tf.Tensor(0.32443088, shape=(), dtype=float32)
loss: tf.Tensor(0.182246, shape=(), dtype=float32)
loss: tf.Tensor(0.3354164, shape=(), dtype=float32)
loss: tf.Tensor(0.23254362, shape=(), dtype=float32)
loss: tf.Tensor(0.23790446, shape=(), dtype=float32)
loss: tf.Tensor(0.270283, shape=(), dtype=float32)
loss: tf.Tensor(0.32266518, shape=(), dtype=float32)
loss: tf.Tensor(0.21308811, shape=(), dtype=float32)
loss: tf.Tensor(0.2639908, shape=(), dtype=float32)
loss: tf.Tensor(0.2941694, shape=(), dtype=float32)
loss: tf.Tensor(0.15788327, shape=(), dtype=float32)
loss: tf.Tensor(0.9607923, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6975787, shape=(), dtype=float32)
F1 SCORE:
0.84018517
EPOCH  12 #################################
loss: tf.Tensor(0.15622288, shape=(), dtype=float32)
loss: tf.Tensor(0.33516443, shape=(), dtype=float32)
loss: tf.Tensor(0.21605548, shape=(), dtype=float32)
loss: tf.Tensor(0.52605677, shape=(), dtype=float32)
loss: tf.Tensor(0.40083835, shape=(), dtype=float32)
loss: tf.Tensor(0.34106687, shape=(), dtype=float32)
loss: tf.Tensor(0.5081894, shape=(), dtype=float32)
loss: tf.Tensor(0.37244144, shape=(), dtype=float32)
loss: tf.Tensor(0.43566415, shape=(), dtype=float32)
loss: tf.Tensor(0.53847826, shape=(), dtype=float32)
loss: tf.Tensor(0.27572653, shape=(), dtype=float32)
loss: tf.Tensor(0.377499, shape=(), dtype=float32)
loss: tf.Tensor(0.4711804, shape=(), dtype=float32)
loss: tf.Tensor(0.29084593, shape=(), dtype=float32)
loss: tf.Tensor(0.27144974, shape=(), dtype=float32)
loss: tf.Tensor(0.24578038, shape=(), dtype=float32)
loss: tf.Tensor(0.1812935, shape=(), dtype=float32)
loss: tf.Tensor(0.4029156, shape=(), dtype=float32)
loss: tf.Tensor(0.26301897, shape=(), dtype=float32)
loss: tf.Tensor(0.3382788, shape=(), dtype=float32)
loss: tf.Tensor(0.4323778, shape=(), dtype=float32)
loss: tf.Tensor(0.2436971, shape=(), dtype=float32)
loss: tf.Tensor(0.30739555, shape=(), dtype=float32)
loss: tf.Tensor(0.41962606, shape=(), dtype=float32)
loss: tf.Tensor(0.144612, shape=(), dtype=float32)
loss: tf.Tensor(0.30447555, shape=(), dtype=float32)
loss: tf.Tensor(0.2695554, shape=(), dtype=float32)
loss: tf.Tensor(0.274753, shape=(), dtype=float32)
loss: tf.Tensor(0.2711161, shape=(), dtype=float32)
loss: tf.Tensor(0.30621737, shape=(), dtype=float32)
loss: tf.Tensor(0.2813613, shape=(), dtype=float32)
loss: tf.Tensor(0.28224283, shape=(), dtype=float32)
loss: tf.Tensor(0.22719708, shape=(), dtype=float32)
loss: tf.Tensor(0.24027911, shape=(), dtype=float32)
loss: tf.Tensor(0.3401361, shape=(), dtype=float32)
loss: tf.Tensor(0.32063895, shape=(), dtype=float32)
loss: tf.Tensor(0.31805173, shape=(), dtype=float32)
loss: tf.Tensor(0.25303155, shape=(), dtype=float32)
loss: tf.Tensor(0.2345665, shape=(), dtype=float32)
loss: tf.Tensor(0.2797413, shape=(), dtype=float32)
loss: tf.Tensor(0.3049772, shape=(), dtype=float32)
loss: tf.Tensor(0.3344534, shape=(), dtype=float32)
loss: tf.Tensor(0.33221734, shape=(), dtype=float32)
loss: tf.Tensor(0.29174706, shape=(), dtype=float32)
loss: tf.Tensor(0.32906657, shape=(), dtype=float32)
loss: tf.Tensor(0.19701508, shape=(), dtype=float32)
loss: tf.Tensor(0.26115072, shape=(), dtype=float32)
loss: tf.Tensor(0.15887837, shape=(), dtype=float32)
loss: tf.Tensor(0.27134973, shape=(), dtype=float32)
loss: tf.Tensor(0.33523795, shape=(), dtype=float32)
loss: tf.Tensor(0.25091732, shape=(), dtype=float32)
loss: tf.Tensor(0.20357352, shape=(), dtype=float32)
loss: tf.Tensor(0.29674467, shape=(), dtype=float32)
loss: tf.Tensor(0.2426245, shape=(), dtype=float32)
loss: tf.Tensor(0.22655816, shape=(), dtype=float32)
loss: tf.Tensor(0.5669913, shape=(), dtype=float32)
loss: tf.Tensor(0.36776027, shape=(), dtype=float32)
loss: tf.Tensor(0.2652763, shape=(), dtype=float32)
loss: tf.Tensor(0.2464736, shape=(), dtype=float32)
loss: tf.Tensor(0.19702828, shape=(), dtype=float32)
loss: tf.Tensor(0.2804195, shape=(), dtype=float32)
loss: tf.Tensor(0.22960739, shape=(), dtype=float32)
loss: tf.Tensor(0.29473782, shape=(), dtype=float32)
loss: tf.Tensor(0.25304845, shape=(), dtype=float32)
loss: tf.Tensor(0.36173496, shape=(), dtype=float32)
loss: tf.Tensor(0.23819384, shape=(), dtype=float32)
loss: tf.Tensor(0.22076881, shape=(), dtype=float32)
loss: tf.Tensor(0.12579776, shape=(), dtype=float32)
loss: tf.Tensor(0.22301011, shape=(), dtype=float32)
loss: tf.Tensor(0.20772739, shape=(), dtype=float32)
loss: tf.Tensor(0.2248242, shape=(), dtype=float32)
loss: tf.Tensor(0.29681394, shape=(), dtype=float32)
loss: tf.Tensor(0.248111, shape=(), dtype=float32)
loss: tf.Tensor(0.0038288157, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7006986, shape=(), dtype=float32)
F1 SCORE:
0.84000474
EPOCH  13 #################################
loss: tf.Tensor(0.24845387, shape=(), dtype=float32)
loss: tf.Tensor(0.1757858, shape=(), dtype=float32)
loss: tf.Tensor(0.24632435, shape=(), dtype=float32)
loss: tf.Tensor(0.17215239, shape=(), dtype=float32)
loss: tf.Tensor(0.33043152, shape=(), dtype=float32)
loss: tf.Tensor(0.17355263, shape=(), dtype=float32)
loss: tf.Tensor(0.32449168, shape=(), dtype=float32)
loss: tf.Tensor(0.26053667, shape=(), dtype=float32)
loss: tf.Tensor(0.2388999, shape=(), dtype=float32)
loss: tf.Tensor(0.27042887, shape=(), dtype=float32)
loss: tf.Tensor(0.22164364, shape=(), dtype=float32)
loss: tf.Tensor(0.1431517, shape=(), dtype=float32)
loss: tf.Tensor(0.22689582, shape=(), dtype=float32)
loss: tf.Tensor(0.1830558, shape=(), dtype=float32)
loss: tf.Tensor(0.2101587, shape=(), dtype=float32)
loss: tf.Tensor(0.28408128, shape=(), dtype=float32)
loss: tf.Tensor(0.32826465, shape=(), dtype=float32)
loss: tf.Tensor(0.14241213, shape=(), dtype=float32)
loss: tf.Tensor(0.21362714, shape=(), dtype=float32)
loss: tf.Tensor(0.16099428, shape=(), dtype=float32)
loss: tf.Tensor(0.2820939, shape=(), dtype=float32)
loss: tf.Tensor(0.19358104, shape=(), dtype=float32)
loss: tf.Tensor(0.2014573, shape=(), dtype=float32)
loss: tf.Tensor(0.27455902, shape=(), dtype=float32)
loss: tf.Tensor(0.30612907, shape=(), dtype=float32)
loss: tf.Tensor(0.15480837, shape=(), dtype=float32)
loss: tf.Tensor(0.3188122, shape=(), dtype=float32)
loss: tf.Tensor(0.22644576, shape=(), dtype=float32)
loss: tf.Tensor(0.1610674, shape=(), dtype=float32)
loss: tf.Tensor(0.22009161, shape=(), dtype=float32)
loss: tf.Tensor(0.17989379, shape=(), dtype=float32)
loss: tf.Tensor(0.25316393, shape=(), dtype=float32)
loss: tf.Tensor(0.14221752, shape=(), dtype=float32)
loss: tf.Tensor(0.20089933, shape=(), dtype=float32)
loss: tf.Tensor(0.23359899, shape=(), dtype=float32)
loss: tf.Tensor(0.16978204, shape=(), dtype=float32)
loss: tf.Tensor(0.19876045, shape=(), dtype=float32)
loss: tf.Tensor(0.25467205, shape=(), dtype=float32)
loss: tf.Tensor(0.22034831, shape=(), dtype=float32)
loss: tf.Tensor(0.29665792, shape=(), dtype=float32)
loss: tf.Tensor(0.2722305, shape=(), dtype=float32)
loss: tf.Tensor(0.11563336, shape=(), dtype=float32)
loss: tf.Tensor(0.26589832, shape=(), dtype=float32)
loss: tf.Tensor(0.17740664, shape=(), dtype=float32)
loss: tf.Tensor(0.22608908, shape=(), dtype=float32)
loss: tf.Tensor(0.33049244, shape=(), dtype=float32)
loss: tf.Tensor(0.1824349, shape=(), dtype=float32)
loss: tf.Tensor(0.2251595, shape=(), dtype=float32)
loss: tf.Tensor(0.24149151, shape=(), dtype=float32)
loss: tf.Tensor(0.2823131, shape=(), dtype=float32)
loss: tf.Tensor(0.17032227, shape=(), dtype=float32)
loss: tf.Tensor(0.33757058, shape=(), dtype=float32)
loss: tf.Tensor(0.2974927, shape=(), dtype=float32)
loss: tf.Tensor(0.2199792, shape=(), dtype=float32)
loss: tf.Tensor(0.22910222, shape=(), dtype=float32)
loss: tf.Tensor(0.23561412, shape=(), dtype=float32)
loss: tf.Tensor(0.17888235, shape=(), dtype=float32)
loss: tf.Tensor(0.32092622, shape=(), dtype=float32)
loss: tf.Tensor(0.15086848, shape=(), dtype=float32)
loss: tf.Tensor(0.20701171, shape=(), dtype=float32)
loss: tf.Tensor(0.27958602, shape=(), dtype=float32)
loss: tf.Tensor(0.26128393, shape=(), dtype=float32)
loss: tf.Tensor(0.28059804, shape=(), dtype=float32)
loss: tf.Tensor(0.24066095, shape=(), dtype=float32)
loss: tf.Tensor(0.2474906, shape=(), dtype=float32)
loss: tf.Tensor(0.20130217, shape=(), dtype=float32)
loss: tf.Tensor(0.19391412, shape=(), dtype=float32)
loss: tf.Tensor(0.24528728, shape=(), dtype=float32)
loss: tf.Tensor(0.29360676, shape=(), dtype=float32)
loss: tf.Tensor(0.13956746, shape=(), dtype=float32)
loss: tf.Tensor(0.24003033, shape=(), dtype=float32)
loss: tf.Tensor(0.1669268, shape=(), dtype=float32)
loss: tf.Tensor(0.26252845, shape=(), dtype=float32)
loss: tf.Tensor(0.00010775939, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7021799, shape=(), dtype=float32)
F1 SCORE:
0.84009486
EPOCH  14 #################################
loss: tf.Tensor(0.12564798, shape=(), dtype=float32)
loss: tf.Tensor(0.14945413, shape=(), dtype=float32)
loss: tf.Tensor(0.18309107, shape=(), dtype=float32)
loss: tf.Tensor(0.14246383, shape=(), dtype=float32)
loss: tf.Tensor(0.15460624, shape=(), dtype=float32)
loss: tf.Tensor(0.18796922, shape=(), dtype=float32)
loss: tf.Tensor(0.18795152, shape=(), dtype=float32)
loss: tf.Tensor(0.19337481, shape=(), dtype=float32)
loss: tf.Tensor(0.06567535, shape=(), dtype=float32)
loss: tf.Tensor(0.27974555, shape=(), dtype=float32)
loss: tf.Tensor(0.14245354, shape=(), dtype=float32)
loss: tf.Tensor(0.22802675, shape=(), dtype=float32)
loss: tf.Tensor(0.19700949, shape=(), dtype=float32)
loss: tf.Tensor(0.30307508, shape=(), dtype=float32)
loss: tf.Tensor(0.11887098, shape=(), dtype=float32)
loss: tf.Tensor(0.2389295, shape=(), dtype=float32)
loss: tf.Tensor(0.24513137, shape=(), dtype=float32)
loss: tf.Tensor(0.23600157, shape=(), dtype=float32)
loss: tf.Tensor(0.18387023, shape=(), dtype=float32)
loss: tf.Tensor(0.1606913, shape=(), dtype=float32)
loss: tf.Tensor(0.17152847, shape=(), dtype=float32)
loss: tf.Tensor(0.078555554, shape=(), dtype=float32)
loss: tf.Tensor(0.22905324, shape=(), dtype=float32)
loss: tf.Tensor(0.20231357, shape=(), dtype=float32)
loss: tf.Tensor(0.25147802, shape=(), dtype=float32)
loss: tf.Tensor(0.24392495, shape=(), dtype=float32)
loss: tf.Tensor(0.20641468, shape=(), dtype=float32)
loss: tf.Tensor(0.22130749, shape=(), dtype=float32)
loss: tf.Tensor(0.29677612, shape=(), dtype=float32)
loss: tf.Tensor(0.1763254, shape=(), dtype=float32)
loss: tf.Tensor(0.15499063, shape=(), dtype=float32)
loss: tf.Tensor(0.33377153, shape=(), dtype=float32)
loss: tf.Tensor(0.25133938, shape=(), dtype=float32)
loss: tf.Tensor(0.30008882, shape=(), dtype=float32)
loss: tf.Tensor(0.12881638, shape=(), dtype=float32)
loss: tf.Tensor(0.28656146, shape=(), dtype=float32)
loss: tf.Tensor(0.24320059, shape=(), dtype=float32)
loss: tf.Tensor(0.20513843, shape=(), dtype=float32)
loss: tf.Tensor(0.24879664, shape=(), dtype=float32)
loss: tf.Tensor(0.23432161, shape=(), dtype=float32)
loss: tf.Tensor(0.16778582, shape=(), dtype=float32)
loss: tf.Tensor(0.22020082, shape=(), dtype=float32)
loss: tf.Tensor(0.25473148, shape=(), dtype=float32)
loss: tf.Tensor(0.25276902, shape=(), dtype=float32)
loss: tf.Tensor(0.11963667, shape=(), dtype=float32)
loss: tf.Tensor(0.27211022, shape=(), dtype=float32)
loss: tf.Tensor(0.21183649, shape=(), dtype=float32)
loss: tf.Tensor(0.24134661, shape=(), dtype=float32)
loss: tf.Tensor(0.10209059, shape=(), dtype=float32)
loss: tf.Tensor(0.13822939, shape=(), dtype=float32)
loss: tf.Tensor(0.25970143, shape=(), dtype=float32)
loss: tf.Tensor(0.21792924, shape=(), dtype=float32)
loss: tf.Tensor(0.25449514, shape=(), dtype=float32)
loss: tf.Tensor(0.28679484, shape=(), dtype=float32)
loss: tf.Tensor(0.14342529, shape=(), dtype=float32)
loss: tf.Tensor(0.18142101, shape=(), dtype=float32)
loss: tf.Tensor(0.15404098, shape=(), dtype=float32)
loss: tf.Tensor(0.21992177, shape=(), dtype=float32)
loss: tf.Tensor(0.15658222, shape=(), dtype=float32)
loss: tf.Tensor(0.15046687, shape=(), dtype=float32)
loss: tf.Tensor(0.18624422, shape=(), dtype=float32)
loss: tf.Tensor(0.3175299, shape=(), dtype=float32)
loss: tf.Tensor(0.27596393, shape=(), dtype=float32)
loss: tf.Tensor(0.15271446, shape=(), dtype=float32)
loss: tf.Tensor(0.19313364, shape=(), dtype=float32)
loss: tf.Tensor(0.18123448, shape=(), dtype=float32)
loss: tf.Tensor(0.28910998, shape=(), dtype=float32)
loss: tf.Tensor(0.2028782, shape=(), dtype=float32)
loss: tf.Tensor(0.19069979, shape=(), dtype=float32)
loss: tf.Tensor(0.2211172, shape=(), dtype=float32)
loss: tf.Tensor(0.17070282, shape=(), dtype=float32)
loss: tf.Tensor(0.27935344, shape=(), dtype=float32)
loss: tf.Tensor(0.14717941, shape=(), dtype=float32)
loss: tf.Tensor(0.011915107, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6950031, shape=(), dtype=float32)
F1 SCORE:
0.8398866
EPOCH  15 #################################
loss: tf.Tensor(0.3533042, shape=(), dtype=float32)
loss: tf.Tensor(0.18910523, shape=(), dtype=float32)
loss: tf.Tensor(0.19799878, shape=(), dtype=float32)
loss: tf.Tensor(0.1856304, shape=(), dtype=float32)
loss: tf.Tensor(0.24104834, shape=(), dtype=float32)
loss: tf.Tensor(0.3874361, shape=(), dtype=float32)
loss: tf.Tensor(0.14188217, shape=(), dtype=float32)
loss: tf.Tensor(0.1654016, shape=(), dtype=float32)
loss: tf.Tensor(0.24918503, shape=(), dtype=float32)
loss: tf.Tensor(0.14035365, shape=(), dtype=float32)
loss: tf.Tensor(0.11652264, shape=(), dtype=float32)
loss: tf.Tensor(0.19029154, shape=(), dtype=float32)
loss: tf.Tensor(0.21456991, shape=(), dtype=float32)
loss: tf.Tensor(0.10757226, shape=(), dtype=float32)
loss: tf.Tensor(0.21007733, shape=(), dtype=float32)
loss: tf.Tensor(0.1531635, shape=(), dtype=float32)
loss: tf.Tensor(0.1327287, shape=(), dtype=float32)
loss: tf.Tensor(0.17621824, shape=(), dtype=float32)
loss: tf.Tensor(0.19799511, shape=(), dtype=float32)
loss: tf.Tensor(0.28945616, shape=(), dtype=float32)
loss: tf.Tensor(0.16959059, shape=(), dtype=float32)
loss: tf.Tensor(0.18061107, shape=(), dtype=float32)
loss: tf.Tensor(0.11018549, shape=(), dtype=float32)
loss: tf.Tensor(0.23526014, shape=(), dtype=float32)
loss: tf.Tensor(0.15833986, shape=(), dtype=float32)
loss: tf.Tensor(0.25227952, shape=(), dtype=float32)
loss: tf.Tensor(0.1347649, shape=(), dtype=float32)
loss: tf.Tensor(0.14372788, shape=(), dtype=float32)
loss: tf.Tensor(0.18156871, shape=(), dtype=float32)
loss: tf.Tensor(0.17880854, shape=(), dtype=float32)
loss: tf.Tensor(0.20249471, shape=(), dtype=float32)
loss: tf.Tensor(0.30272093, shape=(), dtype=float32)
loss: tf.Tensor(0.17967856, shape=(), dtype=float32)
loss: tf.Tensor(0.20865297, shape=(), dtype=float32)
loss: tf.Tensor(0.27815711, shape=(), dtype=float32)
loss: tf.Tensor(0.15935156, shape=(), dtype=float32)
loss: tf.Tensor(0.28957972, shape=(), dtype=float32)
loss: tf.Tensor(0.22778824, shape=(), dtype=float32)
loss: tf.Tensor(0.14901026, shape=(), dtype=float32)
loss: tf.Tensor(0.12222126, shape=(), dtype=float32)
loss: tf.Tensor(0.18515144, shape=(), dtype=float32)
loss: tf.Tensor(0.15961784, shape=(), dtype=float32)
loss: tf.Tensor(0.2243871, shape=(), dtype=float32)
loss: tf.Tensor(0.15350115, shape=(), dtype=float32)
loss: tf.Tensor(0.1324188, shape=(), dtype=float32)
loss: tf.Tensor(0.14770891, shape=(), dtype=float32)
loss: tf.Tensor(0.17846876, shape=(), dtype=float32)
loss: tf.Tensor(0.22693329, shape=(), dtype=float32)
loss: tf.Tensor(0.18162607, shape=(), dtype=float32)
loss: tf.Tensor(0.2085106, shape=(), dtype=float32)
loss: tf.Tensor(0.10628171, shape=(), dtype=float32)
loss: tf.Tensor(0.08945005, shape=(), dtype=float32)
loss: tf.Tensor(0.12895167, shape=(), dtype=float32)
loss: tf.Tensor(0.17243186, shape=(), dtype=float32)
loss: tf.Tensor(0.1880977, shape=(), dtype=float32)
loss: tf.Tensor(0.13347661, shape=(), dtype=float32)
loss: tf.Tensor(0.25562492, shape=(), dtype=float32)
loss: tf.Tensor(0.14521302, shape=(), dtype=float32)
loss: tf.Tensor(0.17780243, shape=(), dtype=float32)
loss: tf.Tensor(0.14099535, shape=(), dtype=float32)
loss: tf.Tensor(0.123194106, shape=(), dtype=float32)
loss: tf.Tensor(0.20523757, shape=(), dtype=float32)
loss: tf.Tensor(0.20691274, shape=(), dtype=float32)
loss: tf.Tensor(0.20432398, shape=(), dtype=float32)
loss: tf.Tensor(0.07584262, shape=(), dtype=float32)
loss: tf.Tensor(0.113954544, shape=(), dtype=float32)
loss: tf.Tensor(0.21872331, shape=(), dtype=float32)
loss: tf.Tensor(0.15205617, shape=(), dtype=float32)
loss: tf.Tensor(0.21421328, shape=(), dtype=float32)
loss: tf.Tensor(0.19143443, shape=(), dtype=float32)
loss: tf.Tensor(0.15674858, shape=(), dtype=float32)
loss: tf.Tensor(0.08773215, shape=(), dtype=float32)
loss: tf.Tensor(0.16788886, shape=(), dtype=float32)
loss: tf.Tensor(0.0039147898, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6902685, shape=(), dtype=float32)
F1 SCORE:
0.84030366
EPOCH  16 #################################
loss: tf.Tensor(0.14601475, shape=(), dtype=float32)
loss: tf.Tensor(0.16687721, shape=(), dtype=float32)
loss: tf.Tensor(0.1260822, shape=(), dtype=float32)
loss: tf.Tensor(0.18093842, shape=(), dtype=float32)
loss: tf.Tensor(0.18698755, shape=(), dtype=float32)
loss: tf.Tensor(0.12460109, shape=(), dtype=float32)
loss: tf.Tensor(0.13196734, shape=(), dtype=float32)
loss: tf.Tensor(0.2887912, shape=(), dtype=float32)
loss: tf.Tensor(0.20381285, shape=(), dtype=float32)
loss: tf.Tensor(0.15432398, shape=(), dtype=float32)
loss: tf.Tensor(0.1464828, shape=(), dtype=float32)
loss: tf.Tensor(0.13002998, shape=(), dtype=float32)
loss: tf.Tensor(0.128778, shape=(), dtype=float32)
loss: tf.Tensor(0.09907781, shape=(), dtype=float32)
loss: tf.Tensor(0.12104321, shape=(), dtype=float32)
loss: tf.Tensor(0.15458788, shape=(), dtype=float32)
loss: tf.Tensor(0.17506762, shape=(), dtype=float32)
loss: tf.Tensor(0.11323383, shape=(), dtype=float32)
loss: tf.Tensor(0.13455614, shape=(), dtype=float32)
loss: tf.Tensor(0.21166432, shape=(), dtype=float32)
loss: tf.Tensor(0.19341959, shape=(), dtype=float32)
loss: tf.Tensor(0.10724869, shape=(), dtype=float32)
loss: tf.Tensor(0.1488099, shape=(), dtype=float32)
loss: tf.Tensor(0.23400682, shape=(), dtype=float32)
loss: tf.Tensor(0.11493268, shape=(), dtype=float32)
loss: tf.Tensor(0.11970724, shape=(), dtype=float32)
loss: tf.Tensor(0.14741042, shape=(), dtype=float32)
loss: tf.Tensor(0.08243674, shape=(), dtype=float32)
loss: tf.Tensor(0.1855284, shape=(), dtype=float32)
loss: tf.Tensor(0.16185126, shape=(), dtype=float32)
loss: tf.Tensor(0.05818268, shape=(), dtype=float32)
loss: tf.Tensor(0.20708098, shape=(), dtype=float32)
loss: tf.Tensor(0.23587078, shape=(), dtype=float32)
loss: tf.Tensor(0.19528466, shape=(), dtype=float32)
loss: tf.Tensor(0.18206765, shape=(), dtype=float32)
loss: tf.Tensor(0.2178641, shape=(), dtype=float32)
loss: tf.Tensor(0.1502272, shape=(), dtype=float32)
loss: tf.Tensor(0.15024313, shape=(), dtype=float32)
loss: tf.Tensor(0.18532135, shape=(), dtype=float32)
loss: tf.Tensor(0.18884897, shape=(), dtype=float32)
loss: tf.Tensor(0.25670588, shape=(), dtype=float32)
loss: tf.Tensor(0.21272509, shape=(), dtype=float32)
loss: tf.Tensor(0.15789214, shape=(), dtype=float32)
loss: tf.Tensor(0.26143983, shape=(), dtype=float32)
loss: tf.Tensor(0.15443951, shape=(), dtype=float32)
loss: tf.Tensor(0.17041545, shape=(), dtype=float32)
loss: tf.Tensor(0.18618888, shape=(), dtype=float32)
loss: tf.Tensor(0.11179032, shape=(), dtype=float32)
loss: tf.Tensor(0.16934519, shape=(), dtype=float32)
loss: tf.Tensor(0.15273307, shape=(), dtype=float32)
loss: tf.Tensor(0.09167671, shape=(), dtype=float32)
loss: tf.Tensor(0.21174785, shape=(), dtype=float32)
loss: tf.Tensor(0.15257165, shape=(), dtype=float32)
loss: tf.Tensor(0.12998085, shape=(), dtype=float32)
loss: tf.Tensor(0.15664555, shape=(), dtype=float32)
loss: tf.Tensor(0.18385813, shape=(), dtype=float32)
loss: tf.Tensor(0.23007487, shape=(), dtype=float32)
loss: tf.Tensor(0.17075361, shape=(), dtype=float32)
loss: tf.Tensor(0.10111754, shape=(), dtype=float32)
loss: tf.Tensor(0.13373803, shape=(), dtype=float32)
loss: tf.Tensor(0.12063258, shape=(), dtype=float32)
loss: tf.Tensor(0.18677522, shape=(), dtype=float32)
loss: tf.Tensor(0.10216012, shape=(), dtype=float32)
loss: tf.Tensor(0.18795116, shape=(), dtype=float32)
loss: tf.Tensor(0.1956144, shape=(), dtype=float32)
loss: tf.Tensor(0.09062145, shape=(), dtype=float32)
loss: tf.Tensor(0.1640345, shape=(), dtype=float32)
loss: tf.Tensor(0.114072464, shape=(), dtype=float32)
loss: tf.Tensor(0.19299728, shape=(), dtype=float32)
loss: tf.Tensor(0.14773919, shape=(), dtype=float32)
loss: tf.Tensor(0.17182648, shape=(), dtype=float32)
loss: tf.Tensor(0.19415306, shape=(), dtype=float32)
loss: tf.Tensor(0.2482396, shape=(), dtype=float32)
loss: tf.Tensor(0.015784321, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6945425, shape=(), dtype=float32)
F1 SCORE:
0.8406236
EPOCH  17 #################################
loss: tf.Tensor(0.1529795, shape=(), dtype=float32)
loss: tf.Tensor(0.066834114, shape=(), dtype=float32)
loss: tf.Tensor(0.09356914, shape=(), dtype=float32)
loss: tf.Tensor(0.17784262, shape=(), dtype=float32)
loss: tf.Tensor(0.09764001, shape=(), dtype=float32)
loss: tf.Tensor(0.08795565, shape=(), dtype=float32)
loss: tf.Tensor(0.24900095, shape=(), dtype=float32)
loss: tf.Tensor(0.13488734, shape=(), dtype=float32)
loss: tf.Tensor(0.1375907, shape=(), dtype=float32)
loss: tf.Tensor(0.12512065, shape=(), dtype=float32)
loss: tf.Tensor(0.13110667, shape=(), dtype=float32)
loss: tf.Tensor(0.15484211, shape=(), dtype=float32)
loss: tf.Tensor(0.112172835, shape=(), dtype=float32)
loss: tf.Tensor(0.18133879, shape=(), dtype=float32)
loss: tf.Tensor(0.1599197, shape=(), dtype=float32)
loss: tf.Tensor(0.12785168, shape=(), dtype=float32)
loss: tf.Tensor(0.14513451, shape=(), dtype=float32)
loss: tf.Tensor(0.07919963, shape=(), dtype=float32)
loss: tf.Tensor(0.107198685, shape=(), dtype=float32)
loss: tf.Tensor(0.17874078, shape=(), dtype=float32)
loss: tf.Tensor(0.08661482, shape=(), dtype=float32)
loss: tf.Tensor(0.12980051, shape=(), dtype=float32)
loss: tf.Tensor(0.25131118, shape=(), dtype=float32)
loss: tf.Tensor(0.111818925, shape=(), dtype=float32)
loss: tf.Tensor(0.15999316, shape=(), dtype=float32)
loss: tf.Tensor(0.22099726, shape=(), dtype=float32)
loss: tf.Tensor(0.09690405, shape=(), dtype=float32)
loss: tf.Tensor(0.063233964, shape=(), dtype=float32)
loss: tf.Tensor(0.18448648, shape=(), dtype=float32)
loss: tf.Tensor(0.2181227, shape=(), dtype=float32)
loss: tf.Tensor(0.13776498, shape=(), dtype=float32)
loss: tf.Tensor(0.11664422, shape=(), dtype=float32)
loss: tf.Tensor(0.13405383, shape=(), dtype=float32)
loss: tf.Tensor(0.17479447, shape=(), dtype=float32)
loss: tf.Tensor(0.08776035, shape=(), dtype=float32)
loss: tf.Tensor(0.08742033, shape=(), dtype=float32)
loss: tf.Tensor(0.08561435, shape=(), dtype=float32)
loss: tf.Tensor(0.17909786, shape=(), dtype=float32)
loss: tf.Tensor(0.34309617, shape=(), dtype=float32)
loss: tf.Tensor(0.13573624, shape=(), dtype=float32)
loss: tf.Tensor(0.26683578, shape=(), dtype=float32)
loss: tf.Tensor(0.101147994, shape=(), dtype=float32)
loss: tf.Tensor(0.15474512, shape=(), dtype=float32)
loss: tf.Tensor(0.19418707, shape=(), dtype=float32)
loss: tf.Tensor(0.09058139, shape=(), dtype=float32)
loss: tf.Tensor(0.18727094, shape=(), dtype=float32)
loss: tf.Tensor(0.19885486, shape=(), dtype=float32)
loss: tf.Tensor(0.19745518, shape=(), dtype=float32)
loss: tf.Tensor(0.12819289, shape=(), dtype=float32)
loss: tf.Tensor(0.18901233, shape=(), dtype=float32)
loss: tf.Tensor(0.061511617, shape=(), dtype=float32)
loss: tf.Tensor(0.15615116, shape=(), dtype=float32)
loss: tf.Tensor(0.13287906, shape=(), dtype=float32)
loss: tf.Tensor(0.15513314, shape=(), dtype=float32)
loss: tf.Tensor(0.13624202, shape=(), dtype=float32)
loss: tf.Tensor(0.20204853, shape=(), dtype=float32)
loss: tf.Tensor(0.1615625, shape=(), dtype=float32)
loss: tf.Tensor(0.10906853, shape=(), dtype=float32)
loss: tf.Tensor(0.18217848, shape=(), dtype=float32)
loss: tf.Tensor(0.12074579, shape=(), dtype=float32)
loss: tf.Tensor(0.16872807, shape=(), dtype=float32)
loss: tf.Tensor(0.13801108, shape=(), dtype=float32)
loss: tf.Tensor(0.12868941, shape=(), dtype=float32)
loss: tf.Tensor(0.15322754, shape=(), dtype=float32)
loss: tf.Tensor(0.2294168, shape=(), dtype=float32)
loss: tf.Tensor(0.11867735, shape=(), dtype=float32)
loss: tf.Tensor(0.23931253, shape=(), dtype=float32)
loss: tf.Tensor(0.27356115, shape=(), dtype=float32)
loss: tf.Tensor(0.08494921, shape=(), dtype=float32)
loss: tf.Tensor(0.17119685, shape=(), dtype=float32)
loss: tf.Tensor(0.21254787, shape=(), dtype=float32)
loss: tf.Tensor(0.0697128, shape=(), dtype=float32)
loss: tf.Tensor(0.13330819, shape=(), dtype=float32)
loss: tf.Tensor(0.001656947, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7029546, shape=(), dtype=float32)
F1 SCORE:
0.83976173
EPOCH  18 #################################
loss: tf.Tensor(0.08788123, shape=(), dtype=float32)
loss: tf.Tensor(0.15035488, shape=(), dtype=float32)
loss: tf.Tensor(0.1218654, shape=(), dtype=float32)
loss: tf.Tensor(0.13912323, shape=(), dtype=float32)
loss: tf.Tensor(0.115551874, shape=(), dtype=float32)
loss: tf.Tensor(0.13058443, shape=(), dtype=float32)
loss: tf.Tensor(0.09999429, shape=(), dtype=float32)
loss: tf.Tensor(0.08774438, shape=(), dtype=float32)
loss: tf.Tensor(0.096566394, shape=(), dtype=float32)
loss: tf.Tensor(0.094322816, shape=(), dtype=float32)
loss: tf.Tensor(0.13610275, shape=(), dtype=float32)
loss: tf.Tensor(0.07602621, shape=(), dtype=float32)
loss: tf.Tensor(0.11706646, shape=(), dtype=float32)
loss: tf.Tensor(0.2304156, shape=(), dtype=float32)
loss: tf.Tensor(0.14571774, shape=(), dtype=float32)
loss: tf.Tensor(0.13286033, shape=(), dtype=float32)
loss: tf.Tensor(0.22708693, shape=(), dtype=float32)
loss: tf.Tensor(0.120218016, shape=(), dtype=float32)
loss: tf.Tensor(0.11308895, shape=(), dtype=float32)
loss: tf.Tensor(0.08841798, shape=(), dtype=float32)
loss: tf.Tensor(0.1397683, shape=(), dtype=float32)
loss: tf.Tensor(0.084876254, shape=(), dtype=float32)
loss: tf.Tensor(0.05509911, shape=(), dtype=float32)
loss: tf.Tensor(0.14288905, shape=(), dtype=float32)
loss: tf.Tensor(0.19085069, shape=(), dtype=float32)
loss: tf.Tensor(0.122100964, shape=(), dtype=float32)
loss: tf.Tensor(0.08439412, shape=(), dtype=float32)
loss: tf.Tensor(0.11102856, shape=(), dtype=float32)
loss: tf.Tensor(0.13739496, shape=(), dtype=float32)
loss: tf.Tensor(0.18754971, shape=(), dtype=float32)
loss: tf.Tensor(0.11688659, shape=(), dtype=float32)
loss: tf.Tensor(0.14699386, shape=(), dtype=float32)
loss: tf.Tensor(0.22486757, shape=(), dtype=float32)
loss: tf.Tensor(0.19313505, shape=(), dtype=float32)
loss: tf.Tensor(0.13027968, shape=(), dtype=float32)
loss: tf.Tensor(0.17536874, shape=(), dtype=float32)
loss: tf.Tensor(0.19057228, shape=(), dtype=float32)
loss: tf.Tensor(0.21428648, shape=(), dtype=float32)
loss: tf.Tensor(0.10767269, shape=(), dtype=float32)
loss: tf.Tensor(0.16042872, shape=(), dtype=float32)
loss: tf.Tensor(0.15192856, shape=(), dtype=float32)
loss: tf.Tensor(0.19964585, shape=(), dtype=float32)
loss: tf.Tensor(0.19630902, shape=(), dtype=float32)
loss: tf.Tensor(0.124866724, shape=(), dtype=float32)
loss: tf.Tensor(0.19730611, shape=(), dtype=float32)
loss: tf.Tensor(0.17349976, shape=(), dtype=float32)
loss: tf.Tensor(0.16556555, shape=(), dtype=float32)
loss: tf.Tensor(0.10763173, shape=(), dtype=float32)
loss: tf.Tensor(0.16599108, shape=(), dtype=float32)
loss: tf.Tensor(0.10346384, shape=(), dtype=float32)
loss: tf.Tensor(0.21454002, shape=(), dtype=float32)
loss: tf.Tensor(0.30963042, shape=(), dtype=float32)
loss: tf.Tensor(0.15430135, shape=(), dtype=float32)
loss: tf.Tensor(0.09067132, shape=(), dtype=float32)
loss: tf.Tensor(0.10795683, shape=(), dtype=float32)
loss: tf.Tensor(0.11701652, shape=(), dtype=float32)
loss: tf.Tensor(0.1148389, shape=(), dtype=float32)
loss: tf.Tensor(0.14904621, shape=(), dtype=float32)
loss: tf.Tensor(0.19645819, shape=(), dtype=float32)
loss: tf.Tensor(0.20892723, shape=(), dtype=float32)
loss: tf.Tensor(0.16174814, shape=(), dtype=float32)
loss: tf.Tensor(0.16798657, shape=(), dtype=float32)
loss: tf.Tensor(0.112267494, shape=(), dtype=float32)
loss: tf.Tensor(0.34977663, shape=(), dtype=float32)
loss: tf.Tensor(0.13048978, shape=(), dtype=float32)
loss: tf.Tensor(0.15666823, shape=(), dtype=float32)
loss: tf.Tensor(0.1547313, shape=(), dtype=float32)
loss: tf.Tensor(0.24515587, shape=(), dtype=float32)
loss: tf.Tensor(0.17301214, shape=(), dtype=float32)
loss: tf.Tensor(0.22784486, shape=(), dtype=float32)
loss: tf.Tensor(0.23178504, shape=(), dtype=float32)
loss: tf.Tensor(0.15540145, shape=(), dtype=float32)
loss: tf.Tensor(0.31886572, shape=(), dtype=float32)
loss: tf.Tensor(0.0077244155, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.72610605, shape=(), dtype=float32)
F1 SCORE:
0.8381605
EPOCH  19 #################################
loss: tf.Tensor(0.18004335, shape=(), dtype=float32)
loss: tf.Tensor(0.2555982, shape=(), dtype=float32)
loss: tf.Tensor(0.17989023, shape=(), dtype=float32)
loss: tf.Tensor(0.2148515, shape=(), dtype=float32)
loss: tf.Tensor(0.10930964, shape=(), dtype=float32)
loss: tf.Tensor(0.1504882, shape=(), dtype=float32)
loss: tf.Tensor(0.07624999, shape=(), dtype=float32)
loss: tf.Tensor(0.18712066, shape=(), dtype=float32)
loss: tf.Tensor(0.17499562, shape=(), dtype=float32)
loss: tf.Tensor(0.110020116, shape=(), dtype=float32)
loss: tf.Tensor(0.22514378, shape=(), dtype=float32)
loss: tf.Tensor(0.13877212, shape=(), dtype=float32)
loss: tf.Tensor(0.16147538, shape=(), dtype=float32)
loss: tf.Tensor(0.16856319, shape=(), dtype=float32)
loss: tf.Tensor(0.14892992, shape=(), dtype=float32)
loss: tf.Tensor(0.08092476, shape=(), dtype=float32)
loss: tf.Tensor(0.11484126, shape=(), dtype=float32)
loss: tf.Tensor(0.19401006, shape=(), dtype=float32)
loss: tf.Tensor(0.13891685, shape=(), dtype=float32)
loss: tf.Tensor(0.14049803, shape=(), dtype=float32)
loss: tf.Tensor(0.120867126, shape=(), dtype=float32)
loss: tf.Tensor(0.08381214, shape=(), dtype=float32)
loss: tf.Tensor(0.101945184, shape=(), dtype=float32)
loss: tf.Tensor(0.1703579, shape=(), dtype=float32)
loss: tf.Tensor(0.14132035, shape=(), dtype=float32)
loss: tf.Tensor(0.09660751, shape=(), dtype=float32)
loss: tf.Tensor(0.16096844, shape=(), dtype=float32)
loss: tf.Tensor(0.11051045, shape=(), dtype=float32)
loss: tf.Tensor(0.12578507, shape=(), dtype=float32)
loss: tf.Tensor(0.20500885, shape=(), dtype=float32)
loss: tf.Tensor(0.12853965, shape=(), dtype=float32)
loss: tf.Tensor(0.13884172, shape=(), dtype=float32)
loss: tf.Tensor(0.1423653, shape=(), dtype=float32)
loss: tf.Tensor(0.113392115, shape=(), dtype=float32)
loss: tf.Tensor(0.15555036, shape=(), dtype=float32)
loss: tf.Tensor(0.07598045, shape=(), dtype=float32)
loss: tf.Tensor(0.12811325, shape=(), dtype=float32)
loss: tf.Tensor(0.14143175, shape=(), dtype=float32)
loss: tf.Tensor(0.20279558, shape=(), dtype=float32)
loss: tf.Tensor(0.16122213, shape=(), dtype=float32)
loss: tf.Tensor(0.10937054, shape=(), dtype=float32)
loss: tf.Tensor(0.19688417, shape=(), dtype=float32)
loss: tf.Tensor(0.08535716, shape=(), dtype=float32)
loss: tf.Tensor(0.110781915, shape=(), dtype=float32)
loss: tf.Tensor(0.070314765, shape=(), dtype=float32)
loss: tf.Tensor(0.11696891, shape=(), dtype=float32)
loss: tf.Tensor(0.1081102, shape=(), dtype=float32)
loss: tf.Tensor(0.1733228, shape=(), dtype=float32)
loss: tf.Tensor(0.13197982, shape=(), dtype=float32)
loss: tf.Tensor(0.07877339, shape=(), dtype=float32)
loss: tf.Tensor(0.103072494, shape=(), dtype=float32)
loss: tf.Tensor(0.12507705, shape=(), dtype=float32)
loss: tf.Tensor(0.27890685, shape=(), dtype=float32)
loss: tf.Tensor(0.093492925, shape=(), dtype=float32)
loss: tf.Tensor(0.13294263, shape=(), dtype=float32)
loss: tf.Tensor(0.106927596, shape=(), dtype=float32)
loss: tf.Tensor(0.2210902, shape=(), dtype=float32)
loss: tf.Tensor(0.19031955, shape=(), dtype=float32)
loss: tf.Tensor(0.13436766, shape=(), dtype=float32)
loss: tf.Tensor(0.13943368, shape=(), dtype=float32)
loss: tf.Tensor(0.054907627, shape=(), dtype=float32)
loss: tf.Tensor(0.15152334, shape=(), dtype=float32)
loss: tf.Tensor(0.07475798, shape=(), dtype=float32)
loss: tf.Tensor(0.05916221, shape=(), dtype=float32)
loss: tf.Tensor(0.12086588, shape=(), dtype=float32)
loss: tf.Tensor(0.1384293, shape=(), dtype=float32)
loss: tf.Tensor(0.11847138, shape=(), dtype=float32)
loss: tf.Tensor(0.12449975, shape=(), dtype=float32)
loss: tf.Tensor(0.15666987, shape=(), dtype=float32)
loss: tf.Tensor(0.17833492, shape=(), dtype=float32)
loss: tf.Tensor(0.1744617, shape=(), dtype=float32)
loss: tf.Tensor(0.17021804, shape=(), dtype=float32)
loss: tf.Tensor(0.19733366, shape=(), dtype=float32)
loss: tf.Tensor(5.817244e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.693162, shape=(), dtype=float32)
F1 SCORE:
0.8386391
EPOCH  20 #################################
loss: tf.Tensor(0.2359618, shape=(), dtype=float32)
loss: tf.Tensor(0.1338385, shape=(), dtype=float32)
loss: tf.Tensor(0.06404923, shape=(), dtype=float32)
loss: tf.Tensor(0.10961772, shape=(), dtype=float32)
loss: tf.Tensor(0.14702213, shape=(), dtype=float32)
loss: tf.Tensor(0.04921052, shape=(), dtype=float32)
loss: tf.Tensor(0.08879042, shape=(), dtype=float32)
loss: tf.Tensor(0.11733114, shape=(), dtype=float32)
loss: tf.Tensor(0.10366034, shape=(), dtype=float32)
loss: tf.Tensor(0.10843915, shape=(), dtype=float32)
loss: tf.Tensor(0.073900506, shape=(), dtype=float32)
loss: tf.Tensor(0.0997262, shape=(), dtype=float32)
loss: tf.Tensor(0.12548544, shape=(), dtype=float32)
loss: tf.Tensor(0.118995965, shape=(), dtype=float32)
loss: tf.Tensor(0.1717698, shape=(), dtype=float32)
loss: tf.Tensor(0.06497688, shape=(), dtype=float32)
loss: tf.Tensor(0.13816792, shape=(), dtype=float32)
loss: tf.Tensor(0.09560615, shape=(), dtype=float32)
loss: tf.Tensor(0.11555128, shape=(), dtype=float32)
loss: tf.Tensor(0.1517298, shape=(), dtype=float32)
loss: tf.Tensor(0.15010332, shape=(), dtype=float32)
loss: tf.Tensor(0.10859377, shape=(), dtype=float32)
loss: tf.Tensor(0.09855468, shape=(), dtype=float32)
loss: tf.Tensor(0.052854702, shape=(), dtype=float32)
loss: tf.Tensor(0.093671426, shape=(), dtype=float32)
loss: tf.Tensor(0.121117264, shape=(), dtype=float32)
loss: tf.Tensor(0.10467789, shape=(), dtype=float32)
loss: tf.Tensor(0.14556427, shape=(), dtype=float32)
loss: tf.Tensor(0.03738033, shape=(), dtype=float32)
loss: tf.Tensor(0.06574669, shape=(), dtype=float32)
loss: tf.Tensor(0.16846596, shape=(), dtype=float32)
loss: tf.Tensor(0.19398303, shape=(), dtype=float32)
loss: tf.Tensor(0.16772003, shape=(), dtype=float32)
loss: tf.Tensor(0.06358355, shape=(), dtype=float32)
loss: tf.Tensor(0.1074189, shape=(), dtype=float32)
loss: tf.Tensor(0.12962127, shape=(), dtype=float32)
loss: tf.Tensor(0.20070152, shape=(), dtype=float32)
loss: tf.Tensor(0.08883997, shape=(), dtype=float32)
loss: tf.Tensor(0.16277403, shape=(), dtype=float32)
loss: tf.Tensor(0.04704091, shape=(), dtype=float32)
loss: tf.Tensor(0.147081, shape=(), dtype=float32)
loss: tf.Tensor(0.23524633, shape=(), dtype=float32)
loss: tf.Tensor(0.11730628, shape=(), dtype=float32)
loss: tf.Tensor(0.13754982, shape=(), dtype=float32)
loss: tf.Tensor(0.10459021, shape=(), dtype=float32)
loss: tf.Tensor(0.17975755, shape=(), dtype=float32)
loss: tf.Tensor(0.107162274, shape=(), dtype=float32)
loss: tf.Tensor(0.12461853, shape=(), dtype=float32)
loss: tf.Tensor(0.14931048, shape=(), dtype=float32)
loss: tf.Tensor(0.09210222, shape=(), dtype=float32)
loss: tf.Tensor(0.10700359, shape=(), dtype=float32)
loss: tf.Tensor(0.09711934, shape=(), dtype=float32)
loss: tf.Tensor(0.120570384, shape=(), dtype=float32)
loss: tf.Tensor(0.06806814, shape=(), dtype=float32)
loss: tf.Tensor(0.10455469, shape=(), dtype=float32)
loss: tf.Tensor(0.120307066, shape=(), dtype=float32)
loss: tf.Tensor(0.116600275, shape=(), dtype=float32)
loss: tf.Tensor(0.10285698, shape=(), dtype=float32)
loss: tf.Tensor(0.12780035, shape=(), dtype=float32)
loss: tf.Tensor(0.23193058, shape=(), dtype=float32)
loss: tf.Tensor(0.07125138, shape=(), dtype=float32)
loss: tf.Tensor(0.08856266, shape=(), dtype=float32)
loss: tf.Tensor(0.11639413, shape=(), dtype=float32)
loss: tf.Tensor(0.22058794, shape=(), dtype=float32)
loss: tf.Tensor(0.13130759, shape=(), dtype=float32)
loss: tf.Tensor(0.08999773, shape=(), dtype=float32)
loss: tf.Tensor(0.16163044, shape=(), dtype=float32)
loss: tf.Tensor(0.08706216, shape=(), dtype=float32)
loss: tf.Tensor(0.11730193, shape=(), dtype=float32)
loss: tf.Tensor(0.0902027, shape=(), dtype=float32)
loss: tf.Tensor(0.17443232, shape=(), dtype=float32)
loss: tf.Tensor(0.091919824, shape=(), dtype=float32)
loss: tf.Tensor(0.055263713, shape=(), dtype=float32)
loss: tf.Tensor(0.0050187325, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69384456, shape=(), dtype=float32)
F1 SCORE:
0.8387092
EPOCH  21 #################################
loss: tf.Tensor(0.1110797, shape=(), dtype=float32)
loss: tf.Tensor(0.08400489, shape=(), dtype=float32)
loss: tf.Tensor(0.039397825, shape=(), dtype=float32)
loss: tf.Tensor(0.15071626, shape=(), dtype=float32)
loss: tf.Tensor(0.0861839, shape=(), dtype=float32)
loss: tf.Tensor(0.13389811, shape=(), dtype=float32)
loss: tf.Tensor(0.095302485, shape=(), dtype=float32)
loss: tf.Tensor(0.060090885, shape=(), dtype=float32)
loss: tf.Tensor(0.13228656, shape=(), dtype=float32)
loss: tf.Tensor(0.101022385, shape=(), dtype=float32)
loss: tf.Tensor(0.12284149, shape=(), dtype=float32)
loss: tf.Tensor(0.13908903, shape=(), dtype=float32)
loss: tf.Tensor(0.05320923, shape=(), dtype=float32)
loss: tf.Tensor(0.07739289, shape=(), dtype=float32)
loss: tf.Tensor(0.07811443, shape=(), dtype=float32)
loss: tf.Tensor(0.071653865, shape=(), dtype=float32)
loss: tf.Tensor(0.112816945, shape=(), dtype=float32)
loss: tf.Tensor(0.045510136, shape=(), dtype=float32)
loss: tf.Tensor(0.0980836, shape=(), dtype=float32)
loss: tf.Tensor(0.062225685, shape=(), dtype=float32)
loss: tf.Tensor(0.08857588, shape=(), dtype=float32)
loss: tf.Tensor(0.045448557, shape=(), dtype=float32)
loss: tf.Tensor(0.0815403, shape=(), dtype=float32)
loss: tf.Tensor(0.12097806, shape=(), dtype=float32)
loss: tf.Tensor(0.11352546, shape=(), dtype=float32)
loss: tf.Tensor(0.18872377, shape=(), dtype=float32)
loss: tf.Tensor(0.18295044, shape=(), dtype=float32)
loss: tf.Tensor(0.05901578, shape=(), dtype=float32)
loss: tf.Tensor(0.10280215, shape=(), dtype=float32)
loss: tf.Tensor(0.06092827, shape=(), dtype=float32)
loss: tf.Tensor(0.16983238, shape=(), dtype=float32)
loss: tf.Tensor(0.11379621, shape=(), dtype=float32)
loss: tf.Tensor(0.14769182, shape=(), dtype=float32)
loss: tf.Tensor(0.115235366, shape=(), dtype=float32)
loss: tf.Tensor(0.17989255, shape=(), dtype=float32)
loss: tf.Tensor(0.0778126, shape=(), dtype=float32)
loss: tf.Tensor(0.1256221, shape=(), dtype=float32)
loss: tf.Tensor(0.11849346, shape=(), dtype=float32)
loss: tf.Tensor(0.26928475, shape=(), dtype=float32)
loss: tf.Tensor(0.055792175, shape=(), dtype=float32)
loss: tf.Tensor(0.037472066, shape=(), dtype=float32)
loss: tf.Tensor(0.07262352, shape=(), dtype=float32)
loss: tf.Tensor(0.13172993, shape=(), dtype=float32)
loss: tf.Tensor(0.20667501, shape=(), dtype=float32)
loss: tf.Tensor(0.14359945, shape=(), dtype=float32)
loss: tf.Tensor(0.030562336, shape=(), dtype=float32)
loss: tf.Tensor(0.11594879, shape=(), dtype=float32)
loss: tf.Tensor(0.1671084, shape=(), dtype=float32)
loss: tf.Tensor(0.14435817, shape=(), dtype=float32)
loss: tf.Tensor(0.09599124, shape=(), dtype=float32)
loss: tf.Tensor(0.13579273, shape=(), dtype=float32)
loss: tf.Tensor(0.06939886, shape=(), dtype=float32)
loss: tf.Tensor(0.118678935, shape=(), dtype=float32)
loss: tf.Tensor(0.10727182, shape=(), dtype=float32)
loss: tf.Tensor(0.06577598, shape=(), dtype=float32)
loss: tf.Tensor(0.044380575, shape=(), dtype=float32)
loss: tf.Tensor(0.2091973, shape=(), dtype=float32)
loss: tf.Tensor(0.08264386, shape=(), dtype=float32)
loss: tf.Tensor(0.06430533, shape=(), dtype=float32)
loss: tf.Tensor(0.16981487, shape=(), dtype=float32)
loss: tf.Tensor(0.12513524, shape=(), dtype=float32)
loss: tf.Tensor(0.07419348, shape=(), dtype=float32)
loss: tf.Tensor(0.08894961, shape=(), dtype=float32)
loss: tf.Tensor(0.074699685, shape=(), dtype=float32)
loss: tf.Tensor(0.10023962, shape=(), dtype=float32)
loss: tf.Tensor(0.22290984, shape=(), dtype=float32)
loss: tf.Tensor(0.12785415, shape=(), dtype=float32)
loss: tf.Tensor(0.16605888, shape=(), dtype=float32)
loss: tf.Tensor(0.11184396, shape=(), dtype=float32)
loss: tf.Tensor(0.13677332, shape=(), dtype=float32)
loss: tf.Tensor(0.15706961, shape=(), dtype=float32)
loss: tf.Tensor(0.06783927, shape=(), dtype=float32)
loss: tf.Tensor(0.09710878, shape=(), dtype=float32)
loss: tf.Tensor(3.4570635e-06, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.736715, shape=(), dtype=float32)
F1 SCORE:
0.8358731
EPOCH  22 #################################
loss: tf.Tensor(0.12515362, shape=(), dtype=float32)
loss: tf.Tensor(0.099925905, shape=(), dtype=float32)
loss: tf.Tensor(0.034869924, shape=(), dtype=float32)
loss: tf.Tensor(0.08717337, shape=(), dtype=float32)
loss: tf.Tensor(0.10623784, shape=(), dtype=float32)
loss: tf.Tensor(0.09978287, shape=(), dtype=float32)
loss: tf.Tensor(0.053892802, shape=(), dtype=float32)
loss: tf.Tensor(0.10872497, shape=(), dtype=float32)
loss: tf.Tensor(0.15573013, shape=(), dtype=float32)
loss: tf.Tensor(0.09905939, shape=(), dtype=float32)
loss: tf.Tensor(0.07143512, shape=(), dtype=float32)
loss: tf.Tensor(0.09071231, shape=(), dtype=float32)
loss: tf.Tensor(0.15469995, shape=(), dtype=float32)
loss: tf.Tensor(0.13744976, shape=(), dtype=float32)
loss: tf.Tensor(0.05367758, shape=(), dtype=float32)
loss: tf.Tensor(0.0752717, shape=(), dtype=float32)
loss: tf.Tensor(0.06908082, shape=(), dtype=float32)
loss: tf.Tensor(0.07797173, shape=(), dtype=float32)
loss: tf.Tensor(0.09747904, shape=(), dtype=float32)
loss: tf.Tensor(0.14441967, shape=(), dtype=float32)
loss: tf.Tensor(0.08649684, shape=(), dtype=float32)
loss: tf.Tensor(0.12092397, shape=(), dtype=float32)
loss: tf.Tensor(0.06213403, shape=(), dtype=float32)
loss: tf.Tensor(0.018288264, shape=(), dtype=float32)
loss: tf.Tensor(0.06781759, shape=(), dtype=float32)
loss: tf.Tensor(0.10230378, shape=(), dtype=float32)
loss: tf.Tensor(0.13761342, shape=(), dtype=float32)
loss: tf.Tensor(0.065468885, shape=(), dtype=float32)
loss: tf.Tensor(0.09126713, shape=(), dtype=float32)
loss: tf.Tensor(0.14799766, shape=(), dtype=float32)
loss: tf.Tensor(0.09387416, shape=(), dtype=float32)
loss: tf.Tensor(0.07134548, shape=(), dtype=float32)
loss: tf.Tensor(0.10567843, shape=(), dtype=float32)
loss: tf.Tensor(0.15116681, shape=(), dtype=float32)
loss: tf.Tensor(0.14834604, shape=(), dtype=float32)
loss: tf.Tensor(0.10204786, shape=(), dtype=float32)
loss: tf.Tensor(0.11837193, shape=(), dtype=float32)
loss: tf.Tensor(0.080189265, shape=(), dtype=float32)
loss: tf.Tensor(0.05787882, shape=(), dtype=float32)
loss: tf.Tensor(0.12484299, shape=(), dtype=float32)
loss: tf.Tensor(0.0979897, shape=(), dtype=float32)
loss: tf.Tensor(0.114496194, shape=(), dtype=float32)
loss: tf.Tensor(0.17805316, shape=(), dtype=float32)
loss: tf.Tensor(0.19609608, shape=(), dtype=float32)
loss: tf.Tensor(0.050792716, shape=(), dtype=float32)
loss: tf.Tensor(0.024897808, shape=(), dtype=float32)
loss: tf.Tensor(0.11827516, shape=(), dtype=float32)
loss: tf.Tensor(0.11510741, shape=(), dtype=float32)
loss: tf.Tensor(0.11593459, shape=(), dtype=float32)
loss: tf.Tensor(0.09589063, shape=(), dtype=float32)
loss: tf.Tensor(0.12557128, shape=(), dtype=float32)
loss: tf.Tensor(0.098743506, shape=(), dtype=float32)
loss: tf.Tensor(0.13087839, shape=(), dtype=float32)
loss: tf.Tensor(0.064742774, shape=(), dtype=float32)
loss: tf.Tensor(0.110421896, shape=(), dtype=float32)
loss: tf.Tensor(0.15384983, shape=(), dtype=float32)
loss: tf.Tensor(0.14436248, shape=(), dtype=float32)
loss: tf.Tensor(0.25138262, shape=(), dtype=float32)
loss: tf.Tensor(0.056477223, shape=(), dtype=float32)
loss: tf.Tensor(0.1635355, shape=(), dtype=float32)
loss: tf.Tensor(0.12557934, shape=(), dtype=float32)
loss: tf.Tensor(0.108558156, shape=(), dtype=float32)
loss: tf.Tensor(0.13849042, shape=(), dtype=float32)
loss: tf.Tensor(0.084547, shape=(), dtype=float32)
loss: tf.Tensor(0.17628375, shape=(), dtype=float32)
loss: tf.Tensor(0.21536765, shape=(), dtype=float32)
loss: tf.Tensor(0.092713155, shape=(), dtype=float32)
loss: tf.Tensor(0.11210336, shape=(), dtype=float32)
loss: tf.Tensor(0.099624336, shape=(), dtype=float32)
loss: tf.Tensor(0.15210833, shape=(), dtype=float32)
loss: tf.Tensor(0.14294633, shape=(), dtype=float32)
loss: tf.Tensor(0.0813052, shape=(), dtype=float32)
loss: tf.Tensor(0.07979025, shape=(), dtype=float32)
loss: tf.Tensor(0.00019095505, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7036257, shape=(), dtype=float32)
F1 SCORE:
0.8358168
EPOCH  23 #################################
loss: tf.Tensor(0.15380776, shape=(), dtype=float32)
loss: tf.Tensor(0.103279114, shape=(), dtype=float32)
loss: tf.Tensor(0.07899662, shape=(), dtype=float32)
loss: tf.Tensor(0.119138286, shape=(), dtype=float32)
loss: tf.Tensor(0.050970234, shape=(), dtype=float32)
loss: tf.Tensor(0.15940565, shape=(), dtype=float32)
loss: tf.Tensor(0.13197733, shape=(), dtype=float32)
loss: tf.Tensor(0.10765689, shape=(), dtype=float32)
loss: tf.Tensor(0.06264009, shape=(), dtype=float32)
loss: tf.Tensor(0.13269708, shape=(), dtype=float32)
loss: tf.Tensor(0.028303467, shape=(), dtype=float32)
loss: tf.Tensor(0.137558, shape=(), dtype=float32)
loss: tf.Tensor(0.093079835, shape=(), dtype=float32)
loss: tf.Tensor(0.09510496, shape=(), dtype=float32)
loss: tf.Tensor(0.055995755, shape=(), dtype=float32)
loss: tf.Tensor(0.07719509, shape=(), dtype=float32)
loss: tf.Tensor(0.18315783, shape=(), dtype=float32)
loss: tf.Tensor(0.11926916, shape=(), dtype=float32)
loss: tf.Tensor(0.07653754, shape=(), dtype=float32)
loss: tf.Tensor(0.07787709, shape=(), dtype=float32)
loss: tf.Tensor(0.0953288, shape=(), dtype=float32)
loss: tf.Tensor(0.09763814, shape=(), dtype=float32)
loss: tf.Tensor(0.052582856, shape=(), dtype=float32)
loss: tf.Tensor(0.09037688, shape=(), dtype=float32)
loss: tf.Tensor(0.08669673, shape=(), dtype=float32)
loss: tf.Tensor(0.1658828, shape=(), dtype=float32)
loss: tf.Tensor(0.07460583, shape=(), dtype=float32)
loss: tf.Tensor(0.103873655, shape=(), dtype=float32)
loss: tf.Tensor(0.13757016, shape=(), dtype=float32)
loss: tf.Tensor(0.06598272, shape=(), dtype=float32)
loss: tf.Tensor(0.101512864, shape=(), dtype=float32)
loss: tf.Tensor(0.13267456, shape=(), dtype=float32)
loss: tf.Tensor(0.037718587, shape=(), dtype=float32)
loss: tf.Tensor(0.1890326, shape=(), dtype=float32)
loss: tf.Tensor(0.036486153, shape=(), dtype=float32)
loss: tf.Tensor(0.053050105, shape=(), dtype=float32)
loss: tf.Tensor(0.111474946, shape=(), dtype=float32)
loss: tf.Tensor(0.102517456, shape=(), dtype=float32)
loss: tf.Tensor(0.10694558, shape=(), dtype=float32)
loss: tf.Tensor(0.12402755, shape=(), dtype=float32)
loss: tf.Tensor(0.09075485, shape=(), dtype=float32)
loss: tf.Tensor(0.2434319, shape=(), dtype=float32)
loss: tf.Tensor(0.08991783, shape=(), dtype=float32)
loss: tf.Tensor(0.16575126, shape=(), dtype=float32)
loss: tf.Tensor(0.10444505, shape=(), dtype=float32)
loss: tf.Tensor(0.05165272, shape=(), dtype=float32)
loss: tf.Tensor(0.12219799, shape=(), dtype=float32)
loss: tf.Tensor(0.083710544, shape=(), dtype=float32)
loss: tf.Tensor(0.17956597, shape=(), dtype=float32)
loss: tf.Tensor(0.09146547, shape=(), dtype=float32)
loss: tf.Tensor(0.06366657, shape=(), dtype=float32)
loss: tf.Tensor(0.15453821, shape=(), dtype=float32)
loss: tf.Tensor(0.08587215, shape=(), dtype=float32)
loss: tf.Tensor(0.09563023, shape=(), dtype=float32)
loss: tf.Tensor(0.069312885, shape=(), dtype=float32)
loss: tf.Tensor(0.06064083, shape=(), dtype=float32)
loss: tf.Tensor(0.09446019, shape=(), dtype=float32)
loss: tf.Tensor(0.11222171, shape=(), dtype=float32)
loss: tf.Tensor(0.07677054, shape=(), dtype=float32)
loss: tf.Tensor(0.03492987, shape=(), dtype=float32)
loss: tf.Tensor(0.096841335, shape=(), dtype=float32)
loss: tf.Tensor(0.14814949, shape=(), dtype=float32)
loss: tf.Tensor(0.14656286, shape=(), dtype=float32)
loss: tf.Tensor(0.08371812, shape=(), dtype=float32)
loss: tf.Tensor(0.019105418, shape=(), dtype=float32)
loss: tf.Tensor(0.10539092, shape=(), dtype=float32)
loss: tf.Tensor(0.090534374, shape=(), dtype=float32)
loss: tf.Tensor(0.11219469, shape=(), dtype=float32)
loss: tf.Tensor(0.06978162, shape=(), dtype=float32)
loss: tf.Tensor(0.06367366, shape=(), dtype=float32)
loss: tf.Tensor(0.03688999, shape=(), dtype=float32)
loss: tf.Tensor(0.04961289, shape=(), dtype=float32)
loss: tf.Tensor(0.117389336, shape=(), dtype=float32)
loss: tf.Tensor(0.0003569681, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69749796, shape=(), dtype=float32)
F1 SCORE:
0.8359211
EPOCH  24 #################################
loss: tf.Tensor(0.010187988, shape=(), dtype=float32)
loss: tf.Tensor(0.025444023, shape=(), dtype=float32)
loss: tf.Tensor(0.028777104, shape=(), dtype=float32)
loss: tf.Tensor(0.057443596, shape=(), dtype=float32)
loss: tf.Tensor(0.031148814, shape=(), dtype=float32)
loss: tf.Tensor(0.07990036, shape=(), dtype=float32)
loss: tf.Tensor(0.05340562, shape=(), dtype=float32)
loss: tf.Tensor(0.056179218, shape=(), dtype=float32)
loss: tf.Tensor(0.10751137, shape=(), dtype=float32)
loss: tf.Tensor(0.06893707, shape=(), dtype=float32)
loss: tf.Tensor(0.04012024, shape=(), dtype=float32)
loss: tf.Tensor(0.13076136, shape=(), dtype=float32)
loss: tf.Tensor(0.09753483, shape=(), dtype=float32)
loss: tf.Tensor(0.03220682, shape=(), dtype=float32)
loss: tf.Tensor(0.11751669, shape=(), dtype=float32)
loss: tf.Tensor(0.07345294, shape=(), dtype=float32)
loss: tf.Tensor(0.082345665, shape=(), dtype=float32)
loss: tf.Tensor(0.15278052, shape=(), dtype=float32)
loss: tf.Tensor(0.044101745, shape=(), dtype=float32)
loss: tf.Tensor(0.12864004, shape=(), dtype=float32)
loss: tf.Tensor(0.04899413, shape=(), dtype=float32)
loss: tf.Tensor(0.05357634, shape=(), dtype=float32)
loss: tf.Tensor(0.11268588, shape=(), dtype=float32)
loss: tf.Tensor(0.033829216, shape=(), dtype=float32)
loss: tf.Tensor(0.07025629, shape=(), dtype=float32)
loss: tf.Tensor(0.030785002, shape=(), dtype=float32)
loss: tf.Tensor(0.12854522, shape=(), dtype=float32)
loss: tf.Tensor(0.10578158, shape=(), dtype=float32)
loss: tf.Tensor(0.053021025, shape=(), dtype=float32)
loss: tf.Tensor(0.08222766, shape=(), dtype=float32)
loss: tf.Tensor(0.024617137, shape=(), dtype=float32)
loss: tf.Tensor(0.1352422, shape=(), dtype=float32)
loss: tf.Tensor(0.043249536, shape=(), dtype=float32)
loss: tf.Tensor(0.109739944, shape=(), dtype=float32)
loss: tf.Tensor(0.16926624, shape=(), dtype=float32)
loss: tf.Tensor(0.112264365, shape=(), dtype=float32)
loss: tf.Tensor(0.1010587, shape=(), dtype=float32)
loss: tf.Tensor(0.06339752, shape=(), dtype=float32)
loss: tf.Tensor(0.056505933, shape=(), dtype=float32)
loss: tf.Tensor(0.027717404, shape=(), dtype=float32)
loss: tf.Tensor(0.062182788, shape=(), dtype=float32)
loss: tf.Tensor(0.13471878, shape=(), dtype=float32)
loss: tf.Tensor(0.06301423, shape=(), dtype=float32)
loss: tf.Tensor(0.045810834, shape=(), dtype=float32)
loss: tf.Tensor(0.06011487, shape=(), dtype=float32)
loss: tf.Tensor(0.070324324, shape=(), dtype=float32)
loss: tf.Tensor(0.057163414, shape=(), dtype=float32)
loss: tf.Tensor(0.06134624, shape=(), dtype=float32)
loss: tf.Tensor(0.056859326, shape=(), dtype=float32)
loss: tf.Tensor(0.14511919, shape=(), dtype=float32)
loss: tf.Tensor(0.047531214, shape=(), dtype=float32)
loss: tf.Tensor(0.06544372, shape=(), dtype=float32)
loss: tf.Tensor(0.05602827, shape=(), dtype=float32)
loss: tf.Tensor(0.053934693, shape=(), dtype=float32)
loss: tf.Tensor(0.04783051, shape=(), dtype=float32)
loss: tf.Tensor(0.05867636, shape=(), dtype=float32)
loss: tf.Tensor(0.07722646, shape=(), dtype=float32)
loss: tf.Tensor(0.08828456, shape=(), dtype=float32)
loss: tf.Tensor(0.060346514, shape=(), dtype=float32)
loss: tf.Tensor(0.057715315, shape=(), dtype=float32)
loss: tf.Tensor(0.037750803, shape=(), dtype=float32)
loss: tf.Tensor(0.09028699, shape=(), dtype=float32)
loss: tf.Tensor(0.043728407, shape=(), dtype=float32)
loss: tf.Tensor(0.055727288, shape=(), dtype=float32)
loss: tf.Tensor(0.038694233, shape=(), dtype=float32)
loss: tf.Tensor(0.08509506, shape=(), dtype=float32)
loss: tf.Tensor(0.026238112, shape=(), dtype=float32)
loss: tf.Tensor(0.043772783, shape=(), dtype=float32)
loss: tf.Tensor(0.047070082, shape=(), dtype=float32)
loss: tf.Tensor(0.06519957, shape=(), dtype=float32)
loss: tf.Tensor(0.10350414, shape=(), dtype=float32)
loss: tf.Tensor(0.10968198, shape=(), dtype=float32)
loss: tf.Tensor(0.060258172, shape=(), dtype=float32)
loss: tf.Tensor(3.3020428e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.7174648, shape=(), dtype=float32)
F1 SCORE:
0.8350064
EPOCH  25 #################################
loss: tf.Tensor(0.06474964, shape=(), dtype=float32)
loss: tf.Tensor(0.0784357, shape=(), dtype=float32)
loss: tf.Tensor(0.0760125, shape=(), dtype=float32)
loss: tf.Tensor(0.11585081, shape=(), dtype=float32)
loss: tf.Tensor(0.055720665, shape=(), dtype=float32)
loss: tf.Tensor(0.053024326, shape=(), dtype=float32)
loss: tf.Tensor(0.1410089, shape=(), dtype=float32)
loss: tf.Tensor(0.09621853, shape=(), dtype=float32)
loss: tf.Tensor(0.046735972, shape=(), dtype=float32)
loss: tf.Tensor(0.03798038, shape=(), dtype=float32)
loss: tf.Tensor(0.062343717, shape=(), dtype=float32)
loss: tf.Tensor(0.065321654, shape=(), dtype=float32)
loss: tf.Tensor(0.12144157, shape=(), dtype=float32)
loss: tf.Tensor(0.081317484, shape=(), dtype=float32)
loss: tf.Tensor(0.053081915, shape=(), dtype=float32)
loss: tf.Tensor(0.02299642, shape=(), dtype=float32)
loss: tf.Tensor(0.07309392, shape=(), dtype=float32)
loss: tf.Tensor(0.06789, shape=(), dtype=float32)
loss: tf.Tensor(0.10678989, shape=(), dtype=float32)
loss: tf.Tensor(0.14419636, shape=(), dtype=float32)
loss: tf.Tensor(0.07048596, shape=(), dtype=float32)
loss: tf.Tensor(0.06391871, shape=(), dtype=float32)
loss: tf.Tensor(0.085611865, shape=(), dtype=float32)
loss: tf.Tensor(0.06288367, shape=(), dtype=float32)
loss: tf.Tensor(0.16577521, shape=(), dtype=float32)
loss: tf.Tensor(0.13617823, shape=(), dtype=float32)
loss: tf.Tensor(0.1954686, shape=(), dtype=float32)
loss: tf.Tensor(0.04702785, shape=(), dtype=float32)
loss: tf.Tensor(0.06623032, shape=(), dtype=float32)
loss: tf.Tensor(0.1262948, shape=(), dtype=float32)
loss: tf.Tensor(0.16344872, shape=(), dtype=float32)
loss: tf.Tensor(0.045706186, shape=(), dtype=float32)
loss: tf.Tensor(0.055212636, shape=(), dtype=float32)
loss: tf.Tensor(0.22563864, shape=(), dtype=float32)
loss: tf.Tensor(0.056286424, shape=(), dtype=float32)
loss: tf.Tensor(0.11122943, shape=(), dtype=float32)
loss: tf.Tensor(0.05858358, shape=(), dtype=float32)
loss: tf.Tensor(0.046940934, shape=(), dtype=float32)
loss: tf.Tensor(0.09584917, shape=(), dtype=float32)
loss: tf.Tensor(0.07954034, shape=(), dtype=float32)
loss: tf.Tensor(0.10230865, shape=(), dtype=float32)
loss: tf.Tensor(0.09330454, shape=(), dtype=float32)
loss: tf.Tensor(0.042095304, shape=(), dtype=float32)
loss: tf.Tensor(0.086384125, shape=(), dtype=float32)
loss: tf.Tensor(0.02457804, shape=(), dtype=float32)
loss: tf.Tensor(0.08448329, shape=(), dtype=float32)
loss: tf.Tensor(0.052773375, shape=(), dtype=float32)
loss: tf.Tensor(0.082574345, shape=(), dtype=float32)
loss: tf.Tensor(0.068627074, shape=(), dtype=float32)
loss: tf.Tensor(0.0870705, shape=(), dtype=float32)
loss: tf.Tensor(0.027521605, shape=(), dtype=float32)
loss: tf.Tensor(0.07022316, shape=(), dtype=float32)
loss: tf.Tensor(0.11284687, shape=(), dtype=float32)
loss: tf.Tensor(0.07745595, shape=(), dtype=float32)
loss: tf.Tensor(0.07900021, shape=(), dtype=float32)
loss: tf.Tensor(0.01834802, shape=(), dtype=float32)
loss: tf.Tensor(0.04217959, shape=(), dtype=float32)
loss: tf.Tensor(0.051409446, shape=(), dtype=float32)
loss: tf.Tensor(0.0698817, shape=(), dtype=float32)
loss: tf.Tensor(0.09431865, shape=(), dtype=float32)
loss: tf.Tensor(0.020369297, shape=(), dtype=float32)
loss: tf.Tensor(0.15771806, shape=(), dtype=float32)
loss: tf.Tensor(0.031052275, shape=(), dtype=float32)
loss: tf.Tensor(0.11149815, shape=(), dtype=float32)
loss: tf.Tensor(0.047624327, shape=(), dtype=float32)
loss: tf.Tensor(0.049409267, shape=(), dtype=float32)
loss: tf.Tensor(0.06881759, shape=(), dtype=float32)
loss: tf.Tensor(0.046496216, shape=(), dtype=float32)
loss: tf.Tensor(0.10966931, shape=(), dtype=float32)
loss: tf.Tensor(0.12567252, shape=(), dtype=float32)
loss: tf.Tensor(0.06907495, shape=(), dtype=float32)
loss: tf.Tensor(0.044786826, shape=(), dtype=float32)
loss: tf.Tensor(0.07938445, shape=(), dtype=float32)
loss: tf.Tensor(0.026507806, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6909205, shape=(), dtype=float32)
F1 SCORE:
0.8354694
EPOCH  26 #################################
loss: tf.Tensor(0.06537606, shape=(), dtype=float32)
loss: tf.Tensor(0.10379954, shape=(), dtype=float32)
loss: tf.Tensor(0.07099275, shape=(), dtype=float32)
loss: tf.Tensor(0.11387403, shape=(), dtype=float32)
loss: tf.Tensor(0.066898026, shape=(), dtype=float32)
loss: tf.Tensor(0.10805853, shape=(), dtype=float32)
loss: tf.Tensor(0.06887115, shape=(), dtype=float32)
loss: tf.Tensor(0.05578843, shape=(), dtype=float32)
loss: tf.Tensor(0.11887922, shape=(), dtype=float32)
loss: tf.Tensor(0.0893382, shape=(), dtype=float32)
loss: tf.Tensor(0.11426358, shape=(), dtype=float32)
loss: tf.Tensor(0.1093624, shape=(), dtype=float32)
loss: tf.Tensor(0.07620348, shape=(), dtype=float32)
loss: tf.Tensor(0.03879311, shape=(), dtype=float32)
loss: tf.Tensor(0.09969275, shape=(), dtype=float32)
loss: tf.Tensor(0.11724834, shape=(), dtype=float32)
loss: tf.Tensor(0.031580545, shape=(), dtype=float32)
loss: tf.Tensor(0.11758916, shape=(), dtype=float32)
loss: tf.Tensor(0.082736194, shape=(), dtype=float32)
loss: tf.Tensor(0.05856075, shape=(), dtype=float32)
loss: tf.Tensor(0.04484415, shape=(), dtype=float32)
loss: tf.Tensor(0.035498533, shape=(), dtype=float32)
loss: tf.Tensor(0.020077653, shape=(), dtype=float32)
loss: tf.Tensor(0.03268244, shape=(), dtype=float32)
loss: tf.Tensor(0.09540012, shape=(), dtype=float32)
loss: tf.Tensor(0.154214, shape=(), dtype=float32)
loss: tf.Tensor(0.06094907, shape=(), dtype=float32)
loss: tf.Tensor(0.104109615, shape=(), dtype=float32)
loss: tf.Tensor(0.087585784, shape=(), dtype=float32)
loss: tf.Tensor(0.03719804, shape=(), dtype=float32)
loss: tf.Tensor(0.13012606, shape=(), dtype=float32)
loss: tf.Tensor(0.110324726, shape=(), dtype=float32)
loss: tf.Tensor(0.017659042, shape=(), dtype=float32)
loss: tf.Tensor(0.06189249, shape=(), dtype=float32)
loss: tf.Tensor(0.09944686, shape=(), dtype=float32)
loss: tf.Tensor(0.03903255, shape=(), dtype=float32)
loss: tf.Tensor(0.037483513, shape=(), dtype=float32)
loss: tf.Tensor(0.08524905, shape=(), dtype=float32)
loss: tf.Tensor(0.21598783, shape=(), dtype=float32)
loss: tf.Tensor(0.08996752, shape=(), dtype=float32)
loss: tf.Tensor(0.08806242, shape=(), dtype=float32)
loss: tf.Tensor(0.06706688, shape=(), dtype=float32)
loss: tf.Tensor(0.078559116, shape=(), dtype=float32)
loss: tf.Tensor(0.0662478, shape=(), dtype=float32)
loss: tf.Tensor(0.13329181, shape=(), dtype=float32)
loss: tf.Tensor(0.08266732, shape=(), dtype=float32)
loss: tf.Tensor(0.15086366, shape=(), dtype=float32)
loss: tf.Tensor(0.08497201, shape=(), dtype=float32)
loss: tf.Tensor(0.12592489, shape=(), dtype=float32)
loss: tf.Tensor(0.19643463, shape=(), dtype=float32)
loss: tf.Tensor(0.07267538, shape=(), dtype=float32)
loss: tf.Tensor(0.09033214, shape=(), dtype=float32)
loss: tf.Tensor(0.04053806, shape=(), dtype=float32)
loss: tf.Tensor(0.07213942, shape=(), dtype=float32)
loss: tf.Tensor(0.053796064, shape=(), dtype=float32)
loss: tf.Tensor(0.15931523, shape=(), dtype=float32)
loss: tf.Tensor(0.06797943, shape=(), dtype=float32)
loss: tf.Tensor(0.060935453, shape=(), dtype=float32)
loss: tf.Tensor(0.082957566, shape=(), dtype=float32)
loss: tf.Tensor(0.07570755, shape=(), dtype=float32)
loss: tf.Tensor(0.055413395, shape=(), dtype=float32)
loss: tf.Tensor(0.04177214, shape=(), dtype=float32)
loss: tf.Tensor(0.035969596, shape=(), dtype=float32)
loss: tf.Tensor(0.056426868, shape=(), dtype=float32)
loss: tf.Tensor(0.047087487, shape=(), dtype=float32)
loss: tf.Tensor(0.08957221, shape=(), dtype=float32)
loss: tf.Tensor(0.10070722, shape=(), dtype=float32)
loss: tf.Tensor(0.3747934, shape=(), dtype=float32)
loss: tf.Tensor(0.08309831, shape=(), dtype=float32)
loss: tf.Tensor(0.062184133, shape=(), dtype=float32)
loss: tf.Tensor(0.06793598, shape=(), dtype=float32)
loss: tf.Tensor(0.06945186, shape=(), dtype=float32)
loss: tf.Tensor(0.061713673, shape=(), dtype=float32)
loss: tf.Tensor(0.0017838056, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.742024, shape=(), dtype=float32)
F1 SCORE:
0.83366984
EPOCH  27 #################################
loss: tf.Tensor(0.13476172, shape=(), dtype=float32)
loss: tf.Tensor(0.12071927, shape=(), dtype=float32)
loss: tf.Tensor(0.058521353, shape=(), dtype=float32)
loss: tf.Tensor(0.054954566, shape=(), dtype=float32)
loss: tf.Tensor(0.10467536, shape=(), dtype=float32)
loss: tf.Tensor(0.036859076, shape=(), dtype=float32)
loss: tf.Tensor(0.06176772, shape=(), dtype=float32)
loss: tf.Tensor(0.056344982, shape=(), dtype=float32)
loss: tf.Tensor(0.031326547, shape=(), dtype=float32)
loss: tf.Tensor(0.12961054, shape=(), dtype=float32)
loss: tf.Tensor(0.16874993, shape=(), dtype=float32)
loss: tf.Tensor(0.029285671, shape=(), dtype=float32)
loss: tf.Tensor(0.05314647, shape=(), dtype=float32)
loss: tf.Tensor(0.08455198, shape=(), dtype=float32)
loss: tf.Tensor(0.07701907, shape=(), dtype=float32)
loss: tf.Tensor(0.04513317, shape=(), dtype=float32)
loss: tf.Tensor(0.02964463, shape=(), dtype=float32)
loss: tf.Tensor(0.0732672, shape=(), dtype=float32)
loss: tf.Tensor(0.066290796, shape=(), dtype=float32)
loss: tf.Tensor(0.06629887, shape=(), dtype=float32)
loss: tf.Tensor(0.090197966, shape=(), dtype=float32)
loss: tf.Tensor(0.0681254, shape=(), dtype=float32)
loss: tf.Tensor(0.04602724, shape=(), dtype=float32)
loss: tf.Tensor(0.052145395, shape=(), dtype=float32)
loss: tf.Tensor(0.048192285, shape=(), dtype=float32)
loss: tf.Tensor(0.07754856, shape=(), dtype=float32)
loss: tf.Tensor(0.07194217, shape=(), dtype=float32)
loss: tf.Tensor(0.21172361, shape=(), dtype=float32)
loss: tf.Tensor(0.06841043, shape=(), dtype=float32)
loss: tf.Tensor(0.1506326, shape=(), dtype=float32)
loss: tf.Tensor(0.08775672, shape=(), dtype=float32)
loss: tf.Tensor(0.04231644, shape=(), dtype=float32)
loss: tf.Tensor(0.050713282, shape=(), dtype=float32)
loss: tf.Tensor(0.065052636, shape=(), dtype=float32)
loss: tf.Tensor(0.08162203, shape=(), dtype=float32)
loss: tf.Tensor(0.048216343, shape=(), dtype=float32)
loss: tf.Tensor(0.05323621, shape=(), dtype=float32)
loss: tf.Tensor(0.033672925, shape=(), dtype=float32)
loss: tf.Tensor(0.096643835, shape=(), dtype=float32)
loss: tf.Tensor(0.08080942, shape=(), dtype=float32)
loss: tf.Tensor(0.049289152, shape=(), dtype=float32)
loss: tf.Tensor(0.06665543, shape=(), dtype=float32)
loss: tf.Tensor(0.047626797, shape=(), dtype=float32)
loss: tf.Tensor(0.061053127, shape=(), dtype=float32)
loss: tf.Tensor(0.05402649, shape=(), dtype=float32)
loss: tf.Tensor(0.09366395, shape=(), dtype=float32)
loss: tf.Tensor(0.057348773, shape=(), dtype=float32)
loss: tf.Tensor(0.09070792, shape=(), dtype=float32)
loss: tf.Tensor(0.042802323, shape=(), dtype=float32)
loss: tf.Tensor(0.12766308, shape=(), dtype=float32)
loss: tf.Tensor(0.060800143, shape=(), dtype=float32)
loss: tf.Tensor(0.07761247, shape=(), dtype=float32)
loss: tf.Tensor(0.07929098, shape=(), dtype=float32)
loss: tf.Tensor(0.05654829, shape=(), dtype=float32)
loss: tf.Tensor(0.14061098, shape=(), dtype=float32)
loss: tf.Tensor(0.16820668, shape=(), dtype=float32)
loss: tf.Tensor(0.04112399, shape=(), dtype=float32)
loss: tf.Tensor(0.1719466, shape=(), dtype=float32)
loss: tf.Tensor(0.061114825, shape=(), dtype=float32)
loss: tf.Tensor(0.030270783, shape=(), dtype=float32)
loss: tf.Tensor(0.061708532, shape=(), dtype=float32)
loss: tf.Tensor(0.020260317, shape=(), dtype=float32)
loss: tf.Tensor(0.08012996, shape=(), dtype=float32)
loss: tf.Tensor(0.057411615, shape=(), dtype=float32)
loss: tf.Tensor(0.12584384, shape=(), dtype=float32)
loss: tf.Tensor(0.1351744, shape=(), dtype=float32)
loss: tf.Tensor(0.13584319, shape=(), dtype=float32)
loss: tf.Tensor(0.069386184, shape=(), dtype=float32)
loss: tf.Tensor(0.030873707, shape=(), dtype=float32)
loss: tf.Tensor(0.09734842, shape=(), dtype=float32)
loss: tf.Tensor(0.07133909, shape=(), dtype=float32)
loss: tf.Tensor(0.11432467, shape=(), dtype=float32)
loss: tf.Tensor(0.09644226, shape=(), dtype=float32)
loss: tf.Tensor(0.00026723152, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6948759, shape=(), dtype=float32)
F1 SCORE:
0.83375317
EPOCH  28 #################################
loss: tf.Tensor(0.0532263, shape=(), dtype=float32)
loss: tf.Tensor(0.07313235, shape=(), dtype=float32)
loss: tf.Tensor(0.06947937, shape=(), dtype=float32)
loss: tf.Tensor(0.076922126, shape=(), dtype=float32)
loss: tf.Tensor(0.057155814, shape=(), dtype=float32)
loss: tf.Tensor(0.08255178, shape=(), dtype=float32)
loss: tf.Tensor(0.096803166, shape=(), dtype=float32)
loss: tf.Tensor(0.04962133, shape=(), dtype=float32)
loss: tf.Tensor(0.02878753, shape=(), dtype=float32)
loss: tf.Tensor(0.1060336, shape=(), dtype=float32)
loss: tf.Tensor(0.025228912, shape=(), dtype=float32)
loss: tf.Tensor(0.039344173, shape=(), dtype=float32)
loss: tf.Tensor(0.036356233, shape=(), dtype=float32)
loss: tf.Tensor(0.06312064, shape=(), dtype=float32)
loss: tf.Tensor(0.0586863, shape=(), dtype=float32)
loss: tf.Tensor(0.05752001, shape=(), dtype=float32)
loss: tf.Tensor(0.08011454, shape=(), dtype=float32)
loss: tf.Tensor(0.043968845, shape=(), dtype=float32)
loss: tf.Tensor(0.0117198415, shape=(), dtype=float32)
loss: tf.Tensor(0.057122022, shape=(), dtype=float32)
loss: tf.Tensor(0.12719649, shape=(), dtype=float32)
loss: tf.Tensor(0.09854109, shape=(), dtype=float32)
loss: tf.Tensor(0.042361654, shape=(), dtype=float32)
loss: tf.Tensor(0.045502163, shape=(), dtype=float32)
loss: tf.Tensor(0.04371112, shape=(), dtype=float32)
loss: tf.Tensor(0.13422944, shape=(), dtype=float32)
loss: tf.Tensor(0.07352027, shape=(), dtype=float32)
loss: tf.Tensor(0.09407718, shape=(), dtype=float32)
loss: tf.Tensor(0.017705984, shape=(), dtype=float32)
loss: tf.Tensor(0.024527824, shape=(), dtype=float32)
loss: tf.Tensor(0.06023966, shape=(), dtype=float32)
loss: tf.Tensor(0.044999428, shape=(), dtype=float32)
loss: tf.Tensor(0.09232482, shape=(), dtype=float32)
loss: tf.Tensor(0.07475853, shape=(), dtype=float32)
loss: tf.Tensor(0.029321099, shape=(), dtype=float32)
loss: tf.Tensor(0.13727546, shape=(), dtype=float32)
loss: tf.Tensor(0.04634224, shape=(), dtype=float32)
loss: tf.Tensor(0.064766705, shape=(), dtype=float32)
loss: tf.Tensor(0.026019683, shape=(), dtype=float32)
loss: tf.Tensor(0.04428857, shape=(), dtype=float32)
loss: tf.Tensor(0.08003083, shape=(), dtype=float32)
loss: tf.Tensor(0.06773317, shape=(), dtype=float32)
loss: tf.Tensor(0.068195544, shape=(), dtype=float32)
loss: tf.Tensor(0.07113454, shape=(), dtype=float32)
loss: tf.Tensor(0.039827827, shape=(), dtype=float32)
loss: tf.Tensor(0.11298826, shape=(), dtype=float32)
loss: tf.Tensor(0.07198999, shape=(), dtype=float32)
loss: tf.Tensor(0.07399426, shape=(), dtype=float32)
loss: tf.Tensor(0.051396456, shape=(), dtype=float32)
loss: tf.Tensor(0.058737427, shape=(), dtype=float32)
loss: tf.Tensor(0.057134952, shape=(), dtype=float32)
loss: tf.Tensor(0.04890456, shape=(), dtype=float32)
loss: tf.Tensor(0.032795254, shape=(), dtype=float32)
loss: tf.Tensor(0.11323601, shape=(), dtype=float32)
loss: tf.Tensor(0.06666043, shape=(), dtype=float32)
loss: tf.Tensor(0.06101525, shape=(), dtype=float32)
loss: tf.Tensor(0.1002279, shape=(), dtype=float32)
loss: tf.Tensor(0.052586533, shape=(), dtype=float32)
loss: tf.Tensor(0.032629002, shape=(), dtype=float32)
loss: tf.Tensor(0.11141324, shape=(), dtype=float32)
loss: tf.Tensor(0.17634282, shape=(), dtype=float32)
loss: tf.Tensor(0.059172105, shape=(), dtype=float32)
loss: tf.Tensor(0.084270455, shape=(), dtype=float32)
loss: tf.Tensor(0.116038755, shape=(), dtype=float32)
loss: tf.Tensor(0.06612732, shape=(), dtype=float32)
loss: tf.Tensor(0.023399036, shape=(), dtype=float32)
loss: tf.Tensor(0.073396124, shape=(), dtype=float32)
loss: tf.Tensor(0.13407618, shape=(), dtype=float32)
loss: tf.Tensor(0.095530204, shape=(), dtype=float32)
loss: tf.Tensor(0.09698617, shape=(), dtype=float32)
loss: tf.Tensor(0.10536823, shape=(), dtype=float32)
loss: tf.Tensor(0.029571302, shape=(), dtype=float32)
loss: tf.Tensor(0.0487959, shape=(), dtype=float32)
loss: tf.Tensor(0.0011667357, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.68999195, shape=(), dtype=float32)
F1 SCORE:
0.83388305
EPOCH  29 #################################
loss: tf.Tensor(0.1580606, shape=(), dtype=float32)
loss: tf.Tensor(0.04147521, shape=(), dtype=float32)
loss: tf.Tensor(0.06546864, shape=(), dtype=float32)
loss: tf.Tensor(0.1851086, shape=(), dtype=float32)
loss: tf.Tensor(0.07558507, shape=(), dtype=float32)
loss: tf.Tensor(0.051665284, shape=(), dtype=float32)
loss: tf.Tensor(0.026564095, shape=(), dtype=float32)
loss: tf.Tensor(0.07297695, shape=(), dtype=float32)
loss: tf.Tensor(0.08384279, shape=(), dtype=float32)
loss: tf.Tensor(0.022800392, shape=(), dtype=float32)
loss: tf.Tensor(0.1200771, shape=(), dtype=float32)
loss: tf.Tensor(0.031998213, shape=(), dtype=float32)
loss: tf.Tensor(0.021592595, shape=(), dtype=float32)
loss: tf.Tensor(0.06741285, shape=(), dtype=float32)
loss: tf.Tensor(0.055914253, shape=(), dtype=float32)
loss: tf.Tensor(0.17673956, shape=(), dtype=float32)
loss: tf.Tensor(0.012122844, shape=(), dtype=float32)
loss: tf.Tensor(0.05475135, shape=(), dtype=float32)
loss: tf.Tensor(0.06263467, shape=(), dtype=float32)
loss: tf.Tensor(0.13309968, shape=(), dtype=float32)
loss: tf.Tensor(0.04488431, shape=(), dtype=float32)
loss: tf.Tensor(0.04625908, shape=(), dtype=float32)
loss: tf.Tensor(0.023266343, shape=(), dtype=float32)
loss: tf.Tensor(0.021450698, shape=(), dtype=float32)
loss: tf.Tensor(0.04317107, shape=(), dtype=float32)
loss: tf.Tensor(0.04395347, shape=(), dtype=float32)
loss: tf.Tensor(0.05578354, shape=(), dtype=float32)
loss: tf.Tensor(0.05104196, shape=(), dtype=float32)
loss: tf.Tensor(0.0939083, shape=(), dtype=float32)
loss: tf.Tensor(0.10724278, shape=(), dtype=float32)
loss: tf.Tensor(0.07036222, shape=(), dtype=float32)
loss: tf.Tensor(0.07095537, shape=(), dtype=float32)
loss: tf.Tensor(0.06723917, shape=(), dtype=float32)
loss: tf.Tensor(0.07936719, shape=(), dtype=float32)
loss: tf.Tensor(0.035824038, shape=(), dtype=float32)
loss: tf.Tensor(0.043514263, shape=(), dtype=float32)
loss: tf.Tensor(0.09229054, shape=(), dtype=float32)
loss: tf.Tensor(0.0705573, shape=(), dtype=float32)
loss: tf.Tensor(0.031118322, shape=(), dtype=float32)
loss: tf.Tensor(0.05776544, shape=(), dtype=float32)
loss: tf.Tensor(0.094781, shape=(), dtype=float32)
loss: tf.Tensor(0.02759936, shape=(), dtype=float32)
loss: tf.Tensor(0.049493063, shape=(), dtype=float32)
loss: tf.Tensor(0.028568484, shape=(), dtype=float32)
loss: tf.Tensor(0.010675817, shape=(), dtype=float32)
loss: tf.Tensor(0.12880772, shape=(), dtype=float32)
loss: tf.Tensor(0.051750604, shape=(), dtype=float32)
loss: tf.Tensor(0.0243057, shape=(), dtype=float32)
loss: tf.Tensor(0.07800567, shape=(), dtype=float32)
loss: tf.Tensor(0.073766924, shape=(), dtype=float32)
loss: tf.Tensor(0.07514542, shape=(), dtype=float32)
loss: tf.Tensor(0.09134407, shape=(), dtype=float32)
loss: tf.Tensor(0.0928801, shape=(), dtype=float32)
loss: tf.Tensor(0.03832314, shape=(), dtype=float32)
loss: tf.Tensor(0.04708942, shape=(), dtype=float32)
loss: tf.Tensor(0.041407477, shape=(), dtype=float32)
loss: tf.Tensor(0.09041734, shape=(), dtype=float32)
loss: tf.Tensor(0.058579933, shape=(), dtype=float32)
loss: tf.Tensor(0.05432856, shape=(), dtype=float32)
loss: tf.Tensor(0.030320145, shape=(), dtype=float32)
loss: tf.Tensor(0.043906115, shape=(), dtype=float32)
loss: tf.Tensor(0.07101387, shape=(), dtype=float32)
loss: tf.Tensor(0.02599878, shape=(), dtype=float32)
loss: tf.Tensor(0.030256933, shape=(), dtype=float32)
loss: tf.Tensor(0.15561788, shape=(), dtype=float32)
loss: tf.Tensor(0.058489334, shape=(), dtype=float32)
loss: tf.Tensor(0.16206259, shape=(), dtype=float32)
loss: tf.Tensor(0.038852166, shape=(), dtype=float32)
loss: tf.Tensor(0.15050153, shape=(), dtype=float32)
loss: tf.Tensor(0.028776728, shape=(), dtype=float32)
loss: tf.Tensor(0.048260644, shape=(), dtype=float32)
loss: tf.Tensor(0.035197705, shape=(), dtype=float32)
loss: tf.Tensor(0.03926073, shape=(), dtype=float32)
loss: tf.Tensor(0.00086520426, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.71011865, shape=(), dtype=float32)
F1 SCORE:
0.8334845
EPOCH  30 #################################
loss: tf.Tensor(0.03777467, shape=(), dtype=float32)
loss: tf.Tensor(0.047738414, shape=(), dtype=float32)
loss: tf.Tensor(0.09113665, shape=(), dtype=float32)
loss: tf.Tensor(0.04457245, shape=(), dtype=float32)
loss: tf.Tensor(0.02410713, shape=(), dtype=float32)
loss: tf.Tensor(0.031053074, shape=(), dtype=float32)
loss: tf.Tensor(0.06589783, shape=(), dtype=float32)
loss: tf.Tensor(0.040179495, shape=(), dtype=float32)
loss: tf.Tensor(0.035292502, shape=(), dtype=float32)
loss: tf.Tensor(0.09146881, shape=(), dtype=float32)
loss: tf.Tensor(0.057822604, shape=(), dtype=float32)
loss: tf.Tensor(0.012825377, shape=(), dtype=float32)
loss: tf.Tensor(0.14335193, shape=(), dtype=float32)
loss: tf.Tensor(0.0059248563, shape=(), dtype=float32)
loss: tf.Tensor(0.062575586, shape=(), dtype=float32)
loss: tf.Tensor(0.02436154, shape=(), dtype=float32)
loss: tf.Tensor(0.07895177, shape=(), dtype=float32)
loss: tf.Tensor(0.02110006, shape=(), dtype=float32)
loss: tf.Tensor(0.05690146, shape=(), dtype=float32)
loss: tf.Tensor(0.029722007, shape=(), dtype=float32)
loss: tf.Tensor(0.036409315, shape=(), dtype=float32)
loss: tf.Tensor(0.0489434, shape=(), dtype=float32)
loss: tf.Tensor(0.06691, shape=(), dtype=float32)
loss: tf.Tensor(0.0905843, shape=(), dtype=float32)
loss: tf.Tensor(0.034285873, shape=(), dtype=float32)
loss: tf.Tensor(0.047551513, shape=(), dtype=float32)
loss: tf.Tensor(0.08889341, shape=(), dtype=float32)
loss: tf.Tensor(0.1323337, shape=(), dtype=float32)
loss: tf.Tensor(0.048178587, shape=(), dtype=float32)
loss: tf.Tensor(0.01605543, shape=(), dtype=float32)
loss: tf.Tensor(0.04888215, shape=(), dtype=float32)
loss: tf.Tensor(0.10351524, shape=(), dtype=float32)
loss: tf.Tensor(0.04418601, shape=(), dtype=float32)
loss: tf.Tensor(0.034903824, shape=(), dtype=float32)
loss: tf.Tensor(0.022798775, shape=(), dtype=float32)
loss: tf.Tensor(0.082869224, shape=(), dtype=float32)
loss: tf.Tensor(0.05659256, shape=(), dtype=float32)
loss: tf.Tensor(0.03400701, shape=(), dtype=float32)
loss: tf.Tensor(0.09828393, shape=(), dtype=float32)
loss: tf.Tensor(0.027763037, shape=(), dtype=float32)
loss: tf.Tensor(0.122616485, shape=(), dtype=float32)
loss: tf.Tensor(0.070449255, shape=(), dtype=float32)
loss: tf.Tensor(0.093823284, shape=(), dtype=float32)
loss: tf.Tensor(0.06860566, shape=(), dtype=float32)
loss: tf.Tensor(0.03123065, shape=(), dtype=float32)
loss: tf.Tensor(0.08153149, shape=(), dtype=float32)
loss: tf.Tensor(0.09764905, shape=(), dtype=float32)
loss: tf.Tensor(0.08381758, shape=(), dtype=float32)
loss: tf.Tensor(0.08506734, shape=(), dtype=float32)
loss: tf.Tensor(0.039567713, shape=(), dtype=float32)
loss: tf.Tensor(0.120925166, shape=(), dtype=float32)
loss: tf.Tensor(0.10894392, shape=(), dtype=float32)
loss: tf.Tensor(0.038226403, shape=(), dtype=float32)
loss: tf.Tensor(0.10546715, shape=(), dtype=float32)
loss: tf.Tensor(0.08489446, shape=(), dtype=float32)
loss: tf.Tensor(0.043934174, shape=(), dtype=float32)
loss: tf.Tensor(0.03424044, shape=(), dtype=float32)
loss: tf.Tensor(0.053084664, shape=(), dtype=float32)
loss: tf.Tensor(0.02854501, shape=(), dtype=float32)
loss: tf.Tensor(0.1041089, shape=(), dtype=float32)
loss: tf.Tensor(0.08556941, shape=(), dtype=float32)
loss: tf.Tensor(0.03347782, shape=(), dtype=float32)
loss: tf.Tensor(0.09948237, shape=(), dtype=float32)
loss: tf.Tensor(0.08534173, shape=(), dtype=float32)
loss: tf.Tensor(0.075180285, shape=(), dtype=float32)
loss: tf.Tensor(0.041195642, shape=(), dtype=float32)
loss: tf.Tensor(0.06447908, shape=(), dtype=float32)
loss: tf.Tensor(0.05612873, shape=(), dtype=float32)
loss: tf.Tensor(0.15020996, shape=(), dtype=float32)
loss: tf.Tensor(0.08805084, shape=(), dtype=float32)
loss: tf.Tensor(0.0238027, shape=(), dtype=float32)
loss: tf.Tensor(0.044627022, shape=(), dtype=float32)
loss: tf.Tensor(0.044175066, shape=(), dtype=float32)
loss: tf.Tensor(0.0006298227, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.6894113, shape=(), dtype=float32)
F1 SCORE:
0.83379793
EPOCH  31 #################################
loss: tf.Tensor(0.023930876, shape=(), dtype=float32)
loss: tf.Tensor(0.06717531, shape=(), dtype=float32)
loss: tf.Tensor(0.0831137, shape=(), dtype=float32)
loss: tf.Tensor(0.09424942, shape=(), dtype=float32)
loss: tf.Tensor(0.020863736, shape=(), dtype=float32)
loss: tf.Tensor(0.04219299, shape=(), dtype=float32)
loss: tf.Tensor(0.056812145, shape=(), dtype=float32)
loss: tf.Tensor(0.03369937, shape=(), dtype=float32)
loss: tf.Tensor(0.086236805, shape=(), dtype=float32)
loss: tf.Tensor(0.10387659, shape=(), dtype=float32)
loss: tf.Tensor(0.08372812, shape=(), dtype=float32)
loss: tf.Tensor(0.06846573, shape=(), dtype=float32)
loss: tf.Tensor(0.04191503, shape=(), dtype=float32)
loss: tf.Tensor(0.04656635, shape=(), dtype=float32)
loss: tf.Tensor(0.10027151, shape=(), dtype=float32)
loss: tf.Tensor(0.108944766, shape=(), dtype=float32)
loss: tf.Tensor(0.0892338, shape=(), dtype=float32)
loss: tf.Tensor(0.051943187, shape=(), dtype=float32)
loss: tf.Tensor(0.054886393, shape=(), dtype=float32)
loss: tf.Tensor(0.037603606, shape=(), dtype=float32)
loss: tf.Tensor(0.015348744, shape=(), dtype=float32)
loss: tf.Tensor(0.028429331, shape=(), dtype=float32)
loss: tf.Tensor(0.010976107, shape=(), dtype=float32)
loss: tf.Tensor(0.0054007797, shape=(), dtype=float32)
loss: tf.Tensor(0.055642158, shape=(), dtype=float32)
loss: tf.Tensor(0.08031141, shape=(), dtype=float32)
loss: tf.Tensor(0.025279814, shape=(), dtype=float32)
loss: tf.Tensor(0.055869766, shape=(), dtype=float32)
loss: tf.Tensor(0.040597886, shape=(), dtype=float32)
loss: tf.Tensor(0.034762338, shape=(), dtype=float32)
loss: tf.Tensor(0.092634164, shape=(), dtype=float32)
loss: tf.Tensor(0.06010823, shape=(), dtype=float32)
loss: tf.Tensor(0.09416155, shape=(), dtype=float32)
loss: tf.Tensor(0.06763428, shape=(), dtype=float32)
loss: tf.Tensor(0.10132883, shape=(), dtype=float32)
loss: tf.Tensor(0.04272996, shape=(), dtype=float32)
loss: tf.Tensor(0.07882126, shape=(), dtype=float32)
loss: tf.Tensor(0.06864501, shape=(), dtype=float32)
loss: tf.Tensor(0.037744462, shape=(), dtype=float32)
loss: tf.Tensor(0.02671571, shape=(), dtype=float32)
loss: tf.Tensor(0.08803991, shape=(), dtype=float32)
loss: tf.Tensor(0.030527322, shape=(), dtype=float32)
loss: tf.Tensor(0.05027371, shape=(), dtype=float32)
loss: tf.Tensor(0.07041556, shape=(), dtype=float32)
loss: tf.Tensor(0.036508605, shape=(), dtype=float32)
loss: tf.Tensor(0.03446604, shape=(), dtype=float32)
loss: tf.Tensor(0.020320129, shape=(), dtype=float32)
loss: tf.Tensor(0.060803283, shape=(), dtype=float32)
loss: tf.Tensor(0.02980803, shape=(), dtype=float32)
loss: tf.Tensor(0.066713125, shape=(), dtype=float32)
loss: tf.Tensor(0.03616518, shape=(), dtype=float32)
loss: tf.Tensor(0.07027576, shape=(), dtype=float32)
loss: tf.Tensor(0.08640857, shape=(), dtype=float32)
loss: tf.Tensor(0.07403973, shape=(), dtype=float32)
loss: tf.Tensor(0.0810124, shape=(), dtype=float32)
loss: tf.Tensor(0.046619244, shape=(), dtype=float32)
loss: tf.Tensor(0.0596939, shape=(), dtype=float32)
loss: tf.Tensor(0.04780414, shape=(), dtype=float32)
loss: tf.Tensor(0.1822511, shape=(), dtype=float32)
loss: tf.Tensor(0.05032793, shape=(), dtype=float32)
loss: tf.Tensor(0.01999747, shape=(), dtype=float32)
loss: tf.Tensor(0.09919552, shape=(), dtype=float32)
loss: tf.Tensor(0.039717514, shape=(), dtype=float32)
loss: tf.Tensor(0.022742338, shape=(), dtype=float32)
loss: tf.Tensor(0.10596195, shape=(), dtype=float32)
loss: tf.Tensor(0.054720603, shape=(), dtype=float32)
loss: tf.Tensor(0.038140915, shape=(), dtype=float32)
loss: tf.Tensor(0.045980442, shape=(), dtype=float32)
loss: tf.Tensor(0.033574887, shape=(), dtype=float32)
loss: tf.Tensor(0.052256636, shape=(), dtype=float32)
loss: tf.Tensor(0.056070544, shape=(), dtype=float32)
loss: tf.Tensor(0.010709672, shape=(), dtype=float32)
loss: tf.Tensor(0.061581187, shape=(), dtype=float32)
loss: tf.Tensor(6.520536e-05, shape=(), dtype=float32)
TEST LOSS: #####################################
WARNING:tensorflow:11 out of the last 11 calls to <function class_loss at 0x7f46c9e99bf8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
tf.Tensor(0.69710934, shape=(), dtype=float32)
F1 SCORE:
0.8338859
EPOCH  32 #################################
loss: tf.Tensor(0.06423244, shape=(), dtype=float32)
loss: tf.Tensor(0.15754277, shape=(), dtype=float32)
loss: tf.Tensor(0.07442823, shape=(), dtype=float32)
loss: tf.Tensor(0.028912218, shape=(), dtype=float32)
loss: tf.Tensor(0.010217085, shape=(), dtype=float32)
loss: tf.Tensor(0.015072644, shape=(), dtype=float32)
loss: tf.Tensor(0.06775869, shape=(), dtype=float32)
loss: tf.Tensor(0.082869805, shape=(), dtype=float32)
loss: tf.Tensor(0.033763982, shape=(), dtype=float32)
loss: tf.Tensor(0.04072538, shape=(), dtype=float32)
loss: tf.Tensor(0.14669389, shape=(), dtype=float32)
loss: tf.Tensor(0.051392958, shape=(), dtype=float32)
loss: tf.Tensor(0.11294793, shape=(), dtype=float32)
loss: tf.Tensor(0.12375378, shape=(), dtype=float32)
loss: tf.Tensor(0.03410519, shape=(), dtype=float32)
loss: tf.Tensor(0.06403048, shape=(), dtype=float32)
loss: tf.Tensor(0.117122374, shape=(), dtype=float32)
loss: tf.Tensor(0.041681755, shape=(), dtype=float32)
loss: tf.Tensor(0.05316, shape=(), dtype=float32)
loss: tf.Tensor(0.037995458, shape=(), dtype=float32)
loss: tf.Tensor(0.06493871, shape=(), dtype=float32)
loss: tf.Tensor(0.0380991, shape=(), dtype=float32)
loss: tf.Tensor(0.065556556, shape=(), dtype=float32)
loss: tf.Tensor(0.062417284, shape=(), dtype=float32)
loss: tf.Tensor(0.047897678, shape=(), dtype=float32)
loss: tf.Tensor(0.0507532, shape=(), dtype=float32)
loss: tf.Tensor(0.025107853, shape=(), dtype=float32)
loss: tf.Tensor(0.072530314, shape=(), dtype=float32)
loss: tf.Tensor(0.030965235, shape=(), dtype=float32)
loss: tf.Tensor(0.15416642, shape=(), dtype=float32)
loss: tf.Tensor(0.044298705, shape=(), dtype=float32)
loss: tf.Tensor(0.09710509, shape=(), dtype=float32)
loss: tf.Tensor(0.055769637, shape=(), dtype=float32)
loss: tf.Tensor(0.033914905, shape=(), dtype=float32)
loss: tf.Tensor(0.019881198, shape=(), dtype=float32)
loss: tf.Tensor(0.09824912, shape=(), dtype=float32)
loss: tf.Tensor(0.013607033, shape=(), dtype=float32)
loss: tf.Tensor(0.03933793, shape=(), dtype=float32)
loss: tf.Tensor(0.062797755, shape=(), dtype=float32)
loss: tf.Tensor(0.045193072, shape=(), dtype=float32)
